<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="SubstringEx"></A><PRE>
          <FONT SIZE="2"><I>/* SubstringEx */</I><BR>
CREATE FUNCTION CDN.SubstringEx(@str varchar(255),@sep varchar(255),@ix int)
RETURNS 
VARCHAR(255)
AS
BEGIN
	DECLARE @tempstr varchar(255)
	DECLARE @counter int
	DECLARE @pos int

	If @ix &lt; 1 Return ''

	Set @counter = 1
	Set @tempstr = @str

	Set @pos=charindex(@sep,@tempstr,1)

	While @pos&gt;0
	Begin
		if @counter = @ix
		Begin
				set @tempstr = substring(@tempstr,1,@pos-1)
			break
		End

		set @tempstr = substring(@tempstr,@pos+1,len(@tempstr))

		set @pos=charindex(@sep,@tempstr,1)

		If @pos &gt; 0
  		set @counter = @counter + 1
	End  

  If @counter &lt; @ix -1
		Return ''

	Return @tempstr
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>