<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="[POS_EksportUprawnienia]"></A><PRE>
          <FONT SIZE="2"><I>/* [POS_EksportUprawnienia] */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportUprawnienia] 
@rowVersion bigint
AS
BEGIN
SET NOCOUNT ON;
	declare @uprawnienia table(id int,Name nvarchar(50),IsAllowedToAll nvarchar(5))
	insert into @uprawnienia 
	select 1 as [@id], 'Receipt' as [@Name], 'false' as [@IsAllowedToAll] union all
	select 2 as [@id], 'ReceiptQuantityCorrection' as [@Name], 'false' as [@IsAllowedToAll] union all
	select 3 as [@id], 'SalesInvoice' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 4 as [@id], 'SalesInvoiceQuantityCorrection' as [@Name], 'false' as [@IsAllowedToAll] union all
	select 5 as [@id], 'CashBankDeposit' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 6 as [@id], 'CashBankWithdrawal' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 7 as [@id], 'SalesComplaint' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 8 as [@id], 'InternalOrder' as [@Name], 'true' as [@IsAllowedToAll]  union all
	select 9 as [@id], 'TaxFree' as [@Name], 'true' as [@IsAllowedToAll]  union all
	select 10 as [@id], 'DebitNote' as [@Name], 'true' as [@IsAllowedToAll]  union all
	select 11 as [@id], 'WarehouseMovementMinus' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 12 as [@id], 'WarehouseMovementPlus' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 13 as [@id], 'ReceivingAndDeliveryReport' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 14 as [@id], 'SalesOrder' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 15 as [@id], 'SalesQuote' as [@Name], 'true' as [@IsAllowedToAll]  union all
	select 16 as [@id], 'AdvanceInvoice' as [@Name], 'true' as [@IsAllowedToAll]  union all
	select 17 as [@id], 'AdvanceInvoiceCorrection' as [@Name], 'true' as [@IsAllowedToAll]  union all
	select 18 as [@id], 'CollectionPoint' as [@Name], 'true' as [@IsAllowedToAll]  union all
	select 19 as [@id], 'OfflineLogin' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 20 as [@id], 'Configuration' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 21 as [@id], 'UIConfiguration' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 22 as [@id], 'ChangeArticleEndPrice' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 23 as [@id], 'ElementStorno' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 24 as [@id], 'ReceiptStorno' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 25 as [@id], 'ManualOpenDrawer' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 26 as [@id], 'PrintDailyCashReport' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 27 as [@id], 'PrintPeriodCashReport' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 28 as [@id], 'RegisterStatePreview' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 29 as [@id], 'OperatorShiftStart' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 30 as [@id], 'CashRegisterBalanceAtShiftStart' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 31 as [@id], 'ShiftStartWithDifferenceInCashRegisterBalance' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 32 as [@id], 'OtherOperatorsShiftEnd' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 33 as [@id], 'ShiftEndWithoutWithdrawal' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 34 as [@id], 'EndOfTheDay' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 35 as [@id], 'ShiftEndWithDifferenceInCashRegisterBalance' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 36 as [@id], 'Refiscalization' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 37 as [@id], 'AccessToPurchasePrices' as [@Name], 'true' as [@IsAllowedToAll]  union all	
	select 38 as [@id], 'DeliveryStatusChange' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 39 as [@id], 'PaymentStatusChange' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 40 as [@id], 'OtherOperatorsDocumentsEdit' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 41 as [@id], 'ConsentsToPersonalDataProcessing' as [@Name], 'false' as [@IsAllowedToAll]  union all	
	select 42 as [@id], 'ExceedingCashRegisterLimit' as [@Name], 'false' as [@IsAllowedToAll]  union all
	select 43 as [@id], 'CustomersModification' as [@Name],'false' as [@IsAllowedToAll]  union all
	select 44 as [@id], 'InitialPriceModification' as [@Name],'true' as [@IsAllowedToAll]  union all
	select 45 as [@id], 'CreationOfManualCorrections' as [@Name],'false' as [@IsAllowedToAll]  union all
	select 46 as [@id], 'AcceptanceOfUnvalidatedPayments' as [@Name],'true' as [@IsAllowedToAll]  union all
	select 47 as [@id], 'CancellingPaymentCardOperations' as [@Name],'true' as [@IsAllowedToAll]  union all
	select 48 as [@id], 'RefundApproval' as [@Name],'true' as [@IsAllowedToAll] union all

	select 49 as [@id], 'DeliveryNote' as [@Name],'true' as [@IsAllowedToAll] union all
	select 50 as [@id], 'InternalReceipt' as [@Name],'false' as [@IsAllowedToAll] union all
	select 51 as [@id], 'InternalRelease' as [@Name],'false' as [@IsAllowedToAll] union all
	select 52 as [@id], 'EmployeeManagment' as [@Name],'false' as [@IsAllowedToAll] union all
	select 53 as [@id], 'EmployeePasswordChange' as [@Name],'false' as [@IsAllowedToAll] union all
	select 54 as [@id], 'StockLevelsReconciliation' as [@Name],'false' as [@IsAllowedToAll] union all
	select 55 as [@id], 'CanViewOtherOperatorsCashBankTransactions' as [@Name],'false' as [@IsAllowedToAll] union all
	select 56 as [@id], 'CanOpenShiftOffline' as [@Name],'false' as [@IsAllowedToAll] union all
	select 57 as [@id], 'PurchaseOrderReception' as [@Name],
	case when exists (select 1 from cdn.PicoStanowiskaOperatorzy 
					join cdn.OpeKarty on Ope_GIDNumer = PKn_OpeNumer
					join cdn.StaKarty on Ope_StaNumer = Sta_GIDNumer
					join cdn.StaZakazy on StZ_StaNumer = Sta_GIDNumer and StZ_ProcID=2907) then 'false' else 'true' end as [@IsAllowedToAll] union all
	select 58 as [@id], 'AccessToInventoryCount' as [@Name],'false' as [@IsAllowedToAll] union all
	select 59 as [@id], 'InventoryCount' as [@Name],'false' as [@IsAllowedToAll] union all
	select 60 as [@id], 'CanOpenInventoryCount' as [@Name],'false' as [@IsAllowedToAll] union all
	select 61 as [@id], 'CanCloseInventoryCount' as [@Name],'false' as [@IsAllowedToAll] union all
	select 62 as [@id], 'InventoryCountList' as [@Name],'false' as [@IsAllowedToAll] union all
	select 63 as [@id], 'CanOpenInventoryCountList' as [@Name],'false' as [@IsAllowedToAll] union all
	select 64 as [@id], 'CanCloseInventoryCountList' as [@Name],'false' as [@IsAllowedToAll] union all
	select 65 as [@id], 'CanAddProductOnInventoryCountList' as [@Name],'false' as [@IsAllowedToAll] union all
	select 66 as [@id], 'ReportListPreview' as [@Name],'false' as [@IsAllowedToAll] union all
	select 67 as [@id], 'AnotherUserUnclosedReportModification' as [@Name],'false' as [@IsAllowedToAll]
	--UWAGA, przy dodawaniu kolejnych uprawnień zmienić [CDN].[POS_EksportUsunieteObiekty]
	SELECT 1 AS [@RowVersion],(
		select id as [@Id], name as [@Name],IsAllowedToAll as [@IsAllowedToAll] from @uprawnienia --where @rowVersion = 0 --Tylko przy pierwszej synchronizacji?

	for xml path('Permission'), type)
	for xml path('Permissions')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>