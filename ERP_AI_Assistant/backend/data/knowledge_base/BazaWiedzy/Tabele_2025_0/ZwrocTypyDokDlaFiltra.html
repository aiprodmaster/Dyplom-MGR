<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="[ZwrocTypyDokDlaFiltra]"></A><PRE>
          <FONT SIZE="2"><I>/* [ZwrocTypyDokDlaFiltra] */</I><BR>
CREATE FUNCTION [CDN].[ZwrocTypyDokDlaFiltra]
(
 @FiltrId int,
 @SubFiltrId int=null
)
RETURNS TABLE
AS
RETURN
(
select * from (
select 1521 DokTyp, null DokSubTyp, 1 FiltrId, null SubFiltrId --Typ_FZ                        EQUATE(0000010111110001b) !1521   #obiekty:1521,FZ,Faktura zakupu,
union all select 1529, null , 1, null  --Typ_FZK                       EQUATE(0000010111111001b) !1529   #obiekty:1529,FZK,Korekta faktury zakupu,    
union all select 1312, null , 1, null  --Typ_FZ_Zaliczkowa             EQUATE(0000010100100000b) !1312   #obiekty:1312,FZL,Faktura zakupu zaliczkowa,
union all select 1320, null , 1, null  --Typ_FZK_Zaliczkowa            EQUATE(0000010100101000b) !1320   #obiekty:1320,KZL,Korekta faktury zakupu zaliczkowej,
union all select 1489, null , 1, null  --Typ_PZ                        EQUATE(0000010111010001b) !1489   #obiekty:1489,PZ,Przyjęcie zewnętrzne,
union all select 1497, null , 1, null  --Typ_PZK                       EQUATE(0000010111011001b) !1497   #obiekty:1497,PZK,Korekta przyjęcia zewnętrznego,
union all select 1490, null , 1, null  --Typ_PZI                       EQUATE(0000010111010010b) !1490   #obiekty:1490,PZI,Przyjęcie zewnętrzne importowe,
union all select 1498, null , 1, null  --Typ_PKI                       EQUATE(0000010111011010b) !1498   #obiekty:1498,PKI,Korekta przyjęcia importowego,
union all select 1520, null , 1, null  --Typ_FRR                       EQUATE(0000010111110000b) !1520   #obiekty:1520,FRR,Faktura VAT RR,
union all select 1528, null , 1, null  --Typ_FRK                       EQUATE(0000010111111000b) !1528   #obiekty:1528,FRK,Korekta faktury VAT RR,
union all select 3344, null , 1, null  --Typ_FAI                       EQUATE(0000110100010000b) !3344   #obiekty:3344,FAI,Faktura importowa,
union all select 3352, null , 1, null  --Typ_FKI                       EQUATE(0000110100011000b) !3352   #obiekty:3352,FKI,Korekta faktury importowej,
union all select 2002, null , 1, null  --Typ_Przyjecie_Kaucji          EQUATE(0000011111010010b) !2002   #obiekty:2002,PKA,Przyjęcie towarów kaucjonowanych,
union all select 2010, null , 1, null  --Typ_PKK                       EQUATE(0000011111011010b) !2010   #obiekty:2010,PKK,Korekta przyjęcia towarów kaucjonowanych,
union all select 1617, null , 1, null  --Typ_Przychod_Wewnetrzny       EQUATE(0000011001010001b) !1617   #obiekty:1617,PW,Przychód wewnętrzny,
union all select 1625, null , 1, null  --Typ_PWK                       EQUATE(0000011001011001b) !1625   #obiekty:1625,PWK,Korekta przychodu wewnętrznego,
union all select 2033, null , 1, null  --Typ_FS                        EQUATE(0000011111110001b) !2033   #obiekty:2033,FS,Faktura sprzedaży,
union all select 1824, null , 1, null  --Typ_FS_Zaliczkowa             EQUATE(0000011100100000b) !1824   #obiekty:1824,FSL,Faktura sprzedaży zaliczkowa,
union all select 1832, null , 1, null  --Typ_FSK_Zaliczkowa            EQUATE(0000011100101000b) !1832   #obiekty:1832,KSL,Korekta faktury sprzedaży zaliczkowej,
union all select 2041, null , 1, null  --Typ_FSK                       EQUATE(0000011111111001b) !2041   #obiekty:2041,FSK,Korekta faktury sprzedaży,
union all select 2036, null , 1, null  --Typ_FW                        EQUATE(0000011111110100b) !2036   #obiekty:2036,FW,Faktura wewnętrzna,
union all select 2044, null , 1, null  --Typ_FWK                       EQUATE(0000011111111100b) !2044   #obiekty:2044,FWK,Korekta faktury wewnętrznej,
union all select 2001, null , 1, null  --Typ_WZ                        EQUATE(0000011111010001b) !2001   #obiekty:2001,WZ,Wydanie zewnętrzne,
union all select 2009, null , 1, null  --Typ_WZK                       EQUATE(0000011111011001b) !2009   #obiekty:2009,WZK,Korekta wydania zewnętrznego,
union all select 2034, null , 1, null  --Typ_PA                        EQUATE(0000011111110010b) !2034   #obiekty:2034,PA,Paragon,
union all select 2042, null , 1, null  --Typ_PAK                       EQUATE(0000011111111010b) !2042   #obiekty:2042,PAK,Korekta paragonu,
union all select 2037, null , 1, null  --Typ_FSE                       EQUATE(0000011111110101b) !2037   #obiekty:2037,FSE,Faktura eksportowa,
union all select 2045, null , 1, null  --Typ_FKE                       EQUATE(0000011111111101b) !2045   #obiekty:2045,FKE,Korekta faktury eksportowej,
union all select 2005, null , 1, null  --Typ_WZE                       EQUATE(0000011111010101b) !2005   #obiekty:2005,WZE,Wydanie zewnętrzne eksportowe,
union all select 2013, null , 1, null  --Typ_WKE                       EQUATE(0000011111011101b) !2013   #obiekty:2013,WKE,Korekta wydania eksportowego,
union all select 2000, null , 1, null  --Typ_Wydanie_Kaucji            EQUATE(0000011111010000b) !2000   #obiekty:2000,WKA,Wydanie towarów kaucjonowanych,
union all select 2008, null , 1, null  --Typ_WKK                       EQUATE(0000011111011000b) !2008   #obiekty:2008,WKK,Korekta wydania towarów kaucjonowanych,
union all select 1616, null , 1, null  --Typ_Rozchod_Wewnetrzny        EQUATE(0000011001010000b) !1616   #obiekty:1616,RW,Rozchód wewnętrzny,
union all select 1624, null , 1, null  --Typ_RWK                       EQUATE(0000011001011000b) !1624   #obiekty:1624,RWK,Korekta rozchodu wewnętrznego,
union all select 1232, null , 1, null  --Typ_KDZ                       EQUATE(0000010011010000b) !1232   #obiekty:1232,KDZ,Koszt dodatkowy zakupu,
union all select 4608, null , 1, null  --Typ_KBN                       EQUATE(0001001000000000b) !4608	#obiekty:4608,KBN,Kompensata braków i nadwyżek

union all select 960, null , 2, null--Typ_Zam                       EQUATE(0000001111000000B) ! 960   #obiekty:960,Zam,Zamówienie,
union all select 8832, 640, 2, 1 --Typ_OZ                        EQUATE(0010001010000000b) !8832   #obiekty:8832,OZ,Oferta na zakup
union all select 8960, 768, 2, 2 --Typ_OS                        EQUATE(0010001100000000b) !8960   #obiekty:8960,OS,Oferta sprzedaży
union all select 9344, 1152, 2, 4 --Typ_ZZ                        EQUATE(0010010010000000b) !9344   #obiekty:9344,ZZ,Zamówienie zakupu
union all select 9472, 1280, 2, 8 --Typ_ZS                        EQUATE(0010010100000000b) !9472   #obiekty:9472,ZS,Zamówienie sprzedaży
union all select 10880, 2688, 2, 16 --Typ_ZOZ                       EQUATE(0010101010000000b) !10880  #obiekty:10880,ZOZ,Zapytanie ofertowe na zakup
union all select 11008, 2816, 2, 32 --Typ_ZOS                       EQUATE(0010101100000000b) !11008  #obiekty:11008,ZOS,Zapytanie ofertowe na sprzedaż

union all select 784, null , 4, 1	--TYP_Zapis_kasowy              EQUATE(0000001100010000B) ! 784   #obiekty:784,KB,Zapis kasowy/bankowy,
union all select 4144, null , 4, 2	--TYP_Nota_Memorialowa          EQUATE(0001000000110000B) !4144   #obiekty:4144,NM,Nota memoriałowa,
union all select 2833, null , 4, 4	--TYP_Upomnienie                EQUATE(0000101100010001B) !2833   #obiekty:2833,UP,Upomnienie,
union all select 2832, null , 4, 8	--TYP_Nota_odsetkowa            EQUATE(0000101100010000B) !2832   #obiekty:2832,NO,Nota odsetkowa,
union all select 2976, null , 4, 16 --TYP_Lista_Plac                EQUATE(0000101110100000B) !2976   #obiekty:2976,LP,Lista płac,
union all select 7680, null , 4, 32	--TYP_BO                        EQUATE(0001111000000000B) !7680   #obiekty:7680,BO,Bilans otwarcia,
union all select 7942, null , 4, 64 --Typ_PRG                       EQUATE(0001111100000110B) !7942   #obiekty:7942,PRG,Prolongata,
union all select 7943, null , 4, 128 --Typ_PRK                       EQUATE(0001111100000111B) !7943   #obiekty:7943,PRK,Korekta prolongaty,

union all select 4192, null , 8, 1 --Typ_kompletacja               EQUATE(0001000001100000B) ! 4192  #obiekty:4192,ZK,Zlecenie kompletacji,
union all select 4208, null , 8, 2 --Typ_dekompletacja             EQUATE(0001000001110000B) ! 4208  #obiekty:4208,ZD,Zlecenie dekompletacji,
union all select 4240, null , 8, 4 --Typ_Zlecenie_serwisowe        EQUATE(0001000010010000B) ! 4240  #obiekty:4240,ZLS,Zlecenie serwisowe,
union all select 4345, null , 8, 8 --Typ_SerwisObiektu             EQUATE(0001000011111001B) ! 4345  #obiekty:4345,ZSE,Zlecenie remontowo-serwisowe,
union all select 4346, null , 8, 16 --Typ_RemontObiektu             EQUATE(0001000011111010B) ! 4346  #obiekty:4346,ZRE,Zlecenie remontowe,
union all select 4700, null , 8, 32 --Typ_ZSR                       EQUATE(0001001001011100B) !4700   #obiekty:4700,ZSR,Zlecenie serwisowe,
union all select 14343, null , 8, 64 --Typ_ProdZlecenia              EQUATE(0011100000000111b) !14343  #obiekty:14343,ZP,Zlecenie produkcyjne
union all select 14350, null , 8, 128 --Typ_Harmonogram               EQUATE(0011100000001110b) !14350  #obiekty:14350,HPR,Harmonogram projektu
union all select 3584, null , 8, 256 --Typ_RLS                       EQUATE(0000111000000000b) !3584   #obiekty:3584,RLS,Reklamacja sprzedaży,
union all select 3585, null , 8, 512 --Typ_RLZ                       EQUATE(0000111000000001b) !3585   #obiekty:3585,RLZ,Reklamacja zakupu,
union all select 4710, null , 8, 1024 --Typ_PLP                       EQUATE(0001001001100110B) !4710   #obiekty:4710,PLP,Plan przeglądu technicznego,


union all select 14451, null , 16, 1 --Typ_SWD                       EQUATE(0011100001110011b) !14451  #obiekty:14451,DWD,Dokument wychodzący,
union all select 14452, null , 16, 2 --Typ_SWW                       EQUATE(0011100001110100b) !14452  #obiekty:14452,DWW,Dokument wewnętrzny,
union all select 14453, null , 16, 4 --Typ_SPW                       EQUATE(0011100001110101b) !14453  #obiekty:14453,DPD,Dokument przychodzący,

union all select 4595, null , 32, 1 --Typ_BDT                       EQUATE(0001000111110011B) !4595   #obiekty:4595,BDT,Budżet projektu
union all select 4596, null , 32, 2 --Typ_BPE                       EQUATE(0001000111110100B) !4596   #obiekty:4596,BPE,element budżet projektu
union all select 4592, null , 32, 4--Typ_PrjStruktura              EQUATE(0001000111110000B) !4592   #obiekty:4592,PRJ,Projekt
union all select -4592, null , 32, 8 --Typ_GPrjStruktura             EQUATE(-Typ_PrjStruktura) !-4592  #obiekty:-4592,GPRJ,Projekt - węzeł

) a where a.FiltrId &amp; @FiltrId &gt; 0 and (@SubFiltrId is null or @SubFiltrId &amp; a.SubFiltrId&gt;0)
			 
)
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>