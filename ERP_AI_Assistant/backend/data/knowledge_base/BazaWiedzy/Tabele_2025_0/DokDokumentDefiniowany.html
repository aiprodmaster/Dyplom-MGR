<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="DokDokumentDefiniowany"></A><PRE>
          <FONT SIZE="2"><I>/* DokDokumentDefiniowany */</I><BR>
CREATE      function CDN.DokDokumentDefiniowany(@lTypDok int)
RETURNS int
AS
BEGIN

DECLARE @lTypDokumentu int

SET @lTypDokumentu = @lTypDok


  set @lTypDokumentu =  (
  Case 	when  	@lTypDok = 2043   -- RAK
	     or @lTypDok = 2035   -- RA
	then
	        2033		  -- FS  
   	when  	@lTypDok = 1497   -- PZK
	     or @lTypDok = 2009   -- WZK
	     or @lTypDok = 2013   -- WKE
	     or @lTypDok = 1529   -- FZK
	     or @lTypDok = 2041   -- FSK
	     or @lTypDok = 2045   -- FKE
	     or @lTypDok = 2044   -- FWK
	     or @lTypDok = 2042   -- PAK
	     or @lTypDok = 1625   -- PWK
	     or @lTypDok = 1498   -- PKI
	     or @lTypDok = 1624   -- RWK
		 or @lTypDok = 2008   -- WKK
	    or @lTypDok = 2010   -- PKK
	    or @lTypDok = 2047   -- RSS
	    or @lTypDok = 1528   -- FRK
	    or @lTypDok = 1320   -- KZL
		or @lTypDok = 1832   -- KSL
        or @lTypDok = 1836   -- KEL
		or @lTypDok = 1498   -- PKI

	then
 		( @lTypDok &amp; 0xFFF7)   -- czyszczę bit korekty
	when  	@lTypDok = 1489   -- PZ
	     or @lTypDok = 2001   -- WZ
	     or @lTypDok = 2005   -- WZE
	     or @lTypDok = 1521   -- FZ
	     or @lTypDok = 2033   -- FS
	     or @lTypDok = 2037   -- FSE
	     or @lTypDok = 2036   -- FW
	     or @lTypDok = 2034   -- PA
         or @lTypDok = 1968   -- TF
	     or @lTypDok = 1616   -- RW
	     or @lTypDok = 1617   -- PW
	     or @lTypDok = 1600   -- MM
	     or @lTypDok = 2000   -- WKA
	     or @lTypDok = 2002   -- PKA
	     or @lTypDok = 2039   -- RS
	     or @lTypDok = 1520   -- FRR
	     or @lTypDok = 1312   -- FZL
	  	 or @lTypDok = 1824   -- FSL
         or @lTypDok = 1828   -- FEL
		 or @lTypDok = 1490   -- PZI
		 or @lTypDok = 1603   -- MMW
		 or @lTypDok = 1604   -- MMP

	then
		@lTypDok
	when    @lTypDok = 4192	  -- ZLK
	     or @lTypDok = 4208   -- ZLD
         or @lTypDok = 4345   -- ZSE
         or @lTypDok = 4346   -- ZRE
         or @lTypDok = 4700   -- ZSR
	then
		@lTypDok
	when    @lTypDok = 8832	  -- OS
	     or @lTypDok = 8960   -- 0Z
	     or @lTypDok = 9344   -- ZZ
	     or @lTypDok = 9472   -- ZS
	     or @lTypDok = 9473   -- ZW
	then
		@lTypDok
	when    @lTypDok = 1601	  -- WM
	     or @lTypDok = 1089   -- PM
	     or @lTypDok = 1602   -- MP
		 or @lTypDok = 1605   -- ZWM
		 or @lTypDok = 1093	  -- AWD   
	then
		@lTypDok
	when    @lTypDok = 14448	  -- BST
	then
		@lTypDok
	when    @lTypDok = 4176	  -- KM
	     or @lTypDok = 4177   -- WK
	     or @lTypDok = 4180   -- WH
	then
		@lTypDok
    when @lTypDok = 14360 -- PP 
    then
		@lTypDok
	else
		0
	end
	)
	Return @lTypDokumentu
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>