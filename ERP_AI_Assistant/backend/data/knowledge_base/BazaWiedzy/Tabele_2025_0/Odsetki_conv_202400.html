<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="Wype%C5%82nienie tabeli Odsetki 2024.0.0 "></A><PRE>
          <FONT SIZE="2"><I>/* Wypełnienie tabeli Odsetki 2024.0.0  */</I><BR>
set nocount on

declare @ustawoweZaOpoznienie int = 0
declare @ustawoweWTranHandl int = 0
declare @kapitalowe int = 0
declare @ODSLp int = 1

select @ustawoweZaOpoznienie = SLW_ID from cdn.Slowniki where SLW_Kategoria = 'Typy odsetek' and SLW_WartoscS = 'Ustawowe za opóźnienie' and SLW_WersjaNr=1
select @ustawoweWTranHandl = SLW_ID from cdn.Slowniki where SLW_Kategoria = 'Typy odsetek' and SLW_WartoscS = 'Ustawowe w transakcjach handlowych' and SLW_WersjaNr=1
select @kapitalowe = SLW_ID from cdn.Slowniki where SLW_Kategoria = 'Typy odsetek' and SLW_WartoscS = 'Kapitałowe' and SLW_WersjaNr=1

if not exists(select ODS_GIDLp from CDN.Odsetki where ODS_DataO=DATEDIFF(d,'18001228','20230907') and ODS_SlwTypOdsetek=@kapitalowe)
	begin
	select @ODSLp = max(ODS_GIDLp)+1 from CDN.Odsetki where ODS_GidNumer = 1 
	insert into CDN.Odsetki(ODS_GIDTyp,ODS_GIDFirma,ODS_GIDNumer,ODS_GIDLp,ODS_DataO,ODS_ProcOds,ODS_TypOdsetek,ODS_TStamp,ODS_SlwTypOdsetek)
	values(2848,CDN.GIDFirma(),1,IsNull(@ODSLp,1),DATEDIFF(d,'18001228','20230907'),9.50,3,0, @kapitalowe)
	end

if not exists(select ODS_GIDLp from CDN.Odsetki where ODS_DataO=DATEDIFF(d,'18001228','20230907') and ODS_SlwTypOdsetek=@ustawoweZaOpoznienie)
	begin
	select @ODSLp = max(ODS_GIDLp)+1 from CDN.Odsetki where ODS_GidNumer = 1 
	insert into CDN.Odsetki(ODS_GIDTyp,ODS_GIDFirma,ODS_GIDNumer,ODS_GIDLp,ODS_DataO,ODS_ProcOds,ODS_TypOdsetek,ODS_TStamp,ODS_SlwTypOdsetek)
	values(2848,CDN.GIDFirma(),1,IsNull(@ODSLp,1),DATEDIFF(d,'18001228','20230907'),11.50,3,0, @ustawoweZaOpoznienie)
	end

if not exists(select ODS_GIDLp from CDN.Odsetki where ODS_DataO=DATEDIFF(d,'18001228','20231005') and ODS_SlwTypOdsetek=@kapitalowe)
	begin
	select @ODSLp = max(ODS_GIDLp)+1 from CDN.Odsetki where ODS_GidNumer = 1 
	insert into CDN.Odsetki(ODS_GIDTyp,ODS_GIDFirma,ODS_GIDNumer,ODS_GIDLp,ODS_DataO,ODS_ProcOds,ODS_TypOdsetek,ODS_TStamp,ODS_SlwTypOdsetek)
	values(2848,CDN.GIDFirma(),1,IsNull(@ODSLp,1),DATEDIFF(d,'18001228','20231005'),9.25,3,0, @kapitalowe)
	end

if not exists(select ODS_GIDLp from CDN.Odsetki where ODS_DataO=DATEDIFF(d,'18001228','20231005') and ODS_SlwTypOdsetek=@ustawoweZaOpoznienie)
	begin
	select @ODSLp = max(ODS_GIDLp)+1 from CDN.Odsetki where ODS_GidNumer = 1 
	insert into CDN.Odsetki(ODS_GIDTyp,ODS_GIDFirma,ODS_GIDNumer,ODS_GIDLp,ODS_DataO,ODS_ProcOds,ODS_TypOdsetek,ODS_TStamp,ODS_SlwTypOdsetek)
	values(2848,CDN.GIDFirma(),1,IsNull(@ODSLp,1),DATEDIFF(d,'18001228','20231005'),11.25,3,0, @ustawoweZaOpoznienie)
	end

if not exists(select ODS_GIDLp from CDN.Odsetki where ODS_DataO=DATEDIFF(d,'18001228','20240101') and ODS_SlwTypOdsetek=@ustawoweWTranHandl)
	begin
	select @ODSLp = max(ODS_GIDLp)+1 from CDN.Odsetki where ODS_GidNumer = 1 
	insert into CDN.Odsetki(ODS_GIDTyp,ODS_GIDFirma,ODS_GIDNumer,ODS_GIDLp,ODS_DataO,ODS_ProcOds,ODS_TypOdsetek,ODS_TStamp,ODS_SlwTypOdsetek)
	values(2848,CDN.GIDFirma(),1,IsNull(@ODSLp,1),DATEDIFF(d,'18001228','20240101'),15.75,3,0, @ustawoweWTranHandl)
	end

set nocount off 
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>