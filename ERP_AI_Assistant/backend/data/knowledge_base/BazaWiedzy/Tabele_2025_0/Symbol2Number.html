<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="Symbol2Number"></A><PRE>
          <FONT SIZE="2"><I>/* Symbol2Number */</I><BR>
CREATE FUNCTION CDN.Symbol2Number (@Znak varchar(6), @Wzorzec char(1))
RETURNS smallint
 AS
BEGIN
	--wzorzec 
		--A lub a - litery
		--1 - liczby arabskie
		--X lub x liczby rzymskie

	declare @rv smallint
	
	if @Wzorzec = '1' 
		goto liczby
	else if (@Wzorzec = 'X' or @Wzorzec = 'x')
		goto rzymskie
	else if (@Wzorzec = 'A' or @Wzorzec = 'a')
		goto litery

	goto wyjscie

liczby:	
	set @rv = convert(smallint, @Znak)
	goto wyjscie

litery:
	set @rv = ASCII(UPPER(@Znak)) - ASCII('A') + 1
	goto wyjscie 

rzymskie:
	if @Znak = 'I'
		set @rv = 1
	else if @Znak = 'II'
		set @rv = 2
	else if @Znak = 'III'
		set @rv = 3
	else if @Znak = 'IV'
		set @rv = 4
	else if @Znak = 'V'
		set @rv = 5
	else if @Znak = 'VI'
		set @rv = 6
	else if @Znak = 'VII'
		set @rv = 7
	else if @Znak = 'VIII'
		set @rv = 8
	else if @Znak = 'IX'
		set @rv = 9
	else if @Znak = 'X'
		set @rv = 10
	else if @Znak = 'XI'
		set @rv = 11
	else if @Znak = 'XII'
		set @rv = 12
	else if @Znak = 'XIII'
		set @rv = 13
	else if @Znak = 'XIV'
		set @rv = 14
	else if @Znak = 'XV'
		set @rv = 15
	else if @Znak = 'XVI'
		set @rv = 16
	else if @Znak = 'XVII'
		set @rv = 17
	else if @Znak = 'XVIII'
		set @rv = 18
	else if @Znak = 'XIX'
		set @rv = 19
	else if @Znak = 'XX'
		set @rv = 20
	else if @Znak = 'XXI'
		set @rv = 21
	else if @Znak = 'XXII'
		set @rv = 22
	else if @Znak = 'XXIII'
		set @rv = 23
	else if @Znak = 'XXIV'
		set @rv = 24
	else if @Znak = 'XXV'
		set @rv = 25
	else if @Znak = 'XXVI'
		set @rv = 26
	else if @Znak = 'XXVII'
		set @rv = 27
	else if @Znak = 'XXVIII'
		set @rv = 28
	else if @Znak = 'XXIX'
		set @rv = 29
	else if @Znak = 'XXX'
		set @rv = 30
	else if @Znak = 'XXXI'
		set @rv = 31
	else if @Znak = 'XXXII'
		set @rv = 32
	else if @Znak = 'XXXIII'
		set @rv = 33
	else if @Znak = 'XXXIV'
		set @rv = 34
	else if @Znak = 'XXXV'
		set @rv = 35
	else if @Znak = 'XXXVI'
		set @rv = 36
	else if @Znak = 'XXXVII'
		set @rv = 37
	else if @Znak = 'XXXVIII'
		set @rv = 38
	else if @Znak = 'XXXIX'
		set @rv = 39
	else if @Znak = 'XL'
		set @rv = 40
	else if @Znak = 'XLI'
		set @rv = 41
	else if @Znak = 'XLII'
		set @rv = 42
	else if @Znak = 'XLIII'
		set @rv = 43
	else if @Znak = 'XLIV'
		set @rv = 44
	else if @Znak = 'XLV'
		set @rv = 45
	else if @Znak = 'XLVI'
		set @rv = 46
	else if @Znak = 'XLVII'
		set @rv = 47
	else if @Znak = 'XLVIII'
		set @rv = 48
	else if @Znak = 'XLIX'
		set @rv = 49
	else if @Znak = 'L'
		set @rv = 50
	else if @Znak = 'LI'
		set @rv = 51
	else if @Znak = 'LII'
		set @rv = 52
	else if @Znak = 'LIII'
		set @rv = 53
	else if @Znak = 'LIV'
		set @rv = 54
	else if @Znak = 'LV'
		set @rv = 55
	else if @Znak = 'LVI'
		set @rv = 56
	else if @Znak = 'LVII'
		set @rv = 57
	else if @Znak = 'LVIII'
		set @rv = 58
	else if @Znak = 'LIX'
		set @rv = 59
	else if @Znak = 'LX'
		set @rv = 60	
	
	goto wyjscie

wyjscie:
	return @rv

END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>