<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportNominaly"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportNominaly */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportNominaly' and type = 'P')
drop procedure CDN.POS_EksportNominaly;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportNominaly"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportNominaly */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportNominaly]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('Denomination'), type)
	for xml path('Denominations')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportNominaly"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportNominaly */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportNominaly TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportRodzajeCenGrupKnt"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportRodzajeCenGrupKnt */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportRodzajeCenGrupKnt' and type = 'P')
drop procedure CDN.POS_EksportRodzajeCenGrupKnt;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportRodzajeCenGrupKnt"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportRodzajeCenGrupKnt */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportRodzajeCenGrupKnt]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('CustomerGroupPriceType'), type)
	for xml path('CustomerGroupPriceTypes')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportRodzajeCenGrupKnt"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportRodzajeCenGrupKnt */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportRodzajeCenGrupKnt TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportPunktyZbiorcze"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportPunktyZbiorcze */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportPunktyZbiorcze' and type = 'P')
drop procedure CDN.POS_EksportPunktyZbiorcze;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportPunktyZbiorcze"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportPunktyZbiorcze */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportPunktyZbiorcze]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('CollectionPoint'), type)
	for xml path('CollectionPoints')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportPunktyZbiorcze"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportPunktyZbiorcze */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportPunktyZbiorcze TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportElementyZestawu"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportElementyZestawu */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportElementyZestawu' and type = 'P')
drop procedure CDN.POS_EksportElementyZestawu;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportElementyZestawu"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportElementyZestawu */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportElementyZestawu]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('SetElement'), type)
	for xml path('SetElements')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportElementyZestawu"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportElementyZestawu */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportElementyZestawu TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportCenyPartii"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportCenyPartii */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportCenyPartii' and type = 'P')
drop procedure CDN.POS_EksportCenyPartii;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportCenyPartii"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportCenyPartii */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportCenyPartii]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('LotPrice'), type)
	for xml path('LotPrices')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportCenyPartii"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportCenyPartii */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportCenyPartii TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportCenyProgowe"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportCenyProgowe */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportCenyProgowe' and type = 'P')
drop procedure CDN.POS_EksportCenyProgowe;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportCenyProgowe"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportCenyProgowe */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportCenyProgowe]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('ThresholdPrice'), type)
	for xml path('ThresholdPrices')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportCenyProgowe"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportCenyProgowe */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportCenyProgowe TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportObrazki"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportObrazki */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportObrazki' and type = 'P')
drop procedure CDN.POS_EksportObrazki;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportObrazki"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportObrazki */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportObrazki] 
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;	
	

	declare @TypId int = (select slw_id from cdn.slowniki where slw_kategoria = 'Typy załączników' and SLW_WartoscS='Obraz')
	declare @Obrazki TABLE([@Id] int, [@Extension] nvarchar(32),[@ModificationDate] datetime,[@IsActive] varchar(5),[@IsUpToDate] varchar(5), [@IsThumbnailUpToDate] varchar(5),RW int)
	
	IF EXISTS(select * FROM CDN.DaneBinarne where DAB_Retail=1 AND DAB_TypId = @TypId AND (@RowVersion = 0 OR DAB_CzasModyfikacji &gt; @RowVersion))
	OR EXISTS(select 1 from cdn.POS_OddzialyDoEksportu(@PointOfSaleId,@RowVersion) where @PointOfSaleId is null and oddzialBylWyslany = 0)

	BEGIN
		
		INSERT INTO @Obrazki 
		SELECT distinct
				 DAB_ID as [@Id],
				 DAB_Rozszerzenie/*reverse(left(reverse(DAB_URL),charindex('.',reverse(DAB_URL))-1))*/ as [@Extension],
				 DATEADD(second,DAB_CzasModyfikacji,convert(datetime,'01-01-1990',105)) as [@ModificationDate],
				 case when DAB_Archiwalny = 0 then 'true' else 'false' end as [@IsActive],
				 'true' as [@IsUpToDate],
				 'true' as [@IsThumbnailUpToDate],
				 case when @PointOfSaleId is null and oddzialBylWyslany = 0 and PSaDataDodania &gt; DAB_CzasModyfikacji then PSaDataDodania else DAB_CzasModyfikacji end
					from cdn.POS_OddzialyDoEksportu(@PointOfSaleId, @RowVersion)
					cross apply CDN.POS_TwrDoEksportu(PSaID,0)				
					join CDN.DaneObiekty on DAO_ObiTyp = 16  AND DAO_ObiNumer = TwrGIDNumer
					join CDN.DaneBinarne on DAB_ID=DAO_DABId
					where DAB_Retail=1 AND DAB_TypId = @TypId AND (@RowVersion = 0 OR DAB_CzasModyfikacji &gt; @RowVersion OR (@PointOfSaleId is null and oddzialBylWyslany = 0))
		INSERT INTO @Obrazki 
		SELECT distinct
				 DAB_ID as [@Id],
				 DAB_Rozszerzenie/*reverse(left(reverse(DAB_URL),charindex('.',reverse(DAB_URL))-1))*/ as [@Extension],
				 DATEADD(second,DAB_CzasModyfikacji,convert(datetime,'01-01-1990',105)) as [@ModificationDate],
				 case when DAB_Archiwalny = 0 then 'true' else 'false' end as [@IsActive],
				 'true' as [@IsUpToDate],
				 'true' as [@IsThumbnailUpToDate],
				 DAB_CzasModyfikacji
					from CDN.DaneObiekty			
					join CDN.DaneBinarne on DAB_ID=DAO_DABId
					where DAB_Retail=1 AND DAB_TypId = @TypId AND (@RowVersion = 0 OR DAB_CzasModyfikacji &gt; @RowVersion)
					AND DAO_ObiTyp = -16


	END
		

	select
		coalesce((select case when MAX(RW) &gt; @RowVersion THEN MAX(RW) ELSE @RowVersion END FROM @Obrazki),0) as [@RowVersion], 

		(		
			SELECT [@Id] , [@Extension] ,[@ModificationDate] ,[@IsActive] ,[@IsUpToDate] , [@IsThumbnailUpToDate] FROM @Obrazki
			for xml path('Picture'), type)
		for xml path('Pictures')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportObrazki"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportObrazki */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportObrazki TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportObrazkiPartii"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportObrazkiPartii */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportObrazkiPartii' and type = 'P')
drop procedure CDN.POS_EksportObrazkiPartii;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportObrazkiPartii"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportObrazkiPartii */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportObrazkiPartii] 
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('LotPicture'), type)
	for xml path('LotPictures')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportObrazkiPartii"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportObrazkiPartii */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportObrazkiPartii TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportAktualneNumery"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportAktualneNumery */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportAktualneNumery' and type = 'P')
drop procedure CDN.POS_EksportAktualneNumery;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportAktualneNumery"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportAktualneNumery */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportAktualneNumery]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('CurrentNumber'), type)
	for xml path('CurrentNumbers')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportAktualneNumery"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportAktualneNumery */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportAktualneNumery TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportDomyslneJednostki"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportDomyslneJednostki */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportDomyslneJednostki' and type = 'P')
drop procedure CDN.POS_EksportDomyslneJednostki;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportDomyslneJednostki"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportDomyslneJednostki */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportDomyslneJednostki]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN 
SET NOCOUNT ON;
	
	select
		0 as [@RowVersion], (
		select distinct
			dok_id as [@DocumentTypeId],
			Twj_Id as [@ProductUnitId],
			case when Twr_JMBlokujZmiane in (1,3) then 1 else 0 end as [@LockChange]
			from cdn.twrkarty 
			cross join cdn.POS_OddzialyDoEksportu(@PointOfSaleId, @RowVersion)
			join cdn.twrjm on TwJ_TwrNumer = Twr_GIDNumer AND TwJ_TwrLp=Twr_JmDomyslna
			cross apply cdn.POS_TwrDoEksportu(PSaID,0)
			join cdn.DokDefinicje on Dok_FrsId = PckCentrumID
			where dok_gidtyp in (2033,2041,2034,2042) and twr_gidnumer= TwrGidNumer
	for xml path('DefaultUnit'), type)
	for xml path('DefaultUnits')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportDomyslneJednostki"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportDomyslneJednostki */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportDomyslneJednostki TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportTransakcje"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportTransakcje */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportTransakcje' and type = 'P')
drop procedure CDN.POS_EksportTransakcje;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportTransakcje"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportTransakcje */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportTransakcje]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('Transaction'), type)
	for xml path('Transactions')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportTransakcje"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportTransakcje */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportTransakcje TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportZnizki"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportZnizki */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportZnizki' and type = 'P')
drop procedure CDN.POS_EksportZnizki;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportZnizki"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportZnizki */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportZnizki]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
		for xml path('Discount'), type
	) for xml path('Discounts')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportZnizki"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportZnizki */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportZnizki TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportOferty"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportOferty */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportOferty' and type = 'P')
drop procedure CDN.POS_EksportOferty;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportOferty"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportOferty */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportOferty]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('SalesQuote'), type)
	for xml path('SalesQuotes')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportOferty"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportOferty */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportOferty TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportOkresyHandlowe"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportOkresyHandlowe */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportOkresyHandlowe' and type = 'P')
drop procedure CDN.POS_EksportOkresyHandlowe;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportOkresyHandlowe"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportOkresyHandlowe */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportOkresyHandlowe]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('TradingPeriod'), type)
	for xml path('TradingPeriods')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportOkresyHandlowe"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportOkresyHandlowe */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportOkresyHandlowe TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportLimityStanuGotowki"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportLimityStanuGotowki */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportLimityStanuGotowki' and type = 'P')
drop procedure CDN.POS_EksportLimityStanuGotowki;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportLimityStanuGotowki"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportLimityStanuGotowki */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportLimityStanuGotowki]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('CashStateLimit'), type)
	for xml path('CashStateLimits')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportLimityStanuGotowki"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportLimityStanuGotowki */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportLimityStanuGotowki TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportObiektyNiestandardowe"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportObiektyNiestandardowe */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportObiektyNiestandardowe' and type = 'P')
drop procedure CDN.POS_EksportObiektyNiestandardowe;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportObiektyNiestandardowe"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportObiektyNiestandardowe */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportObiektyNiestandardowe]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('CustomObject'), type)
	for xml path('CustomObjects')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportObiektyNiestandardowe"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportObiektyNiestandardowe */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportObiektyNiestandardowe TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportLayoutyGrupOperatorow"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportLayoutyGrupOperatorow */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportLayoutyGrupOperatorow' and type = 'P')
drop procedure CDN.POS_EksportLayoutyGrupOperatorow;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportLayoutyGrupOperatorow"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportLayoutyGrupOperatorow */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportLayoutyGrupOperatorow]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (
		select distinct
			Dab_ID as [@LayoutId],
			Sta_GIDNumer as [@GroupId]
		from cdn.PicoStanowiskaOperatorzy 
		join cdn.OpeKarty on Ope_GIDNumer = PKn_OpeNumer
		join cdn.StaKarty on Ope_StaNumer = Sta_GIDNumer
		join CDN.DaneObiekty on DAO_ObiNumer = Sta_GIDNumer and DAO_ObiTyp = Sta_GIDTyp
		join CDN.DaneBinarne on DAB_ID = DAO_DABId
		where PKn_PSaID = @PointOfSaleId AND DAB_TypId =  (select top 1 slw_id from CDN.Slowniki where SLW_Kategoria = 'Typy załączników' AND SLW_WartoscS = 'Profile POS')
	for xml path('LayoutSecurityGroup'), type)
	for xml path('LayoutSecurityGroups')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportLayoutyGrupOperatorow"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportLayoutyGrupOperatorow */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportLayoutyGrupOperatorow TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportTypyAdresow"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportTypyAdresow */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportTypyAdresow' and type = 'P')
drop procedure CDN.POS_EksportTypyAdresow;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportTypyAdresow"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportTypyAdresow */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportTypyAdresow]
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (
		select * from(
			select 0 as [@Id], 0 as [@POSAddressType], 'Adres' as [@Name] 
			union
			select 1 as [@Id], 1 as [@POSAddressType], 'Adres dostawy' as [@Name] 
			union
			select 2 as [@Id], 2 as [@POSAddressType], 'Adres oddziału' as [@Name] 
			union
			select 3 as [@Id], 3 as [@POSAddressType], 'Adres pocztowy' as [@Name] 
			union
			select 4 as [@Id], 4 as [@POSAddressType], 'Adres rozliczeniowy' as [@Name] 
			union
			select 5 as [@Id], 5 as [@POSAddressType], 'Adres zamieszkania' as [@Name] 
			union
			select 6 as [@Id], 6 as [@POSAddressType], 'Adres inny' as [@Name]) a
	for xml path('AddressType'), type)
	for xml path('AddressTypes')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportTypyAdresow"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportTypyAdresow */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportTypyAdresow TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportMaskiWalidacjiPol"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportMaskiWalidacjiPol */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportMaskiWalidacjiPol' and type = 'P')
drop procedure CDN.POS_EksportMaskiWalidacjiPol;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportMaskiWalidacjiPol"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportMaskiWalidacjiPol */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportMaskiWalidacjiPol] 
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		from cdn.KrajeCelne
		where KPC_Kod='PL'
	for xml path('FieldValidationMask'), type)
	for xml path('FieldValidationMasks')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportMaskiWalidacjiPol"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportMaskiWalidacjiPol */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportMaskiWalidacjiPol TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportCentraFirmy"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportCentraFirmy */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportCentraFirmy' and type = 'P')
drop procedure CDN.POS_EksportCentraFirmy;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportCentraFirmy"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportCentraFirmy */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportCentraFirmy]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;

	select
		0 as [@RowVersion], (
		select
			Frs_Id as [@Id],
			Frs_Nazwa as [@Name],
			Frs_Nazwa as [@Code],
			Frm_NIP as [@TIN],
			case when FRS_Archiwalny &lt;&gt; 0 then 'FALSE' else 'TRUE' end as [@IsActive],
			Frm_GidNumer as [@StampId]
			from cdn.POS_OddzialyDoEksportu(@PointOfSaleId, @RowVersion)
			join CDN.FrmStruktura on FRS_ID = PckCentrumID 
			join cdn.Firma on FRS_FrmNumer = Frm_GidNumer
			join cdn.KrajeCelne on KPC_Kod = (case when Frm_Kraj = '' OR Frm_Kraj is null then 'PL' else Frm_Kraj end)
			LEFT JOIN CDN.WaLNag on Frm_DWalutaKapitalu = WaN_Symbol
			outer apply cdn.POS_WanDoEksportu(PSaID,0)
			where (Frm_DWalutaKapitalu = '' OR (WanID is not null and WaN_Id = WanID))
	for xml path('CompanyUnit'), type)
	for xml path('CompanyUnits')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportCentraFirmy"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportCentraFirmy */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportCentraFirmy TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportGodzinyOtwarcia"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportGodzinyOtwarcia */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportGodzinyOtwarcia' and type = 'P')
drop procedure CDN.POS_EksportGodzinyOtwarcia;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportGodzinyOtwarcia"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportGodzinyOtwarcia */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportGodzinyOtwarcia]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('OpeningHour'), type)
	for xml path('OpeningHours')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportGodzinyOtwarcia"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportGodzinyOtwarcia */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportGodzinyOtwarcia TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportKontakty"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportKontakty */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportKontakty' and type = 'P')
drop procedure CDN.POS_EksportKontakty;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportKontakty"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportKontakty */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportKontakty]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;

	DECLARE @Typ_Osoba int = 8211
	DECLARE @knt TABLE (KntGIDNumer INT,KntLastMod INT,KntWaNCzasModyfikacji INT)
	INSERT INTO @knt SELECT distinct KntGIDNumer,KntLastMod,KntWaNCzasModyfikacji FROM cdn.POS_KntDoEksportu(@PointOfSaleId,0)
        select
                (select MAX(v) from(
                select ( select MAX(rw) FROM (VALUES (KntLastMod),(KntWaNCzasModyfikacji),(KnA_LastModL),(KnS_CzasModyfikacji)) AS rws(rw)) as v
                from (
				SELECT KntLastMod,KntWaNCzasModyfikacji,KnS_CzasModyfikacji,0 AS KnA_LastModL FROM @knt
                JOIN CDN.KntOsoby ON KnS_KntNumer = KntGIDNumer
				UNION ALL
				SELECT KntLastMod,KntWaNCzasModyfikacji,0 AS KnS_CzasModyfikacji, KnA_LastModL FROM @knt
                JOIN cdn.KntAdresy on KnA_KntNumer = KntGIDNumer 
				JOIN CDN.KrajeCelne ON KPC_Kod = KnA_Kraj
				) knt )
				 a)
                 as [@RowVersion], (
                        select * from(
                                select
                                        case when s.typ = 1 then Kns_GUID else Kns_GUID2 end as [@GUID],
                                        Kns_GUID as [@AddressGUID],
                                        s.typ as [@Type],
                                        case when kns_anonim = 1 then '' when s.typ = 2 then Kns_Email else Kns_telefon end as [@Value],
                                        DATEADD(second,Kns_CzasModyfikacji,convert(datetime,'01-01-1990',105)) as [@ModificationDate],
                                        case when KnS_Archiwalny = 0 then 'false' else 'true' end as [@IsObsolete]
                                FROM @knt
                                JOIN CDN.KntOsoby ON KnS_KntNumer = KntGIDNumer
                                cross apply(select 1 as typ union select 2) as s
                                where ((Kns_Email &lt;&gt; '' and s.typ = 2 OR KnS_Telefon &lt;&gt; '' and s.typ = 1) OR KnS_Anonim=1)
                                AND Kns_GUID IS NOT NULL AND Kns_GUID &lt;&gt; '' AND Kns_GUID2 IS NOT NULL AND Kns_GUID2 &lt;&gt; ''
                                AND (case when KntWaNCzasModyfikacji &gt; KnS_CzasModyfikacji THEN KntWaNCzasModyfikacji else KnS_CzasModyfikacji end) &gt; @rowVersion

                                union all

                                select distinct
                                case when s.typ = 1 then k1.kna_GUIDTelefon else k1.kna_GUIDEmail end as [@GUID],
                                k1.kna_guid as [@AddressGUID],
                                s.typ as [@Type],
                                        case when k1.kna_anonim = 1 then '' when s.typ = 2 then k1.kna_Email else k1.kna_telefon1 end as [@Value],
                                        DATEADD(second,k1.kna_LastModL,convert(datetime,'01-01-1990',105)) as [@ModificationDate],
                                        case when k1.kna_DataArc = 0 then 'false' else 'true' end as [@IsObsolete]
                                FROM @knt
                                join cdn.KntAdresy k1 on k1.kna_KntNumer = KntGIDNumer
                                left join cdn.KrajeCelne on k1.kna_Kraj = case when k1.kna_Anonim=1 then 'PL' else KPC_Kod end
                                cross apply(select 1 as typ union select 2) as s
                                where ((k1.kna_Email &lt;&gt; '' and s.typ = 2 OR k1.kna_Telefon1 &lt;&gt; '' and s.typ = 1) OR (k1.kna_anonim = 1))
                                        AND k1.kna_GUIDTelefon IS NOT NULL AND k1.kna_GUIDTelefon &lt;&gt; '' AND k1.kna_GUIDEmail IS NOT NULL AND k1.kna_GUIDEmail &lt;&gt; ''
                                        AND ((SELECT MAX(rw) FROM (VALUES (KntLastMod),(KntWaNCzasModyfikacji),(k1.kna_LastModL)) AS rws(rw)) &gt; @rowVersion OR @rowVersion=0)
                                        AND k1.kna_gidnumer = (select MAX(k2.kna_gidnumer) from cdn.kntadresy k2 where k2.KnA_GUIDDane = k1.KnA_GUIDDane)

                        ) a for xml path('Contact'), type)
        for xml path('Contacts')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportKontakty"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportKontakty */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportKontakty TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportWojewodztwa"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportWojewodztwa */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportWojewodztwa' and type = 'P')
drop procedure CDN.POS_EksportWojewodztwa;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportWojewodztwa"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportWojewodztwa */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportWojewodztwa]
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (
				select
				ROW_NUMBER() OVER(ORDER BY ProvName ASC) as [@Id],
				x.ProvName as [@Name],
				(select isnull((select kpc_id from cdn.krajecelne where kpc_kod='pl'),0)) as [@CountryId],
				'True' as [@IsActive]
				from
				(
					select 'dolnośląskie' as ProvName
					union select 'kujawsko-pomorskie'
					union select 'lubelskie'
					union select 'lubuskie'
					union select 'łódzkie'
					union select 'małopolskie'
					union select 'mazowieckie'
					union select 'opolskie'
					union select 'podkarpackie'
					union select 'podlaskie'
					union select 'pomorskie'
					union select 'śląskie'
					union select 'świętokrzyskie'
					union select 'warmińsko-mazurskie'
					union select 'wielkopolskie'
					union select 'zachodniopomorskie'

				) x
			for xml path('Province'), type)
	for xml path('Provinces')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportWojewodztwa"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportWojewodztwa */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportWojewodztwa TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportSortowanieKuponow"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportSortowanieKuponow */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportSortowanieKuponow' and type = 'P')
drop procedure CDN.POS_EksportSortowanieKuponow;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportSortowanieKuponow"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportSortowanieKuponow */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportSortowanieKuponow]
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('CustomerCreditLimit'), type)
	for xml path('CustomerCreditLimits')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportSortowanieKuponow"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportSortowanieKuponow */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportSortowanieKuponow TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportPotwierdzenia"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportPotwierdzenia */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportPotwierdzenia' and type = 'P')
drop procedure CDN.POS_EksportPotwierdzenia;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportPotwierdzenia"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportPotwierdzenia */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportPotwierdzenia]
	@RowVersion BIGINT,
	@PointOfSaleId INT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('Confirmation'), type)
	for xml path('Confirmations')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportPotwierdzenia"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportPotwierdzenia */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportPotwierdzenia TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportDokumentyHandlowe"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportDokumentyHandlowe */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportDokumentyHandlowe' and type = 'P')
drop procedure CDN.POS_EksportDokumentyHandlowe;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportDokumentyHandlowe"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportDokumentyHandlowe */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportDokumentyHandlowe]
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('TradeDocument'), type)
	for xml path('TradeDocuments')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportDokumentyHandlowe"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportDokumentyHandlowe */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportDokumentyHandlowe TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportParametryFormPlatnosci"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportParametryFormPlatnosci */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportParametryFormPlatnosci' and type = 'P' )
drop procedure CDN.POS_EksportParametryFormPlatnosci;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportParametryFormPlatnosci"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportParametryFormPlatnosci */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportParametryFormPlatnosci]
	@RowVersion BIGINT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('PaymentFormParameter'), type)
	for xml path('PaymentFormParameters')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportParametryFormPlatnosci"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportParametryFormPlatnosci */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportParametryFormPlatnosci TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportRabatyReczne"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportRabatyReczne */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportRabatyReczne' and type = 'P' )
drop procedure CDN.POS_EksportRabatyReczne;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportRabatyReczne"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportRabatyReczne */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportRabatyReczne]
	@RowVersion BIGINT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('ManualDiscount'), type)
	for xml path('ManualDiscounts')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportRabatyReczne"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportRabatyReczne */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportRabatyReczne TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportRabatyUprawnienia"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportRabatyUprawnienia */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportRabatyUprawnienia' and type = 'P' )
drop procedure CDN.POS_EksportRabatyUprawnienia;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportRabatyUprawnienia"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportRabatyUprawnienia */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportRabatyUprawnienia]
	@RowVersion BIGINT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('SecurityGroupDiscount'), type)
	for xml path('SecurityGroupDiscounts')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportRabatyUprawnienia"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportRabatyUprawnienia */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportRabatyUprawnienia TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportDeterminantyRabatow"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportDeterminantyRabatow */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportDeterminantyRabatow' and type = 'P' )
drop procedure CDN.POS_EksportDeterminantyRabatow;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportDeterminantyRabatow"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportDeterminantyRabatow */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportDeterminantyRabatow]
	@RowVersion BIGINT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('DiscountDeterminant'), type)
	for xml path('DiscountDeterminants')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportDeterminantyRabatow"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportDeterminantyRabatow */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportDeterminantyRabatow TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportHarmonogramy"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportHarmonogramy */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportHarmonogramy' and type = 'P' )
drop procedure CDN.POS_EksportHarmonogramy;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportHarmonogramy"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportHarmonogramy */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportHarmonogramy]
	@RowVersion BIGINT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('Schedule'), type)
	for xml path('Schedules')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportHarmonogramy"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportHarmonogramy */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportHarmonogramy TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Usuwanie procedury POS_EksportHarmonogramyObiekty"></A><PRE>
          <FONT SIZE="2" DISABLED="True"><I>/* Usuwanie procedury POS_EksportHarmonogramyObiekty */</I><BR>
if exists (select name from sysobjects where name = 'POS_EksportHarmonogramyObiekty' and type = 'P' )
drop procedure CDN.POS_EksportHarmonogramyObiekty;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tworzenie procedury POS_EksportHarmonogramyObiekty"></A><PRE>
          <FONT SIZE="2"><I>/* Tworzenie procedury POS_EksportHarmonogramyObiekty */</I><BR>
CREATE PROCEDURE [CDN].[POS_EksportHarmonogramyObiekty]
	@RowVersion BIGINT
AS
BEGIN
SET NOCOUNT ON;
	select
		0 as [@RowVersion], (select 1 WHERE 1=0		
	for xml path('ScheduleObject'), type)
	for xml path('ScheduleObjects')
	SET NOCOUNT OFF;	
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Przyznanie praw do procedury POS_EksportHarmonogramyObiekty"></A><PRE>
          <FONT SIZE="2"><I>/* Przyznanie praw do procedury POS_EksportHarmonogramyObiekty */</I><BR>
GRANT EXECUTE ON CDN.POS_EksportHarmonogramyObiekty TO CDNRaport
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>