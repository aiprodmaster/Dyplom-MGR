<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="OFFLXL_AtrybutyObiektuXml"></A><PRE>
          <FONT SIZE="2"><I>/* OFFLXL_AtrybutyObiektuXml */</I><BR>
CREATE FUNCTION CDN.OFFLXL_AtrybutyObiektuXml
(
 @ObiTyp   INT,
 @ObiNumer INT,
 @ObiLp	   SMALLINT,
 @ObiSubLp SMALLINT
 )
RETURNS VARCHAR(8000)
BEGIN 
	RETURN 'Funkcja OFFLXL_AtrybutyObiektuXml nie jest obługiwana na MSSQL 2000'
END	
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OFFLXL_AtrybutyObiektuXml"></A><PRE>
          <FONT SIZE="2"><I>/* OFFLXL_AtrybutyObiektuXml */</I><BR>
CREATE FUNCTION CDN.OFFLXL_AtrybutyObiektuXml
(
 @ObiTyp   INT,
 @ObiNumer INT,
 @ObiLp	   SMALLINT,
 @ObiSubLp SMALLINT
 )
RETURNS XML
AS
BEGIN

	RETURN  ( SELECT 
					Atr_Id						AS [@Id],
					Atr_ObiTyp					AS [@ObiTyp],
					Atr_ObiNumer				AS [@ObiNumer],
					Atr_ObiLp					AS [@ObiLp],
					Atr_ObiSubLp				AS [@ObiSubLp],
					Atr_AtkId					AS [@AtkId],
					ISNULL(Atr_Wartosc,'')		AS [@Wartosc],	
					ISNULL(Atr_AtrTyp,0)		AS [@AtrTyp],  
					ISNULL(Atr_AtrNumer,0)		AS [@AtrNumer],
					ISNULL(Atr_AtrLp,0)			AS [@AtrLp],
					ISNULL(Atr_AtrSubLp,0)		AS [@AtrSubLp],
					ISNULL(Atr_OptimaId,0)		AS [@OptimaId]
				FROM   CDN.Atrybuty
				WHERE  Atr_ObiTyp = @ObiTyp AND Atr_ObiNumer = @ObiNumer AND Atr_ObiLp = @ObiLp AND Atr_ObiSubLp = @ObiSubLp
				FOR XML PATH('ATR'), ROOT('ATRI')
			 )

END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>