<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="SrtPrefiksDokumentu"></A><PRE>
          <FONT SIZE="2"><I>/* SrtPrefiksDokumentu */</I><BR>
create FUNCTION CDN.SrtPrefiksDokumentu(@_Typ SMALLINT)
RETURNS varchar(max) AS
BEGIN
	-- funkcja zwraca prefiks dokumentu Srt na podstawie GIDTypu
	declare @pref varchar(max) = ''
    select 
		@pref = case @_Typ 
				when 2304 then 'AK'
				when 2064 then 'AM'
				when 2192 then 'AMK'
				when 6208 then 'AMP'
				when 2096 then 'LT'
				when 2224 then 'LTK'
				when 2432 then 'MW'
				when 2496 then 'MWK'
				when 2048 then 'OT'
				when 2176 then 'OTK'
				when 2080 then 'PK'
				when 2128 then 'RN'
				when 2532 then 'RT'
				when 2112 then 'WN'
				when 2552 then 'ZKZ'
				when 2160 then 'ZM'
				when 2548 then 'ZMT'
				when 2144 then 'ZO'
				when 2556 then 'ZSA'
				when 2288 then 'ZW'
				when 2536 then 'NT'
				when -368 then 'SRTG'
				when 368 then 'SRT'
				else 'Bląd'
				end
	return @pref
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtPrefiks2GIDTyp"></A><PRE>
          <FONT SIZE="2"><I>/* SrtPrefiks2GIDTyp */</I><BR>
create FUNCTION CDN.SrtPrefiks2GIDTyp(@_Typ varchar(4))
RETURNS int AS
BEGIN
	-- funkcja zwraca gidtyp dokumentu Srt na podstawie prefiksu
	declare @gidTyp int = ''
    select @gidTyp = case @_Typ 
				when 'AK'  then 2304
				when 'AM'  then 2064
				when 'AMK' then 2192 
				when 'AMP' then 6208 
				when 'LT'  then 2096
				when 'LTK' then 2224 
				when 'MW'  then 2432
				when 'MWK' then 2496 
				when 'OT'  then 2048
				when 'OTK' then 2176 
				when 'PK'  then 2080
				when 'RN'  then 2128
				when 'RT'  then 2532
				when 'WN'  then 2112
				when 'ZKZ' then 2552 
				when 'ZM'  then 2160
				when 'ZMT' then 2548 
				when 'ZO'  then 2144
				when 'ZSA' then 2556 
				when 'ZW'  then 2288
				when 'NT'  then 2536
				when 'SRTG' then -368
				when 'SRT' then 368 
				else '0' end				
	return @gidTyp
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>