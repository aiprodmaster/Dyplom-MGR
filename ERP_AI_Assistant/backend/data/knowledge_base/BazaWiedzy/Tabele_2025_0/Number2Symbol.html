<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="Number2Symbol"></A><PRE>
          <FONT SIZE="2"><I>/* Number2Symbol */</I><BR>
CREATE FUNCTION CDN.Number2Symbol (@Pozycja smallint, @Wzorzec char(1) )
RETURNS varchar(10)
 AS
BEGIN
	--wzorzec 
		--A lub a - litery
		--1 - liczby arabskie
		--X lub x liczby rzymskie

	declare @rv varchar(6)
	declare @DuzeLitery tinyint

	if @Pozycja = 0
	begin 
		set @rv = NULL
		goto wyjscie
	end

	if @Wzorzec = '1' 
	begin
		set @DuzeLitery = 1
		goto liczby
	end
	else if @Wzorzec = 'X' COLLATE SQL_Latin1_General_CP1_CS_AS	
	begin 
		set @DuzeLitery = 1
		goto rzymskie
	end		
	else if @Wzorzec = 'x' COLLATE SQL_Latin1_General_CP1_CS_AS	
	begin 
		set @DuzeLitery = 0
		goto rzymskie
	end		
	else if @Wzorzec = 'A' COLLATE SQL_Latin1_General_CP1_CS_AS	
	begin 
		set @DuzeLitery = 1
		goto litery
	end
	else if @Wzorzec = 'a' COLLATE SQL_Latin1_General_CP1_CS_AS 	
	begin 
		set @DuzeLitery = 0
		goto litery
	end

	goto wyjscie

liczby:	
	set @rv = convert(varchar, @Pozycja)
	goto wyjscie

litery:
	set @rv = char(@Pozycja+ascii('A')-1)
	goto wyjscie 

rzymskie:
	if @Pozycja = 1
		set @rv = 'I'
	else if @Pozycja = 2		
		set @rv = 'II'
	else if @Pozycja = 3		
		set @rv = 'III'
	else if @Pozycja = 4
		set @rv = 'IV'
	else if @Pozycja = 5
		set @rv = 'V'
	else if @Pozycja = 6
		set @rv = 'VI'
	else if @Pozycja = 7
		set @rv = 'VII'
	else if @Pozycja = 8
		set @rv = 'VIII'
	else if @Pozycja = 9
		set @rv = 'IX'
	else if @Pozycja = 10
		set @rv = 'X'
	else if @Pozycja = 11
		set @rv = 'XI'
	else if @Pozycja = 12
		set @rv = 'XII'
	else if @Pozycja = 13
		set @rv = 'XIII'
	else if @Pozycja = 14
		set @rv = 'XIV'
	else if @Pozycja = 15
		set @rv = 'XV'
	else if @Pozycja = 16
		set @rv = 'XVI'
	else if @Pozycja = 17
		set @rv = 'XVII'
	else if @Pozycja = 18
		set @rv = 'XVIII'
	else if @Pozycja = 19
		set @rv = 'XIX'
	else if @Pozycja = 20
		set @rv = 'XX'
	else if @Pozycja = 21
		set @rv = 'XXI'
	else if @Pozycja = 22
		set @rv = 'XXII'
	else if @Pozycja = 23
		set @rv = 'XXIII'
	else if @Pozycja = 24
		set @rv = 'XXIV'
	else if @Pozycja = 25
		set @rv = 'XXV'
	else if @Pozycja = 26
		set @rv = 'XXVI'
	else if @Pozycja = 27
		set @rv = 'XXVII'
	else if @Pozycja = 28
		set @rv = 'XXVIII'
	else if @Pozycja = 29
		set @rv = 'XXIX'
	else if @Pozycja = 30
		set @rv = 'XXX'
	else if @Pozycja = 31
		set @rv = 'XXXI'
	else if @Pozycja = 32
		set @rv = 'XXXII'
	else if @Pozycja = 33
		set @rv = 'XXXIII'
	else if @Pozycja = 34
		set @rv = 'XXXIV'
	else if @Pozycja = 35
		set @rv = 'XXXV'
	else if @Pozycja = 36
		set @rv = 'XXXVI'
	else if @Pozycja = 37
		set @rv = 'XXXVII'
	else if @Pozycja = 38
		set @rv = 'XXXVIII'
	else if @Pozycja = 39
		set @rv = 'XXXIX'
	else if @Pozycja = 40
		set @rv = 'XL'
	else if @Pozycja = 41
		set @rv = 'XLI'
	else if @Pozycja = 42
		set @rv = 'XLII'
	else if @Pozycja = 43
		set @rv = 'XLIII'
	else if @Pozycja = 44
		set @rv = 'XLIV'
	else if @Pozycja = 45
		set @rv = 'XLV'
	else if @Pozycja = 46
		set @rv = 'XLVI'
	else if @Pozycja = 47
		set @rv = 'XLVII'
	else if @Pozycja = 48
		set @rv = 'XLVIII'
	else if @Pozycja = 49
		set @rv = 'XLIX'
	else if @Pozycja = 50
		set @rv = 'L'
	else if @Pozycja = 51
		set @rv = 'LI'
	else if @Pozycja = 52
		set @rv = 'LII'
	else if @Pozycja = 53
		set @rv = 'LIII'
	else if @Pozycja = 54
		set @rv = 'LIV'
	else if @Pozycja = 55
		set @rv = 'LV'
	else if @Pozycja = 56	
		set @rv = 'LVI'
	else if @Pozycja = 57
		set @rv = 'LVII'
	else if @Pozycja = 58
		set @rv = 'LVIII'
	else if @Pozycja = 59
		set @rv = 'LIX'
	else if @Pozycja = 60	
		set @rv = 'LX'
		
	goto wyjscie


wyjscie:
	if @DuzeLitery=1
		set @rv = upper(@rv)
	else
		set @rv = lower(@rv)

	
	return @rv
END
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>