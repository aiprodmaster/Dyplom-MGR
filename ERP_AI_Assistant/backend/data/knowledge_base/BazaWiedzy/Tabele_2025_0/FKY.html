<HTML>
  <HEAD>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1250">
    <META NAME="Author" CONTENT="Comarch S.A.">
    <LINK rel="stylesheet" type="text/css" href="Style/doc.css">
    <TITLE>Skrypt SQL</TITLE>
  </HEAD>
  <BODY>
<DIV CLASS="TextInfo">
      <P><A name="FK_AILKHKntNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AILKHKntNumer */</I><BR>
ALTER TABLE CDN.AILimityKredytoweHistoria ADD CONSTRAINT FK_AILKHKntNumer
 FOREIGN KEY
   (
                          AILKH_KntNumer                      
                         )
             REFERENCES CDN.KntKarty
                         (
                          Knt_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AIPPTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AIPPTowar */</I><BR>
ALTER TABLE CDN.AIPrognozaPopytu ADD CONSTRAINT FK_AIPPTowar
 FOREIGN KEY
   (
                          AIPP_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AIPPMagazyn"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AIPPMagazyn */</I><BR>
ALTER TABLE CDN.AIPrognozaPopytu ADD CONSTRAINT FK_AIPPMagazyn
 FOREIGN KEY
   (
                          AIPP_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AnEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AnEPrimary */</I><BR>
ALTER TABLE CDN.AnElem ADD CONSTRAINT FK_AnEPrimary
 FOREIGN KEY
   (
                          AnE_GIDNumer                      
                         )
             REFERENCES CDN.AnNag
                         (
                          AnN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AnElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AnElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.AnElem_InsertUpdateHandler
  ON CDN.AnElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( AnE_AnFTyp )  OR UPDATE( AnE_AnFNumer )  OR UPDATE( AnE_AnFLp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AnFunkcje ON
                    inserted.AnE_AnFTyp = CDN.AnFunkcje.AnF_AnRTyp
                AND inserted.AnE_AnFNumer = CDN.AnFunkcje.AnF_AnRNumer
                AND inserted.AnE_AnFLp = CDN.AnFunkcje.AnF_AnRLp
              WHERE CDN.AnFunkcje.AnF_AnRLp IS NULL
                AND (
                          IsNull(inserted.AnE_AnFTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.AnE_AnFNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.AnE_AnFLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AnFunkcje) [AnElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AnE_AnZNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AnZestawy ON
                    inserted.AnE_AnZNumer = CDN.AnZestawy.AnZ_GIDNumer
              WHERE CDN.AnZestawy.AnZ_GIDNumer IS NULL
                AND (
                          IsNull(inserted.AnE_AnZNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AnZestawy) [AnElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AnFPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AnFPrimary */</I><BR>
ALTER TABLE CDN.AnFunkcje ADD CONSTRAINT FK_AnFPrimary
 FOREIGN KEY
   (
                          AnF_AnRNumer                      
                         )
             REFERENCES CDN.AnRaporty
                         (
                          AnR_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AnFunkcje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AnFunkcje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.AnFunkcje_DeleteHandler
  ON CDN.AnFunkcje
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.AnElem
    IF EXISTS
       ( SELECT * FROM CDN.AnElem JOIN deleted
          ON
                deleted.AnF_AnRTyp = CDN.AnElem.AnE_AnFTyp
            AND deleted.AnF_AnRNumer = CDN.AnElem.AnE_AnFNumer
            AND deleted.AnF_AnRLp = CDN.AnElem.AnE_AnFLp
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą AnElem) [AnFunkcje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AnKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AnKPrimary */</I><BR>
ALTER TABLE CDN.AnKolejka ADD CONSTRAINT FK_AnKPrimary
 FOREIGN KEY
   (
                          AnK_AnRNumer                      
                         )
             REFERENCES CDN.AnRaporty
                         (
                          AnR_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AnWPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AnWPrimaryNoType */</I><BR>
ALTER TABLE CDN.AnWyniki ADD CONSTRAINT FK_AnWPrimaryNoType
 FOREIGN KEY
   (
                          AnW_AnZNumer                      
                         )
             REFERENCES CDN.AnZestawy
                         (
                          AnZ_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AnZRaport"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AnZRaport */</I><BR>
ALTER TABLE CDN.AnZestawy ADD CONSTRAINT FK_AnZRaport
 FOREIGN KEY
   (
                          AnZ_AnFTyp                        ,
                          AnZ_AnFNumer                      ,
                          AnZ_AnFLp                         
                         )
             REFERENCES CDN.AnFunkcje
                         (
                          AnF_AnRTyp                        ,
                          AnF_AnRNumer                      ,
                          AnF_AnRLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AnZestawy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AnZestawy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.AnZestawy_DeleteHandler
  ON CDN.AnZestawy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.AnElem
    IF EXISTS
       ( SELECT * FROM CDN.AnElem JOIN deleted
          ON
                deleted.AnZ_GIDNumer = CDN.AnElem.AnE_AnZNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą AnElem) [AnZestawy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Ankiety_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Ankiety_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Ankiety_DeleteHandler
  ON CDN.Ankiety
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyAnkiety
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyAnkiety JOIN deleted
          ON
                deleted.ANT_Id = CDN.CRMWizytyAnkiety.CWA_ANTId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyAnkiety) [Ankiety_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.ANT_Id = CDN.CRMKntEtapy.CEK_AntId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMKntEtapy) [Ankiety_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyElemObiekty
    IF EXISTS(SELECT * FROM CDN.CRMWizytyElemObiekty JOIN deleted
            ON 
          deleted.ANT_Id = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=14460)
            )
        DELETE CDN.CRMWizytyElemObiekty
        FROM CDN.CRMWizytyElemObiekty JOIN deleted
        ON 
          deleted.ANT_Id = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=14460)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zadania
    IF EXISTS(SELECT * FROM CDN.Zadania JOIN deleted
            ON 
          deleted.ANT_Id = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=14460 AND CDN.Zadania.ZAD_ZrdLP=0)
            )
        DELETE CDN.Zadania
        FROM CDN.Zadania JOIN deleted
        ON 
          deleted.ANT_Id = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=14460 AND CDN.Zadania.ZAD_ZrdLP=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Ankiety_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Ankiety_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Ankiety_InsertUpdateHandler
  ON CDN.Ankiety
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ANT_Rodzaj ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.ANT_Rodzaj = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.ANT_Rodzaj,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Ankiety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ApfTrN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ApfTrN */</I><BR>
ALTER TABLE CDN.Apfino ADD CONSTRAINT FK_ApfTrN
 FOREIGN KEY
   (
                          Apf_TrNNumer                      
                         )
             REFERENCES CDN.TraNag
                         (
                          TrN_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AKlPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AKlPrimary */</I><BR>
ALTER TABLE CDN.AtrKompletyLinki ADD CONSTRAINT FK_AKlPrimary
 FOREIGN KEY
   (
                          AKl_AKpID                         
                         )
             REFERENCES CDN.AtrybutyKomplety
                         (
                          AKp_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AKLAtkID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AKLAtkID */</I><BR>
ALTER TABLE CDN.AtrKompletyLinki ADD CONSTRAINT FK_AKLAtkID
 FOREIGN KEY
   (
                          AKl_AtKId                         
                         )
             REFERENCES CDN.AtrybutyKlasy
                         (
                          AtK_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AtrAtKID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AtrAtKID */</I><BR>
ALTER TABLE CDN.Atrybuty ADD CONSTRAINT FK_AtrAtKID
 FOREIGN KEY
   (
                          Atr_AtkId                         
                         )
             REFERENCES CDN.AtrybutyKlasy
                         (
                          AtK_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Atrybuty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Atrybuty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Atrybuty_DeleteHandler
  ON CDN.Atrybuty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ParamRozKonf
    IF EXISTS(SELECT * FROM CDN.ParamRozKonf JOIN deleted
            ON 
          deleted.Atr_ObiTyp = CDN.ParamRozKonf.PRK_ObiTyp
      AND deleted.Atr_ObiNumer = CDN.ParamRozKonf.PRK_ObiNumer
      AND deleted.Atr_ObiLp = CDN.ParamRozKonf.PRK_ObiLp
      AND deleted.Atr_ObiSubLp = CDN.ParamRozKonf.PRK_ObiSubLp
      AND deleted.Atr_AtkId = CDN.ParamRozKonf.PRK_AtkId
      AND (CDN.ParamRozKonf.PRK_ObiTyp &lt;&gt; -16)
            )
        DELETE CDN.ParamRozKonf
        FROM CDN.ParamRozKonf JOIN deleted
        ON 
          deleted.Atr_ObiTyp = CDN.ParamRozKonf.PRK_ObiTyp
      AND deleted.Atr_ObiNumer = CDN.ParamRozKonf.PRK_ObiNumer
      AND deleted.Atr_ObiLp = CDN.ParamRozKonf.PRK_ObiLp
      AND deleted.Atr_ObiSubLp = CDN.ParamRozKonf.PRK_ObiSubLp
      AND deleted.Atr_AtkId = CDN.ParamRozKonf.PRK_AtkId
      AND (CDN.ParamRozKonf.PRK_ObiTyp &lt;&gt; -16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.Atr_Id = CDN.AtrybutyHist.AtH_Id
      AND (exists (Select AtK_Id FRom Cdn.AtrybutyKlasy Where  Atk_ID= CDN.AtrybutyHist.AtH_AtkId and (Atk_Okresowe=1 or Atk_Wielowart=1 /*w zw. z  113992*/)))
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.Atr_Id = CDN.AtrybutyHist.AtH_Id
      AND (exists (Select AtK_Id FRom Cdn.AtrybutyKlasy Where  Atk_ID= CDN.AtrybutyHist.AtH_AtkId and (Atk_Okresowe=1 or Atk_Wielowart=1 /*w zw. z  113992*/)))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Atrybuty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Atrybuty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Atrybuty_InsertUpdateHandler
  ON CDN.Atrybuty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14362 and inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanyObciazeniaGniazd ON
                    inserted.Atr_ObiNumer = CDN.PlanyObciazeniaGniazd.POG_Id
              WHERE CDN.PlanyObciazeniaGniazd.POG_Id IS NULL AND (inserted.Atr_OBITyp=14362 and inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanyObciazeniaGniazd) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14360 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPlany ON
                    inserted.Atr_ObiNumer = CDN.ProdPlany.PPL_Id
              WHERE CDN.ProdPlany.PPL_Id IS NULL AND (inserted.Atr_OBITyp=14360 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPlany) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4710 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwPlanPrzegladu ON
                    inserted.Atr_ObiNumer = CDN.SrwPlanPrzegladu.SPP_Id
              WHERE CDN.SrwPlanPrzegladu.SPP_Id IS NULL AND (inserted.Atr_OBITyp=4710 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwPlanPrzegladu) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=2752 AND inserted.Atr_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KsoNag ON
                    inserted.Atr_ObiNumer = CDN.KsoNag.KSN_GIDNumer
              WHERE CDN.KsoNag.KSN_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=2752 AND inserted.Atr_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KsoNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=2752 AND inserted.Atr_ObiLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KsoElem ON
                    inserted.Atr_ObiNumer = CDN.KsoElem.KSE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.KsoElem.KSE_GIDLp
              WHERE CDN.KsoElem.KSE_GIDLp IS NULL AND ( inserted.Atr_OBITyp=2752 AND inserted.Atr_ObiLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KsoElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4800 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwNag ON
                    inserted.Atr_ObiNumer = CDN.UmwNag.UmN_Id
              WHERE CDN.UmwNag.UmN_Id IS NULL AND (inserted.Atr_OBITyp=4800 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBISubLp = 4807 AND inserted.Atr_OBITyp in (4800,4801,4802) and inserted.Atr_OBILp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwElem ON
                    inserted.Atr_ObiNumer = CDN.UmwElem.UmE_GIDNumer
                AND inserted.Atr_ObiTyp = CDN.UmwElem.UmE_GIDTyp
                AND inserted.Atr_ObiLp = CDN.UmwElem.UmE_GIDLp
              WHERE CDN.UmwElem.UmE_GIDLp IS NULL AND (inserted.Atr_OBISubLp = 4807 AND inserted.Atr_OBITyp in (4800,4801,4802) and inserted.Atr_OBILp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp = -16 and inserted.Atr_OBILp = 1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.Atr_ObiNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.Atr_ObiTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (inserted.Atr_OBITyp = -16 and inserted.Atr_OBILp = 1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (3584,3585) and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 3586)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklElem ON
                    inserted.Atr_ObiNumer = CDN.ReklElem.RLE_Id
              WHERE CDN.ReklElem.RLE_Id IS NULL AND (inserted.Atr_OBITyp in (3584,3585) and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 3586)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (3584,3585) and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 3587)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklRealizacja ON
                    inserted.Atr_ObiNumer = CDN.ReklRealizacja.RLR_Id
              WHERE CDN.ReklRealizacja.RLR_Id IS NULL AND (inserted.Atr_OBITyp in (3584,3585) and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 3587)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklRealizacja) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (3584,3585) and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklNag ON
                    inserted.Atr_ObiNumer = CDN.ReklNag.RLN_Id
              WHERE CDN.ReklNag.RLN_Id IS NULL AND (inserted.Atr_OBITyp in (3584,3585) and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (14451,14452,14453) and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SekDokumenty ON
                    inserted.Atr_ObiNumer = CDN.SekDokumenty.SDD_Id
              WHERE CDN.SekDokumenty.SDD_Id IS NULL AND (inserted.Atr_OBITyp in (14451,14452,14453) and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SekDokumenty) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp )  OR UPDATE( Atr_ObiTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBISubLp = 0 AND ((inserted.Atr_OBITyp in (4180,4181) and inserted.Atr_OBILp&gt;0) OR (inserted.Atr_OBITyp=4182 and inserted.Atr_OBILp=0)))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyElem ON
                    inserted.Atr_ObiNumer = CDN.CRMWizytyElem.CWE_GidNumer
                AND inserted.Atr_ObiLp = CDN.CRMWizytyElem.CWE_GidLp
                AND inserted.Atr_ObiTyp = CDN.CRMWizytyElem.CWE_GidTyp
              WHERE CDN.CRMWizytyElem.CWE_GidTyp IS NULL AND (inserted.Atr_OBISubLp = 0 AND ((inserted.Atr_OBITyp in (4180,4181) and inserted.Atr_OBILp&gt;0) OR (inserted.Atr_OBITyp=4182 and inserted.Atr_OBILp=0)))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4181 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWzorceWizyt ON
                    inserted.Atr_ObiNumer = CDN.CRMWzorceWizyt.CWW_Id
              WHERE CDN.CRMWzorceWizyt.CWW_Id IS NULL AND (inserted.Atr_OBITyp=4181 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWzorceWizyt) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4180 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyNag ON
                    inserted.Atr_ObiNumer = CDN.CRMWizytyNag.CWN_ID
              WHERE CDN.CRMWizytyNag.CWN_ID IS NULL AND (inserted.Atr_OBITyp=4180 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=342 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Samochody ON
                    inserted.Atr_ObiNumer = CDN.Samochody.SaM_Id
              WHERE CDN.Samochody.SaM_Id IS NULL AND (inserted.Atr_OBITyp=342 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Samochody) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4703 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcSkladniki ON
                    inserted.Atr_ObiNumer = CDN.SrwZlcSkladniki.SZS_Id
              WHERE CDN.SrwZlcSkladniki.SZS_Id IS NULL AND (inserted.Atr_OBITyp=4703 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcSkladniki) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4701 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.Atr_ObiNumer = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL AND (inserted.Atr_OBITyp=4701 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4702 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.Atr_ObiNumer = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL AND (inserted.Atr_OBITyp=4702 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4700 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.Atr_ObiNumer = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL AND (inserted.Atr_OBITyp=4700 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14502 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrStanowiska ON
                    inserted.Atr_ObiNumer = CDN.KadrStanowiska.KSt_Id
              WHERE CDN.KadrStanowiska.KSt_Id IS NULL AND (inserted.Atr_OBITyp=14502 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrStanowiska) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14503 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceElementyWyplat ON
                    inserted.Atr_ObiNumer = CDN.PlaceElementyWyplat.PEW_Id
              WHERE CDN.PlaceElementyWyplat.PEW_Id IS NULL AND (inserted.Atr_OBITyp=14503 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceElementyWyplat) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14504 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdFunkcje ON
                    inserted.Atr_ObiNumer = CDN.ProdFunkcje.PFU_Id
              WHERE CDN.ProdFunkcje.PFU_Id IS NULL AND (inserted.Atr_OBITyp=14504 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdFunkcje) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4179)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMEtapyDef ON
                    inserted.Atr_ObiNumer = CDN.CRMEtapyDef.CED_ID
              WHERE CDN.CRMEtapyDef.CED_ID IS NULL AND (inserted.Atr_OBITyp=4179)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMEtapyDef) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4178)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMDefZadania ON
                    inserted.Atr_ObiNumer = CDN.CRMDefZadania.CDZ_Id
              WHERE CDN.CRMDefZadania.CDZ_Id IS NULL AND (inserted.Atr_OBITyp=4178)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMDefZadania) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.Atr_OBITyp IN (2976,2977)  AND  inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PIKNag ON
                    inserted.Atr_ObiNumer = CDN.PIKNag.PIN_GIDNumer
              WHERE CDN.PIKNag.PIN_GIDNumer IS NULL AND (  inserted.Atr_OBITyp IN (2976,2977)  AND  inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PIKNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp = 1536 AND  inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.InwOdc ON
                    inserted.Atr_ObiNumer = CDN.InwOdc.InO_Id
              WHERE CDN.InwOdc.InO_Id IS NULL AND (inserted.Atr_OBITyp = 1536 AND  inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  InwOdc) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14448 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BstNag ON
                    inserted.Atr_ObiNumer = CDN.BstNag.BsN_ID
              WHERE CDN.BstNag.BsN_ID IS NULL AND (inserted.Atr_OBITyp=14448 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BstNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=1536 and  inserted.Atr_OBILp &lt;&gt; 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.InwArk ON
                    inserted.Atr_ObiNumer = CDN.InwArk.InA_Id
              WHERE CDN.InwArk.InA_Id IS NULL AND (inserted.Atr_OBITyp=1536 and  inserted.Atr_OBILp &lt;&gt; 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  InwArk) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=12300 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Preliminarz ON
                    inserted.Atr_ObiNumer = CDN.Preliminarz.PRL_GIDNumer
              WHERE CDN.Preliminarz.PRL_GIDNumer IS NULL AND (inserted.Atr_OBITyp=12300 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Preliminarz) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=1536 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.InwNag ON
                    inserted.Atr_ObiNumer = CDN.InwNag.InN_Id
              WHERE CDN.InwNag.InN_Id IS NULL AND (inserted.Atr_OBITyp=1536 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  InwNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp )  OR UPDATE( Atr_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (-1089,-1601,-1602,-1093,-1605) AND  inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagPElem ON
                    inserted.Atr_ObiNumer = CDN.MagPElem.MaP_GIDNumer
                AND inserted.Atr_ObiLp = CDN.MagPElem.MaP_GIDLp
                AND inserted.Atr_ObiSubLp = CDN.MagPElem.MaP_SubGIDLp
              WHERE CDN.MagPElem.MaP_SubGIDLp IS NULL AND (inserted.Atr_OBITyp in (-1089,-1601,-1602,-1093,-1605) AND  inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagPElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (1089,1601,1602,1093,1605) AND  inserted.Atr_OBILp&gt;0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagElem ON
                    inserted.Atr_ObiNumer = CDN.MagElem.MaE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.MagElem.MaE_GIDLp
              WHERE CDN.MagElem.MaE_GIDLp IS NULL AND (inserted.Atr_OBITyp in (1089,1601,1602,1093,1605) AND  inserted.Atr_OBILp&gt;0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14400 AND NOT EXISTS (SELECT * FROM CDN.DaneBinarne WHERE DAB_ID = inserted.Atr_ObiNumer))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DaneBinarne ON
                    inserted.Atr_ObiNumer = CDN.DaneBinarne.DAB_ID
              WHERE CDN.DaneBinarne.DAB_ID IS NULL AND (inserted.Atr_OBITyp=14400 AND NOT EXISTS (SELECT * FROM CDN.DaneBinarne WHERE DAB_ID = inserted.Atr_ObiNumer))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DaneBinarne) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=432 AND inserted.Atr_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Dziennik ON
                    inserted.Atr_ObiNumer = CDN.Dziennik.DZK_GIDNumer
              WHERE CDN.Dziennik.DZK_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=432 AND inserted.Atr_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Dziennik) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=432 AND inserted.Atr_ObiLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DziennikElem ON
                    inserted.Atr_ObiNumer = CDN.DziennikElem.DEL_GIDNumer
                AND inserted.Atr_ObiLp = CDN.DziennikElem.DEL_GIDLp
              WHERE CDN.DziennikElem.DEL_GIDLp IS NULL AND ( inserted.Atr_OBITyp=432 AND inserted.Atr_ObiLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DziennikElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp =-16 and inserted.Atr_OBILp &lt;&gt; 0 and  inserted.Atr_OBISubLp = 64)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzCeny ON
                    inserted.Atr_ObiTyp = CDN.TwrWzCeny.WTC_GrpTyp
                AND inserted.Atr_ObiNumer = CDN.TwrWzCeny.WTC_GrpNumer
                AND inserted.Atr_ObiLp = CDN.TwrWzCeny.WTC_GrpLp
              WHERE CDN.TwrWzCeny.WTC_GrpLp IS NULL AND ( inserted.Atr_OBITyp =-16 and inserted.Atr_OBILp &lt;&gt; 0 and  inserted.Atr_OBISubLp = 64)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzCeny) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp = 64 and inserted.Atr_OBILp &lt;&gt; 0 and  inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrCeny ON
                    inserted.Atr_ObiNumer = CDN.TwrCeny.TwC_ID
              WHERE CDN.TwrCeny.TwC_ID IS NULL AND (inserted.Atr_OBITyp = 64 and inserted.Atr_OBILp &lt;&gt; 0 and  inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrCeny) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=435)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RozniceKursowe ON
                    inserted.Atr_ObiNumer = CDN.RozniceKursowe.RKN_ID
              WHERE CDN.RozniceKursowe.RKN_ID IS NULL AND (inserted.Atr_OBITyp=435)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RozniceKursowe) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14346 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.Atr_ObiNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.Atr_OBITyp=14346 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14345 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.Atr_ObiNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.Atr_OBITyp=14345 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14344 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdProcesy ON
                    inserted.Atr_ObiNumer = CDN.ProdProcesy.PPC_Id
              WHERE CDN.ProdProcesy.PPC_Id IS NULL AND (inserted.Atr_OBITyp=14344 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdProcesy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14342 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.Atr_ObiNumer = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL AND (inserted.Atr_OBITyp=14342 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14341 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaCzynnosci ON
                    inserted.Atr_ObiNumer = CDN.ProdTechnologiaCzynnosci.PTC_Id
              WHERE CDN.ProdTechnologiaCzynnosci.PTC_Id IS NULL AND (inserted.Atr_OBITyp=14341 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaCzynnosci) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14343 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.Atr_ObiNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.Atr_OBITyp=14343 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (14340,14370) and inserted.Atr_OBINumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.Atr_ObiNumer = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL AND (inserted.Atr_OBITyp in (14340,14370) and inserted.Atr_OBINumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14337 and inserted.Atr_OBINumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.Atr_ObiNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.Atr_OBITyp=14337 and inserted.Atr_OBINumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=7040 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsWyposazenia ON
                    inserted.Atr_ObiNumer = CDN.SrsWyposazenia.SsW_Id
              WHERE CDN.SrsWyposazenia.SsW_Id IS NULL AND (inserted.Atr_OBITyp=7040 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsWyposazenia) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=434 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KompNag ON
                    inserted.Atr_ObiNumer = CDN.KompNag.KMN_ID
              WHERE CDN.KompNag.KMN_ID IS NULL AND (inserted.Atr_OBITyp=434 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KompNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=32 AND inserted.Atr_OBISubLp=8211)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.Atr_ObiTyp = CDN.KntOsoby.KnS_KntTyp
                AND inserted.Atr_ObiNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.Atr_ObiLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.Atr_OBITyp=32 AND inserted.Atr_OBISubLp=8211)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBISubLp = -8210)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraVat ON
                    inserted.Atr_ObiTyp = CDN.TraVat.TRV_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.TraVat.TRV_GIDNumer
                AND inserted.Atr_ObiLp = CDN.TraVat.TRV_GIDLp
              WHERE CDN.TraVat.TRV_GIDLp IS NULL AND (inserted.Atr_OBISubLp = -8210)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraVat) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp = 960 and inserted.Atr_OBISubLp = -8209)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamPlat ON
                    inserted.Atr_ObiTyp = CDN.ZamPlat.ZaP_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.ZamPlat.ZaP_GIDNumer
                AND inserted.Atr_ObiLp = CDN.ZamPlat.ZaP_GIDLp
              WHERE CDN.ZamPlat.ZaP_GIDLp IS NULL AND (inserted.Atr_OBITyp = 960 and inserted.Atr_OBISubLp = -8209)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamPlat) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp &lt;&gt; 960 and inserted.Atr_OBISubLp = -8209)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraPlat ON
                    inserted.Atr_ObiTyp = CDN.TraPlat.TrP_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.TraPlat.TrP_GIDNumer
                AND inserted.Atr_ObiLp = CDN.TraPlat.TrP_GIDLp
              WHERE CDN.TraPlat.TrP_GIDLp IS NULL AND (inserted.Atr_OBITyp &lt;&gt; 960 and inserted.Atr_OBISubLp = -8209)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraPlat) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=340 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WysPaczki ON
                    inserted.Atr_ObiNumer = CDN.WysPaczki.WyP_IdPaczki
              WHERE CDN.WysPaczki.WyP_IdPaczki IS NULL AND (inserted.Atr_OBITyp=340 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WysPaczki) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=337 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wysylki ON
                    inserted.Atr_ObiNumer = CDN.Wysylki.WYS_GIDNumer
              WHERE CDN.Wysylki.WYS_GIDNumer IS NULL AND (inserted.Atr_OBITyp=337 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wysylki) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp= -4592 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.Atr_ObiNumer = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL AND ( inserted.Atr_OBITyp= -4592 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4176 and inserted.Atr_OBILp = 0 and         inserted.Atr_OBISubLp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKntEtapy ON
                    inserted.Atr_ObiNumer = CDN.CRMKntEtapy.CEK_ID
              WHERE CDN.CRMKntEtapy.CEK_ID IS NULL AND (inserted.Atr_OBITyp=4176 and inserted.Atr_OBILp = 0 and         inserted.Atr_OBISubLp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKntEtapy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4176 and inserted.Atr_OBILp &lt;&gt; 0 and         inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.Atr_ObiNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.Atr_OBITyp=4176 and inserted.Atr_OBILp &lt;&gt; 0 and         inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4176 and inserted.Atr_OBILp = 0 and         inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampNag ON
                    inserted.Atr_ObiNumer = CDN.CRMKampNag.CKN_GIDNumer
              WHERE CDN.CRMKampNag.CKN_GIDNumer IS NULL AND (inserted.Atr_OBITyp=4176 and inserted.Atr_OBILp = 0 and         inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=339 and inserted.Atr_OBILp &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsElem ON
                    inserted.Atr_ObiNumer = CDN.SrsElem.SsE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.SrsElem.SsE_GIDLp
              WHERE CDN.SrsElem.SsE_GIDLp IS NULL AND (inserted.Atr_OBITyp=339 and inserted.Atr_OBILp &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=339 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsNag ON
                    inserted.Atr_ObiNumer = CDN.SrsNag.SsN_GIDNumer
              WHERE CDN.SrsNag.SsN_GIDNumer IS NULL AND (inserted.Atr_OBITyp=339 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp =-16 and inserted.Atr_OBILp &lt;&gt; 0 and           inserted.Atr_OBISubLp = -32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzDst ON
                    inserted.Atr_ObiTyp = CDN.TwrWzDst.WTD_GrpTyp
                AND inserted.Atr_ObiNumer = CDN.TwrWzDst.WTD_GrpNumer
                AND inserted.Atr_ObiLp = CDN.TwrWzDst.WTD_GrpLp
              WHERE CDN.TwrWzDst.WTD_GrpLp IS NULL AND ( inserted.Atr_OBITyp =-16 and inserted.Atr_OBILp &lt;&gt; 0 and           inserted.Atr_OBISubLp = -32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzDst) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp =16 and inserted.Atr_OBILp &lt;&gt; 0 and           inserted.Atr_OBISubLp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrDost ON
                    inserted.Atr_ObiTyp = CDN.TwrDost.TWD_TwrTyp
                AND inserted.Atr_ObiNumer = CDN.TwrDost.TWD_TwrNumer
                AND inserted.Atr_ObiLp = CDN.TwrDost.TWD_TwrLp
              WHERE CDN.TwrDost.TWD_TwrLp IS NULL AND ( inserted.Atr_OBITyp =16 and inserted.Atr_OBILp &lt;&gt; 0 and           inserted.Atr_OBISubLp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrDost) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp )  OR UPDATE( Atr_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Atr_OBILp &lt;&gt; 0 and inserted.Atr_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaSElem ON
                    inserted.Atr_ObiTyp = CDN.BilansOtwarciaSElem.BOS_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.BilansOtwarciaSElem.BOS_GIDNumer
                AND inserted.Atr_ObiLp = CDN.BilansOtwarciaSElem.BOS_GIDLp
                AND inserted.Atr_ObiSubLp = CDN.BilansOtwarciaSElem.BOS_SubGIDLp
              WHERE CDN.BilansOtwarciaSElem.BOS_SubGIDLp IS NULL AND ( inserted.Atr_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Atr_OBILp &lt;&gt; 0 and inserted.Atr_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaSElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Atr_OBILp &lt;&gt; 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaElem ON
                    inserted.Atr_ObiTyp = CDN.BilansOtwarciaElem.BOE_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.BilansOtwarciaElem.BOE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.BilansOtwarciaElem.BOE_GIDLp
              WHERE CDN.BilansOtwarciaElem.BOE_GIDLp IS NULL AND ( inserted.Atr_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Atr_OBILp &lt;&gt; 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaNag ON
                    inserted.Atr_ObiTyp = CDN.BilansOtwarciaNag.BON_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.BilansOtwarciaNag.BON_GIDNumer
              WHERE CDN.BilansOtwarciaNag.BON_GIDNumer IS NULL AND ( inserted.Atr_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=8225  and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.Atr_ObiNumer = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND ( inserted.Atr_OBITyp=8225  and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=4272 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.Atr_ObiNumer = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL AND ( inserted.Atr_OBITyp=4272 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=4320 and inserted.Atr_OBILp &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DokDefinicje ON
                    inserted.Atr_ObiNumer = CDN.DokDefinicje.Dok_FrsId
                AND inserted.Atr_ObiLp = CDN.DokDefinicje.Dok_GIDTyp
              WHERE CDN.DokDefinicje.Dok_GIDTyp IS NULL AND ( inserted.Atr_OBITyp=4320 and inserted.Atr_OBILp &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DokDefinicje) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=7685)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wymiary ON
                    inserted.Atr_ObiNumer = CDN.Wymiary.WMR_ID
              WHERE CDN.Wymiary.WMR_ID IS NULL AND ( inserted.Atr_OBITyp=7685)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wymiary) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=864 or inserted.Atr_OBITyp=896)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.Atr_ObiTyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=864 or inserted.Atr_OBITyp=896)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=112 and inserted.Atr_OBILp &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RecElem ON
                    inserted.Atr_ObiNumer = CDN.RecElem.ReE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.RecElem.ReE_GIDLp
              WHERE CDN.RecElem.ReE_GIDLp IS NULL AND ( inserted.Atr_OBITyp=112 and inserted.Atr_OBILp &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RecElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=112 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RecNag ON
                    inserted.Atr_ObiNumer = CDN.RecNag.ReN_GIDNumer
              WHERE CDN.RecNag.ReN_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=112 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RecNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=784)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zapisy ON
                    inserted.Atr_ObiNumer = CDN.Zapisy.KAZ_GIDNumer
              WHERE CDN.Zapisy.KAZ_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=784)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zapisy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=4144 and inserted.Atr_OBILp &lt;&gt; 0 and         inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemElem ON
                    inserted.Atr_ObiTyp = CDN.MemElem.MEE_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.MemElem.MEE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.MemElem.MEE_GIDLp
              WHERE CDN.MemElem.MEE_GIDLp IS NULL AND ( inserted.Atr_OBITyp=4144 and inserted.Atr_OBILp &lt;&gt; 0 and         inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.Atr_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532 ) AND inserted.Atr_OBILp=0 and          inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtHistNag ON
                    inserted.Atr_ObiTyp = CDN.SrtHistNag.SHN_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.SrtHistNag.SHN_GIDNumer
              WHERE CDN.SrtHistNag.SHN_GIDNumer IS NULL AND (  inserted.Atr_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532 ) AND inserted.Atr_OBILp=0 and          inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtHistNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=-368 and  inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtWzorce ON
                    inserted.Atr_ObiTyp = CDN.SrtWzorce.SrW_GrpTyp
                AND inserted.Atr_ObiNumer = CDN.SrtWzorce.SrW_GrpNumer
              WHERE CDN.SrtWzorce.SrW_GrpNumer IS NULL AND (inserted.Atr_OBITyp=-368 and  inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtWzorce) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.Atr_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532  ) AND inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtHistElem ON
                    inserted.Atr_ObiTyp = CDN.SrtHistElem.SHE_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.SrtHistElem.SHE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.SrtHistElem.SHE_GIDLp
              WHERE CDN.SrtHistElem.SHE_GIDLp IS NULL AND (  inserted.Atr_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532  ) AND inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtHistElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=368)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.Atr_ObiNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL AND (inserted.Atr_OBITyp=368)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=16 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.Atr_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.Atr_OBITyp=16 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=-16 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzorce ON
                    inserted.Atr_ObiTyp = CDN.TwrWzorce.TwW_GrpTyp
                AND inserted.Atr_ObiNumer = CDN.TwrWzorce.TwW_GrpNumer
              WHERE CDN.TwrWzorce.TwW_GrpNumer IS NULL AND (inserted.Atr_OBITyp=-16 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzorce) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntWzorce ON
                    inserted.Atr_ObiTyp = CDN.KntWzorce.KnW_GrpTyp
                AND inserted.Atr_ObiNumer = CDN.KntWzorce.KnW_GrpNumer
              WHERE CDN.KntWzorce.KnW_GrpNumer IS NULL AND (inserted.Atr_OBITyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntWzorce) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.Atr_ObiNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBILp = 0 and inserted.Atr_ObiTyp in (4144,4145,4146) and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.Atr_ObiNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.Atr_OBILp = 0 and inserted.Atr_ObiTyp in (4144,4145,4146) and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=4351)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcRemElem ON
                    inserted.Atr_ObiNumer = CDN.ZlcRemElem.ZRE_GIDNumer
              WHERE CDN.ZlcRemElem.ZRE_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=4351)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcRemElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=4347)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNKartyPracy ON
                    inserted.Atr_ObiNumer = CDN.ZRNKartyPracy.ZRK_GIDNumer
              WHERE CDN.ZRNKartyPracy.ZRK_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=4347)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNKartyPracy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=4348)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNKartyPracyPrc ON
                    inserted.Atr_ObiNumer = CDN.ZRNKartyPracyPrc.ZRP_GIDNumer
              WHERE CDN.ZRNKartyPracyPrc.ZRP_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=4348)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNKartyPracyPrc) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=4350)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNMaterialy ON
                    inserted.Atr_ObiNumer = CDN.ZRNMaterialy.ZRM_GIDNumer
              WHERE CDN.ZRNMaterialy.ZRM_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=4350)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNMaterialy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4349)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNKartyPracyUsl ON
                    inserted.Atr_ObiNumer = CDN.ZRNKartyPracyUsl.ZRU_GIDNumer
              WHERE CDN.ZRNKartyPracyUsl.ZRU_GIDNumer IS NULL AND (inserted.Atr_OBITyp=4349)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNKartyPracyUsl) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Atr_OBITyp=4345 or inserted.Atr_OBITyp=4346 ))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcRemNag ON
                    inserted.Atr_ObiTyp = CDN.ZlcRemNag.ZRN_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.ZlcRemNag.ZRN_GIDNumer
              WHERE CDN.ZlcRemNag.ZRN_GIDNumer IS NULL AND ( (inserted.Atr_OBITyp=4345 or inserted.Atr_OBITyp=4346 ))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcRemNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=448)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konta ON
                    inserted.Atr_ObiTyp = CDN.Konta.KKS_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.Konta.KKS_GIDNumer
              WHERE CDN.Konta.KKS_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=448)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konta) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.Atr_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp=160)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Dostawy ON
                    inserted.Atr_ObiNumer = CDN.Dostawy.Dst_GIDNumer
              WHERE CDN.Dostawy.Dst_GIDNumer IS NULL AND ( inserted.Atr_OBITyp=160)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Dostawy) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Atr_OBITyp=4192 or inserted.Atr_OBITyp=4208 or           inserted.Atr_OBITyp=4240 ) and inserted.Atr_OBILp &lt;&gt; 0 and  inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcElem ON
                    inserted.Atr_ObiTyp = CDN.ZlcElem.ZcE_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.ZlcElem.ZcE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.ZlcElem.ZcE_GIDLp
              WHERE CDN.ZlcElem.ZcE_GIDLp IS NULL AND ( (inserted.Atr_OBITyp=4192 or inserted.Atr_OBITyp=4208 or           inserted.Atr_OBITyp=4240 ) and inserted.Atr_OBILp &lt;&gt; 0 and  inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Atr_OBITyp=4192 or inserted.Atr_OBITyp=4208 or           inserted.Atr_OBITyp=4240 ) and inserted.Atr_OBILp = 0 and  inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcNag ON
                    inserted.Atr_ObiTyp = CDN.ZlcNag.ZcN_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.ZlcNag.ZcN_GIDNumer
              WHERE CDN.ZlcNag.ZcN_GIDNumer IS NULL AND ( (inserted.Atr_OBITyp=4192 or inserted.Atr_OBITyp=4208 or           inserted.Atr_OBITyp=4240 ) and inserted.Atr_OBILp = 0 and  inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=32 AND inserted.Atr_OBISubLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Atr_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Atr_OBITyp=32 AND inserted.Atr_OBISubLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,    2005 ,2013 ,2034 ,2042, 2035, 2043 , 2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.Atr_ObiTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,    2005 ,2013 ,2034 ,2042, 2035, 2043 , 2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp )  OR UPDATE( Atr_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (1089,1601,1602,1093,1605) AND  inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagSElem ON
                    inserted.Atr_ObiNumer = CDN.MagSElem.MaS_GIDNumer
                AND inserted.Atr_ObiLp = CDN.MagSElem.MaS_GIDLp
                AND inserted.Atr_ObiSubLp = CDN.MagSElem.MaS_SubGIDLp
              WHERE CDN.MagSElem.MaS_SubGIDLp IS NULL AND (inserted.Atr_OBITyp in (1089,1601,1602,1093,1605) AND  inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagSElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in (1089,1601,1602,1093,1605) AND inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.Atr_ObiNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL AND (inserted.Atr_OBITyp in (1089,1601,1602,1093,1605) AND inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp )  OR UPDATE( Atr_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,     2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528,1521 ,1529 ,1489 ,1497 ,1600 ,1603,1604,2036      ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraSElem ON
                    inserted.Atr_ObiTyp = CDN.TraSElem.TrS_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.TraSElem.TrS_GIDNumer
                AND inserted.Atr_ObiLp = CDN.TraSElem.TrS_GIDLp
                AND inserted.Atr_ObiSubLp = CDN.TraSElem.TrS_SubGIDLp
              WHERE CDN.TraSElem.TrS_SubGIDLp IS NULL AND (inserted.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,     2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528,1521 ,1529 ,1489 ,1497 ,1600 ,1603,1604,2036      ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   inserted.Atr_OBILp&lt;&gt;0 and inserted.Atr_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraSElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=960 and  inserted.Atr_OBILp &lt;&gt; 0 and        inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.Atr_ObiTyp = CDN.ZamElem.ZaE_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.Atr_OBITyp=960 and  inserted.Atr_OBILp &lt;&gt; 0 and        inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND  inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.Atr_ObiTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND  inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=3344 and  inserted.Atr_OBILp &lt;&gt; 0 and         inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpElem ON
                    inserted.Atr_ObiTyp = CDN.ImpElem.ImE_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.ImpElem.ImE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.ImpElem.ImE_GIDLp
              WHERE CDN.ImpElem.ImE_GIDLp IS NULL AND (inserted.Atr_OBITyp=3344 and  inserted.Atr_OBILp &lt;&gt; 0 and         inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  ( inserted.Atr_OBITyp=3344 or inserted.Atr_OBITyp=3352 ) and  inserted.Atr_OBILp = 0 and        inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.Atr_ObiNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND ( ( inserted.Atr_OBITyp=3344 or inserted.Atr_OBITyp=3352 ) and  inserted.Atr_OBILp = 0 and        inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Atr_OBITyp in (3376, 3377, 3378, 3379, 3387, 3386) and  inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.Atr_ObiTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND ( inserted.Atr_OBITyp in (3376, 3377, 3378, 3379, 3387, 3386) and  inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Atr_OBITyp=3376 or inserted.Atr_OBITyp=3377 or        inserted.Atr_OBITyp=3378 or inserted.Atr_OBITyp=3379) and    inserted.Atr_OBILp &lt;&gt; 0 and     inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadElem ON
                    inserted.Atr_ObiTyp = CDN.SadElem.SaE_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.SadElem.SaE_GIDNumer
                AND inserted.Atr_ObiLp = CDN.SadElem.SaE_GIDLp
              WHERE CDN.SadElem.SaE_GIDLp IS NULL AND ( (inserted.Atr_OBITyp=3376 or inserted.Atr_OBITyp=3377 or        inserted.Atr_OBITyp=3378 or inserted.Atr_OBITyp=3379) and    inserted.Atr_OBILp &lt;&gt; 0 and     inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiTyp )  OR UPDATE( Atr_ObiNumer )  OR UPDATE( Atr_ObiLp )  OR UPDATE( Atr_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Atr_OBITyp=3376 or inserted.Atr_OBITyp=3377 or        inserted.Atr_OBITyp=3378 or inserted.Atr_OBITyp=3379) and    inserted.Atr_OBILp &lt;&gt; 0 and     inserted.Atr_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadSElem ON
                    inserted.Atr_ObiTyp = CDN.SadSElem.SaS_GIDTyp
                AND inserted.Atr_ObiNumer = CDN.SadSElem.SaS_GIDNumer
                AND inserted.Atr_ObiLp = CDN.SadSElem.SaS_GIDLp
                AND inserted.Atr_ObiSubLp = CDN.SadSElem.SaS_SubGIDLp
              WHERE CDN.SadSElem.SaS_SubGIDLp IS NULL AND ( (inserted.Atr_OBITyp=3376 or inserted.Atr_OBITyp=3377 or        inserted.Atr_OBITyp=3378 or inserted.Atr_OBITyp=3379) and    inserted.Atr_OBILp &lt;&gt; 0 and     inserted.Atr_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadSElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=960 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.Atr_ObiNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.Atr_OBITyp=960 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp = 64 and inserted.Atr_OBILp = 0 and  inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrCenyNag ON
                    inserted.Atr_ObiNumer = CDN.TwrCenyNag.TCN_Id
              WHERE CDN.TwrCenyNag.TCN_Id IS NULL AND (inserted.Atr_OBITyp = 64 and inserted.Atr_OBILp = 0 and  inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrCenyNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp IN(14343,14350) and inserted.Atr_OBILp = 1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecElem ON
                    inserted.Atr_ObiNumer = CDN.ProdZlecElem.PZE_Id
              WHERE CDN.ProdZlecElem.PZE_Id IS NULL AND (inserted.Atr_OBITyp IN(14343,14350) and inserted.Atr_OBILp = 1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecElem) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4800 AND inserted.Atr_OBILp=0 AND inserted.Atr_OBISubLp=4803)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwPozycje ON
                    inserted.Atr_ObiNumer = CDN.UmwPozycje.UmP_Id
              WHERE CDN.UmwPozycje.UmP_Id IS NULL AND (inserted.Atr_OBITyp=4800 AND inserted.Atr_OBILp=0 AND inserted.Atr_OBISubLp=4803)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwPozycje) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_ObiTyp = 6560 and inserted.Atr_ObiLp = 0 and  inserted.Atr_ObiSubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zgody ON
                    inserted.Atr_ObiNumer = CDN.Zgody.Zgo_Id
              WHERE CDN.Zgody.Zgo_Id IS NULL AND (inserted.Atr_ObiTyp = 6560 and inserted.Atr_ObiLp = 0 and  inserted.Atr_ObiSubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zgody) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=4184 and inserted.Atr_OBILp =0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMRaportyDef ON
                    inserted.Atr_ObiNumer = CDN.CRMRaportyDef.CRD_Id
              WHERE CDN.CRMRaportyDef.CRD_Id IS NULL AND (inserted.Atr_OBITyp=4184 and inserted.Atr_OBILp =0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMRaportyDef) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp IN(14363,14364) and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdRekomendacje ON
                    inserted.Atr_ObiNumer = CDN.ProdRekomendacje.PRE_Id
              WHERE CDN.ProdRekomendacje.PRE_Id IS NULL AND (inserted.Atr_OBITyp IN(14363,14364) and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdRekomendacje) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=6562 and inserted.Atr_ObiNumer&gt;0 and inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PDOCzynnosci ON
                    inserted.Atr_ObiNumer = CDN.PDOCzynnosci.PDOC_Id
              WHERE CDN.PDOCzynnosci.PDOC_Id IS NULL AND (inserted.Atr_OBITyp=6562 and inserted.Atr_ObiNumer&gt;0 and inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PDOCzynnosci) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=6563 and inserted.Atr_ObiNumer&gt;0 and inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PDONaruszenia ON
                    inserted.Atr_ObiNumer = CDN.PDONaruszenia.PDON_Id
              WHERE CDN.PDONaruszenia.PDON_Id IS NULL AND (inserted.Atr_OBITyp=6563 and inserted.Atr_ObiNumer&gt;0 and inserted.Atr_OBILp=0 and inserted.Atr_OBISubLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PDONaruszenia) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=6561 and inserted.Atr_ObiNumer&gt;0 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PDOUpowaznienia ON
                    inserted.Atr_ObiNumer = CDN.PDOUpowaznienia.PDOU_Id
              WHERE CDN.PDOUpowaznienia.PDOU_Id IS NULL AND (inserted.Atr_OBITyp=6561 and inserted.Atr_ObiNumer&gt;0 and inserted.Atr_OBILp = 0 and inserted.Atr_OBISubLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PDOUpowaznienia) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14368 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdNadzlecenia ON
                    inserted.Atr_ObiNumer = CDN.ProdNadzlecenia.PNZ_Id
              WHERE CDN.ProdNadzlecenia.PNZ_Id IS NULL AND (inserted.Atr_OBITyp=14368 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdNadzlecenia) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14380 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdParamKJNormyObiektow ON
                    inserted.Atr_ObiNumer = CDN.ProdParamKJNormyObiektow.PPKO_Id
              WHERE CDN.ProdParamKJNormyObiektow.PPKO_Id IS NULL AND (inserted.Atr_OBITyp=14380 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdParamKJNormyObiektow) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14383 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPKJNag ON
                    inserted.Atr_ObiNumer = CDN.ProdPKJNag.PKJN_Id
              WHERE CDN.ProdPKJNag.PKJN_Id IS NULL AND (inserted.Atr_OBITyp=14383 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPKJNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp=14381 and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdWzorceKJ ON
                    inserted.Atr_ObiNumer = CDN.ProdWzorceKJ.WKJ_Id
              WHERE CDN.ProdWzorceKJ.WKJ_Id IS NULL AND (inserted.Atr_OBITyp=14381 and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdWzorceKJ) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBITyp =1648  and inserted.Atr_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RachunkiBankowe ON
                    inserted.Atr_ObiNumer = CDN.RachunkiBankowe.RkB_Id
              WHERE CDN.RachunkiBankowe.RkB_Id IS NULL AND (inserted.Atr_OBITyp =1648  and inserted.Atr_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RachunkiBankowe) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Atr_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Atr_OBILp = 0 and inserted.Atr_ObiTyp=880 and inserted.Atr_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrzelewyNag ON
                    inserted.Atr_ObiNumer = CDN.PrzelewyNag.PPN_ID
              WHERE CDN.PrzelewyNag.PPN_ID IS NULL AND (inserted.Atr_OBILp = 0 and inserted.Atr_ObiTyp=880 and inserted.Atr_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrzelewyNag) [Atrybuty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AtFKostka"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AtFKostka */</I><BR>
ALTER TABLE CDN.AtrybutyFakty ADD CONSTRAINT FK_AtFKostka
 FOREIGN KEY
   (
                          AtF_KosID                         
                         )
             REFERENCES CDN.Kostki
                         (
                          Kos_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AtFFakt"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AtFFakt */</I><BR>
ALTER TABLE CDN.AtrybutyFakty ADD CONSTRAINT FK_AtFFakt
 FOREIGN KEY
   (
                          AtF_FakID                         
                         )
             REFERENCES CDN.Fakty
                         (
                          Fak_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AtrybutyHist_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AtrybutyHist_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.AtrybutyHist_InsertUpdateHandler
  ON CDN.AtrybutyHist
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp )  OR UPDATE( AtH_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp in (-1089,-1601,-1602,-1093,-1605) AND  inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagPElem ON
                    inserted.AtH_ObiNumer = CDN.MagPElem.MaP_GIDNumer
                AND inserted.AtH_ObiLp = CDN.MagPElem.MaP_GIDLp
                AND inserted.AtH_ObiSubLp = CDN.MagPElem.MaP_SubGIDLp
              WHERE CDN.MagPElem.MaP_SubGIDLp IS NULL AND (inserted.Ath_OBITyp in (-1089,-1601,-1602,-1093,-1605) AND  inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagPElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp in (1089,1601,1602,1093,1605) AND  inserted.Ath_OBILp&gt;0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagElem ON
                    inserted.AtH_ObiNumer = CDN.MagElem.MaE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.MagElem.MaE_GIDLp
              WHERE CDN.MagElem.MaE_GIDLp IS NULL AND (inserted.Ath_OBITyp in (1089,1601,1602,1093,1605) AND  inserted.Ath_OBILp&gt;0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=2752 AND inserted.Ath_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KsoNag ON
                    inserted.AtH_ObiNumer = CDN.KsoNag.KSN_GIDNumer
              WHERE CDN.KsoNag.KSN_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=2752 AND inserted.Ath_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KsoNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=2752 AND inserted.Ath_ObiLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KsoElem ON
                    inserted.AtH_ObiNumer = CDN.KsoElem.KSE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.KsoElem.KSE_GIDLp
              WHERE CDN.KsoElem.KSE_GIDLp IS NULL AND ( inserted.Ath_OBITyp=2752 AND inserted.Ath_ObiLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KsoElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=4179)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMEtapyDef ON
                    inserted.AtH_ObiNumer = CDN.CRMEtapyDef.CED_ID
              WHERE CDN.CRMEtapyDef.CED_ID IS NULL AND (inserted.Ath_OBITyp=4179)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMEtapyDef) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=4178)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMDefZadania ON
                    inserted.AtH_ObiNumer = CDN.CRMDefZadania.CDZ_Id
              WHERE CDN.CRMDefZadania.CDZ_Id IS NULL AND (inserted.Ath_OBITyp=4178)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMDefZadania) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.Ath_OBITyp IN (2976,2977)  AND  inserted.Ath_OBILp=0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PIKNag ON
                    inserted.AtH_ObiNumer = CDN.PIKNag.PIN_GIDNumer
              WHERE CDN.PIKNag.PIN_GIDNumer IS NULL AND (  inserted.Ath_OBITyp IN (2976,2977)  AND  inserted.Ath_OBILp=0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PIKNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp = 1536 AND  inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.InwOdc ON
                    inserted.AtH_ObiNumer = CDN.InwOdc.InO_Id
              WHERE CDN.InwOdc.InO_Id IS NULL AND (inserted.Ath_OBITyp = 1536 AND  inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  InwOdc) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=1536 and  inserted.Ath_OBILp &lt;&gt; 0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.InwArk ON
                    inserted.AtH_ObiNumer = CDN.InwArk.InA_Id
              WHERE CDN.InwArk.InA_Id IS NULL AND (inserted.Ath_OBITyp=1536 and  inserted.Ath_OBILp &lt;&gt; 0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  InwArk) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=1536 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.InwNag ON
                    inserted.AtH_ObiNumer = CDN.InwNag.InN_Id
              WHERE CDN.InwNag.InN_Id IS NULL AND (inserted.Ath_OBITyp=1536 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  InwNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_Id ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE exists (Select AtK_Id FRom Cdn.AtrybutyKlasy Where  Atk_ID= inserted.AtH_AtkId and (Atk_Okresowe=1 or Atk_Wielowart=1 /*w zw. z  113992*/)))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Atrybuty ON
                    inserted.AtH_Id = CDN.Atrybuty.Atr_Id
              WHERE CDN.Atrybuty.Atr_Id IS NULL AND (exists (Select AtK_Id FRom Cdn.AtrybutyKlasy Where  Atk_ID= inserted.AtH_AtkId and (Atk_Okresowe=1 or Atk_Wielowart=1 /*w zw. z  113992*/)))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Atrybuty) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=432 AND inserted.Ath_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Dziennik ON
                    inserted.AtH_ObiNumer = CDN.Dziennik.DZK_GIDNumer
              WHERE CDN.Dziennik.DZK_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=432 AND inserted.Ath_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Dziennik) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=432 AND inserted.Ath_ObiLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DziennikElem ON
                    inserted.AtH_ObiNumer = CDN.DziennikElem.DEL_GIDNumer
                AND inserted.AtH_ObiLp = CDN.DziennikElem.DEL_GIDLp
              WHERE CDN.DziennikElem.DEL_GIDLp IS NULL AND ( inserted.Ath_OBITyp=432 AND inserted.Ath_ObiLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DziennikElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=435)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RozniceKursowe ON
                    inserted.AtH_ObiNumer = CDN.RozniceKursowe.RKN_ID
              WHERE CDN.RozniceKursowe.RKN_ID IS NULL AND (inserted.Ath_OBITyp=435)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RozniceKursowe) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14346 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.AtH_ObiNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.Ath_OBITyp=14346 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14345 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.AtH_ObiNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.Ath_OBITyp=14345 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14344 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdProcesy ON
                    inserted.AtH_ObiNumer = CDN.ProdProcesy.PPC_Id
              WHERE CDN.ProdProcesy.PPC_Id IS NULL AND (inserted.Ath_OBITyp=14344 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdProcesy) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14342 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.AtH_ObiNumer = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL AND (inserted.Ath_OBITyp=14342 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14341 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaCzynnosci ON
                    inserted.AtH_ObiNumer = CDN.ProdTechnologiaCzynnosci.PTC_Id
              WHERE CDN.ProdTechnologiaCzynnosci.PTC_Id IS NULL AND (inserted.Ath_OBITyp=14341 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaCzynnosci) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14343 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.AtH_ObiNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.Ath_OBITyp=14343 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14340 and inserted.Ath_OBINumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.AtH_ObiNumer = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL AND (inserted.Ath_OBITyp=14340 and inserted.Ath_OBINumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14337 and inserted.Ath_OBINumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.AtH_ObiNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.Ath_OBITyp=14337 and inserted.Ath_OBINumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=7040 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsWyposazenia ON
                    inserted.AtH_ObiNumer = CDN.SrsWyposazenia.SsW_Id
              WHERE CDN.SrsWyposazenia.SsW_Id IS NULL AND (inserted.Ath_OBITyp=7040 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsWyposazenia) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=32 AND inserted.Ath_OBISubLp=8211)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.AtH_ObiTyp = CDN.KntOsoby.KnS_KntTyp
                AND inserted.AtH_ObiNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.AtH_ObiLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.Ath_OBITyp=32 AND inserted.Ath_OBISubLp=8211)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBISubLp = -8210)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraVat ON
                    inserted.AtH_ObiTyp = CDN.TraVat.TRV_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.TraVat.TRV_GIDNumer
                AND inserted.AtH_ObiLp = CDN.TraVat.TRV_GIDLp
              WHERE CDN.TraVat.TRV_GIDLp IS NULL AND (inserted.Ath_OBISubLp = -8210)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraVat) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp = 960 and inserted.Ath_OBISubLp = -8209)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamPlat ON
                    inserted.AtH_ObiTyp = CDN.ZamPlat.ZaP_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.ZamPlat.ZaP_GIDNumer
                AND inserted.AtH_ObiLp = CDN.ZamPlat.ZaP_GIDLp
              WHERE CDN.ZamPlat.ZaP_GIDLp IS NULL AND (inserted.Ath_OBITyp = 960 and inserted.Ath_OBISubLp = -8209)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamPlat) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp &lt;&gt; 960 and inserted.Ath_OBISubLp = -8209)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraPlat ON
                    inserted.AtH_ObiTyp = CDN.TraPlat.TrP_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.TraPlat.TrP_GIDNumer
                AND inserted.AtH_ObiLp = CDN.TraPlat.TrP_GIDLp
              WHERE CDN.TraPlat.TrP_GIDLp IS NULL AND (inserted.Ath_OBITyp &lt;&gt; 960 and inserted.Ath_OBISubLp = -8209)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraPlat) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=340 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WysPaczki ON
                    inserted.AtH_ObiNumer = CDN.WysPaczki.WyP_IdPaczki
              WHERE CDN.WysPaczki.WyP_IdPaczki IS NULL AND (inserted.Ath_OBITyp=340 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WysPaczki) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=337 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wysylki ON
                    inserted.AtH_ObiNumer = CDN.Wysylki.WYS_GIDNumer
              WHERE CDN.Wysylki.WYS_GIDNumer IS NULL AND (inserted.Ath_OBITyp=337 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wysylki) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp= -4592 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.AtH_ObiNumer = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL AND ( inserted.Ath_OBITyp= -4592 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=4176 and inserted.Ath_OBILp = 0 and         inserted.Ath_OBISubLp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKntEtapy ON
                    inserted.AtH_ObiNumer = CDN.CRMKntEtapy.CEK_ID
              WHERE CDN.CRMKntEtapy.CEK_ID IS NULL AND (inserted.Ath_OBITyp=4176 and inserted.Ath_OBILp = 0 and         inserted.Ath_OBISubLp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKntEtapy) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=4176 and inserted.Ath_OBILp &lt;&gt; 0 and         inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.AtH_ObiNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.Ath_OBITyp=4176 and inserted.Ath_OBILp &lt;&gt; 0 and         inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=4176 and inserted.Ath_OBILp = 0 and         inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampNag ON
                    inserted.AtH_ObiNumer = CDN.CRMKampNag.CKN_GIDNumer
              WHERE CDN.CRMKampNag.CKN_GIDNumer IS NULL AND (inserted.Ath_OBITyp=4176 and inserted.Ath_OBILp = 0 and         inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=339 and inserted.Ath_OBILp &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsElem ON
                    inserted.AtH_ObiNumer = CDN.SrsElem.SsE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.SrsElem.SsE_GIDLp
              WHERE CDN.SrsElem.SsE_GIDLp IS NULL AND (inserted.Ath_OBITyp=339 and inserted.Ath_OBILp &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=339 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsNag ON
                    inserted.AtH_ObiNumer = CDN.SrsNag.SsN_GIDNumer
              WHERE CDN.SrsNag.SsN_GIDNumer IS NULL AND (inserted.Ath_OBITyp=339 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp =-16 and inserted.Ath_OBILp &lt;&gt; 0 and           inserted.Ath_OBISubLp = -32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzDst ON
                    inserted.AtH_ObiTyp = CDN.TwrWzDst.WTD_GrpTyp
                AND inserted.AtH_ObiNumer = CDN.TwrWzDst.WTD_GrpNumer
                AND inserted.AtH_ObiLp = CDN.TwrWzDst.WTD_GrpLp
              WHERE CDN.TwrWzDst.WTD_GrpLp IS NULL AND ( inserted.Ath_OBITyp =-16 and inserted.Ath_OBILp &lt;&gt; 0 and           inserted.Ath_OBISubLp = -32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzDst) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp =16 and inserted.Ath_OBILp &lt;&gt; 0 and           inserted.Ath_OBISubLp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrDost ON
                    inserted.AtH_ObiTyp = CDN.TwrDost.TWD_TwrTyp
                AND inserted.AtH_ObiNumer = CDN.TwrDost.TWD_TwrNumer
                AND inserted.AtH_ObiLp = CDN.TwrDost.TWD_TwrLp
              WHERE CDN.TwrDost.TWD_TwrLp IS NULL AND ( inserted.Ath_OBITyp =16 and inserted.Ath_OBILp &lt;&gt; 0 and           inserted.Ath_OBISubLp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrDost) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp )  OR UPDATE( AtH_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Ath_OBILp &lt;&gt; 0 and inserted.Ath_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaSElem ON
                    inserted.AtH_ObiTyp = CDN.BilansOtwarciaSElem.BOS_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.BilansOtwarciaSElem.BOS_GIDNumer
                AND inserted.AtH_ObiLp = CDN.BilansOtwarciaSElem.BOS_GIDLp
                AND inserted.AtH_ObiSubLp = CDN.BilansOtwarciaSElem.BOS_SubGIDLp
              WHERE CDN.BilansOtwarciaSElem.BOS_SubGIDLp IS NULL AND ( inserted.Ath_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Ath_OBILp &lt;&gt; 0 and inserted.Ath_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaSElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Ath_OBILp &lt;&gt; 0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaElem ON
                    inserted.AtH_ObiTyp = CDN.BilansOtwarciaElem.BOE_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.BilansOtwarciaElem.BOE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.BilansOtwarciaElem.BOE_GIDLp
              WHERE CDN.BilansOtwarciaElem.BOE_GIDLp IS NULL AND ( inserted.Ath_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Ath_OBILp &lt;&gt; 0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Ath_OBILp = 0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaNag ON
                    inserted.AtH_ObiTyp = CDN.BilansOtwarciaNag.BON_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.BilansOtwarciaNag.BON_GIDNumer
              WHERE CDN.BilansOtwarciaNag.BON_GIDNumer IS NULL AND ( inserted.Ath_OBITyp in (7680, 7681, 7682, 7683) and           inserted.Ath_OBILp = 0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=8225  and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.AtH_ObiNumer = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND ( inserted.Ath_OBITyp=8225  and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=4272 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.AtH_ObiNumer = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL AND ( inserted.Ath_OBITyp=4272 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=4320 and inserted.Ath_OBILp &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DokDefinicje ON
                    inserted.AtH_ObiNumer = CDN.DokDefinicje.Dok_FrsId
                AND inserted.AtH_ObiLp = CDN.DokDefinicje.Dok_GIDTyp
              WHERE CDN.DokDefinicje.Dok_GIDTyp IS NULL AND ( inserted.Ath_OBITyp=4320 and inserted.Ath_OBILp &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DokDefinicje) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=7685)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wymiary ON
                    inserted.AtH_ObiNumer = CDN.Wymiary.WMR_ID
              WHERE CDN.Wymiary.WMR_ID IS NULL AND ( inserted.Ath_OBITyp=7685)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wymiary) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=864 or inserted.Ath_OBITyp=896)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.AtH_ObiTyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=864 or inserted.Ath_OBITyp=896)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=112 and inserted.Ath_OBILp &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RecElem ON
                    inserted.AtH_ObiNumer = CDN.RecElem.ReE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.RecElem.ReE_GIDLp
              WHERE CDN.RecElem.ReE_GIDLp IS NULL AND ( inserted.Ath_OBITyp=112 and inserted.Ath_OBILp &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RecElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=112 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RecNag ON
                    inserted.AtH_ObiNumer = CDN.RecNag.ReN_GIDNumer
              WHERE CDN.RecNag.ReN_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=112 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RecNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=784)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zapisy ON
                    inserted.AtH_ObiNumer = CDN.Zapisy.KAZ_GIDNumer
              WHERE CDN.Zapisy.KAZ_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=784)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zapisy) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=4144 and inserted.Ath_OBILp &lt;&gt; 0 and         inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemElem ON
                    inserted.AtH_ObiTyp = CDN.MemElem.MEE_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.MemElem.MEE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.MemElem.MEE_GIDLp
              WHERE CDN.MemElem.MEE_GIDLp IS NULL AND ( inserted.Ath_OBITyp=4144 and inserted.Ath_OBILp &lt;&gt; 0 and         inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.Ath_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532 ) AND inserted.Ath_OBILp=0 and          inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtHistNag ON
                    inserted.AtH_ObiTyp = CDN.SrtHistNag.SHN_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.SrtHistNag.SHN_GIDNumer
              WHERE CDN.SrtHistNag.SHN_GIDNumer IS NULL AND (  inserted.Ath_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532 ) AND inserted.Ath_OBILp=0 and          inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtHistNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=-368 and  inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtWzorce ON
                    inserted.AtH_ObiTyp = CDN.SrtWzorce.SrW_GrpTyp
                AND inserted.AtH_ObiNumer = CDN.SrtWzorce.SrW_GrpNumer
              WHERE CDN.SrtWzorce.SrW_GrpNumer IS NULL AND (inserted.Ath_OBITyp=-368 and  inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtWzorce) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.Ath_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532  ) AND inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtHistElem ON
                    inserted.AtH_ObiTyp = CDN.SrtHistElem.SHE_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.SrtHistElem.SHE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.SrtHistElem.SHE_GIDLp
              WHERE CDN.SrtHistElem.SHE_GIDLp IS NULL AND (  inserted.Ath_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532  ) AND inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtHistElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=368)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.AtH_ObiNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL AND (inserted.Ath_OBITyp=368)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=-16 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzorce ON
                    inserted.AtH_ObiTyp = CDN.TwrWzorce.TwW_GrpTyp
                AND inserted.AtH_ObiNumer = CDN.TwrWzorce.TwW_GrpNumer
              WHERE CDN.TwrWzorce.TwW_GrpNumer IS NULL AND (inserted.Ath_OBITyp=-16 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzorce) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntWzorce ON
                    inserted.AtH_ObiTyp = CDN.KntWzorce.KnW_GrpTyp
                AND inserted.AtH_ObiNumer = CDN.KntWzorce.KnW_GrpNumer
              WHERE CDN.KntWzorce.KnW_GrpNumer IS NULL AND (inserted.Ath_OBITyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntWzorce) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.AtH_ObiNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBILp = 0 and inserted.Ath_OBITyp in (4144,4145,4146) and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.AtH_ObiNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.Ath_OBILp = 0 and inserted.Ath_OBITyp in (4144,4145,4146) and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=4351)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcRemElem ON
                    inserted.AtH_ObiNumer = CDN.ZlcRemElem.ZRE_GIDNumer
              WHERE CDN.ZlcRemElem.ZRE_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=4351)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcRemElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=4347)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNKartyPracy ON
                    inserted.AtH_ObiNumer = CDN.ZRNKartyPracy.ZRK_GIDNumer
              WHERE CDN.ZRNKartyPracy.ZRK_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=4347)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNKartyPracy) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=4348)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNKartyPracyPrc ON
                    inserted.AtH_ObiNumer = CDN.ZRNKartyPracyPrc.ZRP_GIDNumer
              WHERE CDN.ZRNKartyPracyPrc.ZRP_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=4348)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNKartyPracyPrc) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=4350)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNMaterialy ON
                    inserted.AtH_ObiNumer = CDN.ZRNMaterialy.ZRM_GIDNumer
              WHERE CDN.ZRNMaterialy.ZRM_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=4350)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNMaterialy) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=4349)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNKartyPracyUsl ON
                    inserted.AtH_ObiNumer = CDN.ZRNKartyPracyUsl.ZRU_GIDNumer
              WHERE CDN.ZRNKartyPracyUsl.ZRU_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=4349)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNKartyPracyUsl) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Ath_OBITyp=4345 or inserted.Ath_OBITyp=4346 ))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcRemNag ON
                    inserted.AtH_ObiTyp = CDN.ZlcRemNag.ZRN_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.ZlcRemNag.ZRN_GIDNumer
              WHERE CDN.ZlcRemNag.ZRN_GIDNumer IS NULL AND ( (inserted.Ath_OBITyp=4345 or inserted.Ath_OBITyp=4346 ))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcRemNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=448)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konta ON
                    inserted.AtH_ObiTyp = CDN.Konta.KKS_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.Konta.KKS_GIDNumer
              WHERE CDN.Konta.KKS_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=448)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konta) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.AtH_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp=160)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Dostawy ON
                    inserted.AtH_ObiNumer = CDN.Dostawy.Dst_GIDNumer
              WHERE CDN.Dostawy.Dst_GIDNumer IS NULL AND ( inserted.Ath_OBITyp=160)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Dostawy) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Ath_OBITyp=4192 or inserted.Ath_OBITyp=4208 or           inserted.Ath_OBITyp=4240 ) and inserted.Ath_OBILp &lt;&gt; 0 and  inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcElem ON
                    inserted.AtH_ObiTyp = CDN.ZlcElem.ZcE_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.ZlcElem.ZcE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.ZlcElem.ZcE_GIDLp
              WHERE CDN.ZlcElem.ZcE_GIDLp IS NULL AND ( (inserted.Ath_OBITyp=4192 or inserted.Ath_OBITyp=4208 or           inserted.Ath_OBITyp=4240 ) and inserted.Ath_OBILp &lt;&gt; 0 and  inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Ath_OBITyp=4192 or inserted.Ath_OBITyp=4208 or           inserted.Ath_OBITyp=4240 ) and inserted.Ath_OBILp = 0 and  inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcNag ON
                    inserted.AtH_ObiTyp = CDN.ZlcNag.ZcN_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.ZlcNag.ZcN_GIDNumer
              WHERE CDN.ZlcNag.ZcN_GIDNumer IS NULL AND ( (inserted.Ath_OBITyp=4192 or inserted.Ath_OBITyp=4208 or           inserted.Ath_OBITyp=4240 ) and inserted.Ath_OBILp = 0 and  inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=32 AND inserted.Ath_OBISubLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.AtH_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Ath_OBITyp=32 AND inserted.Ath_OBISubLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,    2005 ,2013 ,2034 ,2042, 2035, 2043 , 2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.AtH_ObiTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,    2005 ,2013 ,2034 ,2042, 2035, 2043 , 2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp )  OR UPDATE( AtH_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp in (1089,1601,1602,1093,1605) AND  inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagSElem ON
                    inserted.AtH_ObiNumer = CDN.MagSElem.MaS_GIDNumer
                AND inserted.AtH_ObiLp = CDN.MagSElem.MaS_GIDLp
                AND inserted.AtH_ObiSubLp = CDN.MagSElem.MaS_SubGIDLp
              WHERE CDN.MagSElem.MaS_SubGIDLp IS NULL AND (inserted.Ath_OBITyp in (1089,1601,1602,1093,1605) AND  inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagSElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp in (1089,1601,1602,1093,1605) AND inserted.Ath_OBILp=0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.AtH_ObiNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL AND (inserted.Ath_OBITyp in (1089,1601,1602,1093,1605) AND inserted.Ath_OBILp=0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp )  OR UPDATE( AtH_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,     2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528,1521 ,1529 ,1489 ,1497 ,1600,1603,1604 ,2036      ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraSElem ON
                    inserted.AtH_ObiTyp = CDN.TraSElem.TrS_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.TraSElem.TrS_GIDNumer
                AND inserted.AtH_ObiLp = CDN.TraSElem.TrS_GIDLp
                AND inserted.AtH_ObiSubLp = CDN.TraSElem.TrS_SubGIDLp
              WHERE CDN.TraSElem.TrS_SubGIDLp IS NULL AND (inserted.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,     2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528,1521 ,1529 ,1489 ,1497 ,1600,1603,1604 ,2036      ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   inserted.Ath_OBILp&lt;&gt;0 and inserted.Ath_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraSElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=960 and  inserted.Ath_OBILp &lt;&gt; 0 and        inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.AtH_ObiTyp = CDN.ZamElem.ZaE_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.Ath_OBITyp=960 and  inserted.Ath_OBILp &lt;&gt; 0 and        inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600 ,1603,1604,2036,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND  inserted.Ath_OBILp=0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.AtH_ObiTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600 ,1603,1604,2036,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND  inserted.Ath_OBILp=0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=3344 and  inserted.Ath_OBILp &lt;&gt; 0 and         inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpElem ON
                    inserted.AtH_ObiTyp = CDN.ImpElem.ImE_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.ImpElem.ImE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.ImpElem.ImE_GIDLp
              WHERE CDN.ImpElem.ImE_GIDLp IS NULL AND (inserted.Ath_OBITyp=3344 and  inserted.Ath_OBILp &lt;&gt; 0 and         inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  ( inserted.Ath_OBITyp=3344 or inserted.Ath_OBITyp=3352 ) and  inserted.Ath_OBILp = 0 and        inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.AtH_ObiNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND ( ( inserted.Ath_OBITyp=3344 or inserted.Ath_OBITyp=3352 ) and  inserted.Ath_OBILp = 0 and        inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.Ath_OBITyp in (3376, 3377, 3378, 3379, 3387, 3386) and    inserted.Ath_OBILp = 0 and inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.AtH_ObiTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND ( inserted.Ath_OBITyp in (3376, 3377, 3378, 3379, 3387, 3386) and    inserted.Ath_OBILp = 0 and inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Ath_OBITyp=3376 or inserted.Ath_OBITyp=3377 or        inserted.Ath_OBITyp=3378 or inserted.Ath_OBITyp=3379) and    inserted.Ath_OBILp &lt;&gt; 0 and     inserted.Ath_OBISubLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadElem ON
                    inserted.AtH_ObiTyp = CDN.SadElem.SaE_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.SadElem.SaE_GIDNumer
                AND inserted.AtH_ObiLp = CDN.SadElem.SaE_GIDLp
              WHERE CDN.SadElem.SaE_GIDLp IS NULL AND ( (inserted.Ath_OBITyp=3376 or inserted.Ath_OBITyp=3377 or        inserted.Ath_OBITyp=3378 or inserted.Ath_OBITyp=3379) and    inserted.Ath_OBILp &lt;&gt; 0 and     inserted.Ath_OBISubLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiTyp )  OR UPDATE( AtH_ObiNumer )  OR UPDATE( AtH_ObiLp )  OR UPDATE( AtH_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  (inserted.Ath_OBITyp=3376 or inserted.Ath_OBITyp=3377 or        inserted.Ath_OBITyp=3378 or inserted.Ath_OBITyp=3379) and    inserted.Ath_OBILp &lt;&gt; 0 and     inserted.Ath_OBISubLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadSElem ON
                    inserted.AtH_ObiTyp = CDN.SadSElem.SaS_GIDTyp
                AND inserted.AtH_ObiNumer = CDN.SadSElem.SaS_GIDNumer
                AND inserted.AtH_ObiLp = CDN.SadSElem.SaS_GIDLp
                AND inserted.AtH_ObiSubLp = CDN.SadSElem.SaS_SubGIDLp
              WHERE CDN.SadSElem.SaS_SubGIDLp IS NULL AND ( (inserted.Ath_OBITyp=3376 or inserted.Ath_OBITyp=3377 or        inserted.Ath_OBITyp=3378 or inserted.Ath_OBITyp=3379) and    inserted.Ath_OBILp &lt;&gt; 0 and     inserted.Ath_OBISubLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadSElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14348 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecElem ON
                    inserted.AtH_ObiNumer = CDN.ProdZlecElem.PZE_Id
              WHERE CDN.ProdZlecElem.PZE_Id IS NULL AND (inserted.Ath_OBITyp=14348 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecElem) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14368 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdNadzlecenia ON
                    inserted.AtH_ObiNumer = CDN.ProdNadzlecenia.PNZ_Id
              WHERE CDN.ProdNadzlecenia.PNZ_Id IS NULL AND (inserted.Ath_OBITyp=14368 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdNadzlecenia) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14380 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdParamKJNormyObiektow ON
                    inserted.AtH_ObiNumer = CDN.ProdParamKJNormyObiektow.PPKO_Id
              WHERE CDN.ProdParamKJNormyObiektow.PPKO_Id IS NULL AND (inserted.Ath_OBITyp=14380 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdParamKJNormyObiektow) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14383 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPKJNag ON
                    inserted.AtH_ObiNumer = CDN.ProdPKJNag.PKJN_Id
              WHERE CDN.ProdPKJNag.PKJN_Id IS NULL AND (inserted.Ath_OBITyp=14383 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPKJNag) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtH_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Ath_OBITyp=14381 and inserted.Ath_OBILp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdWzorceKJ ON
                    inserted.AtH_ObiNumer = CDN.ProdWzorceKJ.WKJ_Id
              WHERE CDN.ProdWzorceKJ.WKJ_Id IS NULL AND (inserted.Ath_OBITyp=14381 and inserted.Ath_OBILp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdWzorceKJ) [AtrybutyHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AtrybutyKlasy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AtrybutyKlasy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.AtrybutyKlasy_DeleteHandler
  ON CDN.AtrybutyKlasy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ParamRozKonf
    IF EXISTS
       ( SELECT * FROM CDN.ParamRozKonf JOIN deleted
          ON
                deleted.AtK_ID = CDN.ParamRozKonf.PRK_AtkId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć tego rekordu ponieważ, jest on ustawiony jako klasa atrybutu dla parametów różnicujących konfiguratory./# [AtrybutyKlasy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdElem
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdElem JOIN deleted
          ON
                deleted.AtK_ID = CDN.KonfProdElem.KPE_AtkId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KonfProdElem) [AtrybutyKlasy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OpeKarty
    IF EXISTS
       ( SELECT * FROM CDN.OpeKarty JOIN deleted
          ON
                deleted.AtK_ID = CDN.OpeKarty.Ope_MESNrKartyAtkId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OpeKarty) [AtrybutyKlasy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Tlumaczenia
    IF EXISTS(SELECT * FROM CDN.Tlumaczenia JOIN deleted
            ON 
          deleted.AtK_ID = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ=14416)
            )
        DELETE CDN.Tlumaczenia
        FROM CDN.Tlumaczenia JOIN deleted
        ON 
          deleted.AtK_ID = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ=14416)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyUprawnienia
    IF EXISTS(SELECT * FROM CDN.AtrybutyUprawnienia JOIN deleted
            ON 
          deleted.AtK_ID = CDN.AtrybutyUprawnienia.AtU_AtkID
      AND (CDN.AtrybutyUprawnienia.AtU_AtkID&gt;0)
            )
        DELETE CDN.AtrybutyUprawnienia
        FROM CDN.AtrybutyUprawnienia JOIN deleted
        ON 
          deleted.AtK_ID = CDN.AtrybutyUprawnienia.AtU_AtkID
      AND (CDN.AtrybutyUprawnienia.AtU_AtkID&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AtrybutyObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AtrybutyObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.AtrybutyObiekty_InsertUpdateHandler
  ON CDN.AtrybutyObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ATO_ATZID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AtrybutyZrodla ON
                    inserted.ATO_ATZID = CDN.AtrybutyZrodla.ATZ_ID
              WHERE CDN.AtrybutyZrodla.ATZ_ID IS NULL
                AND (
                          IsNull(inserted.ATO_ATZID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AtrybutyZrodla) [AtrybutyObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AOFAtrybutyFakty"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AOFAtrybutyFakty */</I><BR>
ALTER TABLE CDN.AtrybutyObiektyFakty ADD CONSTRAINT FK_AOFAtrybutyFakty
 FOREIGN KEY
   (
                          AOF_AtOTyp                        ,
                          AOF_AtOElement                    ,
                          AOF_KosID                         ,
                          AOF_FakID                         
                         )
             REFERENCES CDN.AtrybutyFakty
                         (
                          AtF_OBTyp                         ,
                          AtF_Element                       ,
                          AtF_KosID                         ,
                          AtF_FakID                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AOFPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AOFPrimary */</I><BR>
ALTER TABLE CDN.AtrybutyObiektyFakty ADD CONSTRAINT FK_AOFPrimary
 FOREIGN KEY
   (
                          AOF_AtOTyp                        ,
                          AOF_AtOElement                    ,
                          AOF_AtOAtkID                      
                         )
             REFERENCES CDN.AtrybutyObiekty
                         (
                          AtO_GIDTyp                        ,
                          AtO_Element                       ,
                          AtO_AtKId                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AtrybutyUprawnienia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AtrybutyUprawnienia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.AtrybutyUprawnienia_InsertUpdateHandler
  ON CDN.AtrybutyUprawnienia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( AtU_AtkID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.AtU_AtkID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AtrybutyKlasy ON
                    inserted.AtU_AtkID = CDN.AtrybutyKlasy.AtK_ID
              WHERE CDN.AtrybutyKlasy.AtK_ID IS NULL AND (inserted.AtU_AtkID&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AtrybutyKlasy) [AtrybutyUprawnienia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( AtU_OpeNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.AtU_OpeNumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.AtU_OpeNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.AtU_OpeNumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [AtrybutyUprawnienia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AtWPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AtWPrimary */</I><BR>
ALTER TABLE CDN.AtrybutyWartosci ADD CONSTRAINT FK_AtWPrimary
 FOREIGN KEY
   (
                          AtW_AtKId                         
                         )
             REFERENCES CDN.AtrybutyKlasy
                         (
                          AtK_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AtrybutyWartosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AtrybutyWartosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.AtrybutyWartosci_DeleteHandler
  ON CDN.AtrybutyWartosci
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Tlumaczenia
    IF EXISTS(SELECT * FROM CDN.Tlumaczenia JOIN deleted
            ON 
          deleted.AtW_ID = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ=14417)
            )
        DELETE CDN.Tlumaczenia
        FROM CDN.Tlumaczenia JOIN deleted
        ON 
          deleted.AtW_ID = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ=14417)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AtrybutyZrodla_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AtrybutyZrodla_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.AtrybutyZrodla_DeleteHandler
  ON CDN.AtrybutyZrodla
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.AtrybutyObiekty
    IF EXISTS
       ( SELECT * FROM CDN.AtrybutyObiekty JOIN deleted
          ON
                deleted.ATZ_ID = CDN.AtrybutyObiekty.ATO_ATZID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą AtrybutyObiekty) [AtrybutyZrodla_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AZOZrodlo"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AZOZrodlo */</I><BR>
ALTER TABLE CDN.AtrybutyZrodlaObiekty ADD CONSTRAINT FK_AZOZrodlo
 FOREIGN KEY
   (
                          AZO_ATZID                         
                         )
             REFERENCES CDN.AtrybutyZrodla
                         (
                          ATZ_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AtePrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AtePrimary */</I><BR>
ALTER TABLE CDN.AtstElem ADD CONSTRAINT FK_AtePrimary
 FOREIGN KEY
   (
                          ATE_DokumentID                    
                         )
             REFERENCES CDN.AtstNag
                         (
                          ATN_DokumentID                    
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AtNTestID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AtNTestID */</I><BR>
ALTER TABLE CDN.AtstNag ADD CONSTRAINT FK_AtNTestID
 FOREIGN KEY
   (
                          ATN_TestID                        
                         )
             REFERENCES CDN.AtstTesty
                         (
                          ATT_TestID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="AtstNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* AtstNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.AtstNag_InsertUpdateHandler
  ON CDN.AtstNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ATN_Magazyn ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ATN_Magazyn = CDN.Magazyny.Mag_Kod
              WHERE CDN.Magazyny.Mag_Kod IS NULL
                AND (
                          IsNull(inserted.ATN_Magazyn,'') &lt;&gt; ''          -- Jeżeli pola mają wartości NULL lub '' to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [AtstNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BREBIPointRaportDef"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BREBIPointRaportDef */</I><BR>
ALTER TABLE CDN.BIPointRaportElem ADD CONSTRAINT FK_BREBIPointRaportDef
 FOREIGN KEY
   (
                          BRE_BRDId                         
                         )
             REFERENCES CDN.BIPointRaportDef
                         (
                          BRD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BROBIPointRaportDef"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BROBIPointRaportDef */</I><BR>
ALTER TABLE CDN.BIPointRaportOpeCentra ADD CONSTRAINT FK_BROBIPointRaportDef
 FOREIGN KEY
   (
                          BRO_BRDId                         
                         )
             REFERENCES CDN.BIPointRaportDef
                         (
                          BRD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BIPointRaportOpeCentra_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BIPointRaportOpeCentra_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.BIPointRaportOpeCentra_InsertUpdateHandler
  ON CDN.BIPointRaportOpeCentra
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( BRO_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BRO_Typ=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.BRO_Numer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.BRO_Typ=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [BIPointRaportOpeCentra_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BRO_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BRO_Typ=-4272)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.BRO_Numer = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL AND (inserted.BRO_Typ=-4272)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [BIPointRaportOpeCentra_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Banki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Banki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Banki_DeleteHandler
  ON CDN.Banki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.UmwNag.UmN_PodNumer
            
       AND (CDN.UmwNag.UmN_PodTyp=48)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie banku nie jest możliwe. Bank jest podmiotem dokumentu umowy./# [Banki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmlNag
    IF EXISTS
       ( SELECT * FROM CDN.UmlNag JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.UmlNag.ULN_PodmFinansNumer
       AND (CDN.UmlNag.ULN_PodmFinansTyp=48)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmlNag) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.SrwZlcNag.SZN_KnPNumer
       AND (CDN.SrwZlcNag.SZN_KnPTyp=48)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.TraNag.TrN_KnPNumer
       AND (CDN.TraNag.TrN_KnPTyp=48)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.ImpNag.ImN_KnPNumer
       AND (CDN.ImpNag.ImN_KnPTyp=48)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.SadNag.SaN_KnPNumer
       AND (CDN.SadNag.SaN_KnPTyp=48)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.KntKarty.Knt_KnPNumer
       AND (CDN.KntKarty.Knt_KnPTyp=48)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraPlat
    IF EXISTS
       ( SELECT * FROM CDN.TraPlat JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.TraPlat.TrP_KntNumer
       AND (CDN.TraPlat.TRP_KntTyp=48)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraPlat) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Urzedy
    IF EXISTS
       ( SELECT * FROM CDN.Urzedy JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.Urzedy.URZ_BnkNumer1
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Urzedy) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rejestry
    IF EXISTS
       ( SELECT * FROM CDN.Rejestry JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.Rejestry.KAR_BNKNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rejestry) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PrcKarty
    IF EXISTS
       ( SELECT * FROM CDN.PrcKarty JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.PrcKarty.Prc_BnkNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PrcKarty) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntWzorce
    IF EXISTS
       ( SELECT * FROM CDN.KntWzorce JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.KntWzorce.KnW_BnkNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntWzorce) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.KntKarty.Knt_BnkNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntAdresy
    IF EXISTS
       ( SELECT * FROM CDN.KntAdresy JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.KntAdresy.KnA_BnkNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntAdresy) [Banki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RachunkiBankowe
    IF EXISTS(SELECT * FROM CDN.RachunkiBankowe JOIN deleted
            ON 
          deleted.Bnk_GIDNumer = CDN.RachunkiBankowe.RkB_BnkNumer
      AND (CDN.RachunkiBankowe.RkB_BnkTyp = 48)
            )
        DELETE CDN.RachunkiBankowe
        FROM CDN.RachunkiBankowe JOIN deleted
        ON 
          deleted.Bnk_GIDNumer = CDN.RachunkiBankowe.RkB_BnkNumer
      AND (CDN.RachunkiBankowe.RkB_BnkTyp = 48)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BankiAlias3_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BankiAlias3_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BankiAlias3_DeleteHandler
  ON CDN.Banki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Urzedy
    IF EXISTS
       ( SELECT * FROM CDN.Urzedy JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.Urzedy.URZ_BnkNumer4
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Urzedy) [BankiAlias3_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BankiAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BankiAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BankiAlias_DeleteHandler
  ON CDN.Banki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Urzedy
    IF EXISTS
       ( SELECT * FROM CDN.Urzedy JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.Urzedy.URZ_BnkNumer2
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Urzedy) [BankiAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BankiAlias2_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BankiAlias2_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BankiAlias2_DeleteHandler
  ON CDN.Banki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Urzedy
    IF EXISTS
       ( SELECT * FROM CDN.Urzedy JOIN deleted
          ON
                deleted.Bnk_GIDNumer = CDN.Urzedy.URZ_BnkNumer3
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Urzedy) [BankiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BDOBankDefId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BDOBankDefId */</I><BR>
ALTER TABLE CDN.BankiDefinicjeOperacje ADD CONSTRAINT FK_BDOBankDefId
 FOREIGN KEY
   (
                          BDO_BankDefId                     
                         )
             REFERENCES CDN.BankiDefinicje
                         (
                          BnD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BOEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BOEPrimary */</I><BR>
ALTER TABLE CDN.BilansOtwarciaElem ADD CONSTRAINT FK_BOEPrimary
 FOREIGN KEY
   (
                          BOE_GIDNumer                      
                         )
             REFERENCES CDN.BilansOtwarciaNag
                         (
                          BON_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BilansOtwarciaElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BilansOtwarciaElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BilansOtwarciaElem_DeleteHandler
  ON CDN.BilansOtwarciaElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.BOE_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.BOE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.BOE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (7680,7681,7682,7683) and CDN.DaneObiekty.DAO_ObiLp&lt;&gt;0 and CDN.DaneObiekty.DAO_ObiSubLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.BOE_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.BOE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.BOE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (7680,7681,7682,7683) and CDN.DaneObiekty.DAO_ObiLp&lt;&gt;0 and CDN.DaneObiekty.DAO_ObiSubLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.BOE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.BOE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.BOE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp in (7680, 7681, 7682, 7683) and           CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.BOE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.BOE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.BOE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp in (7680, 7681, 7682, 7683) and           CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.BOE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.BOE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.BOE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp in (7680, 7681, 7682, 7683) and           CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.BOE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.BOE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.BOE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp in (7680, 7681, 7682, 7683) and           CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.BOE_GIDTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.BOE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND deleted.BOE_GIDLp = CDN.CRMDokumentyPozycje.CDP_DokLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp=7680)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.BOE_GIDTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.BOE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND deleted.BOE_GIDLp = CDN.CRMDokumentyPozycje.CDP_DokLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp=7680)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BilansOtwarciaNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BilansOtwarciaNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BilansOtwarciaNag_DeleteHandler
  ON CDN.BilansOtwarciaNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.BON_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.BON_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (7680,7681,7682,7683) and CDN.DaneObiekty.DAO_ObiLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.BON_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.BON_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (7680,7681,7682,7683) and CDN.DaneObiekty.DAO_ObiLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.BON_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.BON_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( CDN.Atrybuty.Atr_OBITyp in (7680, 7681, 7682, 7683) and           CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.BON_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.BON_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( CDN.Atrybuty.Atr_OBITyp in (7680, 7681, 7682, 7683) and           CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.BON_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.BON_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp IN(7680,7681,7682,7683))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.BON_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.BON_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp IN(7680,7681,7682,7683))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.BON_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.BON_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp in (7680, 7681, 7682, 7683) and           CDN.AtrybutyHist.Ath_OBILp = 0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.BON_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.BON_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp in (7680, 7681, 7682, 7683) and           CDN.AtrybutyHist.Ath_OBILp = 0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.BON_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=7680)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.BON_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=7680)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BOSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BOSPrimary */</I><BR>
ALTER TABLE CDN.BilansOtwarciaSElem ADD CONSTRAINT FK_BOSPrimary
 FOREIGN KEY
   (
                          BOS_GIDTyp                        ,
                          BOS_GIDNumer                      ,
                          BOS_GIDLp                         
                         )
             REFERENCES CDN.BilansOtwarciaElem
                         (
                          BOE_GIDTyp                        ,
                          BOE_GIDNumer                      ,
                          BOE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BilansOtwarciaSElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BilansOtwarciaSElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BilansOtwarciaSElem_DeleteHandler
  ON CDN.BilansOtwarciaSElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.BOS_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.BOS_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.BOS_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND deleted.BOS_SubGIDLp = CDN.DaneObiekty.DAO_ObiSubLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (7680,7681,7682,7683) and CDN.DaneObiekty.DAO_ObiLp&lt;&gt;0 and CDN.DaneObiekty.DAO_ObiSubLp&lt;&gt;0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.BOS_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.BOS_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.BOS_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND deleted.BOS_SubGIDLp = CDN.DaneObiekty.DAO_ObiSubLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (7680,7681,7682,7683) and CDN.DaneObiekty.DAO_ObiLp&lt;&gt;0 and CDN.DaneObiekty.DAO_ObiSubLp&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.BOS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.BOS_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.BOS_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.BOS_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND ( CDN.Atrybuty.Atr_OBITyp in (7680, 7681, 7682, 7683) and           CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.BOS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.BOS_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.BOS_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.BOS_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND ( CDN.Atrybuty.Atr_OBITyp in (7680, 7681, 7682, 7683) and           CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.BOS_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.BOS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.BOS_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.BOS_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp in (7680, 7681, 7682, 7683) and           CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.BOS_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.BOS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.BOS_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.BOS_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp in (7680, 7681, 7682, 7683) and           CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BTelOperator"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BTelOperator */</I><BR>
ALTER TABLE CDN.BilingTel ADD CONSTRAINT FK_BTelOperator
 FOREIGN KEY
   (
                          BTel_OpTelOrgID                    
                         )
             REFERENCES CDN.OperatorTel
                         (
                          OPTel_OrgID                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Bony_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Bony_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Bony_DeleteHandler
  ON CDN.Bony
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Zapisy
    IF EXISTS
       ( SELECT * FROM CDN.Zapisy JOIN deleted
          ON
                deleted.Bbon_Id = CDN.Zapisy.KAZ_BbonId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Zapisy) [Bony_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemElem
    IF EXISTS
       ( SELECT * FROM CDN.MemElem JOIN deleted
          ON
                deleted.Bbon_Id = CDN.MemElem.MEE_BbonID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemElem) [Bony_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraPlat
    IF EXISTS
       ( SELECT * FROM CDN.TraPlat JOIN deleted
          ON
                deleted.Bbon_Id = CDN.TraPlat.TrP_BbonId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraPlat) [Bony_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Bony_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Bony_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Bony_InsertUpdateHandler
  ON CDN.Bony
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Bbon_RBoId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RodzajeBonow ON
                    inserted.Bbon_RBoId = CDN.RodzajeBonow.RBo_Id
              WHERE CDN.RodzajeBonow.RBo_Id IS NULL
                AND (
                          IsNull(inserted.Bbon_RBoId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RodzajeBonow) [Bony_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Bbon_OpeWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.Bbon_OpeWNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Bbon_OpeWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [Bony_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Bbon_OpeMNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.Bbon_OpeMNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Bbon_OpeMNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [Bony_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Bbon_OpeZNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.Bbon_OpeZNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Bbon_OpeZNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [Bony_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Bbon_OpeWydalNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.Bbon_OpeWydalNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Bbon_OpeWydalNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [Bony_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Bbon_OpeBNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.Bbon_OpeBNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Bbon_OpeBNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [Bony_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Bbon_PrzyczynaBlokady ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.Bbon_PrzyczynaBlokady = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.Bbon_PrzyczynaBlokady,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Bony_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BsDBstNag"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BsDBstNag */</I><BR>
ALTER TABLE CDN.BstDokumenty ADD CONSTRAINT FK_BsDBstNag
 FOREIGN KEY
   (
                          BsD_BsNID                         
                         )
             REFERENCES CDN.BstNag
                         (
                          BsN_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BstDokumenty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BstDokumenty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.BstDokumenty_InsertUpdateHandler
  ON CDN.BstDokumenty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( BsD_DokTyp )  OR UPDATE( BsD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BsD_DokTyp=3376)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.BsD_DokTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.BsD_DokNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (inserted.BsD_DokTyp=3376)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [BstDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BsD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BsD_DokTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.BsD_DokNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.BsD_DokTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [BstDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BsD_DokTyp )  OR UPDATE( BsD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BsD_DokTyp IN(1600,1603))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.BsD_DokTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.BsD_DokNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.BsD_DokTyp IN(1600,1603))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [BstDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BsD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BsD_DokTyp=4192)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcNag ON
                    inserted.BsD_DokNumer = CDN.ZlcNag.ZcN_GIDNumer
              WHERE CDN.ZlcNag.ZcN_GIDNumer IS NULL AND (inserted.BsD_DokTyp=4192)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcNag) [BstDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BsD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BsD_DokTyp=14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.BsD_DokNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.BsD_DokTyp=14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [BstDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BsETwrNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BsETwrNumer */</I><BR>
ALTER TABLE CDN.BstElem ADD CONSTRAINT FK_BsETwrNumer
 FOREIGN KEY
   (
                          BsE_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BstElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BstElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BstElem_DeleteHandler
  ON CDN.BstElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanyObciazeniaPozycje
    IF EXISTS(SELECT * FROM CDN.PlanyObciazeniaPozycje JOIN deleted
            ON 
          deleted.BsE_BsNID = CDN.PlanyObciazeniaPozycje.PPO_DokZrdNumer
      AND deleted.BsE_TwrNumer = CDN.PlanyObciazeniaPozycje.PPO_TwrNumer
      AND (CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp=14448)
            )
        DELETE CDN.PlanyObciazeniaPozycje
        FROM CDN.PlanyObciazeniaPozycje JOIN deleted
        ON 
          deleted.BsE_BsNID = CDN.PlanyObciazeniaPozycje.PPO_DokZrdNumer
      AND deleted.BsE_TwrNumer = CDN.PlanyObciazeniaPozycje.PPO_TwrNumer
      AND (CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp=14448)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BstElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BstElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.BstElem_InsertUpdateHandler
  ON CDN.BstElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( BsE_BsNID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BstNag ON
                    inserted.BsE_BsNID = CDN.BstNag.BsN_ID
              WHERE CDN.BstNag.BsN_ID IS NULL
                AND (
                          IsNull(inserted.BsE_BsNID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BstNag) [BstElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BsMBstNag"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BsMBstNag */</I><BR>
ALTER TABLE CDN.BstMagazyny ADD CONSTRAINT FK_BsMBstNag
 FOREIGN KEY
   (
                          BsM_BsNID                         
                         )
             REFERENCES CDN.BstNag
                         (
                          BsN_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BstMagazyny_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BstMagazyny_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.BstMagazyny_InsertUpdateHandler
  ON CDN.BstMagazyny
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( BsM_MagNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BsM_MagTyp = 208)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.BsM_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.BsM_MagTyp = 208)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [BstMagazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BsNOperator"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BsNOperator */</I><BR>
ALTER TABLE CDN.BstNag ADD CONSTRAINT FK_BsNOperator
 FOREIGN KEY
   (
                          BsN_OpeWNumer                     
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BstNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BstNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BstNag_DeleteHandler
  ON CDN.BstNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.BsN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14448 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.BsN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14448 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BstElem
    IF EXISTS(SELECT * FROM CDN.BstElem JOIN deleted
            ON 
          deleted.BsN_ID = CDN.BstElem.BsE_BsNID
            )
        DELETE CDN.BstElem
        FROM CDN.BstElem JOIN deleted
        ON 
          deleted.BsN_ID = CDN.BstElem.BsE_BsNID
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BstNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BstNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.BstNag_InsertUpdateHandler
  ON CDN.BstNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( BsN_MagNNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.BsN_MagNNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.BsN_MagNNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [BstNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BsN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BsN_KntNumer&gt;=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.BsN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.BsN_KntNumer&gt;=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [BstNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BsSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BsSPrimary */</I><BR>
ALTER TABLE CDN.BstSElem ADD CONSTRAINT FK_BsSPrimary
 FOREIGN KEY
   (
                          BsS_BsNID                         ,
                          BsS_TwrNumer                      
                         )
             REFERENCES CDN.BstElem
                         (
                          BsE_BsNID   ,
                          BsE_TwrNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BsKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BsKPrimary */</I><BR>
ALTER TABLE CDN.BstSkladniki ADD CONSTRAINT FK_BsKPrimary
 FOREIGN KEY
   (
                          BsK_BsNID                         
                         )
             REFERENCES CDN.BstNag
                         (
                          BsN_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BPEBPNid"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BPEBPNid */</I><BR>
ALTER TABLE CDN.BudzetPrjElem ADD CONSTRAINT FK_BPEBPNid
 FOREIGN KEY
   (
                          BPE_BPNId                         
                         )
             REFERENCES CDN.BudzetPrjNag
                         (
                          BPN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BudzetPrjElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BudzetPrjElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BudzetPrjElem_DeleteHandler
  ON CDN.BudzetPrjElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.BPE_Id = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4596)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.BPE_Id = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4596)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.BPE_Id = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp=4596)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.BPE_Id = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp=4596)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BudzetPrjElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BudzetPrjElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.BudzetPrjElem_InsertUpdateHandler
  ON CDN.BudzetPrjElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( BPE_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BPE_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.BPE_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.BPE_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [BudzetPrjElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPE_UmNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwNag ON
                    inserted.BPE_UmNId = CDN.UmwNag.UmN_Id
              WHERE CDN.UmwNag.UmN_Id IS NULL
                AND (
                          IsNull(inserted.BPE_UmNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwNag) [BudzetPrjElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPE_Nadrzedny ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BudzetPrjElem ON
                    inserted.BPE_Nadrzedny = CDN.BudzetPrjElem.BPE_Id
              WHERE CDN.BudzetPrjElem.BPE_Id IS NULL
                AND (
                          IsNull(inserted.BPE_Nadrzedny,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BudzetPrjElem) [BudzetPrjElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPE_RezygnacjaId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.BPE_RezygnacjaId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.BPE_RezygnacjaId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [BudzetPrjElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPE_PrjID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.BPE_PrjID = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.BPE_PrjID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [BudzetPrjElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BudzetPrjElemAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BudzetPrjElemAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BudzetPrjElemAlias_DeleteHandler
  ON CDN.BudzetPrjElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BudzetPrjElem
    IF EXISTS(SELECT * FROM CDN.BudzetPrjElem JOIN deleted
            ON 
          deleted.BPE_Id = CDN.BudzetPrjElem.BPE_Nadrzedny
            )
        DELETE CDN.BudzetPrjElem
        FROM CDN.BudzetPrjElem JOIN deleted
        ON 
          deleted.BPE_Id = CDN.BudzetPrjElem.BPE_Nadrzedny
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.BPE_Id = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp=4595)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.BPE_Id = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp=4595)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.BPE_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=4596)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.BPE_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=4596)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BPEDBPEId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BPEDBPEId */</I><BR>
ALTER TABLE CDN.BudzetPrjElemDzialania ADD CONSTRAINT FK_BPEDBPEId
 FOREIGN KEY
   (
                          BPED_BPEId                         
                         )
             REFERENCES CDN.BudzetPrjElem
                         (
                          BPE_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BPEOBPEId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BPEOBPEId */</I><BR>
ALTER TABLE CDN.BudzetPrjElemOkresy ADD CONSTRAINT FK_BPEOBPEId
 FOREIGN KEY
   (
                          BPEO_BPEId                         
                         )
             REFERENCES CDN.BudzetPrjElem
                         (
                          BPE_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BPEPBPE"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BPEPBPE */</I><BR>
ALTER TABLE CDN.BudzetPrjElemPowiazane ADD CONSTRAINT FK_BPEPBPE
 FOREIGN KEY
   (
                          BPEP_BPEId                         
                         )
             REFERENCES CDN.BudzetPrjElem
                         (
                          BPE_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BPEPBPED"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BPEPBPED */</I><BR>
ALTER TABLE CDN.BudzetPrjElemPowiazane ADD CONSTRAINT FK_BPEPBPED
 FOREIGN KEY
   (
                          BPEP_BPEDId                        
                         )
             REFERENCES CDN.BudzetPrjElemDzialania
                         (
                          BPED_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BudzetPrjNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BudzetPrjNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.BudzetPrjNag_DeleteHandler
  ON CDN.BudzetPrjNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.BPN_Id = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4595)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.BPN_Id = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4595)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="BudzetPrjNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* BudzetPrjNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.BudzetPrjNag_InsertUpdateHandler
  ON CDN.BudzetPrjNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( BPN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.BPN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.BPN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.BPN_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [BudzetPrjNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPN_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.BPN_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.BPN_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [BudzetPrjNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPN_StatusId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.BPN_StatusId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.BPN_StatusId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [BudzetPrjNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPN_ZmianaStanuId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.BPN_ZmianaStanuId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.BPN_ZmianaStanuId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [BudzetPrjNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPN_UmNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwNag ON
                    inserted.BPN_UmNId = CDN.UmwNag.UmN_Id
              WHERE CDN.UmwNag.UmN_Id IS NULL
                AND (
                          IsNull(inserted.BPN_UmNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwNag) [BudzetPrjNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( BPN_PrjId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.BPN_PrjId = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.BPN_PrjId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [BudzetPrjNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_BPNWBPNId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_BPNWBPNId */</I><BR>
ALTER TABLE CDN.BudzetPrjNagWaluty ADD CONSTRAINT FK_BPNWBPNId
 FOREIGN KEY
   (
                          BPNW_BPNId                         
                         )
             REFERENCES CDN.BudzetPrjNag
                         (
                          BPN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CDCBnkNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CDCBnkNumer */</I><BR>
ALTER TABLE CDN.CDCCertyfikaty ADD CONSTRAINT FK_CDCBnkNumer
 FOREIGN KEY
   (
                          CDC_BnkNumer                      
                         )
             REFERENCES CDN.Banki
                         (
                          Bnk_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CDCCertyfikaty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CDCCertyfikaty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CDCCertyfikaty_InsertUpdateHandler
  ON CDN.CDCCertyfikaty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CDC_OpeNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDC_OpeNumer != 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.CDC_OpeNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.CDC_OpeNumer != 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [CDCCertyfikaty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KeyBnk"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KeyBnk */</I><BR>
ALTER TABLE CDN.CDCLoginy ADD CONSTRAINT FK_KeyBnk
 FOREIGN KEY
   (
                          CDCL_BnkNumer                      
                         )
             REFERENCES CDN.Banki
                         (
                          Bnk_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KeyOpe"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KeyOpe */</I><BR>
ALTER TABLE CDN.CDCLoginy ADD CONSTRAINT FK_KeyOpe
 FOREIGN KEY
   (
                          CDCL_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMAkcjeAutomatyczne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMAkcjeAutomatyczne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMAkcjeAutomatyczne_InsertUpdateHandler
  ON CDN.CRMAkcjeAutomatyczne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CAA_CRMNumer )  OR UPDATE( CAA_CRMLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CAA_CRMTyp in (4176,4177) and inserted.CAA_CRMLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.CAA_CRMNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.CAA_CRMLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.CAA_CRMTyp in (4176,4177) and inserted.CAA_CRMLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [CRMAkcjeAutomatyczne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CAA_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CAA_CRMTyp=4179 and inserted.CAA_CRMLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMEtapyDef ON
                    inserted.CAA_CRMNumer = CDN.CRMEtapyDef.CED_ID
              WHERE CDN.CRMEtapyDef.CED_ID IS NULL AND (inserted.CAA_CRMTyp=4179 and inserted.CAA_CRMLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMEtapyDef) [CRMAkcjeAutomatyczne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CAA_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CAA_CRMTyp in (4176,4177) and inserted.CAA_CRMLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampNag ON
                    inserted.CAA_CRMNumer = CDN.CRMKampNag.CKN_GIDNumer
              WHERE CDN.CRMKampNag.CKN_GIDNumer IS NULL AND (inserted.CAA_CRMTyp in (4176,4177) and inserted.CAA_CRMLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampNag) [CRMAkcjeAutomatyczne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CADAkcja"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CADAkcja */</I><BR>
ALTER TABLE CDN.CRMAkcjeDokumenty ADD CONSTRAINT FK_CADAkcja
 FOREIGN KEY
   (
                          CAD_CAAId                         
                         )
             REFERENCES CDN.CRMAkcjeAutomatyczne
                         (
                          CAA_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMDefZadania_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMDefZadania_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMDefZadania_DeleteHandler
  ON CDN.CRMDefZadania
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMZadaniaObiekty
    IF EXISTS(SELECT * FROM CDN.CRMZadaniaObiekty JOIN deleted
            ON 
          deleted.CDZ_Id = CDN.CRMZadaniaObiekty.CZO_CdzId
      AND (CDN.CRMZadaniaObiekty.Czo_CdzId&gt;0)
            )
        DELETE CDN.CRMZadaniaObiekty
        FROM CDN.CRMZadaniaObiekty JOIN deleted
        ON 
          deleted.CDZ_Id = CDN.CRMZadaniaObiekty.CZO_CdzId
      AND (CDN.CRMZadaniaObiekty.Czo_CdzId&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.CDZ_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4178)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.CDZ_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4178)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CDZ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4178)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CDZ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4178)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.CDZ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=4178)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.CDZ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=4178)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMDefZadania_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMDefZadania_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMDefZadania_InsertUpdateHandler
  ON CDN.CRMDefZadania
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CDZ_CkeNumer )  OR UPDATE( CDZ_CkeLp )  OR UPDATE( CDZ_CkeTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDZ_CkeTyp in (4180,4181,4182))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyElem ON
                    inserted.CDZ_CkeNumer = CDN.CRMWizytyElem.CWE_GidNumer
                AND inserted.CDZ_CkeLp = CDN.CRMWizytyElem.CWE_GidLp
                AND inserted.CDZ_CkeTyp = CDN.CRMWizytyElem.CWE_GidTyp
              WHERE CDN.CRMWizytyElem.CWE_GidTyp IS NULL AND (inserted.CDZ_CkeTyp in (4180,4181,4182))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyElem) [CRMDefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDZ_CkeNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDZ_CkeTyp = 4179 and inserted.CDZ_CkeLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMEtapyDef ON
                    inserted.CDZ_CkeNumer = CDN.CRMEtapyDef.CED_ID
              WHERE CDN.CRMEtapyDef.CED_ID IS NULL AND (inserted.CDZ_CkeTyp = 4179 and inserted.CDZ_CkeLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMEtapyDef) [CRMDefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDZ_CkeNumer )  OR UPDATE( CDZ_CkeLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDZ_CkeTyp  in (4176,4177) and inserted.CDZ_CkeNumer &gt;0 and inserted.CDZ_CkeLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.CDZ_CkeNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.CDZ_CkeLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.CDZ_CkeTyp  in (4176,4177) and inserted.CDZ_CkeNumer &gt;0 and inserted.CDZ_CkeLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [CRMDefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDZ_TypId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDZ_TypID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.CDZ_TypId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.CDZ_TypID&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [CRMDefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMDokumentyLinki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMDokumentyLinki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMDokumentyLinki_DeleteHandler
  ON CDN.CRMDokumentyLinki
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.CDL_CRMTyp = CDN.CRMDokumentyPozycje.CDP_CRMTyp
      AND deleted.CDL_CRMNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND deleted.CDL_DokTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.CDL_DokNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND deleted.CDL_CRMLp = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp&lt;&gt;4800 and CDN.CRMDokumentyPozycje.CDP_CRMTyp&lt;&gt;4595)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.CDL_CRMTyp = CDN.CRMDokumentyPozycje.CDP_CRMTyp
      AND deleted.CDL_CRMNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND deleted.CDL_DokTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.CDL_DokNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND deleted.CDL_CRMLp = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp&lt;&gt;4800 and CDN.CRMDokumentyPozycje.CDP_CRMTyp&lt;&gt;4595)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.CDL_CRMTyp = CDN.CRMDokumentyPozycje.CDP_CRMTyp
      AND deleted.CDL_CRMNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND deleted.CDL_DokTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.CDL_DokNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp in (4800,4595))
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.CDL_CRMTyp = CDN.CRMDokumentyPozycje.CDP_CRMTyp
      AND deleted.CDL_CRMNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND deleted.CDL_DokTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.CDL_DokNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp in (4800,4595))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMDokumentyLinki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMDokumentyLinki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMDokumentyLinki_InsertUpdateHandler
  ON CDN.CRMDokumentyLinki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=4180)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyNag ON
                    inserted.CDL_DokNumer = CDN.CRMWizytyNag.CWN_ID
              WHERE CDN.CRMWizytyNag.CWN_ID IS NULL AND (inserted.CDL_DokTyp=4180)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=1601)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.CDL_DokNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL AND (inserted.CDL_DokTyp=1601)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CRMTyp=4800)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwNag ON
                    inserted.CDL_CRMNumer = CDN.UmwNag.UmN_Id
              WHERE CDN.UmwNag.UmN_Id IS NULL AND (inserted.CDL_CRMTyp=4800)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (14451,14452,14453))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SekDokumenty ON
                    inserted.CDL_DokNumer = CDN.SekDokumenty.SDD_Id
              WHERE CDN.SekDokumenty.SDD_Id IS NULL AND (inserted.CDL_DokTyp in (14451,14452,14453))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SekDokumenty) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer )  OR UPDATE( CDL_CRMLp )  OR UPDATE( CDL_CRMTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CrmTyp in (4180,4181,4182))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyElem ON
                    inserted.CDL_CRMNumer = CDN.CRMWizytyElem.CWE_GidNumer
                AND inserted.CDL_CRMLp = CDN.CRMWizytyElem.CWE_GidLp
                AND inserted.CDL_CRMTyp = CDN.CRMWizytyElem.CWE_GidTyp
              WHERE CDN.CRMWizytyElem.CWE_GidTyp IS NULL AND (inserted.CDL_CrmTyp in (4180,4181,4182))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyElem) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (3584,3585))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklNag ON
                    inserted.CDL_DokNumer = CDN.ReklNag.RLN_Id
              WHERE CDN.ReklNag.RLN_Id IS NULL AND (inserted.CDL_DokTyp in (3584,3585))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=4700)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.CDL_DokNumer = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL AND (inserted.CDL_DokTyp=4700)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wysylki ON
                    inserted.CDL_DokNumer = CDN.Wysylki.WYS_GIDNumer
              WHERE CDN.Wysylki.WYS_GIDNumer IS NULL AND (inserted.CDL_DokTyp=337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wysylki) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=340)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WysPaczki ON
                    inserted.CDL_DokNumer = CDN.WysPaczki.WyP_IdPaczki
              WHERE CDN.WysPaczki.WyP_IdPaczki IS NULL AND (inserted.CDL_DokTyp=340)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WysPaczki) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (4592,-4592))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.CDL_DokNumer = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL AND (inserted.CDL_DokTyp in (4592,-4592))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.CDL_DokNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.CDL_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=784)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zapisy ON
                    inserted.CDL_DokNumer = CDN.Zapisy.KAZ_GIDNumer
              WHERE CDN.Zapisy.KAZ_GIDNumer IS NULL AND (inserted.CDL_DokTyp=784)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zapisy) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (4144,4145))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.CDL_DokNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.CDL_DokTyp in (4144,4145))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.CDL_DokNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.CDL_DokTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (2832,2833))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UpoNag ON
                    inserted.CDL_DokNumer = CDN.UpoNag.UPN_GIDNumer
              WHERE CDN.UpoNag.UPN_GIDNumer IS NULL AND (inserted.CDL_DokTyp in (2832,2833))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UpoNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (4345,4346))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcRemNag ON
                    inserted.CDL_DokNumer = CDN.ZlcRemNag.ZRN_GIDNumer
              WHERE CDN.ZlcRemNag.ZRN_GIDNumer IS NULL AND (inserted.CDL_DokTyp in (4345,4346))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcRemNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (3344,3352))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.CDL_DokNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.CDL_DokTyp in (3344,3352))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (14343,     14350))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.CDL_DokNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.CDL_DokTyp in (14343,     14350))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp in (4192,4208))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcNag ON
                    inserted.CDL_DokNumer = CDN.ZlcNag.ZcN_GIDNumer
              WHERE CDN.ZlcNag.ZcN_GIDNumer IS NULL AND (inserted.CDL_DokTyp in (4192,4208))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CRMTyp=341)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKntEtapy ON
                    inserted.CDL_CRMNumer = CDN.CRMKntEtapy.CEK_ID
              WHERE CDN.CRMKntEtapy.CEK_ID IS NULL AND (inserted.CDL_CRMTyp=341)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKntEtapy) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CRMTyp=4176 and  inserted.CDL_CRMLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampNag ON
                    inserted.CDL_CRMNumer = CDN.CRMKampNag.CKN_GIDNumer
              WHERE CDN.CRMKampNag.CKN_GIDNumer IS NULL AND (inserted.CDL_CRMTyp=4176 and  inserted.CDL_CRMLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer )  OR UPDATE( CDL_CRMLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CRMTyp=4176 and  inserted.CDL_CRMLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.CDL_CRMNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.CDL_CRMLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.CDL_CRMTyp=4176 and  inserted.CDL_CRMLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CRMTyp=339 and  inserted.CDL_CRMLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsNag ON
                    inserted.CDL_CRMNumer = CDN.SrsNag.SsN_GIDNumer
              WHERE CDN.SrsNag.SsN_GIDNumer IS NULL AND (inserted.CDL_CRMTyp=339 and  inserted.CDL_CRMLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer )  OR UPDATE( CDL_CRMLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CRMTyp=339 and  inserted.CDL_CRMLp &lt;&gt; 0 and  inserted.CDL_CRMLp &lt;&gt; -1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsElem ON
                    inserted.CDL_CRMNumer = CDN.SrsElem.SsE_GIDNumer
                AND inserted.CDL_CRMLp = CDN.SrsElem.SsE_GIDLp
              WHERE CDN.SrsElem.SsE_GIDLp IS NULL AND (inserted.CDL_CRMTyp=339 and  inserted.CDL_CRMLp &lt;&gt; 0 and  inserted.CDL_CRMLp &lt;&gt; -1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsElem) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CRMTyp=4595)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BudzetPrjNag ON
                    inserted.CDL_CRMNumer = CDN.BudzetPrjNag.BPN_Id
              WHERE CDN.BudzetPrjNag.BPN_Id IS NULL AND (inserted.CDL_CRMTyp=4595)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BudzetPrjNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_CRMTyp=4596)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BudzetPrjElem ON
                    inserted.CDL_CRMNumer = CDN.BudzetPrjElem.BPE_Id
              WHERE CDN.BudzetPrjElem.BPE_Id IS NULL AND (inserted.CDL_CRMTyp=4596)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BudzetPrjElem) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=4710)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwPlanPrzegladu ON
                    inserted.CDL_DokNumer = CDN.SrwPlanPrzegladu.SPP_Id
              WHERE CDN.SrwPlanPrzegladu.SPP_Id IS NULL AND (inserted.CDL_DokTyp=4710)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwPlanPrzegladu) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=4596)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BudzetPrjElem ON
                    inserted.CDL_DokNumer = CDN.BudzetPrjElem.BPE_Id
              WHERE CDN.BudzetPrjElem.BPE_Id IS NULL AND (inserted.CDL_DokTyp=4596)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BudzetPrjElem) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDL_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDL_DokTyp=7680)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaNag ON
                    inserted.CDL_DokNumer = CDN.BilansOtwarciaNag.BON_GIDNumer
              WHERE CDN.BilansOtwarciaNag.BON_GIDNumer IS NULL AND (inserted.CDL_DokTyp=7680)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaNag) [CRMDokumentyLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMDokumentyPozycje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMDokumentyPozycje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMDokumentyPozycje_InsertUpdateHandler
  ON CDN.CRMDokumentyPozycje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CDP_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_CRMTyp=4176 and  inserted.CDP_CRMLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampNag ON
                    inserted.CDP_CRMNumer = CDN.CRMKampNag.CKN_GIDNumer
              WHERE CDN.CRMKampNag.CKN_GIDNumer IS NULL AND (inserted.CDP_CRMTyp=4176 and  inserted.CDP_CRMLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampNag) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_CRMTyp=341)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKntEtapy ON
                    inserted.CDP_CRMNumer = CDN.CRMKntEtapy.CEK_ID
              WHERE CDN.CRMKntEtapy.CEK_ID IS NULL AND (inserted.CDP_CRMTyp=341)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKntEtapy) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_CRMNumer )  OR UPDATE( CDP_CRMLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_CRMTyp=4176 and  inserted.CDP_CRMLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.CDP_CRMNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.CDP_CRMLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.CDP_CRMTyp=4176 and  inserted.CDP_CRMLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_CRMTyp )  OR UPDATE( CDP_CRMNumer )  OR UPDATE( CDP_CRMLp )  OR UPDATE( CDP_DokTyp )  OR UPDATE( CDP_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_CRMTyp&lt;&gt;4800 and inserted.CDP_CRMTyp&lt;&gt;4595)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMDokumentyLinki ON
                    inserted.CDP_CRMTyp = CDN.CRMDokumentyLinki.CDL_CRMTyp
                AND inserted.CDP_CRMNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
                AND inserted.CDP_CRMLp = CDN.CRMDokumentyLinki.CDL_CRMLp
                AND inserted.CDP_DokTyp = CDN.CRMDokumentyLinki.CDL_DokTyp
                AND inserted.CDP_DokNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
              WHERE CDN.CRMDokumentyLinki.CDL_DokNumer IS NULL AND (inserted.CDP_CRMTyp&lt;&gt;4800 and inserted.CDP_CRMTyp&lt;&gt;4595)
                AND (
                          IsNull(inserted.CDP_CRMTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CDP_CRMNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CDP_CRMLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CDP_DokTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CDP_DokNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMDokumentyLinki) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_DokTyp )  OR UPDATE( CDP_DokNumer )  OR UPDATE( CDP_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.CDP_DokTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.CDP_DokNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.CDP_DokLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.CDP_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_DokTyp )  OR UPDATE( CDP_DokNumer )  OR UPDATE( CDP_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_DokTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.CDP_DokTyp = CDN.ZamElem.ZaE_GIDTyp
                AND inserted.CDP_DokNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.CDP_DokLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.CDP_DokTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_DokTyp in (3584,3585))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklElem ON
                    inserted.CDP_DokLp = CDN.ReklElem.RLE_Id
              WHERE CDN.ReklElem.RLE_Id IS NULL AND (inserted.CDP_DokTyp in (3584,3585))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklElem) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_CRMTyp=339 and  inserted.CDP_CRMLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsNag ON
                    inserted.CDP_CRMNumer = CDN.SrsNag.SsN_GIDNumer
              WHERE CDN.SrsNag.SsN_GIDNumer IS NULL AND (inserted.CDP_CRMTyp=339 and  inserted.CDP_CRMLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsNag) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_CRMNumer )  OR UPDATE( CDP_CRMLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_CRMTyp=339 and  inserted.CDP_CRMLp &lt;&gt; 0 and  inserted.CDP_CRMLp &lt;&gt; -1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsElem ON
                    inserted.CDP_CRMNumer = CDN.SrsElem.SsE_GIDNumer
                AND inserted.CDP_CRMLp = CDN.SrsElem.SsE_GIDLp
              WHERE CDN.SrsElem.SsE_GIDLp IS NULL AND (inserted.CDP_CRMTyp=339 and  inserted.CDP_CRMLp &lt;&gt; 0 and  inserted.CDP_CRMLp &lt;&gt; -1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsElem) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_CRMLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_DokTyp =4800)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwPozycje ON
                    inserted.CDP_CRMLp = CDN.UmwPozycje.UmP_Id
              WHERE CDN.UmwPozycje.UmP_Id IS NULL AND (inserted.CDP_DokTyp =4800)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwPozycje) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_CRMNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_DokTyp=4596)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BudzetPrjElem ON
                    inserted.CDP_CRMNumer = CDN.BudzetPrjElem.BPE_Id
              WHERE CDN.BudzetPrjElem.BPE_Id IS NULL AND (inserted.CDP_DokTyp=4596)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BudzetPrjElem) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_CRMLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_DokTyp=4595)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BudzetPrjElem ON
                    inserted.CDP_CRMLp = CDN.BudzetPrjElem.BPE_Id
              WHERE CDN.BudzetPrjElem.BPE_Id IS NULL AND (inserted.CDP_DokTyp=4595)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BudzetPrjElem) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CDP_DokTyp )  OR UPDATE( CDP_DokNumer )  OR UPDATE( CDP_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_DokTyp=7680)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaElem ON
                    inserted.CDP_DokTyp = CDN.BilansOtwarciaElem.BOE_GIDTyp
                AND inserted.CDP_DokNumer = CDN.BilansOtwarciaElem.BOE_GIDNumer
                AND inserted.CDP_DokLp = CDN.BilansOtwarciaElem.BOE_GIDLp
              WHERE CDN.BilansOtwarciaElem.BOE_GIDLp IS NULL AND (inserted.CDP_DokTyp=7680)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaElem) [CRMDokumentyPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMDokumentyPozycjeAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMDokumentyPozycjeAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMDokumentyPozycjeAlias_InsertUpdateHandler
  ON CDN.CRMDokumentyPozycje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CDP_CRMTyp )  OR UPDATE( CDP_CRMNumer )  OR UPDATE( CDP_DokTyp )  OR UPDATE( CDP_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CDP_CRMTyp in (4800,4595))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMDokumentyLinki ON
                    inserted.CDP_CRMTyp = CDN.CRMDokumentyLinki.CDL_CRMTyp
                AND inserted.CDP_CRMNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
                AND inserted.CDP_DokTyp = CDN.CRMDokumentyLinki.CDL_DokTyp
                AND inserted.CDP_DokNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
              WHERE CDN.CRMDokumentyLinki.CDL_DokNumer IS NULL AND (inserted.CDP_CRMTyp in (4800,4595))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMDokumentyLinki) [CRMDokumentyPozycjeAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMEtapyDef_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMEtapyDef_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMEtapyDef_DeleteHandler
  ON CDN.CRMEtapyDef
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMAkcjeAutomatyczne
    IF EXISTS(SELECT * FROM CDN.CRMAkcjeAutomatyczne JOIN deleted
            ON 
          deleted.CED_ID = CDN.CRMAkcjeAutomatyczne.CAA_CRMNumer
      AND (CDN.CRMAkcjeAutomatyczne.CAA_CRMTyp=4179 and CDN.CRMAkcjeAutomatyczne.CAA_CRMLp=0)
            )
        DELETE CDN.CRMAkcjeAutomatyczne
        FROM CDN.CRMAkcjeAutomatyczne JOIN deleted
        ON 
          deleted.CED_ID = CDN.CRMAkcjeAutomatyczne.CAA_CRMNumer
      AND (CDN.CRMAkcjeAutomatyczne.CAA_CRMTyp=4179 and CDN.CRMAkcjeAutomatyczne.CAA_CRMLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDefZadania
    IF EXISTS(SELECT * FROM CDN.CRMDefZadania JOIN deleted
            ON 
          deleted.CED_ID = CDN.CRMDefZadania.CDZ_CkeNumer
      AND (CDN.CRMDefZadania.CDZ_CkeTyp = 4179 and CDN.CRMDefZadania.CDZ_CkeLp = 0)
            )
        DELETE CDN.CRMDefZadania
        FROM CDN.CRMDefZadania JOIN deleted
        ON 
          deleted.CED_ID = CDN.CRMDefZadania.CDZ_CkeNumer
      AND (CDN.CRMDefZadania.CDZ_CkeTyp = 4179 and CDN.CRMDefZadania.CDZ_CkeLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.CED_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4179)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.CED_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4179)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CED_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4179)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CED_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4179)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.CED_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=4179)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.CED_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=4179)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CETCKE"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CETCKE */</I><BR>
ALTER TABLE CDN.CRMEtapyTwr ADD CONSTRAINT FK_CETCKE
 FOREIGN KEY
   (
                          CET_CKENumer                      ,
                          CET_CKELp                         
                         )
             REFERENCES CDN.CRMKampEtapy
                         (
                          CKE_GIDNumer   ,
                          CKE_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMEtapyTwr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMEtapyTwr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMEtapyTwr_InsertUpdateHandler
  ON CDN.CRMEtapyTwr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CET_CKTId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampTwr ON
                    inserted.CET_CKTId = CDN.CRMKampTwr.CKT_ID
              WHERE CDN.CRMKampTwr.CKT_ID IS NULL
                AND (
                          IsNull(inserted.CET_CKTId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampTwr) [CRMEtapyTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CkePrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CkePrimary */</I><BR>
ALTER TABLE CDN.CRMKampEtapy ADD CONSTRAINT FK_CkePrimary
 FOREIGN KEY
   (
                          CKE_GIDNumer                      
                         )
             REFERENCES CDN.CRMKampNag
                         (
                          CKN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMKampEtapy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMKampEtapy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMKampEtapy_DeleteHandler
  ON CDN.CRMKampEtapy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND deleted.CKE_GIDLp = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=4176 and  CDN.CRMDokumentyPozycje.CDP_CRMLp&lt;&gt;0)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND deleted.CKE_GIDLp = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=4176 and  CDN.CRMDokumentyPozycje.CDP_CRMLp&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMAkcjeAutomatyczne
    IF EXISTS(SELECT * FROM CDN.CRMAkcjeAutomatyczne JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.CRMAkcjeAutomatyczne.CAA_CRMNumer
      AND deleted.CKE_GIDLp = CDN.CRMAkcjeAutomatyczne.CAA_CRMLp
      AND (CDN.CRMAkcjeAutomatyczne.CAA_CRMTyp in (4176,4177) and CDN.CRMAkcjeAutomatyczne.CAA_CRMLp&lt;&gt;0)
            )
        DELETE CDN.CRMAkcjeAutomatyczne
        FROM CDN.CRMAkcjeAutomatyczne JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.CRMAkcjeAutomatyczne.CAA_CRMNumer
      AND deleted.CKE_GIDLp = CDN.CRMAkcjeAutomatyczne.CAA_CRMLp
      AND (CDN.CRMAkcjeAutomatyczne.CAA_CRMTyp in (4176,4177) and CDN.CRMAkcjeAutomatyczne.CAA_CRMLp&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDefZadania
    IF EXISTS(SELECT * FROM CDN.CRMDefZadania JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.CRMDefZadania.CDZ_CkeNumer
      AND deleted.CKE_GIDLp = CDN.CRMDefZadania.CDZ_CkeLp
      AND (CDN.CRMDefZadania.CDZ_CkeTyp  in (4176,4177) and CDN.CRMDefZadania.CDZ_CkeNumer &gt;0 and CDN.CRMDefZadania.CDZ_CkeLp &gt; 0)
            )
        DELETE CDN.CRMDefZadania
        FROM CDN.CRMDefZadania JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.CRMDefZadania.CDZ_CkeNumer
      AND deleted.CKE_GIDLp = CDN.CRMDefZadania.CDZ_CkeLp
      AND (CDN.CRMDefZadania.CDZ_CkeTyp  in (4176,4177) and CDN.CRMDefZadania.CDZ_CkeNumer &gt;0 and CDN.CRMDefZadania.CDZ_CkeLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND deleted.CKE_GIDLp = CDN.CRMDokumentyLinki.CDL_CRMLp
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4176 and  CDN.CRMDokumentyLinki.CDL_CRMLp&lt;&gt;0)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND deleted.CKE_GIDLp = CDN.CRMDokumentyLinki.CDL_CRMLp
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4176 and  CDN.CRMDokumentyLinki.CDL_CRMLp&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.CKE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4176,4177) AND CDN.DaneObiekty.DAO_ObiLp &gt; 0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.CKE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4176,4177) AND CDN.DaneObiekty.DAO_ObiLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMZwiazaneKamp
    IF EXISTS(SELECT * FROM CDN.CRMZwiazaneKamp JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.CRMZwiazaneKamp.CZK_CKNNumer
      AND deleted.CKE_GIDLp = CDN.CRMZwiazaneKamp.CZK_CKNLp
      AND (CDN.CRMZwiazaneKamp.CZK_CKNLp&gt;0)
            )
        DELETE CDN.CRMZwiazaneKamp
        FROM CDN.CRMZwiazaneKamp JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.CRMZwiazaneKamp.CZK_CKNNumer
      AND deleted.CKE_GIDLp = CDN.CRMZwiazaneKamp.CZK_CKNLp
      AND (CDN.CRMZwiazaneKamp.CZK_CKNLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.CKE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=4176 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and         CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.CKE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=4176 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and         CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMKntEtapy
    IF EXISTS(SELECT * FROM CDN.CRMKntEtapy JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.CRMKntEtapy.CEK_CKENumer
      AND deleted.CKE_GIDLp = CDN.CRMKntEtapy.CEK_CKELp
      AND (CDN.CRMKntEtapy.CEK_CKETyp=4176)
            )
        DELETE CDN.CRMKntEtapy
        FROM CDN.CRMKntEtapy JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.CRMKntEtapy.CEK_CKENumer
      AND deleted.CKE_GIDLp = CDN.CRMKntEtapy.CEK_CKELp
      AND (CDN.CRMKntEtapy.CEK_CKETyp=4176)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.CKE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.CKE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=4176 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.CKE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.CKE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=4176 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMKampEtapyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMKampEtapyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMKampEtapyAlias_DeleteHandler
  ON CDN.CRMKampEtapy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMZwiazaneKamp
    IF EXISTS
       ( SELECT * FROM CDN.CRMZwiazaneKamp JOIN deleted
          ON
                deleted.CKE_GIDNumer = CDN.CRMZwiazaneKamp.CZK_CKNZwNumer
            AND deleted.CKE_GIDLp = CDN.CRMZwiazaneKamp.CZK_CKNZwLp
       AND (CDN.CRMZwiazaneKamp.CZK_CKNZwLp&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMZwiazaneKamp) [CRMKampEtapyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMKampNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMKampNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMKampNag_DeleteHandler
  ON CDN.CRMKampNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.CKN_GIDNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=4176 and  CDN.CRMDokumentyPozycje.CDP_CRMLp=0)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.CKN_GIDNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=4176 and  CDN.CRMDokumentyPozycje.CDP_CRMLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMAkcjeAutomatyczne
    IF EXISTS(SELECT * FROM CDN.CRMAkcjeAutomatyczne JOIN deleted
            ON 
          deleted.CKN_GIDNumer = CDN.CRMAkcjeAutomatyczne.CAA_CRMNumer
      AND (CDN.CRMAkcjeAutomatyczne.CAA_CRMTyp in (4176,4177) and CDN.CRMAkcjeAutomatyczne.CAA_CRMLp=0)
            )
        DELETE CDN.CRMAkcjeAutomatyczne
        FROM CDN.CRMAkcjeAutomatyczne JOIN deleted
        ON 
          deleted.CKN_GIDNumer = CDN.CRMAkcjeAutomatyczne.CAA_CRMNumer
      AND (CDN.CRMAkcjeAutomatyczne.CAA_CRMTyp in (4176,4177) and CDN.CRMAkcjeAutomatyczne.CAA_CRMLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.CKN_GIDNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4176 and  CDN.CRMDokumentyLinki.CDL_CRMLp=0)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.CKN_GIDNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4176 and  CDN.CRMDokumentyLinki.CDL_CRMLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.CKN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4176,4177) AND CDN.DaneObiekty.DAO_ObiLp = 0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.CKN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4176,4177) AND CDN.DaneObiekty.DAO_ObiLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CKN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4176 and CDN.Atrybuty.Atr_OBILp = 0 and         CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CKN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4176 and CDN.Atrybuty.Atr_OBILp = 0 and         CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.CKN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=4176 and CDN.AtrybutyHist.Ath_OBILp = 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.CKN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=4176 and CDN.AtrybutyHist.Ath_OBILp = 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CKTCKN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CKTCKN */</I><BR>
ALTER TABLE CDN.CRMKampTwr ADD CONSTRAINT FK_CKTCKN
 FOREIGN KEY
   (
                          CKT_CKNNumer                      
                         )
             REFERENCES CDN.CRMKampNag
                         (
                          CKN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMKampTwr_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMKampTwr_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMKampTwr_DeleteHandler
  ON CDN.CRMKampTwr
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMEtapyTwr
    IF EXISTS(SELECT * FROM CDN.CRMEtapyTwr JOIN deleted
            ON 
          deleted.CKT_ID = CDN.CRMEtapyTwr.CET_CKTId
            )
        DELETE CDN.CRMEtapyTwr
        FROM CDN.CRMEtapyTwr JOIN deleted
        ON 
          deleted.CKT_ID = CDN.CRMEtapyTwr.CET_CKTId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMKampTwr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMKampTwr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMKampTwr_InsertUpdateHandler
  ON CDN.CRMKampTwr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CKT_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CKT_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.CKT_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.CKT_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [CRMKampTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CKT_TwrNumer )  OR UPDATE( CKT_TwrTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CKT_TwrTyp=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.CKT_TwrNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.CKT_TwrTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (inserted.CKT_TwrTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [CRMKampTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMKntEtapy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMKntEtapy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMKntEtapy_DeleteHandler
  ON CDN.CRMKntEtapy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMDokumentyLinki
    IF EXISTS
       ( SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
          ON
                deleted.CEK_ID = CDN.CRMDokumentyLinki.CDL_CRMNumer
       AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=341)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMDokumentyLinki) [CRMKntEtapy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.CEK_ID = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=341)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.CEK_ID = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=341)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyElemObiekty
    IF EXISTS(SELECT * FROM CDN.CRMWizytyElemObiekty JOIN deleted
            ON 
          deleted.CEK_ID = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=341)
            )
        DELETE CDN.CRMWizytyElemObiekty
        FROM CDN.CRMWizytyElemObiekty JOIN deleted
        ON 
          deleted.CEK_ID = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=341)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.CEK_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=341)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.CEK_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=341)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CEK_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4176 and CDN.Atrybuty.Atr_OBILp = 0 and         CDN.Atrybuty.Atr_OBISubLp = 32)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CEK_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4176 and CDN.Atrybuty.Atr_OBILp = 0 and         CDN.Atrybuty.Atr_OBISubLp = 32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.CEK_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=4176 and CDN.AtrybutyHist.Ath_OBILp = 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 32)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.CEK_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=4176 and CDN.AtrybutyHist.Ath_OBILp = 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 32)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMKntEtapy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMKntEtapy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMKntEtapy_InsertUpdateHandler
  ON CDN.CRMKntEtapy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CEK_TypKnt ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.CEK_TypKnt = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.CEK_TypKnt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_FiaskoID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.CEK_FiaskoID = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.CEK_FiaskoID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_AntZadId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zadania ON
                    inserted.CEK_AntZadId = CDN.Zadania.Zad_Id
              WHERE CDN.Zadania.Zad_Id IS NULL
                AND (
                          IsNull(inserted.CEK_AntZadId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zadania) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_AntId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Ankiety ON
                    inserted.CEK_AntId = CDN.Ankiety.ANT_Id
              WHERE CDN.Ankiety.ANT_Id IS NULL
                AND (
                          IsNull(inserted.CEK_AntId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Ankiety) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_KntNumer )  OR UPDATE( CEK_KntOsobaLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CEK_KntTyp=32 AND inserted.CEK_KntOsobaLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.CEK_KntNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.CEK_KntOsobaLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.CEK_KntTyp=32 AND inserted.CEK_KntOsobaLp&gt;0)
                AND (
                          IsNull(inserted.CEK_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CEK_KntOsobaLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_KnATyp )  OR UPDATE( CEK_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.CEK_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.CEK_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.CEK_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CEK_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_CZKZrdID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CEK_CZKZrdID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMZwiazaneKamp ON
                    inserted.CEK_CZKZrdID = CDN.CRMZwiazaneKamp.CZK_ID
              WHERE CDN.CRMZwiazaneKamp.CZK_ID IS NULL AND (inserted.CEK_CZKZrdID&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMZwiazaneKamp) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CEK_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.CEK_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.CEK_AkwTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CEK_AkwTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.CEK_AkwNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.CEK_AkwTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_CKENumer )  OR UPDATE( CEK_CKELp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CEK_CKETyp=4176)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.CEK_CKENumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.CEK_CKELp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.CEK_CKETyp=4176)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CEK_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.CEK_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.CEK_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CEK_KntNumer )  OR UPDATE( CEK_KntOsobaLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CEK_AkwTyp=32 AND inserted.CEK_AkwOsobaLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.CEK_KntNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.CEK_KntOsobaLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.CEK_AkwTyp=32 AND inserted.CEK_AkwOsobaLp&gt;0)
                AND (
                          IsNull(inserted.CEK_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CEK_KntOsobaLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [CRMKntEtapy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CPTCKT"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CPTCKT */</I><BR>
ALTER TABLE CDN.CRMKntEtapyTwr ADD CONSTRAINT FK_CPTCKT
 FOREIGN KEY
   (
                          CPT_CKTId                         
                         )
             REFERENCES CDN.CRMKampTwr
                         (
                          CKT_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CPTCEK"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CPTCEK */</I><BR>
ALTER TABLE CDN.CRMKntEtapyTwr ADD CONSTRAINT FK_CPTCEK
 FOREIGN KEY
   (
                          CPT_CEKId                         
                         )
             REFERENCES CDN.CRMKntEtapy
                         (
                          CEK_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CKWSsN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CKWSsN */</I><BR>
ALTER TABLE CDN.CRMKontrahenciWatki ADD CONSTRAINT FK_CKWSsN
 FOREIGN KEY
   (
                          CKW_SsnNumer                      
                         )
             REFERENCES CDN.SrsNag
                         (
                          SsN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CKWCEK"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CKWCEK */</I><BR>
ALTER TABLE CDN.CRMKontrahenciWatki ADD CONSTRAINT FK_CKWCEK
 FOREIGN KEY
   (
                          CKW_CekID                         
                         )
             REFERENCES CDN.CRMKntEtapy
                         (
                          CEK_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMRaportyDef_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMRaportyDef_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMRaportyDef_DeleteHandler
  ON CDN.CRMRaportyDef
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyRptTwr
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyRptTwr JOIN deleted
          ON
                deleted.CRD_Id = CDN.CRMWizytyRptTwr.CWT_CRDId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć raportu ponieważ występuje on na elemencie wizyty handlowej ./# [CRMRaportyDef_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyElemObiekty
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyElemObiekty JOIN deleted
          ON
                deleted.CRD_Id = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
            
       AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=4184)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Definicja raportu nie może zostać usunięta, ponieważ została dodana do wzorca elementu wizyty./# [CRMRaportyDef_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyRptKolumny
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyRptKolumny JOIN deleted
          ON
                deleted.CRD_Id = CDN.CRMWizytyRptKolumny.CWRK_CRDId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć raportu ponieważ występuje on na elemencie wizyty handlowej ./# [CRMRaportyDef_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CRD_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4184 and CDN.Atrybuty.Atr_OBILp =0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CRD_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4184 and CDN.Atrybuty.Atr_OBILp =0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CRKCRDId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CRKCRDId */</I><BR>
ALTER TABLE CDN.CRMRaportyKolumny ADD CONSTRAINT FK_CRKCRDId
 FOREIGN KEY
   (
                          CRK_CRDId                         
                         )
             REFERENCES CDN.CRMRaportyDef
                         (
                          CRD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CRKAtKID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CRKAtKID */</I><BR>
ALTER TABLE CDN.CRMRaportyKolumny ADD CONSTRAINT FK_CRKAtKID
 FOREIGN KEY
   (
                          CRK_AtKID                         
                         )
             REFERENCES CDN.AtrybutyKlasy
                         (
                          AtK_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CRTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CRTPrimary */</I><BR>
ALTER TABLE CDN.CRMRaportyTwr ADD CONSTRAINT FK_CRTPrimary
 FOREIGN KEY
   (
                          CRT_CRDId                         
                         )
             REFERENCES CDN.CRMRaportyDef
                         (
                          CRD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CRTTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CRTTowar */</I><BR>
ALTER TABLE CDN.CRMRaportyTwr ADD CONSTRAINT FK_CRTTowar
 FOREIGN KEY
   (
                          CRT_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CSKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CSKPrimary */</I><BR>
ALTER TABLE CDN.CRMSrsKontrahenci ADD CONSTRAINT FK_CSKPrimary
 FOREIGN KEY
   (
                          CSK_SseNumer                      ,
                          CSK_SseLp                         
                         )
             REFERENCES CDN.SrsElem
                         (
                          SsE_GIDNumer                      ,
                          SsE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMSrsKontrahenci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMSrsKontrahenci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMSrsKontrahenci_InsertUpdateHandler
  ON CDN.CRMSrsKontrahenci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CSK_KnSNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.CSK_KnSNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.CSK_KnSNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [CRMSrsKontrahenci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CSK_KnSNumer )  OR UPDATE( CSK_KnSLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CSK_KnSLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.CSK_KnSNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.CSK_KnSLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.CSK_KnSLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [CRMSrsKontrahenci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyAnkiety_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyAnkiety_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyAnkiety_InsertUpdateHandler
  ON CDN.CRMWizytyAnkiety
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CWA_CWENumer )  OR UPDATE( CWA_CWELp )  OR UPDATE( CWA_CWETyp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyElemObiekty ON
                    inserted.CWA_CWENumer = CDN.CRMWizytyElemObiekty.CWO_CWENumer
                AND inserted.CWA_CWELp = CDN.CRMWizytyElemObiekty.CWO_CWELp
                AND inserted.CWA_CWETyp = CDN.CRMWizytyElemObiekty.CWO_CWETyp
              WHERE CDN.CRMWizytyElemObiekty.CWO_CWETyp IS NULL
                AND (
                          IsNull(inserted.CWA_CWENumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWA_CWELp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWA_CWETyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyElemObiekty) [CRMWizytyAnkiety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWA_ANTId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Ankiety ON
                    inserted.CWA_ANTId = CDN.Ankiety.ANT_Id
              WHERE CDN.Ankiety.ANT_Id IS NULL
                AND (
                          IsNull(inserted.CWA_ANTId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Ankiety) [CRMWizytyAnkiety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWA_TWRNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWA_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.CWA_TWRNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.CWA_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [CRMWizytyAnkiety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CDTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CDTPrimary */</I><BR>
ALTER TABLE CDN.CRMWizytyDokTwr ADD CONSTRAINT FK_CDTPrimary
 FOREIGN KEY
   (
                          CDT_CWENumer                      ,
                          CDT_CWELp                         ,
                          CDT_CWETyp                        
                         )
             REFERENCES CDN.CRMWizytyElem
                         (
                          CWE_GidNumer                      ,
                          CWE_GidLp                         ,
                          CWE_GidTyp                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CDTTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CDTTowar */</I><BR>
ALTER TABLE CDN.CRMWizytyDokTwr ADD CONSTRAINT FK_CDTTowar
 FOREIGN KEY
   (
                          CDT_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyElem_DeleteHandler
  ON CDN.CRMWizytyElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoRelacje
    IF EXISTS
       ( SELECT * FROM CDN.PicoRelacje JOIN deleted
          ON
                deleted.CWE_GidNumer = CDN.PicoRelacje.PcR_OBINumer
            AND deleted.CWE_GidTyp = CDN.PicoRelacje.PcR_OBITyp
            
       AND (CDN.PicoRelacje.PcR_OBITyp=4182)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Element nie może być usunięty, ponieważ został zsynchronizowany do Oddziału Offline./# [CRMWizytyElem_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.CWE_GidNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND deleted.CWE_GidLp = CDN.CRMDokumentyLinki.CDL_CRMLp
      AND deleted.CWE_GidTyp = CDN.CRMDokumentyLinki.CDL_CRMTyp
      AND (CDN.CRMDokumentyLinki.CDL_CrmTyp in (4180,4181,4182))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.CWE_GidNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND deleted.CWE_GidLp = CDN.CRMDokumentyLinki.CDL_CRMLp
      AND deleted.CWE_GidTyp = CDN.CRMDokumentyLinki.CDL_CRMTyp
      AND (CDN.CRMDokumentyLinki.CDL_CrmTyp in (4180,4181,4182))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDefZadania
    IF EXISTS(SELECT * FROM CDN.CRMDefZadania JOIN deleted
            ON 
          deleted.CWE_GidNumer = CDN.CRMDefZadania.CDZ_CkeNumer
      AND deleted.CWE_GidLp = CDN.CRMDefZadania.CDZ_CkeLp
      AND deleted.CWE_GidTyp = CDN.CRMDefZadania.CDZ_CkeTyp
      AND (CDN.CRMDefZadania.CDZ_CkeTyp in (4180,4181,4182))
            )
        DELETE CDN.CRMDefZadania
        FROM CDN.CRMDefZadania JOIN deleted
        ON 
          deleted.CWE_GidNumer = CDN.CRMDefZadania.CDZ_CkeNumer
      AND deleted.CWE_GidLp = CDN.CRMDefZadania.CDZ_CkeLp
      AND deleted.CWE_GidTyp = CDN.CRMDefZadania.CDZ_CkeTyp
      AND (CDN.CRMDefZadania.CDZ_CkeTyp in (4180,4181,4182))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CWE_GidNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.CWE_GidTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.CWE_GidLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBISubLp = 0 AND ((CDN.Atrybuty.Atr_OBITyp in (4180,4181) and CDN.Atrybuty.Atr_OBILp&gt;0) OR (CDN.Atrybuty.Atr_OBITyp=4182 and CDN.Atrybuty.Atr_OBILp=0)))
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CWE_GidNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.CWE_GidTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.CWE_GidLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBISubLp = 0 AND ((CDN.Atrybuty.Atr_OBITyp in (4180,4181) and CDN.Atrybuty.Atr_OBILp&gt;0) OR (CDN.Atrybuty.Atr_OBITyp=4182 and CDN.Atrybuty.Atr_OBILp=0)))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.CWE_GidTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.CWE_GidNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.CWE_GidLp = CDN.DaneObiekty.DAO_ObiLp
      AND ((CDN.DaneObiekty.DAO_ObiTyp in (4180,4181) AND CDN.DaneObiekty.DAO_ObiLp&gt;0) OR (CDN.DaneObiekty.DAO_ObiTyp=4182 AND CDN.DaneObiekty.DAO_ObiLp=0))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.CWE_GidTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.CWE_GidNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.CWE_GidLp = CDN.DaneObiekty.DAO_ObiLp
      AND ((CDN.DaneObiekty.DAO_ObiTyp in (4180,4181) AND CDN.DaneObiekty.DAO_ObiLp&gt;0) OR (CDN.DaneObiekty.DAO_ObiTyp=4182 AND CDN.DaneObiekty.DAO_ObiLp=0))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyElem_InsertUpdateHandler
  ON CDN.CRMWizytyElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CWE_GidNumer )  OR UPDATE( CWE_GidLp )  OR UPDATE( CWE_GidTyp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SamPrzejazdy ON
                    inserted.CWE_GidNumer = CDN.SamPrzejazdy.SaP_ZrdNumer
                AND inserted.CWE_GidLp = CDN.SamPrzejazdy.SaP_ZrdLp
                AND inserted.CWE_GidTyp = CDN.SamPrzejazdy.SaP_ZrdTyp
              WHERE CDN.SamPrzejazdy.SaP_ZrdTyp IS NULL AND (CDN.SamPrzejazdy.SaP_ZrdTyp=4180)
                AND (
                          IsNull(inserted.CWE_GidNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWE_GidLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWE_GidTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SamPrzejazdy) [CRMWizytyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWE_RodzajId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.CWE_RodzajId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.CWE_RodzajId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [CRMWizytyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWE_GidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWE_GidTyp=4180)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyNag ON
                    inserted.CWE_GidNumer = CDN.CRMWizytyNag.CWN_ID
              WHERE CDN.CRMWizytyNag.CWN_ID IS NULL AND (inserted.CWE_GidTyp=4180)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyNag) [CRMWizytyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWE_GidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWE_GidTyp=4181)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWzorceWizyt ON
                    inserted.CWE_GidNumer = CDN.CRMWzorceWizyt.CWW_Id
              WHERE CDN.CRMWzorceWizyt.CWW_Id IS NULL AND (inserted.CWE_GidTyp=4181)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWzorceWizyt) [CRMWizytyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CWDPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CWDPrimary */</I><BR>
ALTER TABLE CDN.CRMWizytyElemDok ADD CONSTRAINT FK_CWDPrimary
 FOREIGN KEY
   (
                          CWD_CWENumer                      ,
                          CWD_CWELp                         ,
                          CWD_CWETyp                        
                         )
             REFERENCES CDN.CRMWizytyElem
                         (
                          CWE_GidNumer                      ,
                          CWE_GidLp                         ,
                          CWE_GidTyp                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CWOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CWOPrimary */</I><BR>
ALTER TABLE CDN.CRMWizytyElemObiekty ADD CONSTRAINT FK_CWOPrimary
 FOREIGN KEY
   (
                          CWO_CWENumer                      ,
                          CWO_CWELp                         ,
                          CWO_CWETyp                        
                         )
             REFERENCES CDN.CRMWizytyElem
                         (
                          CWE_GidNumer                      ,
                          CWE_GidLp                         ,
                          CWE_GidTyp                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyElemObiekty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyElemObiekty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyElemObiekty_DeleteHandler
  ON CDN.CRMWizytyElemObiekty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyRptTwr
    IF EXISTS(SELECT * FROM CDN.CRMWizytyRptTwr JOIN deleted
            ON 
          deleted.CWO_CWENumer = CDN.CRMWizytyRptTwr.CWT_CWENumer
      AND deleted.CWO_CWELp = CDN.CRMWizytyRptTwr.CWT_CWELp
      AND deleted.CWO_CWETyp = CDN.CRMWizytyRptTwr.CWT_CWETyp
      AND deleted.CWO_ObiNumer = CDN.CRMWizytyRptTwr.CWT_CRDId
            )
        DELETE CDN.CRMWizytyRptTwr
        FROM CDN.CRMWizytyRptTwr JOIN deleted
        ON 
          deleted.CWO_CWENumer = CDN.CRMWizytyRptTwr.CWT_CWENumer
      AND deleted.CWO_CWELp = CDN.CRMWizytyRptTwr.CWT_CWELp
      AND deleted.CWO_CWETyp = CDN.CRMWizytyRptTwr.CWT_CWETyp
      AND deleted.CWO_ObiNumer = CDN.CRMWizytyRptTwr.CWT_CRDId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyAnkiety
    IF EXISTS(SELECT * FROM CDN.CRMWizytyAnkiety JOIN deleted
            ON 
          deleted.CWO_CWENumer = CDN.CRMWizytyAnkiety.CWA_CWENumer
      AND deleted.CWO_CWELp = CDN.CRMWizytyAnkiety.CWA_CWELp
      AND deleted.CWO_CWETyp = CDN.CRMWizytyAnkiety.CWA_CWETyp
            )
        DELETE CDN.CRMWizytyAnkiety
        FROM CDN.CRMWizytyAnkiety JOIN deleted
        ON 
          deleted.CWO_CWENumer = CDN.CRMWizytyAnkiety.CWA_CWENumer
      AND deleted.CWO_CWELp = CDN.CRMWizytyAnkiety.CWA_CWELp
      AND deleted.CWO_CWETyp = CDN.CRMWizytyAnkiety.CWA_CWETyp
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyRptKolumny
    IF EXISTS(SELECT * FROM CDN.CRMWizytyRptKolumny JOIN deleted
            ON 
          deleted.CWO_CWENumer = CDN.CRMWizytyRptKolumny.CWRK_CWENumer
      AND deleted.CWO_CWELp = CDN.CRMWizytyRptKolumny.CWRK_CWELp
      AND deleted.CWO_CWETyp = CDN.CRMWizytyRptKolumny.CWRK_CWETyp
      AND deleted.CWO_ObiNumer = CDN.CRMWizytyRptKolumny.CWRK_CRDId
            )
        DELETE CDN.CRMWizytyRptKolumny
        FROM CDN.CRMWizytyRptKolumny JOIN deleted
        ON 
          deleted.CWO_CWENumer = CDN.CRMWizytyRptKolumny.CWRK_CWENumer
      AND deleted.CWO_CWELp = CDN.CRMWizytyRptKolumny.CWRK_CWELp
      AND deleted.CWO_CWETyp = CDN.CRMWizytyRptKolumny.CWRK_CWETyp
      AND deleted.CWO_ObiNumer = CDN.CRMWizytyRptKolumny.CWRK_CRDId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyElemObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyElemObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyElemObiekty_InsertUpdateHandler
  ON CDN.CRMWizytyElemObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CWO_ObiNumer )  OR UPDATE( CWO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWO_ObiTyp = 32 AND inserted.CWO_ObiLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.CWO_ObiNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.CWO_ObiLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.CWO_ObiTyp = 32 AND inserted.CWO_ObiLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [CRMWizytyElemObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWO_ObiTyp=4184)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMRaportyDef ON
                    inserted.CWO_ObiNumer = CDN.CRMRaportyDef.CRD_Id
              WHERE CDN.CRMRaportyDef.CRD_Id IS NULL AND (inserted.CWO_ObiTyp=4184)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMRaportyDef) [CRMWizytyElemObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWO_ObiTyp=14460)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Ankiety ON
                    inserted.CWO_ObiNumer = CDN.Ankiety.ANT_Id
              WHERE CDN.Ankiety.ANT_Id IS NULL AND (inserted.CWO_ObiTyp=14460)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Ankiety) [CRMWizytyElemObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWO_ObiTyp=339 and  inserted.CWO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsNag ON
                    inserted.CWO_ObiNumer = CDN.SrsNag.SsN_GIDNumer
              WHERE CDN.SrsNag.SsN_GIDNumer IS NULL AND (inserted.CWO_ObiTyp=339 and  inserted.CWO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsNag) [CRMWizytyElemObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWO_ObiNumer )  OR UPDATE( CWO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWO_ObiTyp=339 and  inserted.CWO_ObiLp &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsElem ON
                    inserted.CWO_ObiNumer = CDN.SrsElem.SsE_GIDNumer
                AND inserted.CWO_ObiLp = CDN.SrsElem.SsE_GIDLp
              WHERE CDN.SrsElem.SsE_GIDLp IS NULL AND (inserted.CWO_ObiTyp=339 and  inserted.CWO_ObiLp &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsElem) [CRMWizytyElemObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWO_ObiTyp=341)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKntEtapy ON
                    inserted.CWO_ObiNumer = CDN.CRMKntEtapy.CEK_ID
              WHERE CDN.CRMKntEtapy.CEK_ID IS NULL AND (inserted.CWO_ObiTyp=341)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKntEtapy) [CRMWizytyElemObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWO_ObiTyp=4702)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.CWO_ObiNumer = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL AND (inserted.CWO_ObiTyp=4702)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [CRMWizytyElemObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyNag_DeleteHandler
  ON CDN.CRMWizytyNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.CWN_ID = CDN.WydatkiPracownikow.WPR_CWNId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć wizyty. Usuwana wizyta jest wybrany na jednym z wydatków pracownika./# [CRMWizytyNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zadania
    IF EXISTS(SELECT * FROM CDN.Zadania JOIN deleted
            ON 
          deleted.CWN_ID = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=4180)
            )
        DELETE CDN.Zadania
        FROM CDN.Zadania JOIN deleted
        ON 
          deleted.CWN_ID = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=4180)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyElem
    IF EXISTS(SELECT * FROM CDN.CRMWizytyElem JOIN deleted
            ON 
          deleted.CWN_ID = CDN.CRMWizytyElem.CWE_GidNumer
      AND (CDN.CRMWizytyElem.CWE_GidTyp=4180)
            )
        DELETE CDN.CRMWizytyElem
        FROM CDN.CRMWizytyElem JOIN deleted
        ON 
          deleted.CWN_ID = CDN.CRMWizytyElem.CWE_GidNumer
      AND (CDN.CRMWizytyElem.CWE_GidTyp=4180)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CWN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4180 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CWN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4180 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.CWN_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4180 AND CDN.DaneObiekty.DAO_ObiLp = 0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.CWN_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4180 AND CDN.DaneObiekty.DAO_ObiLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyNag_InsertUpdateHandler
  ON CDN.CRMWizytyNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CWN_WzNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWzorceWizyt ON
                    inserted.CWN_WzNumer = CDN.CRMWzorceWizyt.CWW_Id
              WHERE CDN.CRMWzorceWizyt.CWW_Id IS NULL
                AND (
                          IsNull(inserted.CWN_WzNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWzorceWizyt) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.CWN_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.CWN_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_Obsluga ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.CWN_Obsluga = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.CWN_Obsluga,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_Opiekun ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.CWN_Opiekun = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.CWN_Opiekun,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_KntTyp )  OR UPDATE( CWN_KntNumer )  OR UPDATE( CWN_KntOsobaLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWN_KntOsobaLp&gt;0 and inserted.CWN_KntOsobaLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.CWN_KntTyp = CDN.KntOsoby.KnS_KntTyp
                AND inserted.CWN_KntNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.CWN_KntOsobaLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.CWN_KntOsobaLp&gt;0 and inserted.CWN_KntOsobaLp&gt;0)
                AND (
                          IsNull(inserted.CWN_KntTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWN_KntOsobaLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.CWN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.CWN_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_KnANumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWN_KnATyp=864 or inserted.CWN_KnATyp=896)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.CWN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL AND (inserted.CWN_KnATyp=864 or inserted.CWN_KnATyp=896)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_TypId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.CWN_TypId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.CWN_TypId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_DGENumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWN_DGETyp=2984 and inserted.CWN_DGELp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Delegacje ON
                    inserted.CWN_DGENumer = CDN.Delegacje.DLG_GIDNumer
              WHERE CDN.Delegacje.DLG_GIDNumer IS NULL AND (inserted.CWN_DGETyp=2984 and inserted.CWN_DGELp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Delegacje) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_DGENumer )  OR UPDATE( CWN_DGELp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CWN_DGETyp=2984 and inserted.CWN_DGELp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DelegacjeElem ON
                    inserted.CWN_DGENumer = CDN.DelegacjeElem.DGE_GIDNumer
                AND inserted.CWN_DGELp = CDN.DelegacjeElem.DGE_GIDLp
              WHERE CDN.DelegacjeElem.DGE_GIDLp IS NULL AND (inserted.CWN_DGETyp=2984 and inserted.CWN_DGELp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DelegacjeElem) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWN_TsNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TrasyNag ON
                    inserted.CWN_TsNId = CDN.TrasyNag.TsN_Id
              WHERE CDN.TrasyNag.TsN_Id IS NULL
                AND (
                          IsNull(inserted.CWN_TsNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TrasyNag) [CRMWizytyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyNagAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyNagAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyNagAlias_DeleteHandler
  ON CDN.CRMWizytyNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.CWN_ID = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=4180)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.CWN_ID = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=4180)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyRptKolumny_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyRptKolumny_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyRptKolumny_InsertUpdateHandler
  ON CDN.CRMWizytyRptKolumny
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CWRK_CWETyp )  OR UPDATE( CWRK_CWENumer )  OR UPDATE( CWRK_CWELp )  OR UPDATE( CWRK_CRDId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyElemObiekty ON
                    inserted.CWRK_CWETyp = CDN.CRMWizytyElemObiekty.CWO_CWETyp
                AND inserted.CWRK_CWENumer = CDN.CRMWizytyElemObiekty.CWO_CWENumer
                AND inserted.CWRK_CWELp = CDN.CRMWizytyElemObiekty.CWO_CWELp
                AND inserted.CWRK_CRDId = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
              WHERE CDN.CRMWizytyElemObiekty.CWO_ObiNumer IS NULL
                AND (
                          IsNull(inserted.CWRK_CWETyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWRK_CWENumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWRK_CWELp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWRK_CRDId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyElemObiekty) [CRMWizytyRptKolumny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWRK_CRDId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMRaportyDef ON
                    inserted.CWRK_CRDId = CDN.CRMRaportyDef.CRD_Id
              WHERE CDN.CRMRaportyDef.CRD_Id IS NULL
                AND (
                          IsNull(inserted.CWRK_CRDId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMRaportyDef) [CRMWizytyRptKolumny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CWTTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CWTTowar */</I><BR>
ALTER TABLE CDN.CRMWizytyRptTwr ADD CONSTRAINT FK_CWTTowar
 FOREIGN KEY
   (
                          CWT_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWizytyRptTwr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWizytyRptTwr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMWizytyRptTwr_InsertUpdateHandler
  ON CDN.CRMWizytyRptTwr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CWT_KntTyp )  OR UPDATE( CWT_KntNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.CWT_KntTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.CWT_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.CWT_KntTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWT_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [CRMWizytyRptTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWT_CWETyp )  OR UPDATE( CWT_CWENumer )  OR UPDATE( CWT_CWELp )  OR UPDATE( CWT_CRDId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyElemObiekty ON
                    inserted.CWT_CWETyp = CDN.CRMWizytyElemObiekty.CWO_CWETyp
                AND inserted.CWT_CWENumer = CDN.CRMWizytyElemObiekty.CWO_CWENumer
                AND inserted.CWT_CWELp = CDN.CRMWizytyElemObiekty.CWO_CWELp
                AND inserted.CWT_CRDId = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
              WHERE CDN.CRMWizytyElemObiekty.CWO_ObiNumer IS NULL
                AND (
                          IsNull(inserted.CWT_CWETyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWT_CWENumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWT_CWELp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.CWT_CRDId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyElemObiekty) [CRMWizytyRptTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWT_CRDId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMRaportyDef ON
                    inserted.CWT_CRDId = CDN.CRMRaportyDef.CRD_Id
              WHERE CDN.CRMRaportyDef.CRD_Id IS NULL
                AND (
                          IsNull(inserted.CWT_CRDId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMRaportyDef) [CRMWizytyRptTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CWT_Ekspozycja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.CWT_Ekspozycja = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.CWT_Ekspozycja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [CRMWizytyRptTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CWRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CWRPrimary */</I><BR>
ALTER TABLE CDN.CRMWzorceRodzajeKnt ADD CONSTRAINT FK_CWRPrimary
 FOREIGN KEY
   (
                          CWR_CWWId                         
                         )
             REFERENCES CDN.CRMWzorceWizyt
                         (
                          CWW_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CWRRodzaj"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CWRRodzaj */</I><BR>
ALTER TABLE CDN.CRMWzorceRodzajeKnt ADD CONSTRAINT FK_CWRRodzaj
 FOREIGN KEY
   (
                          CWR_RodzajId                      
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWzorceWizyt_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWzorceWizyt_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMWzorceWizyt_DeleteHandler
  ON CDN.CRMWzorceWizyt
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoRelacje
    IF EXISTS
       ( SELECT * FROM CDN.PicoRelacje JOIN deleted
          ON
                deleted.CWW_Id = CDN.PicoRelacje.PcR_OBINumer
            
       AND (CDN.PicoRelacje.PcR_OBITyp=4181)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć wzorca wizyty ponieważ został on zsynchronizowany do Oddziału Offline./# [CRMWzorceWizyt_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.CWW_Id = CDN.CRMWizytyNag.CWN_WzNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć wzorca wizyty. Usuwany wzorzec jest wybrany na jednej z wizyt handlowych./# [CRMWzorceWizyt_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyElem
    IF EXISTS(SELECT * FROM CDN.CRMWizytyElem JOIN deleted
            ON 
          deleted.CWW_Id = CDN.CRMWizytyElem.CWE_GidNumer
      AND (CDN.CRMWizytyElem.CWE_GidTyp=4181)
            )
        DELETE CDN.CRMWizytyElem
        FROM CDN.CRMWizytyElem JOIN deleted
        ON 
          deleted.CWW_Id = CDN.CRMWizytyElem.CWE_GidNumer
      AND (CDN.CRMWizytyElem.CWE_GidTyp=4181)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.CWW_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4181 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.CWW_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4181 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.CWW_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4181 AND CDN.DaneObiekty.DAO_ObiLp = 0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.CWW_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4181 AND CDN.DaneObiekty.DAO_ObiLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMWzorceWizyt_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMWzorceWizyt_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMWzorceWizyt_InsertUpdateHandler
  ON CDN.CRMWzorceWizyt
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CWW_TypId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.CWW_TypId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.CWW_TypId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [CRMWzorceWizyt_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMZadaniaObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMZadaniaObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMZadaniaObiekty_InsertUpdateHandler
  ON CDN.CRMZadaniaObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CZO_SseNumer )  OR UPDATE( CZO_SseLP ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Czo_SseNumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsElem ON
                    inserted.CZO_SseNumer = CDN.SrsElem.SsE_GIDNumer
                AND inserted.CZO_SseLP = CDN.SrsElem.SsE_GIDLp
              WHERE CDN.SrsElem.SsE_GIDLp IS NULL AND (inserted.Czo_SseNumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsElem) [CRMZadaniaObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CZO_CdzId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Czo_CdzId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMDefZadania ON
                    inserted.CZO_CdzId = CDN.CRMDefZadania.CDZ_Id
              WHERE CDN.CRMDefZadania.CDZ_Id IS NULL AND (inserted.Czo_CdzId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMDefZadania) [CRMZadaniaObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CZKKampZwiazana"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CZKKampZwiazana */</I><BR>
ALTER TABLE CDN.CRMZwiazaneKamp ADD CONSTRAINT FK_CZKKampZwiazana
 FOREIGN KEY
   (
                          CZK_CKNZwNumer                    
                         )
             REFERENCES CDN.CRMKampNag                     -- oryginalnie CRMKampNagAlias
                         (
                          CKN_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CZKKampania"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CZKKampania */</I><BR>
ALTER TABLE CDN.CRMZwiazaneKamp ADD CONSTRAINT FK_CZKKampania
 FOREIGN KEY
   (
                          CZK_CKNNumer                      
                         )
             REFERENCES CDN.CRMKampNag
                         (
                          CKN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMZwiazaneKamp_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMZwiazaneKamp_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CRMZwiazaneKamp_DeleteHandler
  ON CDN.CRMZwiazaneKamp
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.CZK_ID = CDN.CRMKntEtapy.CEK_CZKZrdID
            
       AND (CDN.CRMKntEtapy.CEK_CZKZrdID&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=W kampanii powiązanej z wybranym obiektem dodano kontrahentów. Usunięcie rekordu jest niemożliwe./# [CRMZwiazaneKamp_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CRMZwiazaneKamp_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CRMZwiazaneKamp_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.CRMZwiazaneKamp_InsertUpdateHandler
  ON CDN.CRMZwiazaneKamp
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( CZK_CKNZwNumer )  OR UPDATE( CZK_CKNZwLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CZK_CKNZwLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.CZK_CKNZwNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.CZK_CKNZwLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.CZK_CKNZwLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [CRMZwiazaneKamp_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( CZK_CKNNumer )  OR UPDATE( CZK_CKNLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.CZK_CKNLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.CZK_CKNNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.CZK_CKNLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.CZK_CKNLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [CRMZwiazaneKamp_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_CChPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_CChPrimaryNoType */</I><BR>
ALTER TABLE CDN.Cechy ADD CONSTRAINT FK_CChPrimaryNoType
 FOREIGN KEY
   (
                          CCh_GIDNumer                      
                         )
             REFERENCES CDN.CechyKlasy
                         (
                          CCK_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="CechyKlasy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* CechyKlasy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.CechyKlasy_DeleteHandler
  ON CDN.CechyKlasy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwOdcTwr
    IF EXISTS
       ( SELECT * FROM CDN.InwOdcTwr JOIN deleted
          ON
                deleted.CCK_GIDNumer = CDN.InwOdcTwr.IOT_CCkNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą InwOdcTwr) [CechyKlasy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwTwr
    IF EXISTS
       ( SELECT * FROM CDN.InwTwr JOIN deleted
          ON
                deleted.CCK_GIDNumer = CDN.InwTwr.InT_CCkNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą InwTwr) [CechyKlasy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Dostawy
    IF EXISTS
       ( SELECT * FROM CDN.Dostawy JOIN deleted
          ON
                deleted.CCK_GIDNumer = CDN.Dostawy.Dst_CCKNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Dostawy) [CechyKlasy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrKarty
    IF EXISTS
       ( SELECT * FROM CDN.TwrKarty JOIN deleted
          ON
                deleted.CCK_GIDNumer = CDN.TwrKarty.Twr_CCKNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrKarty) [CechyKlasy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ClbfPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ClbfPrimary */</I><BR>
ALTER TABLE CDN.ClbkFrs ADD CONSTRAINT FK_ClbfPrimary
 FOREIGN KEY
   (
                          CLBF_ClbkId                        
                         )
             REFERENCES CDN.ClbkKarty
                         (
                          CLBK_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ClbfFirma"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ClbfFirma */</I><BR>
ALTER TABLE CDN.ClbkFrs ADD CONSTRAINT FK_ClbfFirma
 FOREIGN KEY
   (
                          CLBF_FrsId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DABDBGId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DABDBGId */</I><BR>
ALTER TABLE CDN.DaneBinarne ADD CONSTRAINT FK_DABDBGId
 FOREIGN KEY
   (
                          DAB_DBGId                         
                         )
             REFERENCES CDN.DaneBinarneGrupy
                         (
                          DBG_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DaneBinarne_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DaneBinarne_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DaneBinarne_DeleteHandler
  ON CDN.DaneBinarne
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Zgody
    IF EXISTS
       ( SELECT * FROM CDN.Zgody JOIN deleted
          ON
                deleted.DAB_ID = CDN.Zgody.Zgo_Regulamin
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć załącznika ustawionego jako regulamin, na który została udzielona zgoda./# [DaneBinarne_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.DAB_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14400 AND NOT EXISTS(SELECT * FROM CDN.DaneBinarne WHERE DAB_Id = CDN.DaneObiekty.DAO_DABId))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.DAB_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14400 AND NOT EXISTS(SELECT * FROM CDN.DaneBinarne WHERE DAB_Id = CDN.DaneObiekty.DAO_DABId))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.DAB_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14400 AND NOT EXISTS (SELECT * FROM CDN.DaneBinarne WHERE DAB_ID = CDN.Atrybuty.Atr_ObiNumer))
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.DAB_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14400 AND NOT EXISTS (SELECT * FROM CDN.DaneBinarne WHERE DAB_ID = CDN.Atrybuty.Atr_ObiNumer))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.DAB_ID = CDN.DaneObiekty.DAO_DABId
      AND (NOT EXISTS (SELECT * FROM CDN.DaneBinarne WHERE DAB_ID = CDN.DaneObiekty.DaO_DABID))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.DAB_ID = CDN.DaneObiekty.DAO_DABId
      AND (NOT EXISTS (SELECT * FROM CDN.DaneBinarne WHERE DAB_ID = CDN.DaneObiekty.DaO_DABID))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DaneBinarne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DaneBinarne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DaneBinarne_InsertUpdateHandler
  ON CDN.DaneBinarne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DAB_OpeNumerD ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.DAB_OpeNumerD = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.DAB_OpeNumerD,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [DaneBinarne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAB_Jezyk ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.DAB_Jezyk = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.DAB_Jezyk,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [DaneBinarne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAB_TypId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.DAB_TypId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.DAB_TypId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND ( inserted.DAB_TypId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [DaneBinarne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DaneBinarneGrupy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DaneBinarneGrupy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DaneBinarneGrupy_InsertUpdateHandler
  ON CDN.DaneBinarneGrupy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DBG_Ojciec ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DBG_Ojciec &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DaneBinarneGrupy ON
                    inserted.DBG_Ojciec = CDN.DaneBinarneGrupy.DBG_Id
              WHERE CDN.DaneBinarneGrupy.DBG_Id IS NULL AND (inserted.DBG_Ojciec &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DaneBinarneGrupy) [DaneBinarneGrupy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DaneBinarneGrupyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DaneBinarneGrupyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DaneBinarneGrupyAlias_DeleteHandler
  ON CDN.DaneBinarneGrupy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.DaneBinarneGrupy
    IF EXISTS
       ( SELECT * FROM CDN.DaneBinarneGrupy JOIN deleted
          ON
                deleted.DBG_Id = CDN.DaneBinarneGrupy.DBG_Ojciec
       AND (CDN.DaneBinarneGrupy.DBG_Ojciec &gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą DaneBinarneGrupy) [DaneBinarneGrupyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DaneObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DaneObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DaneObiekty_InsertUpdateHandler
  ON CDN.DaneObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14362 AND inserted.DAO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanyObciazeniaGniazd ON
                    inserted.DAO_ObiNumer = CDN.PlanyObciazeniaGniazd.POG_Id
              WHERE CDN.PlanyObciazeniaGniazd.POG_Id IS NULL AND (inserted.DAO_ObiTyp=14362 AND inserted.DAO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanyObciazeniaGniazd) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14360)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPlany ON
                    inserted.DAO_ObiNumer = CDN.ProdPlany.PPL_Id
              WHERE CDN.ProdPlany.PPL_Id IS NULL AND (inserted.DAO_ObiTyp=14360)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPlany) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 4710)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwPlanPrzegladu ON
                    inserted.DAO_ObiNumer = CDN.SrwPlanPrzegladu.SPP_Id
              WHERE CDN.SrwPlanPrzegladu.SPP_Id IS NULL AND (inserted.DAO_ObiTyp = 4710)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwPlanPrzegladu) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (4800,4801,4802) AND inserted.DAO_ObiLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwElem ON
                    inserted.DAO_ObiNumer = CDN.UmwElem.UmE_GIDNumer
                AND inserted.DAO_ObiTyp = CDN.UmwElem.UmE_GIDTyp
                AND inserted.DAO_ObiLp = CDN.UmwElem.UmE_GIDLp
              WHERE CDN.UmwElem.UmE_GIDLp IS NULL AND (inserted.DAO_ObiTyp in (4800,4801,4802) AND inserted.DAO_ObiLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwElem) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (435))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RozniceKursowe ON
                    inserted.DAO_ObiNumer = CDN.RozniceKursowe.RKN_ID
              WHERE CDN.RozniceKursowe.RKN_ID IS NULL AND (inserted.DAO_ObiTyp in  (435))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RozniceKursowe) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (2784))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZestKSNag ON
                    inserted.DAO_ObiNumer = CDN.ZestKSNag.ZKN_GIDNumer
              WHERE CDN.ZestKSNag.ZKN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (2784))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZestKSNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (4144,4145,4146) and inserted.DAO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.DAO_ObiNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (4144,4145,4146) and inserted.DAO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (434))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KompNag ON
                    inserted.DAO_ObiNumer = CDN.KompNag.KMN_ID
              WHERE CDN.KompNag.KMN_ID IS NULL AND (inserted.DAO_ObiTyp in  (434))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KompNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (4144,4145,4146) and inserted.DAO_ObiLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemElem ON
                    inserted.DAO_ObiNumer = CDN.MemElem.MEE_GIDNumer
                AND inserted.DAO_ObiLp = CDN.MemElem.MEE_GIDLp
              WHERE CDN.MemElem.MEE_GIDLp IS NULL AND (inserted.DAO_ObiTyp in  (4144,4145,4146) and inserted.DAO_ObiLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemElem) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (432) and inserted.DAO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Dziennik ON
                    inserted.DAO_ObiNumer = CDN.Dziennik.DZK_GIDNumer
              WHERE CDN.Dziennik.DZK_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (432) and inserted.DAO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Dziennik) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (432) and inserted.DAO_ObiLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DziennikElem ON
                    inserted.DAO_ObiNumer = CDN.DziennikElem.DEL_GIDNumer
                AND inserted.DAO_ObiLp = CDN.DziennikElem.DEL_GIDLp
              WHERE CDN.DziennikElem.DEL_GIDLp IS NULL AND (inserted.DAO_ObiTyp in  (432) and inserted.DAO_ObiLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DziennikElem) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 784)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zapisy ON
                    inserted.DAO_ObiNumer = CDN.Zapisy.KAZ_GIDNumer
              WHERE CDN.Zapisy.KAZ_GIDNumer IS NULL AND (inserted.DAO_ObiTyp = 784)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zapisy) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (7680,7681,7682,7683) and inserted.DAO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaNag ON
                    inserted.DAO_ObiTyp = CDN.BilansOtwarciaNag.BON_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.BilansOtwarciaNag.BON_GIDNumer
              WHERE CDN.BilansOtwarciaNag.BON_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (7680,7681,7682,7683) and inserted.DAO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (448))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konta ON
                    inserted.DAO_ObiTyp = CDN.Konta.KKS_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.Konta.KKS_GIDNumer
              WHERE CDN.Konta.KKS_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (448))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konta) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiLp )  OR UPDATE( DAO_ObiSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (7680,7681,7682,7683) and inserted.DAO_ObiLp&lt;&gt;0 and inserted.DAO_ObiSubLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaSElem ON
                    inserted.DAO_ObiTyp = CDN.BilansOtwarciaSElem.BOS_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.BilansOtwarciaSElem.BOS_GIDNumer
                AND inserted.DAO_ObiLp = CDN.BilansOtwarciaSElem.BOS_GIDLp
                AND inserted.DAO_ObiSubLp = CDN.BilansOtwarciaSElem.BOS_SubGIDLp
              WHERE CDN.BilansOtwarciaSElem.BOS_SubGIDLp IS NULL AND (inserted.DAO_ObiTyp in  (7680,7681,7682,7683) and inserted.DAO_ObiLp&lt;&gt;0 and inserted.DAO_ObiSubLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaSElem) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (7680,7681,7682,7683) and inserted.DAO_ObiLp&lt;&gt;0 and inserted.DAO_ObiSubLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaElem ON
                    inserted.DAO_ObiTyp = CDN.BilansOtwarciaElem.BOE_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.BilansOtwarciaElem.BOE_GIDNumer
                AND inserted.DAO_ObiLp = CDN.BilansOtwarciaElem.BOE_GIDLp
              WHERE CDN.BilansOtwarciaElem.BOE_GIDLp IS NULL AND (inserted.DAO_ObiTyp in  (7680,7681,7682,7683) and inserted.DAO_ObiLp&lt;&gt;0 and inserted.DAO_ObiSubLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaElem) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (2600))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmlNag ON
                    inserted.DAO_ObiNumer = CDN.UmlNag.ULN_ID
              WHERE CDN.UmlNag.ULN_ID IS NULL AND (inserted.DAO_ObiTyp in (2600))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmlNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (2832,2833))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UpoNag ON
                    inserted.DAO_ObiNumer = CDN.UpoNag.UPN_GIDNumer
              WHERE CDN.UpoNag.UPN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in (2832,2833))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UpoNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (2304, 2064, 2162, 6208, 2096, 2224, 2432, 2496, 2048, 2176, 2080, 2128, 2532, 2112, 2552, 2160, 2548, 2144, 2556, 2288, 2192))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtHistNag ON
                    inserted.DAO_ObiTyp = CDN.SrtHistNag.SHN_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.SrtHistNag.SHN_GIDNumer
              WHERE CDN.SrtHistNag.SHN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (2304, 2064, 2162, 6208, 2096, 2224, 2432, 2496, 2048, 2176, 2080, 2128, 2532, 2112, 2552, 2160, 2548, 2144, 2556, 2288, 2192))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtHistNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (2768, 7712, 7696, 7686, 7692, 7689, 7693, 7691))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PodNag ON
                    inserted.DAO_ObiTyp = CDN.PodNag.PON_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.PodNag.PON_GIDNumer
              WHERE CDN.PodNag.PON_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (2768, 7712, 7696, 7686, 7692, 7689, 7693, 7691))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PodNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (14451,14452,14453) AND inserted.DAO_ObiLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SekDokumenty ON
                    inserted.DAO_ObiNumer = CDN.SekDokumenty.SDD_Id
              WHERE CDN.SekDokumenty.SDD_Id IS NULL AND (inserted.DAO_ObiTyp in  (14451,14452,14453) AND inserted.DAO_ObiLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SekDokumenty) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiLp )  OR UPDATE( DAO_ObiTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE (inserted.DAO_ObiTyp in (4180,4181) AND inserted.DAO_ObiLp&gt;0) OR (inserted.DAO_ObiTyp=4182 AND inserted.DAO_ObiLp=0))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyElem ON
                    inserted.DAO_ObiNumer = CDN.CRMWizytyElem.CWE_GidNumer
                AND inserted.DAO_ObiLp = CDN.CRMWizytyElem.CWE_GidLp
                AND inserted.DAO_ObiTyp = CDN.CRMWizytyElem.CWE_GidTyp
              WHERE CDN.CRMWizytyElem.CWE_GidTyp IS NULL AND ((inserted.DAO_ObiTyp in (4180,4181) AND inserted.DAO_ObiLp&gt;0) OR (inserted.DAO_ObiTyp=4182 AND inserted.DAO_ObiLp=0))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyElem) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 4181 AND inserted.DAO_ObiLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWzorceWizyt ON
                    inserted.DAO_ObiNumer = CDN.CRMWzorceWizyt.CWW_Id
              WHERE CDN.CRMWzorceWizyt.CWW_Id IS NULL AND (inserted.DAO_ObiTyp = 4181 AND inserted.DAO_ObiLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWzorceWizyt) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 4180 AND inserted.DAO_ObiLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyNag ON
                    inserted.DAO_ObiNumer = CDN.CRMWizytyNag.CWN_ID
              WHERE CDN.CRMWizytyNag.CWN_ID IS NULL AND (inserted.DAO_ObiTyp = 4180 AND inserted.DAO_ObiLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (3584,3585))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklNag ON
                    inserted.DAO_ObiNumer = CDN.ReklNag.RLN_Id
              WHERE CDN.ReklNag.RLN_Id IS NULL AND (inserted.DAO_ObiTyp in (3584,3585))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 4701)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.DAO_ObiNumer = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL AND (inserted.DAO_ObiTyp = 4701)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 4700)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.DAO_ObiNumer = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL AND (inserted.DAO_ObiTyp = 4700)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 340)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WysPaczki ON
                    inserted.DAO_ObiNumer = CDN.WysPaczki.WyP_IdPaczki
              WHERE CDN.WysPaczki.WyP_IdPaczki IS NULL AND (inserted.DAO_ObiTyp = 340)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WysPaczki) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wysylki ON
                    inserted.DAO_ObiNumer = CDN.Wysylki.WYS_GIDNumer
              WHERE CDN.Wysylki.WYS_GIDNumer IS NULL AND (inserted.DAO_ObiTyp = 337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wysylki) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 32 AND inserted.DAO_ObiLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.DAO_ObiNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.DAO_ObiLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.DAO_ObiTyp = 32 AND inserted.DAO_ObiLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=339 AND inserted.DAO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsNag ON
                    inserted.DAO_ObiNumer = CDN.SrsNag.SsN_GIDNumer
              WHERE CDN.SrsNag.SsN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp=339 AND inserted.DAO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 4179)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMEtapyDef ON
                    inserted.DAO_ObiNumer = CDN.CRMEtapyDef.CED_ID
              WHERE CDN.CRMEtapyDef.CED_ID IS NULL AND (inserted.DAO_ObiTyp = 4179)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMEtapyDef) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (4176,4177) AND inserted.DAO_ObiLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampEtapy ON
                    inserted.DAO_ObiNumer = CDN.CRMKampEtapy.CKE_GIDNumer
                AND inserted.DAO_ObiLp = CDN.CRMKampEtapy.CKE_GIDLp
              WHERE CDN.CRMKampEtapy.CKE_GIDLp IS NULL AND (inserted.DAO_ObiTyp in (4176,4177) AND inserted.DAO_ObiLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampEtapy) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 4178)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMDefZadania ON
                    inserted.DAO_ObiNumer = CDN.CRMDefZadania.CDZ_Id
              WHERE CDN.CRMDefZadania.CDZ_Id IS NULL AND (inserted.DAO_ObiTyp = 4178)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMDefZadania) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (4176,4177) AND inserted.DAO_ObiLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKampNag ON
                    inserted.DAO_ObiNumer = CDN.CRMKampNag.CKN_GIDNumer
              WHERE CDN.CRMKampNag.CKN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in (4176,4177) AND inserted.DAO_ObiLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKampNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=341)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMKntEtapy ON
                    inserted.DAO_ObiNumer = CDN.CRMKntEtapy.CEK_ID
              WHERE CDN.CRMKntEtapy.CEK_ID IS NULL AND (inserted.DAO_ObiTyp=341)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMKntEtapy) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer )  OR UPDATE( DAO_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=339 AND inserted.DAO_ObiLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsElem ON
                    inserted.DAO_ObiNumer = CDN.SrsElem.SsE_GIDNumer
                AND inserted.DAO_ObiLp = CDN.SrsElem.SsE_GIDLp
              WHERE CDN.SrsElem.SsE_GIDLp IS NULL AND (inserted.DAO_ObiTyp=339 AND inserted.DAO_ObiLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsElem) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.DAO_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.DAO_ObiTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.DAO_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.DAO_ObiTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.DAO_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.DAO_ObiTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.DAO_ObiNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.DAO_ObiTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=368)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.DAO_ObiNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL AND (inserted.DAO_ObiTyp=368)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=12289)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_Procesy ON
                    inserted.DAO_ObiNumer = CDN.WF_Procesy.WFP_ID
              WHERE CDN.WF_Procesy.WFP_ID IS NULL AND (inserted.DAO_ObiTyp=12289)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_Procesy) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14340)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.DAO_ObiNumer = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL AND (inserted.DAO_ObiTyp=14340)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14341)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaCzynnosci ON
                    inserted.DAO_ObiNumer = CDN.ProdTechnologiaCzynnosci.PTC_Id
              WHERE CDN.ProdTechnologiaCzynnosci.PTC_Id IS NULL AND (inserted.DAO_ObiTyp=14341)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaCzynnosci) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.DAO_ObiNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.DAO_ObiTyp=14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14344)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdProcesy ON
                    inserted.DAO_ObiNumer = CDN.ProdProcesy.PPC_Id
              WHERE CDN.ProdProcesy.PPC_Id IS NULL AND (inserted.DAO_ObiTyp=14344)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdProcesy) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14345)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.DAO_ObiNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.DAO_ObiTyp=14345)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (1520,1489,2034,1497,2042,1528,1828,2033,2041,  2005,2036,2044,2002,2010,1832,2035,2003,1616,2000,2008,1824,2037,1625,2001,2009, 1617,1836,2039,1490,2047,1600,1603,1604,1529,1521,1232))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.DAO_ObiTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (1520,1489,2034,1497,2042,1528,1828,2033,2041,  2005,2036,2044,2002,2010,1832,2035,2003,1616,2000,2008,1824,2037,1625,2001,2009, 1617,1836,2039,1490,2047,1600,1603,1604,1529,1521,1232))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (1089,1601,1602))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.DAO_ObiNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in (1089,1601,1602))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (3344,3352))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.DAO_ObiNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in (3344,3352))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (3376,3378,3379))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.DAO_ObiTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in (3376,3378,3379))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in  (960,8832,8960,9344,9472,10880,11008,9473))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.DAO_ObiNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in  (960,8832,8960,9344,9472,10880,11008,9473))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (4345,4346))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcRemNag ON
                    inserted.DAO_ObiTyp = CDN.ZlcRemNag.ZRN_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.ZlcRemNag.ZRN_GIDNumer
              WHERE CDN.ZlcRemNag.ZRN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in (4345,4346))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcRemNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiTyp )  OR UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp in (4192,4208))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcNag ON
                    inserted.DAO_ObiTyp = CDN.ZlcNag.ZcN_GIDTyp
                AND inserted.DAO_ObiNumer = CDN.ZlcNag.ZcN_GIDNumer
              WHERE CDN.ZlcNag.ZcN_GIDNumer IS NULL AND (inserted.DAO_ObiTyp in (4192,4208))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_DABId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE NOT EXISTS (SELECT * FROM CDN.DaneBinarne WHERE DAB_ID = inserted.DaO_DABID))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DaneBinarne ON
                    inserted.DAO_DABId = CDN.DaneBinarne.DAB_ID
              WHERE CDN.DaneBinarne.DAB_ID IS NULL AND (NOT EXISTS (SELECT * FROM CDN.DaneBinarne WHERE DAB_ID = inserted.DaO_DABID))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DaneBinarne) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 4803)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwPozycje ON
                    inserted.DAO_ObiNumer = CDN.UmwPozycje.UmP_Id
              WHERE CDN.UmwPozycje.UmP_Id IS NULL AND (inserted.DAO_ObiTyp = 4803)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwPozycje) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14357)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZleceniaZabiegi ON
                    inserted.DAO_ObiNumer = CDN.ProdZleceniaZabiegi.PZZ_Id
              WHERE CDN.ProdZleceniaZabiegi.PZZ_Id IS NULL AND (inserted.DAO_ObiTyp=14357)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZleceniaZabiegi) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14356)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZabiegiOperacji ON
                    inserted.DAO_ObiNumer = CDN.ProdZabiegiOperacji.PZO_Id
              WHERE CDN.ProdZabiegiOperacji.PZO_Id IS NULL AND (inserted.DAO_ObiTyp=14356)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZabiegiOperacji) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.DAO_ObiNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.DAO_ObiTyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=6562 AND inserted.DAO_ObiNumer&gt;0 AND inserted.DAO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PDOCzynnosci ON
                    inserted.DAO_ObiNumer = CDN.PDOCzynnosci.PDOC_Id
              WHERE CDN.PDOCzynnosci.PDOC_Id IS NULL AND (inserted.DAO_ObiTyp=6562 AND inserted.DAO_ObiNumer&gt;0 AND inserted.DAO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PDOCzynnosci) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=6563 AND inserted.DAO_ObiNumer&gt;0 AND inserted.DAO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PDONaruszenia ON
                    inserted.DAO_ObiNumer = CDN.PDONaruszenia.PDON_Id
              WHERE CDN.PDONaruszenia.PDON_Id IS NULL AND (inserted.DAO_ObiTyp=6563 AND inserted.DAO_ObiNumer&gt;0 AND inserted.DAO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PDONaruszenia) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=6561 AND inserted.DAO_ObiNumer&gt;0 AND inserted.DAO_ObiLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PDOUpowaznienia ON
                    inserted.DAO_ObiNumer = CDN.PDOUpowaznienia.PDOU_Id
              WHERE CDN.PDOUpowaznienia.PDOU_Id IS NULL AND (inserted.DAO_ObiTyp=6561 AND inserted.DAO_ObiNumer&gt;0 AND inserted.DAO_ObiLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PDOUpowaznienia) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp = 6560)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zgody ON
                    inserted.DAO_ObiNumer = CDN.Zgody.Zgo_Id
              WHERE CDN.Zgody.Zgo_Id IS NULL AND (inserted.DAO_ObiTyp = 6560)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zgody) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14348)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdNadzlecenia ON
                    inserted.DAO_ObiNumer = CDN.ProdNadzlecenia.PNZ_Id
              WHERE CDN.ProdNadzlecenia.PNZ_Id IS NULL AND (inserted.DAO_ObiTyp=14348)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdNadzlecenia) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14346)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.DAO_ObiNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.DAO_ObiTyp=14346)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14380)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdParamKJNormyObiektow ON
                    inserted.DAO_ObiNumer = CDN.ProdParamKJNormyObiektow.PPKO_Id
              WHERE CDN.ProdParamKJNormyObiektow.PPKO_Id IS NULL AND (inserted.DAO_ObiTyp=14380)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdParamKJNormyObiektow) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14383)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPKJNag ON
                    inserted.DAO_ObiNumer = CDN.ProdPKJNag.PKJN_Id
              WHERE CDN.ProdPKJNag.PKJN_Id IS NULL AND (inserted.DAO_ObiTyp=14383)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPKJNag) [DaneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DaneObiektyAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DaneObiektyAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DaneObiektyAlias_InsertUpdateHandler
  ON CDN.DaneObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DAO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DAO_ObiTyp=14400 AND NOT EXISTS(SELECT * FROM CDN.DaneBinarne WHERE DAB_Id = inserted.DAO_DABId))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DaneBinarne ON
                    inserted.DAO_ObiNumer = CDN.DaneBinarne.DAB_ID
              WHERE CDN.DaneBinarne.DAB_ID IS NULL AND (inserted.DAO_ObiTyp=14400 AND NOT EXISTS(SELECT * FROM CDN.DaneBinarne WHERE DAB_Id = inserted.DAO_DABId))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DaneBinarne) [DaneObiektyAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DRKSesja"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DRKSesja */</I><BR>
ALTER TABLE CDN.DaneRynkowe ADD CONSTRAINT FK_DRKSesja
 FOREIGN KEY
   (
                          DRK_DRN_ID                        
                         )
             REFERENCES CDN.DaneRynkoweNotowania
                         (
                          DRN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DRCPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DRCPrimary */</I><BR>
ALTER TABLE CDN.DaneRynkoweCeny ADD CONSTRAINT FK_DRCPrimary
 FOREIGN KEY
   (
                          DRC_DRK_ID                        
                         )
             REFERENCES CDN.DaneRynkowe
                         (
                          DRK_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DefNieobecnosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DefNieobecnosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DefNieobecnosci_DeleteHandler
  ON CDN.DefNieobecnosci
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoNieobecnosci
    IF EXISTS
       ( SELECT * FROM CDN.OsoNieobecnosci JOIN deleted
          ON
                deleted.DNB_Id = CDN.OsoNieobecnosci.ONB_Definicja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoNieobecnosci) [DefNieobecnosci_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DefNieobecnosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DefNieobecnosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DefNieobecnosci_InsertUpdateHandler
  ON CDN.DefNieobecnosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DNB_WynagrodzeniePEWId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceElementyWyplat ON
                    inserted.DNB_WynagrodzeniePEWId = CDN.PlaceElementyWyplat.PEW_Id
              WHERE CDN.PlaceElementyWyplat.PEW_Id IS NULL
                AND (
                          IsNull(inserted.DNB_WynagrodzeniePEWId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceElementyWyplat) [DefNieobecnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DNB_LimitNieobecnosci ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.DNB_LimitNieobecnosci = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.DNB_LimitNieobecnosci,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [DefNieobecnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DNB_KodRSA ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.DNB_KodRSA = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.DNB_KodRSA,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [DefNieobecnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DNB_KodRCA ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.DNB_KodRCA = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.DNB_KodRCA,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [DefNieobecnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DPEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DPEPrimary */</I><BR>
ALTER TABLE CDN.DefPodElem ADD CONSTRAINT FK_DPEPrimary
 FOREIGN KEY
   (
                          DPE_DPNID                         
                         )
             REFERENCES CDN.DefPodNag
                         (
                          DPN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DPKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DPKPrimary */</I><BR>
ALTER TABLE CDN.DefPodElemKolumny ADD CONSTRAINT FK_DPKPrimary
 FOREIGN KEY
   (
                          DPK_DPNId                         ,
                          DPK_DPELp                         
                         )
             REFERENCES CDN.DefPodElem
                         (
                          DPE_DPNID                         ,
                          DPE_Lp                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DPEWPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DPEWPrimary */</I><BR>
ALTER TABLE CDN.DefPodElemWyrazenia ADD CONSTRAINT FK_DPEWPrimary
 FOREIGN KEY
   (
                          DPEW_DPNId                         ,
                          DPEW_DPELp                         
                         )
             REFERENCES CDN.DefPodElem
                         (
                          DPE_DPNID                         ,
                          DPE_Lp                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DefPodNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DefPodNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DefPodNag_DeleteHandler
  ON CDN.DefPodNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PodNag
    IF EXISTS
       ( SELECT * FROM CDN.PodNag JOIN deleted
          ON
                deleted.DPN_ID = CDN.PodNag.PON_DPNID
       AND (CDN.PodNag.PON_GIDTyp=7691)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PodNag) [DefPodNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DTPrimary */</I><BR>
ALTER TABLE CDN.Dekrety ADD CONSTRAINT FK_DTPrimary
 FOREIGN KEY
   (
                          DT_GIDNumer                      ,
                          DT_GIDLp                         
                         )
             REFERENCES CDN.DziennikElem
                         (
                          DEL_GIDNumer   ,
                          DEL_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Dekrety_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Dekrety_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Dekrety_InsertUpdateHandler
  ON CDN.Dekrety
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DT_KKSNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konta ON
                    inserted.DT_KKSNumer = CDN.Konta.KKS_GIDNumer
              WHERE CDN.Konta.KKS_GIDNumer IS NULL
                AND (
                          IsNull(inserted.DT_KKSNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konta) [Dekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DFEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DFEPrimary */</I><BR>
ALTER TABLE CDN.DekretyFiltryElem ADD CONSTRAINT FK_DFEPrimary
 FOREIGN KEY
   (
                          DFE_DFNID                         
                         )
             REFERENCES CDN.DekretyFiltryNag
                         (
                          DFN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Delegacje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Delegacje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Delegacje_DeleteHandler
  ON CDN.Delegacje
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.DLG_GIDTyp = CDN.CRMWizytyNag.CWN_DGETyp
            AND deleted.DLG_GIDNumer = CDN.CRMWizytyNag.CWN_DGENumer
       AND (CDN.CRMWizytyNag.CWN_DGETyp=2984 and CDN.CRMWizytyNag.CWN_DGELp=0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [Delegacje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DelegacjeElem
    IF EXISTS(SELECT * FROM CDN.DelegacjeElem JOIN deleted
            ON 
          deleted.DLG_GIDNumer = CDN.DelegacjeElem.DGE_GIDNumer
      AND (CDN.DelegacjeElem.DGE_GidTyp=2984)
            )
        DELETE CDN.DelegacjeElem
        FROM CDN.DelegacjeElem JOIN deleted
        ON 
          deleted.DLG_GIDNumer = CDN.DelegacjeElem.DGE_GIDNumer
      AND (CDN.DelegacjeElem.DGE_GidTyp=2984)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zadania
    IF EXISTS(SELECT * FROM CDN.Zadania JOIN deleted
            ON 
          deleted.DLG_GIDNumer = CDN.Zadania.Zad_ZrdNumer
      AND deleted.DLG_GIDTyp = CDN.Zadania.Zad_ZrdTyp
      AND (CDN.Zadania.ZAD_ZrdTyp=2984)
            )
        DELETE CDN.Zadania
        FROM CDN.Zadania JOIN deleted
        ON 
          deleted.DLG_GIDNumer = CDN.Zadania.Zad_ZrdNumer
      AND deleted.DLG_GIDTyp = CDN.Zadania.Zad_ZrdTyp
      AND (CDN.Zadania.ZAD_ZrdTyp=2984)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DelegacjeTransport
    IF EXISTS(SELECT * FROM CDN.DelegacjeTransport JOIN deleted
            ON 
          deleted.DLG_GIDNumer = CDN.DelegacjeTransport.DGT_DLGNumer
            )
        DELETE CDN.DelegacjeTransport
        FROM CDN.DelegacjeTransport JOIN deleted
        ON 
          deleted.DLG_GIDNumer = CDN.DelegacjeTransport.DGT_DLGNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.DLG_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp=2984)
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.DLG_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp=2984)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Delegacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Delegacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Delegacje_InsertUpdateHandler
  ON CDN.Delegacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DLG_PRCNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.DLG_PRCNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.DLG_PRCNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Delegacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DelegacjeElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DelegacjeElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DelegacjeElem_DeleteHandler
  ON CDN.DelegacjeElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.DGE_GIDNumer = CDN.WydatkiPracownikow.WPR_DGENumer
            AND deleted.DGE_GIDLp = CDN.WydatkiPracownikow.WPR_DGELp
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WydatkiPracownikow) [DelegacjeElem_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.DGE_GIDTyp = CDN.CRMWizytyNag.CWN_DGETyp
            AND deleted.DGE_GIDNumer = CDN.CRMWizytyNag.CWN_DGENumer
            AND deleted.DGE_GIDLp = CDN.CRMWizytyNag.CWN_DGELp
       AND (CDN.CRMWizytyNag.CWN_DGETyp=2984 and CDN.CRMWizytyNag.CWN_DGELp&lt;&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [DelegacjeElem_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SamPrzejazdy
    IF EXISTS
       ( SELECT * FROM CDN.SamPrzejazdy JOIN deleted
          ON
                deleted.DGE_GIDNumer = CDN.SamPrzejazdy.SaP_DGENumer
            AND deleted.DGE_GIDLp = CDN.SamPrzejazdy.SaP_DGELp
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SamPrzejazdy) [DelegacjeElem_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DelegacjeElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DelegacjeElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DelegacjeElem_InsertUpdateHandler
  ON CDN.DelegacjeElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DGE_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DGE_GidTyp=2984)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Delegacje ON
                    inserted.DGE_GIDNumer = CDN.Delegacje.DLG_GIDNumer
              WHERE CDN.Delegacje.DLG_GIDNumer IS NULL AND (inserted.DGE_GidTyp=2984)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Delegacje) [DelegacjeElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DLRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DLRPrimary */</I><BR>
ALTER TABLE CDN.DelegacjeRozlZapisy ADD CONSTRAINT FK_DLRPrimary
 FOREIGN KEY
   (
                          DLR_DLGNumer                      
                         )
             REFERENCES CDN.Delegacje
                         (
                          DLG_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DLRKAZNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DLRKAZNumer */</I><BR>
ALTER TABLE CDN.DelegacjeRozlZapisy ADD CONSTRAINT FK_DLRKAZNumer
 FOREIGN KEY
   (
                          DLR_KAZNumer                      
                         )
             REFERENCES CDN.Zapisy
                         (
                          KAZ_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DelegacjeTransport_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DelegacjeTransport_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DelegacjeTransport_InsertUpdateHandler
  ON CDN.DelegacjeTransport
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DGT_DLGNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Delegacje ON
                    inserted.DGT_DLGNumer = CDN.Delegacje.DLG_GIDNumer
              WHERE CDN.Delegacje.DLG_GIDNumer IS NULL
                AND (
                          IsNull(inserted.DGT_DLGNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Delegacje) [DelegacjeTransport_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DGT_SamID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Samochody ON
                    inserted.DGT_SamID = CDN.Samochody.SaM_Id
              WHERE CDN.Samochody.SaM_Id IS NULL
                AND (
                          IsNull(inserted.DGT_SamID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Samochody) [DelegacjeTransport_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DGT_SrodekTransID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.DGT_SrodekTransID = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.DGT_SrodekTransID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [DelegacjeTransport_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DOKDokument"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DOKDokument */</I><BR>
ALTER TABLE CDN.DokDefinicje ADD CONSTRAINT FK_DOKDokument
 FOREIGN KEY
   (
                          Dok_FrsId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DokDefinicje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DokDefinicje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DokDefinicje_DeleteHandler
  ON CDN.DokDefinicje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.Dok_FrsId = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.Dok_GIDTyp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=4320 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.Dok_FrsId = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.Dok_GIDTyp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=4320 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.Dok_FrsId = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.Dok_GIDTyp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4320 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.Dok_FrsId = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.Dok_GIDTyp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4320 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokMagazyny
    IF EXISTS(SELECT * FROM CDN.DokMagazyny JOIN deleted
            ON 
          deleted.Dok_Id = CDN.DokMagazyny.DOKM_DokId
            )
        DELETE CDN.DokMagazyny
        FROM CDN.DokMagazyny JOIN deleted
        ON 
          deleted.Dok_Id = CDN.DokMagazyny.DOKM_DokId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DOKM_Magazyn"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DOKM_Magazyn */</I><BR>
ALTER TABLE CDN.DokMagazyny ADD CONSTRAINT FK_DOKM_Magazyn
 FOREIGN KEY
   (
                          DOKM_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DokMagazyny_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DokMagazyny_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DokMagazyny_InsertUpdateHandler
  ON CDN.DokMagazyny
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DOKM_DokId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DokDefinicje ON
                    inserted.DOKM_DokId = CDN.DokDefinicje.Dok_Id
              WHERE CDN.DokDefinicje.Dok_Id IS NULL
                AND (
                          IsNull(inserted.DOKM_DokId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DokDefinicje) [DokMagazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DoRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DoRPrimary */</I><BR>
ALTER TABLE CDN.DokRelacje ADD CONSTRAINT FK_DoRPrimary
 FOREIGN KEY
   (
                          DoR_ID                            
                         )
             REFERENCES CDN.DokDefinicje
                         (
                          Dok_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DokRelacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DokRelacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DokRelacje_InsertUpdateHandler
  ON CDN.DokRelacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DoR_MSNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoR_MSTyp=272)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Serie ON
                    inserted.DoR_MSNumer = CDN.Serie.SER_GIDNumer
              WHERE CDN.Serie.SER_GIDNumer IS NULL AND (inserted.DoR_MSTyp=272)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Serie) [DokRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoR_MSNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoR_MSTyp=208)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.DoR_MSNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.DoR_MSTyp=208)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [DokRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DowPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DowPrimary */</I><BR>
ALTER TABLE CDN.DokWymiary ADD CONSTRAINT FK_DowPrimary
 FOREIGN KEY
   (
                          DoW_ID                            
                         )
             REFERENCES CDN.DokDefinicje
                         (
                          Dok_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DowWymiar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DowWymiar */</I><BR>
ALTER TABLE CDN.DokWymiary ADD CONSTRAINT FK_DowWymiar
 FOREIGN KEY
   (
                          DoW_WymID                         
                         )
             REFERENCES CDN.Wymiary
                         (
                          WMR_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DokZwiazane_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DokZwiazane_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DokZwiazane_InsertUpdateHandler
  ON CDN.DokZwiazane
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DoZ_DOKNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DOZ_DOKTyp=14455)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ObiegNrDok ON
                    inserted.DoZ_DOKNumer = CDN.ObiegNrDok.OND_DokID
              WHERE CDN.ObiegNrDok.OND_DokID IS NULL AND (inserted.DOZ_DOKTyp=14455)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ObiegNrDok) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_ZRDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_ZrdTyp=14361)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPlanyProdukty ON
                    inserted.DoZ_ZRDNumer = CDN.ProdPlanyProdukty.PPP_Id
              WHERE CDN.ProdPlanyProdukty.PPP_Id IS NULL AND (inserted.DoZ_ZrdTyp=14361)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPlanyProdukty) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_DOKNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DOZ_DOKTyp=337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wysylki ON
                    inserted.DoZ_DOKNumer = CDN.Wysylki.WYS_GIDNumer
              WHERE CDN.Wysylki.WYS_GIDNumer IS NULL AND (inserted.DOZ_DOKTyp=337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wysylki) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_DOKNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DOZ_DOKTyp=340)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WysPaczki ON
                    inserted.DoZ_DOKNumer = CDN.WysPaczki.WyP_IdPaczki
              WHERE CDN.WysPaczki.WyP_IdPaczki IS NULL AND (inserted.DOZ_DOKTyp=340)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WysPaczki) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_DOKNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_DokTyp=3344 AND inserted.DoZ_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.DoZ_DOKNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.DoZ_DokTyp=3344 AND inserted.DoZ_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_ZRDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_ZRDTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968)  AND inserted.DoZ_ZrdLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.DoZ_ZRDNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.DoZ_ZRDTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968)  AND inserted.DoZ_ZrdLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_ZRDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.DoZ_ZRDTyp in (14451,14452,14453))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SekDokumenty ON
                    inserted.DoZ_ZRDNumer = CDN.SekDokumenty.SDD_Id
              WHERE CDN.SekDokumenty.SDD_Id IS NULL AND (  inserted.DoZ_ZRDTyp in (14451,14452,14453))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SekDokumenty) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_ZRDTyp )  OR UPDATE( DoZ_ZRDNumer )  OR UPDATE( DoZ_ZRDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_ZRDTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND inserted.DoZ_ZrdLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.DoZ_ZRDTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.DoZ_ZRDNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.DoZ_ZRDLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.DoZ_ZRDTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND inserted.DoZ_ZrdLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_DOKNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_DokTyp=960 AND inserted.DoZ_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.DoZ_DOKNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.DoZ_DokTyp=960 AND inserted.DoZ_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_ZRDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_ZrdTyp=14347)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanElem ON
                    inserted.DoZ_ZRDNumer = CDN.PlanElem.Ple_Id
              WHERE CDN.PlanElem.Ple_Id IS NULL AND (inserted.DoZ_ZrdTyp=14347)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanElem) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_DOKNumer )  OR UPDATE( DoZ_DOKLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_DokTyp=960 AND inserted.DoZ_DokLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.DoZ_DOKNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.DoZ_DOKLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.DoZ_DokTyp=960 AND inserted.DoZ_DokLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_DOKNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_DokTyp=14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecElem ON
                    inserted.DoZ_DOKNumer = CDN.ProdZlecElem.PZE_Id
              WHERE CDN.ProdZlecElem.PZE_Id IS NULL AND (inserted.DoZ_DokTyp=14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecElem) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_DOKNumer )  OR UPDATE( DoZ_DOKLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_DokTyp=4192)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcElem ON
                    inserted.DoZ_DOKNumer = CDN.ZlcElem.ZcE_GIDNumer
                AND inserted.DoZ_DOKLp = CDN.ZlcElem.ZcE_GIDLp
              WHERE CDN.ZlcElem.ZcE_GIDLp IS NULL AND (inserted.DoZ_DokTyp=4192)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcElem) [DokZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DokZwiazaneAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DokZwiazaneAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DokZwiazaneAlias_InsertUpdateHandler
  ON CDN.DokZwiazane
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DoZ_DOKNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.DoZ_DokTyp in (14451,14452,14453))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SekDokumenty ON
                    inserted.DoZ_DOKNumer = CDN.SekDokumenty.SDD_Id
              WHERE CDN.SekDokumenty.SDD_Id IS NULL AND (  inserted.DoZ_DokTyp in (14451,14452,14453))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SekDokumenty) [DokZwiazaneAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_DOKNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_DOKTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968)  AND inserted.DoZ_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.DoZ_DOKNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.DoZ_DOKTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968)  AND inserted.DoZ_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [DokZwiazaneAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_ZRDNumer )  OR UPDATE( DoZ_ZRDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_ZrdTyp=960 AND inserted.DoZ_ZrdLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.DoZ_ZRDNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.DoZ_ZRDLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.DoZ_ZrdTyp=960 AND inserted.DoZ_ZrdLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [DokZwiazaneAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( DoZ_ZRDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.DoZ_ZrdTyp=960 AND inserted.DoZ_ZrdLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.DoZ_ZRDNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.DoZ_ZrdTyp=960 AND inserted.DoZ_ZrdLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [DokZwiazaneAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Dostawy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Dostawy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Dostawy_DeleteHandler
  ON CDN.Dostawy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraSElem
    IF EXISTS
       ( SELECT * FROM CDN.TraSElem JOIN deleted
          ON
                deleted.Dst_GIDNumer = CDN.TraSElem.TrS_DsFNumer
       AND (CDN.TraSElem.TrS_DsFTyp=160)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraSElem) [Dostawy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.Dst_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=160)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.Dst_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=160)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.Dst_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=160)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.Dst_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=160)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Dostawy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Dostawy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Dostawy_InsertUpdateHandler
  ON CDN.Dostawy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Dst_TpAId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrPartie ON
                    inserted.Dst_TpAId = CDN.TwrPartie.TpA_Id
              WHERE CDN.TwrPartie.TpA_Id IS NULL
                AND (
                          IsNull(inserted.Dst_TpAId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrPartie) [Dostawy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Dst_CCKNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CechyKlasy ON
                    inserted.Dst_CCKNumer = CDN.CechyKlasy.CCK_GIDNumer
              WHERE CDN.CechyKlasy.CCK_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Dst_CCKNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CechyKlasy) [Dostawy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DsOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DsOPrimary */</I><BR>
ALTER TABLE CDN.DstOpisy ADD CONSTRAINT FK_DsOPrimary
 FOREIGN KEY
   (
                          DsO_DstNumer                      
                         )
             REFERENCES CDN.Dostawy
                         (
                          Dst_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DPRPromocje"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DPRPromocje */</I><BR>
ALTER TABLE CDN.DstPromocje ADD CONSTRAINT FK_DPRPromocje
 FOREIGN KEY
   (
                          DPR_TPRID                         
                         )
             REFERENCES CDN.TwrPromocje
                         (
                          TPR_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DPRDostawy"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DPRDostawy */</I><BR>
ALTER TABLE CDN.DstPromocje ADD CONSTRAINT FK_DPRDostawy
 FOREIGN KEY
   (
                          DPR_DstNumer                      
                         )
             REFERENCES CDN.Dostawy
                         (
                          Dst_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DDENaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DDENaglowek */</I><BR>
ALTER TABLE CDN.DtsDeklaracjeElem ADD CONSTRAINT FK_DDENaglowek
 FOREIGN KEY
   (
                          DDE_DdNId                         
                         )
             REFERENCES CDN.DtsDeklaracjeNag
                         (
                          DDN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DtsWsady_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DtsWsady_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DtsWsady_InsertUpdateHandler
  ON CDN.DtsWsady
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DWS_DZEID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DtsZestawy ON
                    inserted.DWS_DZEID = CDN.DtsZestawy.DZE_ID
              WHERE CDN.DtsZestawy.DZE_ID IS NULL
                AND (
                          IsNull(inserted.DWS_DZEID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DtsZestawy) [DtsWsady_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DWKNaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DWKNaglowek */</I><BR>
ALTER TABLE CDN.DtsWyplatyKwoty ADD CONSTRAINT FK_DWKNaglowek
 FOREIGN KEY
   (
                          DWK_DwpID                         
                         )
             REFERENCES CDN.DtsWyplaty
                         (
                          DWp_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DWONaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DWONaglowek */</I><BR>
ALTER TABLE CDN.DtsWyplatyOpis ADD CONSTRAINT FK_DWONaglowek
 FOREIGN KEY
   (
                          DWO_DwpId                         
                         )
             REFERENCES CDN.DtsWyplaty
                         (
                          DWp_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DtsZestawy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DtsZestawy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DtsZestawy_DeleteHandler
  ON CDN.DtsZestawy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DtsWsady
    IF EXISTS(SELECT * FROM CDN.DtsWsady JOIN deleted
            ON 
          deleted.DZE_ID = CDN.DtsWsady.DWS_DZEID
            )
        DELETE CDN.DtsWsady
        FROM CDN.DtsWsady JOIN deleted
        ON 
          deleted.DZE_ID = CDN.DtsWsady.DWS_DZEID
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DtsZmienne
    IF EXISTS(SELECT * FROM CDN.DtsZmienne JOIN deleted
            ON 
          deleted.DZE_ID = CDN.DtsZmienne.DZM_DZEID
            )
        DELETE CDN.DtsZmienne
        FROM CDN.DtsZmienne JOIN deleted
        ON 
          deleted.DZE_ID = CDN.DtsZmienne.DZM_DZEID
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DtsZestawy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DtsZestawy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DtsZestawy_InsertUpdateHandler
  ON CDN.DtsZestawy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DZE_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.DZE_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.DZE_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [DtsZestawy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DtsZmienne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DtsZmienne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.DtsZmienne_InsertUpdateHandler
  ON CDN.DtsZmienne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( DZM_DZEID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DtsZestawy ON
                    inserted.DZM_DZEID = CDN.DtsZestawy.DZE_ID
              WHERE CDN.DtsZestawy.DZE_ID IS NULL
                AND (
                          IsNull(inserted.DZM_DZEID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DtsZestawy) [DtsZmienne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Dziennik_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Dziennik_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Dziennik_DeleteHandler
  ON CDN.Dziennik
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.DZK_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (432) and CDN.DaneObiekty.DAO_ObiLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.DZK_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (432) and CDN.DaneObiekty.DAO_ObiLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.DZK_GIDNumer = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=432)
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.DZK_GIDNumer = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=432)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.DZK_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=432 AND CDN.Atrybuty.Atr_ObiLp=0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.DZK_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=432 AND CDN.Atrybuty.Atr_ObiLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.DZK_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=432 AND CDN.AtrybutyHist.Ath_ObiLp=0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.DZK_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=432 AND CDN.AtrybutyHist.Ath_ObiLp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_DELPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_DELPrimary */</I><BR>
ALTER TABLE CDN.DziennikElem ADD CONSTRAINT FK_DELPrimary
 FOREIGN KEY
   (
                          DEL_GIDNumer                      
                         )
             REFERENCES CDN.Dziennik
                         (
                          DZK_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DziennikElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DziennikElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DziennikElem_DeleteHandler
  ON CDN.DziennikElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rozliczenia
    IF EXISTS
       ( SELECT * FROM CDN.Rozliczenia JOIN deleted
          ON
                deleted.DEL_GIDNumer = CDN.Rozliczenia.R2_Dekret1Numer
            AND deleted.DEL_GIDLp = CDN.Rozliczenia.R2_Dekret1Lp
       AND (CDN.Rozliczenia.R2_Dekret1Numer&lt;&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rozliczenia) [DziennikElem_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.DEL_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.DEL_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (432) and CDN.DaneObiekty.DAO_ObiLp&lt;&gt;0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.DEL_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.DEL_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (432) and CDN.DaneObiekty.DAO_ObiLp&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.DEL_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.DEL_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=432 AND CDN.Atrybuty.Atr_ObiLp&gt;0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.DEL_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.DEL_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=432 AND CDN.Atrybuty.Atr_ObiLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.DEL_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.DEL_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=432 AND CDN.AtrybutyHist.Ath_ObiLp&gt;0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.DEL_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.DEL_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=432 AND CDN.AtrybutyHist.Ath_ObiLp&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="DziennikElemAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* DziennikElemAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.DziennikElemAlias_DeleteHandler
  ON CDN.DziennikElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rozliczenia
    IF EXISTS
       ( SELECT * FROM CDN.Rozliczenia JOIN deleted
          ON
                deleted.DEL_GIDNumer = CDN.Rozliczenia.R2_Dekret2Numer
            AND deleted.DEL_GIDLp = CDN.Rozliczenia.R2_Dekret2Lp
       AND (CDN.Rozliczenia.R2_Dekret2Numer&lt;&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rozliczenia) [DziennikElemAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Firma_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Firma_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Firma_DeleteHandler
  ON CDN.Firma
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntOsobyKomunikatory
    IF EXISTS(SELECT * FROM CDN.KntOsobyKomunikatory JOIN deleted
            ON 
          deleted.Frm_GidNumer = CDN.KntOsobyKomunikatory.KoK_KnSNumer
      AND (CDN.KntOsobyKomunikatory.KOK_KnSTyp=848)
            )
        DELETE CDN.KntOsobyKomunikatory
        FROM CDN.KntOsobyKomunikatory JOIN deleted
        ON 
          deleted.Frm_GidNumer = CDN.KntOsobyKomunikatory.KoK_KnSNumer
      AND (CDN.KntOsobyKomunikatory.KOK_KnSTyp=848)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Firma_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Firma_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Firma_InsertUpdateHandler
  ON CDN.Firma
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Frm_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Frm_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Frm_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Frm_KntTyp=32)
                AND (
                          IsNull(inserted.Frm_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Firma_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Frm_KARNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.Frm_KARNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Frm_KARNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [Firma_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FBENaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FBENaglowek */</I><BR>
ALTER TABLE CDN.FormBanElem ADD CONSTRAINT FK_FBENaglowek
 FOREIGN KEY
   (
                          FBE_FBNID                         
                         )
             REFERENCES CDN.FormBanNag
                         (
                          FBN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FBKElement"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FBKElement */</I><BR>
ALTER TABLE CDN.FormBanKryt ADD CONSTRAINT FK_FBKElement
 FOREIGN KEY
   (
                          FBK_FBEID                         
                         )
             REFERENCES CDN.FormBanElem
                         (
                          FBE_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FZTJezyk"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FZTJezyk */</I><BR>
ALTER TABLE CDN.FrazyTlumaczenia ADD CONSTRAINT FK_FZTJezyk
 FOREIGN KEY
   (
                          FZT_IDJezyka                      
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FZTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FZTPrimary */</I><BR>
ALTER TABLE CDN.FrazyTlumaczenia ADD CONSTRAINT FK_FZTPrimary
 FOREIGN KEY
   (
                          FZT_IDFrazy                       
                         )
             REFERENCES CDN.Frazy
                         (
                          FZY_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FrmLinki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* FrmLinki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.FrmLinki_DeleteHandler
  ON CDN.FrmLinki
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OpeDefKol
    IF EXISTS(SELECT * FROM CDN.OpeDefKol JOIN deleted
            ON 
          deleted.FrL_GIDNumer = CDN.OpeDefKol.ODK_OpeID
      AND deleted.FrL_GIDTyp = CDN.OpeDefKol.ODK_OpeTyp
      AND ( CDN.OpeDefKol.ODK_OpeTyp=-4272)
            )
        DELETE CDN.OpeDefKol
        FROM CDN.OpeDefKol JOIN deleted
        ON 
          deleted.FrL_GIDNumer = CDN.OpeDefKol.ODK_OpeID
      AND deleted.FrL_GIDTyp = CDN.OpeDefKol.ODK_OpeTyp
      AND ( CDN.OpeDefKol.ODK_OpeTyp=-4272)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FroID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FroID */</I><BR>
ALTER TABLE CDN.FrmObiekty ADD CONSTRAINT FK_FroID
 FOREIGN KEY
   (
                          FRO_FRMID                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FrmObiekty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* FrmObiekty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.FrmObiekty_DeleteHandler
  ON CDN.FrmObiekty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RejestryDomyslne
    IF EXISTS(SELECT * FROM CDN.RejestryDomyslne JOIN deleted
            ON 
          deleted.FRO_FRMID = CDN.RejestryDomyslne.RDW_FrsID
      AND deleted.FRO_GIDNumer = CDN.RejestryDomyslne.RDW_KarNumer
      AND (deleted.Fro_GIDTyp=752)
            )
        DELETE CDN.RejestryDomyslne
        FROM CDN.RejestryDomyslne JOIN deleted
        ON 
          deleted.FRO_FRMID = CDN.RejestryDomyslne.RDW_FrsID
      AND deleted.FRO_GIDNumer = CDN.RejestryDomyslne.RDW_KarNumer
      AND (deleted.Fro_GIDTyp=752)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FrmObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* FrmObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.FrmObiekty_InsertUpdateHandler
  ON CDN.FrmObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( FRO_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Fro_GIDTyp=272)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Serie ON
                    inserted.FRO_GIDNumer = CDN.Serie.SER_GIDNumer
              WHERE CDN.Serie.SER_GIDNumer IS NULL AND (inserted.Fro_GIDTyp=272)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Serie) [FrmObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRO_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Fro_GIDTyp=208)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.FRO_GIDNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.Fro_GIDTyp=208)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [FrmObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRO_GIDTyp )  OR UPDATE( FRO_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Fro_GIDTyp=736)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konfig ON
                    inserted.FRO_GIDTyp = CDN.Konfig.KON_Numer
                AND inserted.FRO_GIDNumer = CDN.Konfig.KON_Lp
              WHERE CDN.Konfig.KON_Lp IS NULL AND (inserted.Fro_GIDTyp=736)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konfig) [FrmObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRO_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Fro_GIDTyp=752)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.FRO_GIDNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL AND (inserted.Fro_GIDTyp=752)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [FrmObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRO_MagProdId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.FRO_MagProdId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.FRO_MagProdId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [FrmObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRO_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Fro_GIDTyp=4598)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.FRO_GIDNumer = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.Fro_GIDTyp=4598)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [FrmObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRO_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Fro_GIDTyp=14551)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RodzajeBonow ON
                    inserted.FRO_GIDNumer = CDN.RodzajeBonow.RBo_Id
              WHERE CDN.RodzajeBonow.RBo_Id IS NULL AND (inserted.Fro_GIDTyp=14551)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RodzajeBonow) [FrmObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FrmStruktura_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* FrmStruktura_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.FrmStruktura_DeleteHandler
  ON CDN.FrmStruktura
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPlany
    IF EXISTS
       ( SELECT * FROM CDN.ProdPlany JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdPlany.PPL_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPlany) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwPlanPrzegladu
    IF EXISTS
       ( SELECT * FROM CDN.SrwPlanPrzegladu JOIN deleted
          ON
                deleted.FRS_Id = CDN.SrwPlanPrzegladu.SPP_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwPlanPrzegladu) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.UmwNag.UmN_FrSID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekTypySerie
    IF EXISTS
       ( SELECT * FROM CDN.SekTypySerie JOIN deleted
          ON
                deleted.FRS_Id = CDN.SekTypySerie.STS_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SekTypySerie) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekDokumenty
    IF EXISTS
       ( SELECT * FROM CDN.SekDokumenty JOIN deleted
          ON
                deleted.FRS_Id = CDN.SekDokumenty.SDD_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SekDokumenty) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoKonfig
    IF EXISTS
       ( SELECT * FROM CDN.PicoKonfig JOIN deleted
          ON
                deleted.FRS_Id = CDN.PicoKonfig.PcK_CentrumID
            
       AND (CDN.PicoKonfig.Pck_Typ &lt;&gt; 6 AND CDN.PicoKonfig.Pck_CentrumId &gt; 0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć. Z centrum strukutury jest powiązana baza odległa (Offline)./# [FrmStruktura_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.CRMWizytyNag.CWN_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.FRS_Id = CDN.OsoUmowy.OsU_CentrumPodleglosci
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoUmowy) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.SrwZlcNag.SZN_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsElem
    IF EXISTS
       ( SELECT * FROM CDN.SrsElem JOIN deleted
          ON
                deleted.FRS_Id = CDN.SrsElem.SsE_OpePNumer
       AND (CDN.SrsElem.SSE_OpePTyp=4272)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsElem) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.ProdCzynnosci JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdCzynnosci.PCZ_Oddzial
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdCzynnosci) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdProcesy
    IF EXISTS
       ( SELECT * FROM CDN.ProdProcesy JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdProcesy.PPC_Oddzial
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdProcesy) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecenia JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdZlecenia.PZL_Oddzial
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZlecenia) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaCzynnosci JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdTechnologiaCzynnosci.PTC_Oddzial
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologiaCzynnosci) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologia
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologia JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdTechnologia.PTE_Oddzial
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologia) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiektyFunkcje
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiektyFunkcje JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdObiektyFunkcje.POF_Oddzial
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiektyFunkcje) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiekty JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdObiekty.POB_Oddzial
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiekty) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PIKElem
    IF EXISTS
       ( SELECT * FROM CDN.PIKElem JOIN deleted
          ON
                deleted.FRS_Id = CDN.PIKElem.PIE_FrSId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PIKElem) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.FRS_Id = CDN.KntKarty.Knt_FrsID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.TraNag.TrN_FrsID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rezerwacje
    IF EXISTS
       ( SELECT * FROM CDN.Rezerwacje JOIN deleted
          ON
                deleted.FRS_Id = CDN.Rezerwacje.Rez_FrsID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rezerwacje) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.ZlcRemNag.ZRN_FrSId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.ZlcNag.ZcN_FrSId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.ZamNag.ZaN_FrSID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlecWewNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlecWewNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.ZlecWewNag.ZWN_MPKZlecId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlecWewNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjNag
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.BudzetPrjNag.BPN_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BudzetPrjNag) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrsAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.FrsAplikacje JOIN deleted
          ON
                deleted.FRS_Id = CDN.FrsAplikacje.FrA_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrsAplikacje) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OpisWzorce
    IF EXISTS
       ( SELECT * FROM CDN.OpisWzorce JOIN deleted
          ON
                deleted.FRS_Id = CDN.OpisWzorce.OWW_FrsID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OpisWzorce) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Komunikaty
    IF EXISTS
       ( SELECT * FROM CDN.Komunikaty JOIN deleted
          ON
                deleted.FRS_Id = CDN.Komunikaty.Kom_FrsId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Komunikaty) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdNadzlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdNadzlecenia JOIN deleted
          ON
                deleted.FRS_Id = CDN.ProdNadzlecenia.PNZ_Oddzial
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdNadzlecenia) [FrmStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrcRole
    IF EXISTS(SELECT * FROM CDN.PrcRole JOIN deleted
            ON 
          deleted.FRS_Id = CDN.PrcRole.PrR_FrSId
            )
        DELETE CDN.PrcRole
        FROM CDN.PrcRole JOIN deleted
        ON 
          deleted.FRS_Id = CDN.PrcRole.PrR_FrSId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.FRS_Id = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4272 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.FRS_Id = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4272 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WymPowiazania
    IF EXISTS(SELECT * FROM CDN.WymPowiazania JOIN deleted
            ON 
          deleted.FRS_Id = CDN.WymPowiazania.WMP_PowiazanieID
      AND (CDN.WymPowiazania.WMP_TypPowiazania=1)
            )
        DELETE CDN.WymPowiazania
        FROM CDN.WymPowiazania JOIN deleted
        ON 
          deleted.FRS_Id = CDN.WymPowiazania.WMP_PowiazanieID
      AND (CDN.WymPowiazania.WMP_TypPowiazania=1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.FRS_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4272 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.FRS_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4272 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PunktyKonfig
    IF EXISTS(SELECT * FROM CDN.PunktyKonfig JOIN deleted
            ON 
          deleted.FRS_GIDNumer = CDN.PunktyKonfig.PuK_ObiNumer
      AND deleted.FRS_GIDTyp = CDN.PunktyKonfig.PuK_ObiTyp
      AND (CDN.PunktyKonfig.PuK_ObiTyp=-4272)
            )
        DELETE CDN.PunktyKonfig
        FROM CDN.PunktyKonfig JOIN deleted
        ON 
          deleted.FRS_GIDNumer = CDN.PunktyKonfig.PuK_ObiNumer
      AND deleted.FRS_GIDTyp = CDN.PunktyKonfig.PuK_ObiTyp
      AND (CDN.PunktyKonfig.PuK_ObiTyp=-4272)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BIPointRaportOpeCentra
    IF EXISTS(SELECT * FROM CDN.BIPointRaportOpeCentra JOIN deleted
            ON 
          deleted.FRS_Id = CDN.BIPointRaportOpeCentra.BRO_Numer
      AND (CDN.BIPointRaportOpeCentra.BRO_Typ=-4272)
            )
        DELETE CDN.BIPointRaportOpeCentra
        FROM CDN.BIPointRaportOpeCentra JOIN deleted
        ON 
          deleted.FRS_Id = CDN.BIPointRaportOpeCentra.BRO_Numer
      AND (CDN.BIPointRaportOpeCentra.BRO_Typ=-4272)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdIoTOdbiorcyPowiadomien
    IF EXISTS(SELECT * FROM CDN.ProdIoTOdbiorcyPowiadomien JOIN deleted
            ON 
          deleted.FRS_Id = CDN.ProdIoTOdbiorcyPowiadomien.PIOK_ObiNumer
      AND (CDN.ProdIoTOdbiorcyPowiadomien.PIOK_ObiTyp=-4272)
            )
        DELETE CDN.ProdIoTOdbiorcyPowiadomien
        FROM CDN.ProdIoTOdbiorcyPowiadomien JOIN deleted
        ON 
          deleted.FRS_Id = CDN.ProdIoTOdbiorcyPowiadomien.PIOK_ObiNumer
      AND (CDN.ProdIoTOdbiorcyPowiadomien.PIOK_ObiTyp=-4272)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FrmStruktura_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* FrmStruktura_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.FrmStruktura_InsertUpdateHandler
  ON CDN.FrmStruktura
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( FRS_KaRNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.FRS_KaRNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL
                AND (
                          IsNull(inserted.FRS_KaRNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRS_DetKnGTyp )  OR UPDATE( FRS_DetKnGNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.FRS_DetKnGTyp=-32 and inserted.FRS_DetKnGNumer&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntGrupy ON
                    inserted.FRS_DetKnGTyp = CDN.KntGrupy.KnG_GIDTyp
                AND inserted.FRS_DetKnGNumer = CDN.KntGrupy.KnG_GIDNumer
              WHERE CDN.KntGrupy.KnG_GIDNumer IS NULL AND (inserted.FRS_DetKnGTyp=-32 and inserted.FRS_DetKnGNumer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntGrupy) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRS_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.FRS_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.FRS_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRS_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.FRS_GIDTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.FRS_GIDNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.FRS_GIDTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRS_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.FRS_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.FRS_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRS_SERNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Serie ON
                    inserted.FRS_SERNumer = CDN.Serie.SER_GIDNumer
              WHERE CDN.Serie.SER_GIDNumer IS NULL
                AND (
                          IsNull(inserted.FRS_SERNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Serie) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRS_SCNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SkladyCelne ON
                    inserted.FRS_SCNumer = CDN.SkladyCelne.SC_GIDNumer
              WHERE CDN.SkladyCelne.SC_GIDNumer IS NULL
                AND (
                          IsNull(inserted.FRS_SCNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SkladyCelne) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRS_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.FRS_GIDTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.FRS_GIDNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.FRS_GIDTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FRS_ProdZSRKntTyp )  OR UPDATE( FRS_ProdZSRKntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.FRS_ProdZSRKntNumer=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.FRS_ProdZSRKntTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.FRS_ProdZSRKntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.FRS_ProdZSRKntNumer=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [FrmStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FrmStrukturaAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* FrmStrukturaAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.FrmStrukturaAlias_DeleteHandler
  ON CDN.FrmStruktura
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.FRS_Id = CDN.OsoUmowy.OsU_CentrumKosztow
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoUmowy) [FrmStrukturaAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiekty JOIN deleted
          ON
                deleted.FRS_GIDNumer = CDN.ProdObiekty.POB_ObiNumer
            AND deleted.FRS_GIDTyp = CDN.ProdObiekty.POB_ObiTyp
       AND (CDN.ProdObiekty.POB_ObiTyp=-4272)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiekty) [FrmStrukturaAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlecWewNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlecWewNag JOIN deleted
          ON
                deleted.FRS_Id = CDN.ZlecWewNag.ZWN_MPKWykId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlecWewNag) [FrmStrukturaAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FRTelStruktura"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FRTelStruktura */</I><BR>
ALTER TABLE CDN.FrmStrukturaTel ADD CONSTRAINT FK_FRTelStruktura
 FOREIGN KEY
   (
                          FRTEL_FRSID                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FrsAplikacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* FrsAplikacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.FrsAplikacje_InsertUpdateHandler
  ON CDN.FrsAplikacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( FrA_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.FrA_ObiTyp = -32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntWzorce ON
                    inserted.FrA_ObiNumer = CDN.KntWzorce.KnW_GrpNumer
              WHERE CDN.KntWzorce.KnW_GrpNumer IS NULL AND (inserted.FrA_ObiTyp = -32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntWzorce) [FrsAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FrA_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.FrA_ObiTyp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.FrA_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.FrA_ObiTyp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [FrsAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FrA_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.FrA_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.FrA_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [FrsAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FrA_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.FrA_ObiTyp = -128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.FrA_ObiNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.FrA_ObiTyp = -128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [FrsAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FrA_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.FrA_ObiTyp = 8211)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.FrA_ObiNumer = CDN.KntOsoby.KnS_SyncID
              WHERE CDN.KntOsoby.KnS_SyncID IS NULL AND (inserted.FrA_ObiTyp = 8211)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [FrsAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( FrA_FrsId )  OR UPDATE( FrA_TypAplikacji ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrsAplikacje ON
                    inserted.FrA_FrsId = CDN.FrsAplikacje.FrA_FrsId
                AND inserted.FrA_TypAplikacji = CDN.FrsAplikacje.FrA_TypAplikacji
              WHERE CDN.FrsAplikacje.FrA_TypAplikacji IS NULL AND (CDN.FrsAplikacje.FrA_ObiTyp = 32 and inserted.FrA_ObiTyp = 8211 and exists(select * from cdn.KntOsoby where KnS_KntNumer = CDN.FrsAplikacje.FrA_ObiNumer and KnS_KntTyp = 32 and KnS_SyncId =  inserted.FrA_ObiNumer))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrsAplikacje) [FrsAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FrsAplikacjeAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* FrsAplikacjeAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.FrsAplikacjeAlias1_DeleteHandler
  ON CDN.FrsAplikacje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrsAplikacje
    IF EXISTS(SELECT * FROM CDN.FrsAplikacje JOIN deleted
            ON 
          deleted.FrA_FrsId = CDN.FrsAplikacje.FrA_FrsId
      AND deleted.FrA_TypAplikacji = CDN.FrsAplikacje.FrA_TypAplikacji
      AND (deleted.FrA_ObiTyp = 32 and CDN.FrsAplikacje.FrA_ObiTyp = 8211 and exists(select * from cdn.KntOsoby where KnS_KntNumer = deleted.FrA_ObiNumer and KnS_KntTyp = 32 and KnS_SyncId =  CDN.FrsAplikacje.FrA_ObiNumer))
            )
        DELETE CDN.FrsAplikacje
        FROM CDN.FrsAplikacje JOIN deleted
        ON 
          deleted.FrA_FrsId = CDN.FrsAplikacje.FrA_FrsId
      AND deleted.FrA_TypAplikacji = CDN.FrsAplikacje.FrA_TypAplikacji
      AND (deleted.FrA_ObiTyp = 32 and CDN.FrsAplikacje.FrA_ObiTyp = 8211 and exists(select * from cdn.KntOsoby where KnS_KntNumer = deleted.FrA_ObiNumer and KnS_KntTyp = 32 and KnS_SyncId =  CDN.FrsAplikacje.FrA_ObiNumer))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FprFrS"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FprFrS */</I><BR>
ALTER TABLE CDN.FrsPromocje ADD CONSTRAINT FK_FprFrS
 FOREIGN KEY
   (
                          FPR_FrsId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FprPrm"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FprPrm */</I><BR>
ALTER TABLE CDN.FrsPromocje ADD CONSTRAINT FK_FprPrm
 FOREIGN KEY
   (
                          FPR_PrmId                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FrzFrs"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FrzFrs */</I><BR>
ALTER TABLE CDN.FrsZamienniki ADD CONSTRAINT FK_FrzFrs
 FOREIGN KEY
   (
                          FRZ_FrsId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_FrzTwP"></A><PRE>
          <FONT SIZE="2"><I>/* FK_FrzTwP */</I><BR>
ALTER TABLE CDN.FrsZamienniki ADD CONSTRAINT FK_FrzTwP
 FOREIGN KEY
   (
                          FRZ_TwPId                         
                         )
             REFERENCES CDN.TwrPodm
                         (
                          TwP_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_GPRPrm"></A><PRE>
          <FONT SIZE="2"><I>/* FK_GPRPrm */</I><BR>
ALTER TABLE CDN.GratisyPromocje ADD CONSTRAINT FK_GPRPrm
 FOREIGN KEY
   (
                          GPR_PrmId                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="GratisyPromocje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* GratisyPromocje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.GratisyPromocje_InsertUpdateHandler
  ON CDN.GratisyPromocje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( GPR_PrPID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProgiPromocje ON
                    inserted.GPR_PrPID = CDN.ProgiPromocje.PRP_ID
              WHERE CDN.ProgiPromocje.PRP_ID IS NULL
                AND (
                          IsNull(inserted.GPR_PrPID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProgiPromocje) [GratisyPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( GPR_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.GPR_TwrTyp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.GPR_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.GPR_TwrTyp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [GratisyPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="GrupyKrajow_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* GrupyKrajow_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.GrupyKrajow_DeleteHandler
  ON CDN.GrupyKrajow
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KrajeCelne
    IF EXISTS
       ( SELECT * FROM CDN.KrajeCelne JOIN deleted
          ON
                deleted.GKr_ID = CDN.KrajeCelne.KPC_GKrID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KrajeCelne) [GrupyKrajow_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="HistoriaUruchomien_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* HistoriaUruchomien_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.HistoriaUruchomien_InsertUpdateHandler
  ON CDN.HistoriaUruchomien
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( HtU_OpeNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.HtU_OpeNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.HtU_OpeNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [HistoriaUruchomien_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ImEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ImEPrimary */</I><BR>
ALTER TABLE CDN.ImpElem ADD CONSTRAINT FK_ImEPrimary
 FOREIGN KEY
   (
                          ImE_GIDNumer                      
                         )
             REFERENCES CDN.ImpNag
                         (
                          ImN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImpElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImpElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ImpElem_DeleteHandler
  ON CDN.ImpElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ImE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ImE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.ImE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=3344 and  CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and         CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ImE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ImE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.ImE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=3344 and  CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and         CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ImE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ImE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ImE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=3344 and  CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ImE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ImE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ImE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=3344 and  CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RelTraImp
    IF EXISTS(SELECT * FROM CDN.RelTraImp JOIN deleted
            ON 
          deleted.ImE_GIDNumer = CDN.RelTraImp.RTI_DocNumer
      AND deleted.ImE_GIDLp = CDN.RelTraImp.RTI_DocLp
      AND deleted.ImE_GIDTyp = CDN.RelTraImp.RTI_DocTyp
      AND (CDN.RelTraImp.RTI_DocTyp in (3344, 3352))
            )
        DELETE CDN.RelTraImp
        FROM CDN.RelTraImp JOIN deleted
        ON 
          deleted.ImE_GIDNumer = CDN.RelTraImp.RTI_DocNumer
      AND deleted.ImE_GIDLp = CDN.RelTraImp.RTI_DocLp
      AND deleted.ImE_GIDTyp = CDN.RelTraImp.RTI_DocTyp
      AND (CDN.RelTraImp.RTI_DocTyp in (3344, 3352))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImpElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImpElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ImpElem_InsertUpdateHandler
  ON CDN.ImpElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ImE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.ImE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ImE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ImpElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImpElemAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImpElemAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ImpElemAlias_DeleteHandler
  ON CDN.ImpElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.RelTraImp
    IF EXISTS
       ( SELECT * FROM CDN.RelTraImp JOIN deleted
          ON
                deleted.ImE_GIDNumer = CDN.RelTraImp.RTI_ZrdNumer
            AND deleted.ImE_GIDLp = CDN.RelTraImp.RTI_ZrdLp
            AND deleted.ImE_GIDTyp = CDN.RelTraImp.RTI_ZrdTyp
            
       AND (CDN.RelTraImp.RTI_ZrdTyp in (3344, 3352))
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć elementów z których wygenerowano jakiś dokument./# [ImpElemAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImpNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImpNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ImpNag_DeleteHandler
  ON CDN.ImpNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadKwoty
    IF EXISTS
       ( SELECT * FROM CDN.SadKwoty JOIN deleted
          ON
                deleted.ImN_GIDNumer = CDN.SadKwoty.SaK_TrNNumer
       AND (CDN.SadKwoty.SaK_TrNTyp=3344)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadKwoty) [ImpNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WysKoszty
    IF EXISTS
       ( SELECT * FROM CDN.WysKoszty JOIN deleted
          ON
                deleted.ImN_GIDNumer = CDN.WysKoszty.WyK_DokNumer
            
       AND (CDN.WysKoszty.WyK_DokTyp = 3344)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Modyfikacja dokumentu nie jest możliwa/##CDN_2=Dokument jest spięty w wysyłce jako koszt/##CDN_3=Odepnij dokument od wysyłki/# [ImpNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwPlat
    IF EXISTS
       ( SELECT * FROM CDN.UmwPlat JOIN deleted
          ON
                deleted.ImN_GIDNumer = CDN.UmwPlat.UPl_ImpNumer
       AND (CDN.UmwPlat.UPl_ImpNumer &lt;&gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwPlat) [ImpNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DoZ_DokTyp=3344 AND CDN.DokZwiazane.DoZ_DokLp=0)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DoZ_DokTyp=3344 AND CDN.DokZwiazane.DoZ_DokLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrtDokZakupu
    IF EXISTS(SELECT * FROM CDN.SrtDokZakupu JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.SrtDokZakupu.SDZ_DokNumer
      AND (CDN.SrtDokZakupu.SDZ_DokTyp in (3344,3352))
            )
        DELETE CDN.SrtDokZakupu
        FROM CDN.SrtDokZakupu JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.SrtDokZakupu.SDZ_DokNumer
      AND (CDN.SrtDokZakupu.SDZ_DokTyp in (3344,3352))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (  CDN.ProdKosztyElem.PKE_OBITyp in (3344,3352))
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (  CDN.ProdKosztyElem.PKE_OBITyp in (3344,3352))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (3344,3352))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (3344,3352))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (3344,3352))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (3344,3352))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( ( CDN.Atrybuty.Atr_OBITyp=3344 or CDN.Atrybuty.Atr_OBITyp=3352 ) and  CDN.Atrybuty.Atr_OBILp = 0 and        CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( ( CDN.Atrybuty.Atr_OBITyp=3344 or CDN.Atrybuty.Atr_OBITyp=3352 ) and  CDN.Atrybuty.Atr_OBILp = 0 and        CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=3344)
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=3344)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( ( CDN.AtrybutyHist.Ath_OBITyp=3344 or CDN.AtrybutyHist.Ath_OBITyp=3352 ) and  CDN.AtrybutyHist.Ath_OBILp = 0 and        CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( ( CDN.AtrybutyHist.Ath_OBITyp=3344 or CDN.AtrybutyHist.Ath_OBITyp=3352 ) and  CDN.AtrybutyHist.Ath_OBILp = 0 and        CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraJPK
    IF EXISTS(SELECT * FROM CDN.TraJPK JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.TraJPK.TrJ_TrNNumer
      AND (CDN.TraJPK.TrJ_TrNTyp in (3344,3352))
            )
        DELETE CDN.TraJPK
        FROM CDN.TraJPK JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.TraJPK.TrJ_TrNNumer
      AND (CDN.TraJPK.TrJ_TrNTyp in (3344,3352))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.ImN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (3344,3352))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.ImN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (3344,3352))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImpNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImpNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ImpNag_InsertUpdateHandler
  ON CDN.ImpNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ImN_KnDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ImN_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ImN_KnDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KnSNumer )  OR UPDATE( ImN_KnSLp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.ImN_KnSNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.ImN_KnSLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.ImN_KnSNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ImN_KnSLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KnSNumerD )  OR UPDATE( ImN_KnSLpD ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.ImN_KnSNumerD = CDN.KntOsoby.KnS_KntNumer
                AND inserted.ImN_KnSLpD = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.ImN_KnSNumerD,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ImN_KnSLpD,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KnSNumerP )  OR UPDATE( ImN_KnSLpP ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.ImN_KnSNumerP = CDN.KntOsoby.KnS_KntNumer
                AND inserted.ImN_KnSLpP = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.ImN_KnSNumerP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ImN_KnSLpP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ImN_AkwTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ImN_AkwNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.ImN_AkwTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ImN_KnPTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ImN_KnPNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.ImN_KnPTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ImN_KnPTyp=48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.ImN_KnPNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.ImN_KnPTyp=48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ImN_KnPTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.ImN_KnPNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.ImN_KnPTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ImN_KnPTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ImN_KnPNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ImN_KnPTyp=32)
                AND (
                          IsNull(inserted.ImN_KnPNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ImN_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ImN_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ImN_AkwTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_AdwTyp )  OR UPDATE( ImN_AdwNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.ImN_AdwTyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.ImN_AdwNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ImN_AdwTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ImN_AdwNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KnATyp )  OR UPDATE( ImN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.ImN_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.ImN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ImN_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ImN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ImN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ImN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ImN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ImN_KntTyp=32)
                AND (
                          IsNull(inserted.ImN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ImpNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ITANag"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ITANag */</I><BR>
ALTER TABLE CDN.ImtArkusze ADD CONSTRAINT FK_ITANag
 FOREIGN KEY
   (
                          ITA_ITNId                         
                         )
             REFERENCES CDN.ImtNag
                         (
                          ITN_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IAEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IAEPrimary */</I><BR>
ALTER TABLE CDN.ImtArkuszeElem ADD CONSTRAINT FK_IAEPrimary
 FOREIGN KEY
   (
                          IAE_ITAId                         
                         )
             REFERENCES CDN.ImtArkusze
                         (
                          ITA_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IAESrodek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IAESrodek */</I><BR>
ALTER TABLE CDN.ImtArkuszeElem ADD CONSTRAINT FK_IAESrodek
 FOREIGN KEY
   (
                          IAE_SrtNumer                      
                         )
             REFERENCES CDN.SrtKarty
                         (
                          Srt_GIDNumer                      
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImtArkuszeElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImtArkuszeElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ImtArkuszeElem_DeleteHandler
  ON CDN.ImtArkuszeElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtHistElem
    IF EXISTS
       ( SELECT * FROM CDN.SrtHistElem JOIN deleted
          ON
                deleted.IAE_ITAId = CDN.SrtHistElem.SHE_ITAId
            AND deleted.IAE_Lp = CDN.SrtHistElem.SHE_IAELp
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtHistElem) [ImtArkuszeElem_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImtArkuszeElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImtArkuszeElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ImtArkuszeElem_InsertUpdateHandler
  ON CDN.ImtArkuszeElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( IAE_PrcNumerEwidencja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.IAE_PrcNumerEwidencja = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.IAE_PrcNumerEwidencja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ImtArkuszeElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( IAE_PrcNumerSpis ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.IAE_PrcNumerSpis = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.IAE_PrcNumerSpis,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ImtArkuszeElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImtNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImtNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ImtNag_DeleteHandler
  ON CDN.ImtNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtHistNag
    IF EXISTS
       ( SELECT * FROM CDN.SrtHistNag JOIN deleted
          ON
                deleted.ITN_ID = CDN.SrtHistNag.SHN_ITNId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtHistNag) [ImtNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ITOArkusz"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ITOArkusz */</I><BR>
ALTER TABLE CDN.ImtOdczyty ADD CONSTRAINT FK_ITOArkusz
 FOREIGN KEY
   (
                          ITO_ITAId                         
                         )
             REFERENCES CDN.ImtArkusze
                         (
                          ITA_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IOEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IOEPrimary */</I><BR>
ALTER TABLE CDN.ImtOdczytyElem ADD CONSTRAINT FK_IOEPrimary
 FOREIGN KEY
   (
                          IOE_ITOId                         
                         )
             REFERENCES CDN.ImtOdczyty
                         (
                          ITO_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ImtOdczytyElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ImtOdczytyElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ImtOdczytyElem_InsertUpdateHandler
  ON CDN.ImtOdczytyElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( IOE_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.IOE_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.IOE_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ImtOdczytyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( IOE_SrtNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.IOE_SrtNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.IOE_SrtNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [ImtOdczytyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( IOE_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.IOE_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.IOE_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ImtOdczytyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_InANaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_InANaglowek */</I><BR>
ALTER TABLE CDN.InwArk ADD CONSTRAINT FK_InANaglowek
 FOREIGN KEY
   (
                          InA_InNId                         
                         )
             REFERENCES CDN.InwNag
                         (
                          InN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwArk_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwArk_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.InwArk_DeleteHandler
  ON CDN.InwArk
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.InA_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=1536 and  CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.InA_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=1536 and  CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.InA_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=1536 and  CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.InA_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=1536 and  CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwArk_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwArk_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.InwArk_InsertUpdateHandler
  ON CDN.InwArk
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( InA_MgAIdDo ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagAdresy ON
                    inserted.InA_MgAIdDo = CDN.MagAdresy.MgA_Id
              WHERE CDN.MagAdresy.MgA_Id IS NULL
                AND (
                          IsNull(inserted.InA_MgAIdDo,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagAdresy) [InwArk_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InA_MgAIdOd ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagAdresy ON
                    inserted.InA_MgAIdOd = CDN.MagAdresy.MgA_Id
              WHERE CDN.MagAdresy.MgA_Id IS NULL
                AND (
                          IsNull(inserted.InA_MgAIdOd,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagAdresy) [InwArk_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IATNaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IATNaglowek */</I><BR>
ALTER TABLE CDN.InwArkTwr ADD CONSTRAINT FK_IATNaglowek
 FOREIGN KEY
   (
                          IAT_InAId                         
                         )
             REFERENCES CDN.InwArk
                         (
                          InA_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_InMMagazyn"></A><PRE>
          <FONT SIZE="2"><I>/* FK_InMMagazyn */</I><BR>
ALTER TABLE CDN.InwMag ADD CONSTRAINT FK_InMMagazyn
 FOREIGN KEY
   (
                          InM_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_InMInN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_InMInN */</I><BR>
ALTER TABLE CDN.InwMag ADD CONSTRAINT FK_InMInN
 FOREIGN KEY
   (
                          InM_InNId                         
                         )
             REFERENCES CDN.InwNag
                         (
                          InN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwMag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwMag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.InwMag_InsertUpdateHandler
  ON CDN.InwMag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( InM_RWTyp )  OR UPDATE( InM_RWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.InM_RWTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.InM_RWNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.InM_RWTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.InM_RWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [InwMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InM_PWTyp )  OR UPDATE( InM_PWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.InM_PWTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.InM_PWNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.InM_PWTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.InM_PWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [InwMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InM_WMNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.InM_WMNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.InM_WMNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [InwMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InM_PMNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.InM_PMNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.InM_PMNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [InwMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InM_MPNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.InM_MPNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.InM_MPNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [InwMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IMTInT"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IMTInT */</I><BR>
ALTER TABLE CDN.InwMagTwr ADD CONSTRAINT FK_IMTInT
 FOREIGN KEY
   (
                          IMT_InTId                         
                         )
             REFERENCES CDN.InwTwr
                         (
                          InT_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IMTMagazyn"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IMTMagazyn */</I><BR>
ALTER TABLE CDN.InwMagTwr ADD CONSTRAINT FK_IMTMagazyn
 FOREIGN KEY
   (
                          IMT_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwMagTwr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwMagTwr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.InwMagTwr_InsertUpdateHandler
  ON CDN.InwMagTwr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( IMT_TPaIdMag ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrPartie ON
                    inserted.IMT_TPaIdMag = CDN.TwrPartie.TpA_Id
              WHERE CDN.TwrPartie.TpA_Id IS NULL
                AND (
                          IsNull(inserted.IMT_TPaIdMag,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrPartie) [InwMagTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.InwNag_DeleteHandler
  ON CDN.InwNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.InN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=1536 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.InN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=1536 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.InN_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=1536 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.InN_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=1536 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.InwNagSesje
    IF EXISTS(SELECT * FROM CDN.InwNagSesje JOIN deleted
            ON 
          deleted.InN_Id = CDN.InwNagSesje.InS_InNId
      AND (CDN.InwNagSesje.InS_Typ=0)
            )
        DELETE CDN.InwNagSesje
        FROM CDN.InwNagSesje JOIN deleted
        ON 
          deleted.InN_Id = CDN.InwNagSesje.InS_InNId
      AND (CDN.InwNagSesje.InS_Typ=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwNagSesje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwNagSesje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.InwNagSesje_InsertUpdateHandler
  ON CDN.InwNagSesje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( InS_InNId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.InS_Typ=2)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.InwOdc ON
                    inserted.InS_InNId = CDN.InwOdc.InO_Id
              WHERE CDN.InwOdc.InO_Id IS NULL AND (inserted.InS_Typ=2)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  InwOdc) [InwNagSesje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InS_InNId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.InS_Typ=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.InwNag ON
                    inserted.InS_InNId = CDN.InwNag.InN_Id
              WHERE CDN.InwNag.InN_Id IS NULL AND (inserted.InS_Typ=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  InwNag) [InwNagSesje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_InONaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_InONaglowek */</I><BR>
ALTER TABLE CDN.InwOdc ADD CONSTRAINT FK_InONaglowek
 FOREIGN KEY
   (
                          InO_InAId                         
                         )
             REFERENCES CDN.InwArk
                         (
                          InA_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwOdc_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwOdc_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.InwOdc_DeleteHandler
  ON CDN.InwOdc
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.InwNagSesje
    IF EXISTS(SELECT * FROM CDN.InwNagSesje JOIN deleted
            ON 
          deleted.InO_Id = CDN.InwNagSesje.InS_InNId
      AND (CDN.InwNagSesje.InS_Typ=2)
            )
        DELETE CDN.InwNagSesje
        FROM CDN.InwNagSesje JOIN deleted
        ON 
          deleted.InO_Id = CDN.InwNagSesje.InS_InNId
      AND (CDN.InwNagSesje.InS_Typ=2)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.InO_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp = 1536 AND  CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.InO_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp = 1536 AND  CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.InO_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp = 1536 AND  CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.InO_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp = 1536 AND  CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IOTInwTwr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IOTInwTwr */</I><BR>
ALTER TABLE CDN.InwOdcTwr ADD CONSTRAINT FK_IOTInwTwr
 FOREIGN KEY
   (
                          IOT_InTId                         
                         )
             REFERENCES CDN.InwTwr
                         (
                          InT_Id                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IOTNaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IOTNaglowek */</I><BR>
ALTER TABLE CDN.InwOdcTwr ADD CONSTRAINT FK_IOTNaglowek
 FOREIGN KEY
   (
                          IOT_InOId                         
                         )
             REFERENCES CDN.InwOdc
                         (
                          InO_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwOdcTwr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwOdcTwr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.InwOdcTwr_InsertUpdateHandler
  ON CDN.InwOdcTwr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( IOT_CCkNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CechyKlasy ON
                    inserted.IOT_CCkNumer = CDN.CechyKlasy.CCK_GIDNumer
              WHERE CDN.CechyKlasy.CCK_GIDNumer IS NULL
                AND (
                          IsNull(inserted.IOT_CCkNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CechyKlasy) [InwOdcTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( IOT_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.IOT_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.IOT_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [InwOdcTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_InTNaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_InTNaglowek */</I><BR>
ALTER TABLE CDN.InwTwr ADD CONSTRAINT FK_InTNaglowek
 FOREIGN KEY
   (
                          InT_InNId                         
                         )
             REFERENCES CDN.InwNag
                         (
                          InN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="InwTwr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* InwTwr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.InwTwr_InsertUpdateHandler
  ON CDN.InwTwr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( InT_TpaId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrPartie ON
                    inserted.InT_TpaId = CDN.TwrPartie.TpA_Id
              WHERE CDN.TwrPartie.TpA_Id IS NULL
                AND (
                          IsNull(inserted.InT_TpaId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrPartie) [InwTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InT_MgaId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagAdresy ON
                    inserted.InT_MgaId = CDN.MagAdresy.MgA_Id
              WHERE CDN.MagAdresy.MgA_Id IS NULL
                AND (
                          IsNull(inserted.InT_MgaId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagAdresy) [InwTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InT_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.InT_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.InT_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [InwTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( InT_CCkNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CechyKlasy ON
                    inserted.InT_CCkNumer = CDN.CechyKlasy.CCK_GIDNumer
              WHERE CDN.CechyKlasy.CCK_GIDNumer IS NULL
                AND (
                          IsNull(inserted.InT_CCkNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CechyKlasy) [InwTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IsEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IsEPrimary */</I><BR>
ALTER TABLE CDN.IstElem ADD CONSTRAINT FK_IsEPrimary
 FOREIGN KEY
   (
                          IsE_GIDNumer                      
                         )
             REFERENCES CDN.IstNag
                         (
                          IsN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="IstNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* IstNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.IstNag_InsertUpdateHandler
  ON CDN.IstNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( IsN_UrzNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.IsN_UrzNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL
                AND (
                          IsNull(inserted.IsN_UrzNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [IstNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( IsN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.IsN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.IsN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.IsN_KntTyp=32)
                AND (
                          IsNull(inserted.IsN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [IstNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IsSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IsSPrimary */</I><BR>
ALTER TABLE CDN.IstSElem ADD CONSTRAINT FK_IsSPrimary
 FOREIGN KEY
   (
                          IsS_GIDNumer                      ,
                          IsS_GIDLp                         
                         )
             REFERENCES CDN.IstElem
                         (
                          IsE_GIDNumer                      ,
                          IsE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_IOPPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_IOPPrimary */</I><BR>
ALTER TABLE CDN.IstotneOpcje ADD CONSTRAINT FK_IOPPrimary
 FOREIGN KEY
   (
                          IOP_IDOperatora                   
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KBNEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KBNEPrimary */</I><BR>
ALTER TABLE CDN.KBNElem ADD CONSTRAINT FK_KBNEPrimary
 FOREIGN KEY
   (
                          KBNE_KBNNId                        
                         )
             REFERENCES CDN.KBNNag
                         (
                          KBNN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KBNElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KBNElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KBNElem_InsertUpdateHandler
  ON CDN.KBNElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KBNE_RWTyp )  OR UPDATE( KBNE_RWNumer )  OR UPDATE( KBNE_RWLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KBNE_RWTyp in (1616,1624))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.KBNE_RWTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.KBNE_RWNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.KBNE_RWLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.KBNE_RWTyp in (1616,1624))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [KBNElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KBNE_PWTyp )  OR UPDATE( KBNE_PWNumer )  OR UPDATE( KBNE_PWLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KBNE_PWTyp in (1617,1625))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.KBNE_PWTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.KBNE_PWNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.KBNE_PWLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.KBNE_PWTyp in (1617,1625))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [KBNElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KBNMKBNNag"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KBNMKBNNag */</I><BR>
ALTER TABLE CDN.KBNMagazyny ADD CONSTRAINT FK_KBNMKBNNag
 FOREIGN KEY
   (
                          KBNM_KBNNId                        
                         )
             REFERENCES CDN.KBNNag
                         (
                          KBNN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KBNMMagazyn"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KBNMMagazyn */</I><BR>
ALTER TABLE CDN.KBNMagazyny ADD CONSTRAINT FK_KBNMMagazyn
 FOREIGN KEY
   (
                          KBNM_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KBNNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KBNNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KBNNag_DeleteHandler
  ON CDN.KBNNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.KBNN_Id = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp=4608)
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.KBNN_Id = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp=4608)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KBNOKBNN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KBNOKBNN */</I><BR>
ALTER TABLE CDN.KBNOdpowiedzialni ADD CONSTRAINT FK_KBNOKBNN
 FOREIGN KEY
   (
                          KBNO_KBNNId                        
                         )
             REFERENCES CDN.KBNNag
                         (
                          KBNN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KBNOdpowiedzialni_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KBNOdpowiedzialni_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KBNOdpowiedzialni_InsertUpdateHandler
  ON CDN.KBNOdpowiedzialni
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KBNO_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.KBNO_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KBNO_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [KBNOdpowiedzialni_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KBNO_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.KBNO_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KBNO_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [KBNOdpowiedzialni_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KBNSKBNNag"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KBNSKBNNag */</I><BR>
ALTER TABLE CDN.KBNSerie ADD CONSTRAINT FK_KBNSKBNNag
 FOREIGN KEY
   (
                          KBNS_KBNNId                        
                         )
             REFERENCES CDN.KBNNag
                         (
                          KBNN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KBNSSeria"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KBNSSeria */</I><BR>
ALTER TABLE CDN.KBNSerie ADD CONSTRAINT FK_KBNSSeria
 FOREIGN KEY
   (
                          KBNS_SerNazwa                      
                         )
             REFERENCES CDN.Serie
                         (
                          SER_Nazwa                         
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KPDDzkNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KPDDzkNumer */</I><BR>
ALTER TABLE CDN.KPDZrodla ADD CONSTRAINT FK_KPDDzkNumer
 FOREIGN KEY
   (
                          KPD_DZKNumer                      
                         )
             REFERENCES CDN.Dziennik
                         (
                          DZK_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KadrSlowniki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KadrSlowniki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KadrSlowniki_DeleteHandler
  ON CDN.KadrSlowniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoCzasRazem
    IF EXISTS
       ( SELECT * FROM CDN.OsoCzasRazem JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoCzasRazem.OCR_RodzajPracy
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoCzasRazem) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoCzasPracy
    IF EXISTS
       ( SELECT * FROM CDN.OsoCzasPracy JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoCzasPracy.OCP_RodzajPracy
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoCzasPracy) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoKarty
    IF EXISTS
       ( SELECT * FROM CDN.OsoKarty JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoKarty.Oso_StanCywilny
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoKarty) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoWyksztalcenie
    IF EXISTS
       ( SELECT * FROM CDN.OsoWyksztalcenie JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoWyksztalcenie.OsW_Specjalizacja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoWyksztalcenie) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoUmowy.OsU_TypPracownika
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoUmowy) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DefNieobecnosci
    IF EXISTS
       ( SELECT * FROM CDN.DefNieobecnosci JOIN deleted
          ON
                deleted.KSl_Id = CDN.DefNieobecnosci.DNB_LimitNieobecnosci
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Limit jest ustawiony na definicji nieobecności./# [KadrSlowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PrcKarty
    IF EXISTS
       ( SELECT * FROM CDN.PrcKarty JOIN deleted
          ON
                deleted.KSl_Id = CDN.PrcKarty.Prc_PoziomWyksztalcenia
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PrcKarty) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoKompetencje
    IF EXISTS
       ( SELECT * FROM CDN.OsoKompetencje JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoKompetencje.OsK_Zakres
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoKompetencje) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStanowiska
    IF EXISTS
       ( SELECT * FROM CDN.KadrStanowiska JOIN deleted
          ON
                deleted.KSl_Id = CDN.KadrStanowiska.KSt_WymPozWyksztalcenia
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStanowiska) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoKompZakres
    IF EXISTS
       ( SELECT * FROM CDN.OsoKompZakres JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoKompZakres.OKZ_Zakres
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoKompZakres) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStaSlowniki
    IF EXISTS
       ( SELECT * FROM CDN.KadrStaSlowniki JOIN deleted
          ON
                deleted.KSl_Id = CDN.KadrStaSlowniki.KSS_SlwId
       AND (CDN.KadrStaSlowniki.KSS_SlwTyp in (8224))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStaSlowniki) [KadrSlowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KadrSlownikiAlias3_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KadrSlownikiAlias3_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KadrSlownikiAlias3_DeleteHandler
  ON CDN.KadrSlowniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStanowiska
    IF EXISTS
       ( SELECT * FROM CDN.KadrStanowiska JOIN deleted
          ON
                deleted.KSl_Id = CDN.KadrStanowiska.KSt_Branza
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStanowiska) [KadrSlownikiAlias3_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KadrSlownikiAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KadrSlownikiAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KadrSlownikiAlias1_DeleteHandler
  ON CDN.KadrSlowniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoWyksztalcenie
    IF EXISTS
       ( SELECT * FROM CDN.OsoWyksztalcenie JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoWyksztalcenie.OsW_Kierunek
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoWyksztalcenie) [KadrSlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoUmowy.OsU_PrzyczynaRozwUm
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoUmowy) [KadrSlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoKompetencje
    IF EXISTS
       ( SELECT * FROM CDN.OsoKompetencje JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoKompetencje.OsK_StopienZnajomosci
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoKompetencje) [KadrSlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStanowiska
    IF EXISTS
       ( SELECT * FROM CDN.KadrStanowiska JOIN deleted
          ON
                deleted.KSl_Id = CDN.KadrStanowiska.KSt_Specjalizacja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStanowiska) [KadrSlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStaSlowniki
    IF EXISTS
       ( SELECT * FROM CDN.KadrStaSlowniki JOIN deleted
          ON
                deleted.KSl_Id = CDN.KadrStaSlowniki.KSS_ZakresZnajomosci
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStaSlowniki) [KadrSlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoKompZakres
    IF EXISTS
       ( SELECT * FROM CDN.OsoKompZakres JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoKompZakres.OKZ_StopienZnajomosci
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoKompZakres) [KadrSlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KadrSlownikiAlias2_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KadrSlownikiAlias2_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KadrSlownikiAlias2_DeleteHandler
  ON CDN.KadrSlowniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoKompetencje
    IF EXISTS
       ( SELECT * FROM CDN.OsoKompetencje JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoKompetencje.OsK_KSLId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoKompetencje) [KadrSlownikiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.KSl_Id = CDN.OsoUmowy.OsU_TytulUmowy
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoUmowy) [KadrSlownikiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStanowiska
    IF EXISTS
       ( SELECT * FROM CDN.KadrStanowiska JOIN deleted
          ON
                deleted.KSl_Id = CDN.KadrStanowiska.KSt_Kierunek
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStanowiska) [KadrSlownikiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStaSlowniki
    IF EXISTS
       ( SELECT * FROM CDN.KadrStaSlowniki JOIN deleted
          ON
                deleted.KSl_Id = CDN.KadrStaSlowniki.KSS_StopienZnajomosci
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStaSlowniki) [KadrSlownikiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KSSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KSSPrimary */</I><BR>
ALTER TABLE CDN.KadrStaSlowniki ADD CONSTRAINT FK_KSSPrimary
 FOREIGN KEY
   (
                          KSS_KStId                         
                         )
             REFERENCES CDN.KadrStanowiska
                         (
                          KSt_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KadrStaSlowniki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KadrStaSlowniki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KadrStaSlowniki_InsertUpdateHandler
  ON CDN.KadrStaSlowniki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KSS_ZakresZnajomosci ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.KSS_ZakresZnajomosci = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.KSS_ZakresZnajomosci,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [KadrStaSlowniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSS_SlwId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KSS_SlwTyp in (8225))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.KSS_SlwId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.KSS_SlwTyp in (8225))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [KadrStaSlowniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSS_StopienZnajomosci ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.KSS_StopienZnajomosci = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.KSS_StopienZnajomosci,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [KadrStaSlowniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSS_SlwId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KSS_SlwTyp in (8224))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.KSS_SlwId = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL AND (inserted.KSS_SlwTyp in (8224))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [KadrStaSlowniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KadrStanowiska_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KadrStanowiska_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KadrStanowiska_DeleteHandler
  ON CDN.KadrStanowiska
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoKarty
    IF EXISTS
       ( SELECT * FROM CDN.OsoKarty JOIN deleted
          ON
                deleted.KSt_Id = CDN.OsoKarty.Oso_PropStanowisko
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoKarty) [KadrStanowiska_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.KSt_Id = CDN.OsoUmowy.OsU_Stanowisko
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoUmowy) [KadrStanowiska_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoHistZatrudnienia
    IF EXISTS
       ( SELECT * FROM CDN.OsoHistZatrudnienia JOIN deleted
          ON
                deleted.KSt_Id = CDN.OsoHistZatrudnienia.OHZ_OstStanowisko
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoHistZatrudnienia) [KadrStanowiska_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KSt_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14502 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KSt_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14502 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdObiektyFunkcje
    IF EXISTS(SELECT * FROM CDN.ProdObiektyFunkcje JOIN deleted
            ON 
          deleted.KSt_Id = CDN.ProdObiektyFunkcje.POF_Obiekt
      AND (CDN.ProdObiektyFunkcje.POF_OBITyp=14502)
            )
        DELETE CDN.ProdObiektyFunkcje
        FROM CDN.ProdObiektyFunkcje JOIN deleted
        ON 
          deleted.KSt_Id = CDN.ProdObiektyFunkcje.POF_Obiekt
      AND (CDN.ProdObiektyFunkcje.POF_OBITyp=14502)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KadrStanowiska_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KadrStanowiska_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KadrStanowiska_InsertUpdateHandler
  ON CDN.KadrStanowiska
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KSt_SzczegolneWarunki ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.KSt_SzczegolneWarunki = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.KSt_SzczegolneWarunki,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [KadrStanowiska_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSt_Zaszeregowania ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrZaszeregowania ON
                    inserted.KSt_Zaszeregowania = CDN.KadrZaszeregowania.KZa_Id
              WHERE CDN.KadrZaszeregowania.KZa_Id IS NULL
                AND (
                          IsNull(inserted.KSt_Zaszeregowania,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrZaszeregowania) [KadrStanowiska_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSt_WymPozWyksztalcenia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.KSt_WymPozWyksztalcenia = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.KSt_WymPozWyksztalcenia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [KadrStanowiska_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSt_Branza ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.KSt_Branza = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.KSt_Branza,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [KadrStanowiska_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSt_RodzajUmowy ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.KSt_RodzajUmowy = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.KSt_RodzajUmowy,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [KadrStanowiska_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSt_Specjalizacja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.KSt_Specjalizacja = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.KSt_Specjalizacja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [KadrStanowiska_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSt_Kierunek ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.KSt_Kierunek = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.KSt_Kierunek,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [KadrStanowiska_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KadrZaszeregowania_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KadrZaszeregowania_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KadrZaszeregowania_DeleteHandler
  ON CDN.KadrZaszeregowania
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.KZa_Id = CDN.OsoUmowy.OsU_Zaszeregowanie
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoUmowy) [KadrZaszeregowania_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStanowiska
    IF EXISTS
       ( SELECT * FROM CDN.KadrStanowiska JOIN deleted
          ON
                deleted.KZa_Id = CDN.KadrStanowiska.KSt_Zaszeregowania
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStanowiska) [KadrZaszeregowania_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KatGrupyTwr_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KatGrupyTwr_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KatGrupyTwr_DeleteHandler
  ON CDN.KatGrupyTwr
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.TwrAplikacje JOIN deleted
          ON
                deleted.KGT_Id = CDN.TwrAplikacje.TAp_WszystkoPlKategoria
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrAplikacje) [KatGrupyTwr_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KategorieCelne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KategorieCelne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KategorieCelne_InsertUpdateHandler
  ON CDN.KategorieCelne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KC_Kraj ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KrajeCelne ON
                    inserted.KC_Kraj = CDN.KrajeCelne.KPC_Kod
              WHERE CDN.KrajeCelne.KPC_Kod IS NULL
                AND (
                          IsNull(inserted.KC_Kraj,'') &lt;&gt; ''          -- Jeżeli pola mają wartości NULL lub '' to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KrajeCelne) [KategorieCelne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KPKParamKateg"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KPKParamKateg */</I><BR>
ALTER TABLE CDN.KgtParametryKategorii ADD CONSTRAINT FK_KPKParamKateg
 FOREIGN KEY
   (
                          KPK_KategoriaId                   
                         )
             REFERENCES CDN.KatGrupyTwr
                         (
                          KGT_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KPKParam"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KPKParam */</I><BR>
ALTER TABLE CDN.KgtParametryKategorii ADD CONSTRAINT FK_KPKParam
 FOREIGN KEY
   (
                          KPK_ParametrId                    
                         )
             REFERENCES CDN.KgtParametr
                         (
                          KPar_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KSPKSlown"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KSPKSlown */</I><BR>
ALTER TABLE CDN.KgtSlownikiParametruKategorii ADD CONSTRAINT FK_KSPKSlown
 FOREIGN KEY
   (
                          KSPK_SlownikId                     
                         )
             REFERENCES CDN.KgtSlownik
                         (
                          KSlo_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KSPKSlownParamKateg"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KSPKSlownParamKateg */</I><BR>
ALTER TABLE CDN.KgtSlownikiParametruKategorii ADD CONSTRAINT FK_KSPKSlownParamKateg
 FOREIGN KEY
   (
                          KSPK_ParametrKategoriiId           
                         )
             REFERENCES CDN.KgtParametryKategorii
                         (
                          KPK_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KWPTParamKategTwr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KWPTParamKategTwr */</I><BR>
ALTER TABLE CDN.KgtWartoscParametrDlaTowaru ADD CONSTRAINT FK_KWPTParamKategTwr
 FOREIGN KEY
   (
                          KWPT_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KWPTParamKateg"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KWPTParamKateg */</I><BR>
ALTER TABLE CDN.KgtWartoscParametrDlaTowaru ADD CONSTRAINT FK_KWPTParamKateg
 FOREIGN KEY
   (
                          KWPT_ParametrKategoriiId           
                         )
             REFERENCES CDN.KgtParametryKategorii
                         (
                          KPK_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KGEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KGEPrimary */</I><BR>
ALTER TABLE CDN.KksGrupyElem ADD CONSTRAINT FK_KGEPrimary
 FOREIGN KEY
   (
                          KGE_KGNID                         
                         )
             REFERENCES CDN.KksGrupyNag
                         (
                          KGN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KLENazwa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KLENazwa */</I><BR>
ALTER TABLE CDN.KluczeElem ADD CONSTRAINT FK_KLENazwa
 FOREIGN KEY
   (
                          KLE_KLNID                         
                         )
             REFERENCES CDN.KluczeNag
                         (
                          KLN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KluczeNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KluczeNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KluczeNag_DeleteHandler
  ON CDN.KluczeNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KsoElem
    IF EXISTS
       ( SELECT * FROM CDN.KsoElem JOIN deleted
          ON
                deleted.KLN_ID = CDN.KsoElem.KSE_KLNID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KsoElem) [KluczeNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KLPNazwa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KLPNazwa */</I><BR>
ALTER TABLE CDN.KluczeParametry ADD CONSTRAINT FK_KLPNazwa
 FOREIGN KEY
   (
                          KLP_KLNID                         
                         )
             REFERENCES CDN.KluczeNag
                         (
                          KLN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KmStawki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KmStawki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KmStawki_InsertUpdateHandler
  ON CDN.KmStawki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KmS_SlwId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.KmS_SlwId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.KmS_SlwId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [KmStawki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KKRKodP"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KKRKodP */</I><BR>
ALTER TABLE CDN.KnPRejony ADD CONSTRAINT FK_KKRKodP
 FOREIGN KEY
   (
                          KKR_KnPId                         
                         )
             REFERENCES CDN.KntKody
                         (
                          KnP_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KKRRejon"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KKRRejon */</I><BR>
ALTER TABLE CDN.KnPRejony ADD CONSTRAINT FK_KKRRejon
 FOREIGN KEY
   (
                          KKR_Rejon                         
                         )
             REFERENCES CDN.Rejony
                         (
                          REJ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntAdresy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntAdresy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntAdresy_DeleteHandler
  ON CDN.KntAdresy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.UmwNag.UmN_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekDokumenty
    IF EXISTS
       ( SELECT * FROM CDN.SekDokumenty JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.SekDokumenty.SDD_NadawcaAdrNumer
       AND (CDN.SekDokumenty.SDD_NadawcaAdrTyp in (864,896))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SekDokumenty) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.CRMWizytyNag.CWN_KnANumer
       AND (CDN.CRMWizytyNag.CWN_KnATyp=864 or CDN.CRMWizytyNag.CWN_KnATyp=896)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklNag
    IF EXISTS
       ( SELECT * FROM CDN.ReklNag JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.ReklNag.RLN_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ReklNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.SrwZlcNag.SZN_KnATyp
            AND deleted.KnA_GIDNumer = CDN.SrwZlcNag.SZN_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.CRMKntEtapy.CEK_KnATyp
            AND deleted.KnA_GIDNumer = CDN.CRMKntEtapy.CEK_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMKntEtapy) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TrasyElem
    IF EXISTS
       ( SELECT * FROM CDN.TrasyElem JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.TrasyElem.TsE_KntATyp
            AND deleted.KnA_GIDNumer = CDN.TrasyElem.TsE_KntANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TrasyElem) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WysPaczki
    IF EXISTS
       ( SELECT * FROM CDN.WysPaczki JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.WysPaczki.WyP_KnATyp
            AND deleted.KnA_GIDNumer = CDN.WysPaczki.WyP_KnANumer
       AND (CDN.WysPaczki.Wyp_KnATyp=864 or CDN.WysPaczki.Wyp_KnATyp=896)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WysPaczki) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.SadNag.SaN_KnATyp
            AND deleted.KnA_GIDNumer = CDN.SadNag.SaN_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.ImpNag.ImN_KnATyp
            AND deleted.KnA_GIDNumer = CDN.ImpNag.ImN_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TKNag
    IF EXISTS
       ( SELECT * FROM CDN.TKNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.TKNag.TKN_KnATyp
            AND deleted.KnA_GIDNumer = CDN.TKNag.TKN_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TKNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.ZamNag.ZaN_KnATyp
            AND deleted.KnA_GIDNumer = CDN.ZamNag.ZaN_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagNag
    IF EXISTS
       ( SELECT * FROM CDN.MagNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.MagNag.MaN_KnATyp
            AND deleted.KnA_GIDNumer = CDN.MagNag.MaN_KnANumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.TraNag.TrN_KnANumer
            AND deleted.KnA_GIDTyp = CDN.TraNag.TrN_KnATyp
       AND (exists (select * from CDN.KntKarty where Knt_GIDNumer = deleted.KnA_KntNumer and Knt_GIDNumer = CDN.TraNag.TrN_KntNumer))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Sent
    IF EXISTS
       ( SELECT * FROM CDN.Sent JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.Sent.SnT_KnaGidNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Sent) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOAdministratorzy
    IF EXISTS
       ( SELECT * FROM CDN.PDOAdministratorzy JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.PDOAdministratorzy.PDOA_AdrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDOAdministratorzy) [KntAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KnA_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KnA_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( CDN.Atrybuty.Atr_OBITyp=864 or CDN.Atrybuty.Atr_OBITyp=896)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KnA_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KnA_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( CDN.Atrybuty.Atr_OBITyp=864 or CDN.Atrybuty.Atr_OBITyp=896)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.KnA_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.KnA_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=864 or CDN.AtrybutyHist.Ath_OBITyp=896)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.KnA_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.KnA_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=864 or CDN.AtrybutyHist.Ath_OBITyp=896)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntOsoby
    IF EXISTS(SELECT * FROM CDN.KntOsoby JOIN deleted
            ON 
          deleted.KnA_GIDNumer = CDN.KntOsoby.KnS_AdresId
            )
        DELETE CDN.KntOsoby
        FROM CDN.KntOsoby JOIN deleted
        ON 
          deleted.KnA_GIDNumer = CDN.KntOsoby.KnS_AdresId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.KnA_GIDNumer = CDN.PDOCzynnosci.PDOC_AdminAdr
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.KnA_GIDNumer = CDN.PDOCzynnosci.PDOC_AdminAdr
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RachunkiBankowe
    IF EXISTS(SELECT * FROM CDN.RachunkiBankowe JOIN deleted
            ON 
          deleted.KnA_GIDNumer = CDN.RachunkiBankowe.RkB_KntAdres
            )
        DELETE CDN.RachunkiBankowe
        FROM CDN.RachunkiBankowe JOIN deleted
        ON 
          deleted.KnA_GIDNumer = CDN.RachunkiBankowe.RkB_KntAdres
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntAdresy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntAdresy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntAdresy_InsertUpdateHandler
  ON CDN.KntAdresy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KnA_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KnA_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KnA_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KnA_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntAdresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KnA_BnkNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.KnA_BnkNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KnA_BnkNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [KntAdresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntAdresyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntAdresyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntAdresyAlias_DeleteHandler
  ON CDN.KntAdresy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.UmwNag.UmN_AdWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [KntAdresyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.SrwZlcNag.SZN_AdWTyp
            AND deleted.KnA_GIDNumer = CDN.SrwZlcNag.SZN_AdWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [KntAdresyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.ImpNag.ImN_AdwTyp
            AND deleted.KnA_GIDNumer = CDN.ImpNag.ImN_AdwNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [KntAdresyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.SadNag.SaN_KnAZTyp
            AND deleted.KnA_GIDNumer = CDN.SadNag.SaN_KnAZNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntAdresyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.KnA_GIDTyp = CDN.ZamNag.ZaN_AdWTyp
            AND deleted.KnA_GIDNumer = CDN.ZamNag.ZaN_AdWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [KntAdresyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.TraNag.TrN_AdWNumer
            AND deleted.KnA_GIDTyp = CDN.TraNag.TrN_AdWTyp
       AND (exists (select * from CDN.KntKarty where Knt_GIDNumer = deleted.KnA_KntNumer and Knt_GIDNumer = CDN.TraNag.TrN_KnDNumer))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [KntAdresyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.KnA_GIDNumer = CDN.PDOCzynnosci.PDOC_PrzedstAdr
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.KnA_GIDNumer = CDN.PDOCzynnosci.PDOC_PrzedstAdr
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntAdresyAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntAdresyAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntAdresyAlias1_DeleteHandler
  ON CDN.KntAdresy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.KnA_GIDNumer = CDN.SadNag.SaN_DstAdres
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntAdresyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.KnA_GIDNumer = CDN.PDOCzynnosci.PDOC_InspAdr
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.KnA_GIDNumer = CDN.PDOCzynnosci.PDOC_InspAdr
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntAplikacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntAplikacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntAplikacje_InsertUpdateHandler
  ON CDN.KntAplikacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KAp_MagMSNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.KAp_MagMSNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KAp_MagMSNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [KntAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAp_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.KAp_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KAp_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [KntAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAp_KntTyp )  OR UPDATE( KAp_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KAp_KntTyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntWzorce ON
                    inserted.KAp_KntTyp = CDN.KntWzorce.KnW_GrpTyp
                AND inserted.KAp_KntNumer = CDN.KntWzorce.KnW_GrpNumer
              WHERE CDN.KntWzorce.KnW_GrpNumer IS NULL AND (inserted.KAp_KntTyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntWzorce) [KntAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAp_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KAp_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KAp_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KAp_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAp_KntTyp )  OR UPDATE( KAp_KntNumer )  OR UPDATE( KAp_MagMSNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KAp_MagMSNumer&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntMagazyny ON
                    inserted.KAp_KntTyp = CDN.KntMagazyny.KnM_KntTyp
                AND inserted.KAp_KntNumer = CDN.KntMagazyny.KnM_KntNumer
                AND inserted.KAp_MagMSNumer = CDN.KntMagazyny.KnM_MagNumer
              WHERE CDN.KntMagazyny.KnM_MagNumer IS NULL AND (inserted.KAp_MagMSNumer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntMagazyny) [KntAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAp_KntTyp )  OR UPDATE( KAp_KntNumer )  OR UPDATE( KAp_MagNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KAp_MagNumer&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntMagazyny ON
                    inserted.KAp_KntTyp = CDN.KntMagazyny.KnM_KntTyp
                AND inserted.KAp_KntNumer = CDN.KntMagazyny.KnM_KntNumer
                AND inserted.KAp_MagNumer = CDN.KntMagazyny.KnM_MagNumer
              WHERE CDN.KntMagazyny.KnM_MagNumer IS NULL AND (inserted.KAp_MagNumer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntMagazyny) [KntAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAp_OpeNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.KAp_OpeNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KAp_OpeNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [KntAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAp_OpeONumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.KAp_OpeONumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KAp_OpeONumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [KntAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KObKnt"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KObKnt */</I><BR>
ALTER TABLE CDN.KntAplikacjeObiekty ADD CONSTRAINT FK_KObKnt
 FOREIGN KEY
   (
                          KOb_KntNumer                      ,
                          KOb_KntTyp                        
                         )
             REFERENCES CDN.KntAplikacje
                         (
                          KAp_KntNumer   ,
                          KAp_KntTyp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntAplikacjeObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntAplikacjeObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntAplikacjeObiekty_InsertUpdateHandler
  ON CDN.KntAplikacjeObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KOb_ObiTyp )  OR UPDATE( KOb_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KOb_ObiTyp=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupyDom ON
                    inserted.KOb_ObiTyp = CDN.TwrGrupyDom.TGD_GIDTyp
                AND inserted.KOb_ObiNumer = CDN.TwrGrupyDom.TGD_GIDNumer
              WHERE CDN.TwrGrupyDom.TGD_GIDNumer IS NULL AND (inserted.KOb_ObiTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupyDom) [KntAplikacjeObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntGrupy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntGrupy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntGrupy_DeleteHandler
  ON CDN.KntGrupy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.KnG_GIDTyp = CDN.FrmStruktura.FRS_DetKnGTyp
            AND deleted.KnG_GIDNumer = CDN.FrmStruktura.FRS_DetKnGNumer
       AND (CDN.FrmStruktura.FRS_DetKnGTyp=-32 and CDN.FrmStruktura.FRS_DetKnGNumer&lt;&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [KntGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.NtsKnt
    IF EXISTS
       ( SELECT * FROM CDN.NtsKnt JOIN deleted
          ON
                deleted.KnG_GIDTyp = CDN.NtsKnt.NtK_KntTyp
            AND deleted.KnG_GIDNumer = CDN.NtsKnt.NtK_KntNumer
       AND (CDN.NtsKnt.NtK_KntTyp=-32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą NtsKnt) [KntGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanSprzedazyKnt
    IF EXISTS(SELECT * FROM CDN.PlanSprzedazyKnt JOIN deleted
            ON 
          deleted.KnG_GIDTyp = CDN.PlanSprzedazyKnt.PSK_KntTyp
      AND deleted.KnG_GIDNumer = CDN.PlanSprzedazyKnt.PSK_KntNumer
      AND (CDN.PlanSprzedazyKnt.PSK_KntTyp&lt;0)
            )
        DELETE CDN.PlanSprzedazyKnt
        FROM CDN.PlanSprzedazyKnt JOIN deleted
        ON 
          deleted.KnG_GIDTyp = CDN.PlanSprzedazyKnt.PSK_KntTyp
      AND deleted.KnG_GIDNumer = CDN.PlanSprzedazyKnt.PSK_KntNumer
      AND (CDN.PlanSprzedazyKnt.PSK_KntTyp&lt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntPromocje
    IF EXISTS(SELECT * FROM CDN.KntPromocje JOIN deleted
            ON 
          deleted.KnG_GIDTyp = CDN.KntPromocje.KPR_KntTyp
      AND deleted.KnG_GIDNumer = CDN.KntPromocje.KPR_KntNumer
      AND (CDN.KntPromocje.KPR_KntTyp&lt;0 AND CDN.KntPromocje.KPR_KntNumer&lt;&gt;0)
            )
        DELETE CDN.KntPromocje
        FROM CDN.KntPromocje JOIN deleted
        ON 
          deleted.KnG_GIDTyp = CDN.KntPromocje.KPR_KntTyp
      AND deleted.KnG_GIDNumer = CDN.KntPromocje.KPR_KntNumer
      AND (CDN.KntPromocje.KPR_KntTyp&lt;0 AND CDN.KntPromocje.KPR_KntNumer&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroOdbiorcy
    IF EXISTS(SELECT * FROM CDN.RetroOdbiorcy JOIN deleted
            ON 
          deleted.KnG_GIDNumer = CDN.RetroOdbiorcy.RtO_KntNumer
      AND deleted.KnG_GIDTyp = CDN.RetroOdbiorcy.RtO_KntTyp
      AND (CDN.RetroOdbiorcy.RtO_KntTyp&lt;0 AND CDN.RetroOdbiorcy.RtO_KntNumer&lt;&gt;0)
            )
        DELETE CDN.RetroOdbiorcy
        FROM CDN.RetroOdbiorcy JOIN deleted
        ON 
          deleted.KnG_GIDNumer = CDN.RetroOdbiorcy.RtO_KntNumer
      AND deleted.KnG_GIDTyp = CDN.RetroOdbiorcy.RtO_KntTyp
      AND (CDN.RetroOdbiorcy.RtO_KntTyp&lt;0 AND CDN.RetroOdbiorcy.RtO_KntNumer&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroKontrahenci
    IF EXISTS(SELECT * FROM CDN.RetroKontrahenci JOIN deleted
            ON 
          deleted.KnG_GIDNumer = CDN.RetroKontrahenci.RKt_KntNumer
      AND deleted.KnG_GIDTyp = CDN.RetroKontrahenci.RKt_KntTyp
      AND (CDN.RetroKontrahenci.RKt_KntTyp=-32)
            )
        DELETE CDN.RetroKontrahenci
        FROM CDN.RetroKontrahenci JOIN deleted
        ON 
          deleted.KnG_GIDNumer = CDN.RetroKontrahenci.RKt_KntNumer
      AND deleted.KnG_GIDTyp = CDN.RetroKontrahenci.RKt_KntTyp
      AND (CDN.RetroKontrahenci.RKt_KntTyp=-32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroKntOkresy
    IF EXISTS(SELECT * FROM CDN.RetroKntOkresy JOIN deleted
            ON 
          deleted.KnG_GIDNumer = CDN.RetroKntOkresy.RKO_KntNumer
      AND deleted.KnG_GIDTyp = CDN.RetroKntOkresy.RKO_KntTyp
      AND (CDN.RetroKntOkresy.RKO_KntTyp=-32)
            )
        DELETE CDN.RetroKntOkresy
        FROM CDN.RetroKntOkresy JOIN deleted
        ON 
          deleted.KnG_GIDNumer = CDN.RetroKntOkresy.RKO_KntNumer
      AND deleted.KnG_GIDTyp = CDN.RetroKntOkresy.RKO_KntTyp
      AND (CDN.RetroKntOkresy.RKO_KntTyp=-32)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntGrupy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntGrupy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntGrupy_InsertUpdateHandler
  ON CDN.KntGrupy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KnG_GIDTyp )  OR UPDATE( KnG_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KnG_GIDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KnG_GIDTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.KnG_GIDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KnG_GIDTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntGrupy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntGrupyDom_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntGrupyDom_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntGrupyDom_DeleteHandler
  ON CDN.KntGrupyDom
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntLimityK
    IF EXISTS(SELECT * FROM CDN.KntLimityK JOIN deleted
            ON 
          deleted.KGD_GIDTyp = CDN.KntLimityK.KLK_KntTyp
      AND deleted.KGD_GIDNumer = CDN.KntLimityK.KLK_KntNumer
      AND (deleted.KGD_GIDNumer&lt;&gt;0)
            )
        DELETE CDN.KntLimityK
        FROM CDN.KntLimityK JOIN deleted
        ON 
          deleted.KGD_GIDTyp = CDN.KntLimityK.KLK_KntTyp
      AND deleted.KGD_GIDNumer = CDN.KntLimityK.KLK_KntNumer
      AND (deleted.KGD_GIDNumer&lt;&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKarty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKarty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntKarty_DeleteHandler
  ON CDN.KntKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyRptTwr
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyRptTwr JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.CRMWizytyRptTwr.CWT_KntTyp
            AND deleted.Knt_GIDNumer = CDN.CRMWizytyRptTwr.CWT_KntNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyRptTwr) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwPlanPrzegladu
    IF EXISTS
       ( SELECT * FROM CDN.SrwPlanPrzegladu JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.SrwPlanPrzegladu.SPP_KntTyp
            AND deleted.Knt_GIDNumer = CDN.SrwPlanPrzegladu.SPP_KntNumer
            
       AND (CDN.SrwPlanPrzegladu.SPP_KntTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta, ponieważ występuje on na planie przeglądu technicznego./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.UmwNag.UmN_PodNumer
            
       AND (CDN.UmwNag.UmN_PodTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie kontrahenta nie jest możliwe. Kontrahent jest podmiotem dokumentu umowy./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecElem
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdZlecElem.PZE_KntNumer
            
       AND (CDN.ProdZlecElem.PZE_KntTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony na pozycji zlecenia produkcyjnego./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmlNag
    IF EXISTS
       ( SELECT * FROM CDN.UmlNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.UmlNag.ULN_PodmFinansNumer
       AND (CDN.UmlNag.ULN_PodmFinansTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmlNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.KntKarty.Knt_KnCNumer
            AND deleted.Knt_GIDTyp = CDN.KntKarty.Knt_KnCTyp
            
       AND (CDN.KntKarty.Knt_KnCTyp=32 AND CDN.KntKarty.Knt_KnCNumer &lt;&gt; 0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Usuwany kontrahent jest ustawiony jako centrala dla innych kontrahentów./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.WydatkiPracownikow.WPR_KntNumer
            AND deleted.Knt_GIDTyp = CDN.WydatkiPracownikow.WPR_KntTyp
       AND (  CDN.WydatkiPracownikow.WPR_KntTyp = 32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WydatkiPracownikow) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.CRMWizytyNag.CWN_KntNumer
       AND (CDN.CRMWizytyNag.CWN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklNag
    IF EXISTS
       ( SELECT * FROM CDN.ReklNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ReklNag.RLN_KntNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest wybrany na reklamacji./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PrjStruktura
    IF EXISTS
       ( SELECT * FROM CDN.PrjStruktura JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.PrjStruktura.PRJ_KntNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest wybrany na projekcie./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.SrwZlcNag.SZN_KntTyp
            AND deleted.Knt_GIDNumer = CDN.SrwZlcNag.SZN_KntNumer
       AND (CDN.SrwZlcNag.SZN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzWlasc
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzWlasc JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrwUrzWlasc.SUW_WlaNumer
       AND (CDN.SrwUrzWlasc.SUW_WlaTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwUrzWlasc) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMSrsKontrahenci
    IF EXISTS
       ( SELECT * FROM CDN.CRMSrsKontrahenci JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.CRMSrsKontrahenci.CSK_KnSNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Zarejestrowano konwersacje z kontrahentem./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BstNag
    IF EXISTS
       ( SELECT * FROM CDN.BstNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.BstNag.BsN_KntNumer
       AND (CDN.BstNag.BsN_KntNumer&gt;=0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BstNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Samochody
    IF EXISTS
       ( SELECT * FROM CDN.Samochody JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Samochody.SaM_KntNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Samochody) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TrasyNag
    IF EXISTS
       ( SELECT * FROM CDN.TrasyNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TrasyNag.TsN_KntNumer
       AND (CDN.TrasyNag.TsN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TrasyNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecenia JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdZlecenia.PZL_KntNumer
            
       AND (CDN.ProdZlecenia.PZL_KntTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony na zleceniu produkcyjnym./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiekty JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdObiekty.POB_ObiNumer
       AND (CDN.ProdObiekty.POB_ObiTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiekty) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologia
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologia JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdTechnologia.PTE_KntNumer
            
       AND (CDN.ProdTechnologia.PTE_KntTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony na technologii./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.NtsKnt
    IF EXISTS
       ( SELECT * FROM CDN.NtsKnt JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.NtsKnt.NtK_KntTyp
            AND deleted.Knt_GIDNumer = CDN.NtsKnt.NtK_KntNumer
       AND (CDN.NtsKnt.NtK_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą NtsKnt) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.IstNag
    IF EXISTS
       ( SELECT * FROM CDN.IstNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.IstNag.IsN_KntNumer
       AND (CDN.IstNag.IsN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą IstNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Firma
    IF EXISTS
       ( SELECT * FROM CDN.Firma JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Firma.Frm_KntNumer
       AND (CDN.Firma.Frm_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Firma) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UpoNag
    IF EXISTS
       ( SELECT * FROM CDN.UpoNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.UpoNag.UPN_KNTNumer
       AND (CDN.UpoNag.UPN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UpoNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtHistElem
    IF EXISTS
       ( SELECT * FROM CDN.SrtHistElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrtHistElem.SHE_KnDNumer
       AND (CDN.SrtHistElem.SHE_KnDTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtHistElem) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wysylki
    IF EXISTS
       ( SELECT * FROM CDN.Wysylki JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Wysylki.WYS_SpeNumer
       AND (CDN.Wysylki.Wys_SpeTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wysylki) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtKarty
    IF EXISTS
       ( SELECT * FROM CDN.SrtKarty JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrtKarty.Srt_KnDNumer
       AND (CDN.SrtKarty.Srt_KnDTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtKarty) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNPlanyNag
    IF EXISTS
       ( SELECT * FROM CDN.ZRNPlanyNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZRNPlanyNag.ZPN_KntNumer
       AND (CDN.ZRNPlanyNag.ZPN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNPlanyNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZlcRemNag.ZRN_KNTNumer
       AND (CDN.ZlcRemNag.ZRN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsObiekty
    IF EXISTS
       ( SELECT * FROM CDN.SrsObiekty JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrsObiekty.SOb_KntNumer
       AND (CDN.SrsObiekty.Sob_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsObiekty) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemElem
    IF EXISTS
       ( SELECT * FROM CDN.MemElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.MemElem.MEE_KNTNumer
       AND (CDN.MemElem.MEE_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemElem) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemNag
    IF EXISTS
       ( SELECT * FROM CDN.MemNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.MemNag.MEN_KNTNumer
       AND (CDN.MemNag.MEN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SadNag.SaN_PdmNumer
       AND (CDN.SadNag.SaN_PdmTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Magazyny
    IF EXISTS
       ( SELECT * FROM CDN.Magazyny JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Magazyny.Mag_KntNumer
       AND (CDN.Magazyny.Mag_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Magazyny) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcElem
    IF EXISTS
       ( SELECT * FROM CDN.ZlcElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZlcElem.ZcE_KntNumer
       AND (CDN.ZlcElem.ZcE_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcElem) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZlcNag.ZcN_KntNumer
       AND (CDN.ZlcNag.ZcN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.CRMKntEtapy.CEK_KntNumer
            
       AND (CDN.CRMKntEtapy.CEK_KntTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest obecny w etapie kampanii CRM./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ImpNag.ImN_KntNumer
       AND (CDN.ImpNag.ImN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TKNag
    IF EXISTS
       ( SELECT * FROM CDN.TKNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TKNag.TKN_KntNumer
       AND (CDN.TKNag.TKN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TKNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Konta
    IF EXISTS
       ( SELECT * FROM CDN.Konta JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Konta.KKS_KNTNumer
       AND (CDN.Konta.KKS_KNTTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Konta) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsNag
    IF EXISTS
       ( SELECT * FROM CDN.SrsNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrsNag.SsN_KntNumer
            
       AND (CDN.SrsNag.SsN_KntTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Zarejestrowano konwersacje z kontrahentem./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntTowary
    IF EXISTS
       ( SELECT * FROM CDN.KntTowary JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.KntTowary.KTw_KntNumer
       AND (CDN.KntTowary.KTw_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntTowary) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagNag
    IF EXISTS
       ( SELECT * FROM CDN.MagNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.MagNag.MaN_KntNumer
       AND (CDN.MagNag.MaN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rezerwacje
    IF EXISTS
       ( SELECT * FROM CDN.Rezerwacje JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Rezerwacje.Rez_KntNumer
       AND (CDN.Rezerwacje.Rez_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rezerwacje) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZamNag.ZaN_KntNumer
       AND (CDN.ZamNag.ZaN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TraNag.TrN_KntNumer
       AND (CDN.TraNag.TrN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Zapisy
    IF EXISTS
       ( SELECT * FROM CDN.Zapisy JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Zapisy.KAZ_KNTNumer
       AND (CDN.Zapisy.KAZ_KNTTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Zapisy) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraPlat
    IF EXISTS
       ( SELECT * FROM CDN.TraPlat JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TraPlat.TrP_KntNumer
       AND (CDN.TraPlat.TRP_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraPlat) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrWzDst
    IF EXISTS
       ( SELECT * FROM CDN.TwrWzDst JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TwrWzDst.WTD_KntNumer
       AND (CDN.TwrWzDst.WTD_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrWzDst) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrDost
    IF EXISTS
       ( SELECT * FROM CDN.TwrDost JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TwrDost.TWD_KntNumer
       AND (CDN.TwrDost.TWD_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrDost) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjNag
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.BudzetPrjNag.BPN_KntNumer
       AND (CDN.BudzetPrjNag.BPN_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BudzetPrjNag) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjElem
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.BudzetPrjElem.BPE_KntNumer
       AND (CDN.BudzetPrjElem.BPE_KntTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BudzetPrjElem) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Sent
    IF EXISTS
       ( SELECT * FROM CDN.Sent JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Sent.SnT_KntGidNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Sent) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOUpowaznienia
    IF EXISTS
       ( SELECT * FROM CDN.PDOUpowaznienia JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.PDOUpowaznienia.PDOU_ObiNumer
       AND (CDN.PDOUpowaznienia.PDOU_ObiTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDOUpowaznienia) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDONaruszenia
    IF EXISTS
       ( SELECT * FROM CDN.PDONaruszenia JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.PDONaruszenia.PDON_InsNumer
            
       AND (CDN.PDONaruszenia.PDON_InsTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest obecny na karcie naruszeń przetwarzania danych osobowych./# [KntKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdNadzlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdNadzlecenia JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdNadzlecenia.PNZ_KntNumer
       AND (CDN.ProdNadzlecenia.PNZ_KntTyp = 32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdNadzlecenia) [KntKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntAplikacje
    IF EXISTS(SELECT * FROM CDN.KntAplikacje JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntAplikacje.KAp_KntNumer
      AND (CDN.KntAplikacje.KAp_KntTyp=32)
            )
        DELETE CDN.KntAplikacje
        FROM CDN.KntAplikacje JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntAplikacje.KAp_KntNumer
      AND (CDN.KntAplikacje.KAp_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntMagazyny
    IF EXISTS(SELECT * FROM CDN.KntMagazyny JOIN deleted
            ON 
          deleted.Knt_GIDTyp = CDN.KntMagazyny.KnM_KntTyp
      AND deleted.Knt_GIDNumer = CDN.KntMagazyny.KnM_KntNumer
      AND (CDN.KntMagazyny.KnM_KntTyp=32)
            )
        DELETE CDN.KntMagazyny
        FROM CDN.KntMagazyny JOIN deleted
        ON 
          deleted.Knt_GIDTyp = CDN.KntMagazyny.KnM_KntTyp
      AND deleted.Knt_GIDNumer = CDN.KntMagazyny.KnM_KntNumer
      AND (CDN.KntMagazyny.KnM_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.NumeryRachunkow
    IF EXISTS(SELECT * FROM CDN.NumeryRachunkow JOIN deleted
            ON 
          deleted.Knt_GIDTyp = CDN.NumeryRachunkow.NRB_ObTyp
      AND deleted.Knt_GIDNumer = CDN.NumeryRachunkow.NRB_ObNumer
      AND (CDN.NumeryRachunkow.NrB_ObTyp=32)
            )
        DELETE CDN.NumeryRachunkow
        FROM CDN.NumeryRachunkow JOIN deleted
        ON 
          deleted.Knt_GIDTyp = CDN.NumeryRachunkow.NRB_ObTyp
      AND deleted.Knt_GIDNumer = CDN.NumeryRachunkow.NRB_ObNumer
      AND (CDN.NumeryRachunkow.NrB_ObTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntKoncesje
    IF EXISTS(SELECT * FROM CDN.KntKoncesje JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntKoncesje.KKo_KntNumer
      AND (CDN.KntKoncesje.KKo_KntTyp=32)
            )
        DELETE CDN.KntKoncesje
        FROM CDN.KntKoncesje JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntKoncesje.KKo_KntNumer
      AND (CDN.KntKoncesje.KKo_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntOpiekun
    IF EXISTS(SELECT * FROM CDN.KntOpiekun JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntOpiekun.KtO_KntNumer
      AND (CDN.KntOpiekun.KtO_KntTyp=32)
            )
        DELETE CDN.KntOpiekun
        FROM CDN.KntOpiekun JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntOpiekun.KtO_KntNumer
      AND (CDN.KntOpiekun.KtO_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanSprzedazyKnt
    IF EXISTS(SELECT * FROM CDN.PlanSprzedazyKnt JOIN deleted
            ON 
          deleted.Knt_GIDTyp = CDN.PlanSprzedazyKnt.PSK_KntTyp
      AND deleted.Knt_GIDNumer = CDN.PlanSprzedazyKnt.PSK_KntNumer
      AND (CDN.PlanSprzedazyKnt.PSK_KntTyp&gt;0)
            )
        DELETE CDN.PlanSprzedazyKnt
        FROM CDN.PlanSprzedazyKnt JOIN deleted
        ON 
          deleted.Knt_GIDTyp = CDN.PlanSprzedazyKnt.PSK_KntTyp
      AND deleted.Knt_GIDNumer = CDN.PlanSprzedazyKnt.PSK_KntNumer
      AND (CDN.PlanSprzedazyKnt.PSK_KntTyp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=32)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntKonta
    IF EXISTS(SELECT * FROM CDN.KntKonta JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntKonta.KKT_KntNumer
      AND (CDN.KntKonta.KKT_KntTyp=32)
            )
        DELETE CDN.KntKonta
        FROM CDN.KntKonta JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntKonta.KKT_KntNumer
      AND (CDN.KntKonta.KKT_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntPromocje
    IF EXISTS(SELECT * FROM CDN.KntPromocje JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntPromocje.KPR_KntNumer
      AND (CDN.KntPromocje.KPR_KntTyp&gt;0)
            )
        DELETE CDN.KntPromocje
        FROM CDN.KntPromocje JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntPromocje.KPR_KntNumer
      AND (CDN.KntPromocje.KPR_KntTyp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=32 AND CDN.Atrybuty.Atr_OBISubLp=0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=32 AND CDN.Atrybuty.Atr_OBISubLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntLimityS
    IF EXISTS(SELECT * FROM CDN.KntLimityS JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntLimityS.KLS_KntNumer
      AND (CDN.KntLimityS.KLS_KntTyp=32)
            )
        DELETE CDN.KntLimityS
        FROM CDN.KntLimityS JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntLimityS.KLS_KntNumer
      AND (CDN.KntLimityS.KLS_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Odsetki
    IF EXISTS(SELECT * FROM CDN.Odsetki JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.Odsetki.ODS_GIDNumer
      AND (CDN.Odsetki.ODS_GIDTyp=32)
            )
        DELETE CDN.Odsetki
        FROM CDN.Odsetki JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.Odsetki.ODS_GIDNumer
      AND (CDN.Odsetki.ODS_GIDTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntGrupy
    IF EXISTS(SELECT * FROM CDN.KntGrupy JOIN deleted
            ON 
          deleted.Knt_GIDTyp = CDN.KntGrupy.KnG_GIDTyp
      AND deleted.Knt_GIDNumer = CDN.KntGrupy.KnG_GIDNumer
      AND (CDN.KntGrupy.KnG_GIDTyp=32)
            )
        DELETE CDN.KntGrupy
        FROM CDN.KntGrupy JOIN deleted
        ON 
          deleted.Knt_GIDTyp = CDN.KntGrupy.KnG_GIDTyp
      AND deleted.Knt_GIDNumer = CDN.KntGrupy.KnG_GIDNumer
      AND (CDN.KntGrupy.KnG_GIDTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntOsoby
    IF EXISTS(SELECT * FROM CDN.KntOsoby JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntOsoby.KnS_KntNumer
      AND (CDN.KntOsoby.KnS_KntTyp=32)
            )
        DELETE CDN.KntOsoby
        FROM CDN.KntOsoby JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntOsoby.KnS_KntNumer
      AND (CDN.KntOsoby.KnS_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntKontakty
    IF EXISTS(SELECT * FROM CDN.KntKontakty JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntKontakty.KnK_KntNumer
      AND (CDN.KntKontakty.KnK_KntTyp=32)
            )
        DELETE CDN.KntKontakty
        FROM CDN.KntKontakty JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntKontakty.KnK_KntNumer
      AND (CDN.KntKontakty.KnK_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntOpisy
    IF EXISTS(SELECT * FROM CDN.KntOpisy JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntOpisy.KnO_KntNumer
      AND (CDN.KntOpisy.KnO_KntTyp=32)
            )
        DELETE CDN.KntOpisy
        FROM CDN.KntOpisy JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntOpisy.KnO_KntNumer
      AND (CDN.KntOpisy.KnO_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntAdresy
    IF EXISTS(SELECT * FROM CDN.KntAdresy JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntAdresy.KnA_KntNumer
      AND (CDN.KntAdresy.KnA_KntTyp=32)
            )
        DELETE CDN.KntAdresy
        FROM CDN.KntAdresy JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntAdresy.KnA_KntNumer
      AND (CDN.KntAdresy.KnA_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=32 AND CDN.AtrybutyHist.Ath_OBISubLp=0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=32 AND CDN.AtrybutyHist.Ath_OBISubLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroOdbiorcy
    IF EXISTS(SELECT * FROM CDN.RetroOdbiorcy JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.RetroOdbiorcy.RtO_KntNumer
      AND (CDN.RetroOdbiorcy.RtO_KntTyp&gt;0)
            )
        DELETE CDN.RetroOdbiorcy
        FROM CDN.RetroOdbiorcy JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.RetroOdbiorcy.RtO_KntNumer
      AND (CDN.RetroOdbiorcy.RtO_KntTyp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroKontrahenci
    IF EXISTS(SELECT * FROM CDN.RetroKontrahenci JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.RetroKontrahenci.RKt_KntNumer
      AND (CDN.RetroKontrahenci.RKt_KntTyp=32)
            )
        DELETE CDN.RetroKontrahenci
        FROM CDN.RetroKontrahenci JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.RetroKontrahenci.RKt_KntNumer
      AND (CDN.RetroKontrahenci.RKt_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroKntOkresy
    IF EXISTS(SELECT * FROM CDN.RetroKntOkresy JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.RetroKntOkresy.RKO_KntNumer
      AND (CDN.RetroKntOkresy.RKO_KntTyp=32)
            )
        DELETE CDN.RetroKntOkresy
        FROM CDN.RetroKntOkresy JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.RetroKntOkresy.RKO_KntNumer
      AND (CDN.RetroKntOkresy.RKO_KntTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MSKntOsoby
    IF EXISTS(SELECT * FROM CDN.MSKntOsoby JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.MSKntOsoby.MSKnS_KntNumer
      AND (CDN.MSKntOsoby.MSKnS_KntTyp=32 and CDN.MSKntOsoby.MSKnS_KntLp=0)
            )
        DELETE CDN.MSKntOsoby
        FROM CDN.MSKntOsoby JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.MSKntOsoby.MSKnS_KntNumer
      AND (CDN.MSKntOsoby.MSKnS_KntTyp=32 and CDN.MSKntOsoby.MSKnS_KntLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ObiektyDomyslne
    IF EXISTS(SELECT * FROM CDN.ObiektyDomyslne JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.ObiektyDomyslne.ObD_ObiNumer
      AND (CDN.ObiektyDomyslne.ObD_ObiTyp=32)
            )
        DELETE CDN.ObiektyDomyslne
        FROM CDN.ObiektyDomyslne JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.ObiektyDomyslne.ObD_ObiNumer
      AND (CDN.ObiektyDomyslne.ObD_ObiTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrsAplikacje
    IF EXISTS(SELECT * FROM CDN.FrsAplikacje JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.FrsAplikacje.FrA_ObiNumer
      AND (CDN.FrsAplikacje.FrA_ObiTyp = 32)
            )
        DELETE CDN.FrsAplikacje
        FROM CDN.FrsAplikacje JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.FrsAplikacje.FrA_ObiNumer
      AND (CDN.FrsAplikacje.FrA_ObiTyp = 32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrmTransakcje
    IF EXISTS(SELECT * FROM CDN.PrmTransakcje JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.PrmTransakcje.PrT_KntNumer
            )
        DELETE CDN.PrmTransakcje
        FROM CDN.PrmTransakcje JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.PrmTransakcje.PrT_KntNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOAdministratorzy
    IF EXISTS(SELECT * FROM CDN.PDOAdministratorzy JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.PDOAdministratorzy.PDOA_ObiNumer
      AND (CDN.PDOAdministratorzy.PDOA_ObiTyp=32)
            )
        DELETE CDN.PDOAdministratorzy
        FROM CDN.PDOAdministratorzy JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.PDOAdministratorzy.PDOA_ObiNumer
      AND (CDN.PDOAdministratorzy.PDOA_ObiTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zgody
    IF EXISTS(SELECT * FROM CDN.Zgody JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.Zgody.Zgo_ObiNumer
      AND (CDN.Zgody.Zgo_ObiTyp = 32)
            )
        DELETE CDN.Zgody
        FROM CDN.Zgody JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.Zgody.Zgo_ObiNumer
      AND (CDN.Zgody.Zgo_ObiTyp = 32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.PDOCzynnosci.PDOC_AdminNumer
      AND (CDN.PDOCzynnosci.PDOC_AdminTyp=32)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.PDOCzynnosci.PDOC_AdminNumer
      AND (CDN.PDOCzynnosci.PDOC_AdminTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RachunkiBankowe
    IF EXISTS(SELECT * FROM CDN.RachunkiBankowe JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.RachunkiBankowe.RkB_ObiNumer
      AND (CDN.RachunkiBankowe.RkB_ObiTyp = 32)
            )
        DELETE CDN.RachunkiBankowe
        FROM CDN.RachunkiBankowe JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.RachunkiBankowe.RkB_ObiNumer
      AND (CDN.RachunkiBankowe.RkB_ObiTyp = 32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntRejestr
    IF EXISTS(SELECT * FROM CDN.KntRejestr JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.KntRejestr.KRj_ObiNumer
      AND (CDN.KntRejestr.KRj_ObiTyp = 32)
            )
        DELETE CDN.KntRejestr
        FROM CDN.KntRejestr JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.KntRejestr.KRj_ObiNumer
      AND (CDN.KntRejestr.KRj_ObiTyp = 32)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKarty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKarty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntKarty_InsertUpdateHandler
  ON CDN.KntKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Knt_RegionCRM ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejony ON
                    inserted.Knt_RegionCRM = CDN.Rejony.REJ_Id
              WHERE CDN.Rejony.REJ_Id IS NULL
                AND (
                          IsNull(inserted.Knt_RegionCRM,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejony) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Knt_KnPTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.Knt_KnPNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.Knt_KnPTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Knt_KnPTyp=32 AND inserted.Knt_KnPNumer &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Knt_KnPNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Knt_KnPTyp=32 AND inserted.Knt_KnPNumer &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Knt_AkwTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.Knt_AkwNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.Knt_AkwTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.Knt_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Knt_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_FrsID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.Knt_FrsID = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.Knt_FrsID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_KarNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.Knt_KarNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Knt_KarNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Knt_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Knt_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Knt_AkwTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_BnkNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.Knt_BnkNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Knt_BnkNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [KntKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKartyAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKartyAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntKartyAlias1_DeleteHandler
  ON CDN.KntKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.ZamNag.ZaN_KnDTyp
            AND deleted.Knt_GIDNumer = CDN.ZamNag.ZaN_KnDNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na zamówieniu./# [KntKartyAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrwZlcNag.SZN_KnPNumer
       AND (CDN.SrwZlcNag.SZN_KnPTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [KntKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ImpNag.ImN_KnPNumer
       AND (CDN.ImpNag.ImN_KnPTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [KntKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.KntKarty.Knt_KnPNumer
       AND (CDN.KntKarty.Knt_KnPTyp=32 AND CDN.KntKarty.Knt_KnPNumer &lt;&gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [KntKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZlcRemNag.ZRN_AkwNumer
       AND (CDN.ZlcRemNag.ZrN_AkwTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemNag) [KntKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TraNag.TrN_KnPNumer
       AND (CDN.TraNag.TrN_KnPTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [KntKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SadNag.SaN_KntNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZlcNag.ZcN_AkwNumer
       AND (CDN.ZlcNag.ZcN_AkwTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcNag) [KntKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.PDOCzynnosci.PDOC_InspNumer
      AND (CDN.PDOCzynnosci.PDOC_InspTyp=32)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.PDOCzynnosci.PDOC_InspNumer
      AND (CDN.PDOCzynnosci.PDOC_InspTyp=32)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKartyAlias2_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKartyAlias2_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntKartyAlias2_DeleteHandler
  ON CDN.KntKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntWzorce
    IF EXISTS
       ( SELECT * FROM CDN.KntWzorce JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.KntWzorce.KnW_KnCTyp
            AND deleted.Knt_GIDNumer = CDN.KntWzorce.KnW_KnCNumer
       AND (CDN.KntWzorce.KnW_KnCTyp=32 AND CDN.KntWzorce.KnW_KnCNumer &lt;&gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntWzorce) [KntKartyAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ImpNag.ImN_KnDNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na dokumencie importowym./# [KntKartyAlias2_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TraNag.TrN_KnDNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na dokumencie handlowym./# [KntKartyAlias2_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SadNag.SaN_AkwNumer
       AND (CDN.SadNag.SaN_AkwTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntKartyAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKartyAlias2_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKartyAlias2_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntKartyAlias2_InsertUpdateHandler
  ON CDN.KntKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Knt_KnCTyp )  OR UPDATE( Knt_KnCNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Knt_KnCTyp=32 AND inserted.Knt_KnCNumer &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Knt_KnCTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.Knt_KnCNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Knt_KnCTyp=32 AND inserted.Knt_KnCNumer &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntKartyAlias2_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKartyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKartyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntKartyAlias_DeleteHandler
  ON CDN.KntKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.UmwNag.UmN_KnDNumer
       AND (CDN.UmwNag.UmN_KnDTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklNag
    IF EXISTS
       ( SELECT * FROM CDN.ReklNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ReklNag.RLN_KnDNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na reklamacji./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PrjStruktura
    IF EXISTS
       ( SELECT * FROM CDN.PrjStruktura JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.PrjStruktura.PRJ_KndNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na projekcie./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Zapisy
    IF EXISTS
       ( SELECT * FROM CDN.Zapisy JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.Zapisy.KAZ_KNDNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na zapisie kasowo-bankowym./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemNag
    IF EXISTS
       ( SELECT * FROM CDN.MemNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.MemNag.MEN_KNDNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na nocie memoriałowej./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemElem
    IF EXISTS
       ( SELECT * FROM CDN.MemElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.MemElem.MEE_KNDNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na pozycji noty memoriałowej./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.SrwZlcNag.SZN_KnDTyp
            AND deleted.Knt_GIDNumer = CDN.SrwZlcNag.SZN_KnDNumer
       AND (CDN.SrwZlcNag.SZN_KnDTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecenia JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdZlecenia.PZL_KnDNumer
            
       AND (CDN.ProdZlecenia.PZL_KnDTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na zleceniu produkcyjnym./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologia
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologia JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdTechnologia.PTE_KnDNumer
            
       AND (CDN.ProdTechnologia.PTE_KnDTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na technologii./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNPlanyNag
    IF EXISTS
       ( SELECT * FROM CDN.ZRNPlanyNag JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.ZRNPlanyNag.ZPN_SObTyp
            AND deleted.Knt_GIDNumer = CDN.ZRNPlanyNag.ZPN_SObNumer
       AND (CDN.ZRNPlanyNag.ZpN_SObTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNPlanyNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ImpNag.ImN_AkwNumer
       AND (CDN.ImpNag.ImN_AkwTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsElem
    IF EXISTS
       ( SELECT * FROM CDN.SrsElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrsElem.SsE_AkwNumer
       AND (CDN.SrsElem.SsE_AkwTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsElem) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsNag
    IF EXISTS
       ( SELECT * FROM CDN.SrsNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrsNag.SsN_AkwNumer
       AND (CDN.SrsNag.SsN_AkwTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SadNag.SaN_KntZNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.TraNag.TrN_AkwNumer
       AND (CDN.TraNag.TRN_AkwTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZamNag.ZaN_AkwNumer
       AND (CDN.ZamNag.ZaN_AkwTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNMaterialy
    IF EXISTS
       ( SELECT * FROM CDN.ZRNMaterialy JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZRNMaterialy.ZRM_KntNumerO
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNMaterialy) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemElem
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZlcRemElem.ZRE_KNTNumerO
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemElem) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZlcRemNag.ZRN_KNTNumerO
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsObiekty
    IF EXISTS
       ( SELECT * FROM CDN.SrsObiekty JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SrsObiekty.SOb_KntNumerW
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsObiekty) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.CRMKntEtapy.CEK_AkwNumer
            
       AND (CDN.CRMKntEtapy.CEK_AkwTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest akwizytorem w etapie kampani CRM./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ZlcNag.ZcN_KnDNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcNag) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.KntKarty.Knt_AkwNumer
            
       AND (CDN.KntKarty.Knt_AkwTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest akwizytorem innego kontrahenta./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecElem
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecElem JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdZlecElem.PZE_KnDNumer
            
       AND (CDN.ProdZlecElem.PZE_KnDTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kontrahenta. Kontrahent jest ustawiony jako docelowy na pozycji zlecenia produkcyjnego./# [KntKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdNadzlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdNadzlecenia JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.ProdNadzlecenia.PNZ_KnDNumer
       AND (CDN.ProdNadzlecenia.PNZ_KnDTyp = 32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdNadzlecenia) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.Knt_GIDTyp = CDN.FrmStruktura.FRS_ProdZSRKntTyp
            AND deleted.Knt_GIDNumer = CDN.FrmStruktura.FRS_ProdZSRKntNumer
       AND (CDN.FrmStruktura.FRS_ProdZSRKntNumer=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [KntKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.Knt_GIDNumer = CDN.PDOCzynnosci.PDOC_PrzedstNumer
      AND (CDN.PDOCzynnosci.PDOC_PrzedstTyp=32)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.Knt_GIDNumer = CDN.PDOCzynnosci.PDOC_PrzedstNumer
      AND (CDN.PDOCzynnosci.PDOC_PrzedstTyp=32)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKartyAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKartyAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntKartyAlias_InsertUpdateHandler
  ON CDN.KntKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Knt_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Knt_KnPTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.Knt_KnPNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.Knt_KnPTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [KntKartyAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Knt_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Knt_KnPTyp=48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.Knt_KnPNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.Knt_KnPTyp=48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [KntKartyAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKartyAlias3_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKartyAlias3_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntKartyAlias3_DeleteHandler
  ON CDN.KntKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SadNag.SaN_KnPNumer
       AND (CDN.SadNag.SaN_KnPTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntKartyAlias3_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKartyAlias4_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKartyAlias4_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntKartyAlias4_DeleteHandler
  ON CDN.KntKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Knt_GIDNumer = CDN.SadNag.SaN_DstNumer
            AND deleted.Knt_GIDTyp = CDN.SadNag.SaN_DstTyp
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [KntKartyAlias4_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKoncesje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKoncesje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntKoncesje_InsertUpdateHandler
  ON CDN.KntKoncesje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KKo_KntTyp )  OR UPDATE( KKo_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KKo_KntTyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntWzorce ON
                    inserted.KKo_KntTyp = CDN.KntWzorce.KnW_GrpTyp
                AND inserted.KKo_KntNumer = CDN.KntWzorce.KnW_GrpNumer
              WHERE CDN.KntWzorce.KnW_GrpNumer IS NULL AND (inserted.KKo_KntTyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntWzorce) [KntKoncesje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KKo_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KKo_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KKo_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KKo_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntKoncesje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KKo_Koncesja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.KKo_Koncesja = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.KKo_Koncesja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [KntKoncesje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KKTSymbol"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KKTSymbol */</I><BR>
ALTER TABLE CDN.KntKonta ADD CONSTRAINT FK_KKTSymbol
 FOREIGN KEY
   (
                          KKT_SMKID                         
                         )
             REFERENCES CDN.SymboleKont
                         (
                          SMK_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKonta_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKonta_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntKonta_InsertUpdateHandler
  ON CDN.KntKonta
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KKT_KntTyp )  OR UPDATE( KKT_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KKT_KntTyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntWzorce ON
                    inserted.KKT_KntTyp = CDN.KntWzorce.KnW_GrpTyp
                AND inserted.KKT_KntNumer = CDN.KntWzorce.KnW_GrpNumer
              WHERE CDN.KntWzorce.KnW_GrpNumer IS NULL AND (inserted.KKT_KntTyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntWzorce) [KntKonta_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KKT_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KKT_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KKT_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KKT_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntKonta_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KnKOperator"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KnKOperator */</I><BR>
ALTER TABLE CDN.KntKontakty ADD CONSTRAINT FK_KnKOperator
 FOREIGN KEY
   (
                          KnK_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntKontakty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntKontakty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntKontakty_InsertUpdateHandler
  ON CDN.KntKontakty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KnK_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KnK_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KnK_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KnK_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntKontakty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntLimityK_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntLimityK_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntLimityK_InsertUpdateHandler
  ON CDN.KntLimityK
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KLK_KntTyp )  OR UPDATE( KLK_KntNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntGrupyDom ON
                    inserted.KLK_KntTyp = CDN.KntGrupyDom.KGD_GIDTyp
                AND inserted.KLK_KntNumer = CDN.KntGrupyDom.KGD_GIDNumer
              WHERE CDN.KntGrupyDom.KGD_GIDNumer IS NULL AND (CDN.KntGrupyDom.KGD_GIDNumer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntGrupyDom) [KntLimityK_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KlsFrs"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KlsFrs */</I><BR>
ALTER TABLE CDN.KntLimityS ADD CONSTRAINT FK_KlsFrs
 FOREIGN KEY
   (
                          KLS_FrsID                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntLimityS_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntLimityS_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntLimityS_InsertUpdateHandler
  ON CDN.KntLimityS
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KLS_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KLS_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KLS_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KLS_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntLimityS_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KnMMagazyn"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KnMMagazyn */</I><BR>
ALTER TABLE CDN.KntMagazyny ADD CONSTRAINT FK_KnMMagazyn
 FOREIGN KEY
   (
                          KnM_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntMagazyny_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntMagazyny_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntMagazyny_DeleteHandler
  ON CDN.KntMagazyny
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.KntAplikacje JOIN deleted
          ON
                deleted.KnM_KntTyp = CDN.KntAplikacje.KAp_KntTyp
            AND deleted.KnM_KntNumer = CDN.KntAplikacje.KAp_KntNumer
            AND deleted.KnM_MagNumer = CDN.KntAplikacje.KAp_MagNumer
            
       AND (CDN.KntAplikacje.KAp_MagNumer&lt;&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć przypisania tego magazynu, ponieważ jest on ustawiony jako domyślny dla Pulpitu Kontrahenta u tego kontrahenta./# [KntMagazyny_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntMagazyny_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntMagazyny_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntMagazyny_InsertUpdateHandler
  ON CDN.KntMagazyny
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KnM_KntTyp )  OR UPDATE( KnM_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KnM_KntTyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntWzorce ON
                    inserted.KnM_KntTyp = CDN.KntWzorce.KnW_GrpTyp
                AND inserted.KnM_KntNumer = CDN.KntWzorce.KnW_GrpNumer
              WHERE CDN.KntWzorce.KnW_GrpNumer IS NULL AND (inserted.KnM_KntTyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntWzorce) [KntMagazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KnM_KntTyp )  OR UPDATE( KnM_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KnM_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KnM_KntTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.KnM_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KnM_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntMagazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntMagazynyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntMagazynyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntMagazynyAlias_DeleteHandler
  ON CDN.KntMagazyny
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.KntAplikacje JOIN deleted
          ON
                deleted.KnM_KntTyp = CDN.KntAplikacje.KAp_KntTyp
            AND deleted.KnM_KntNumer = CDN.KntAplikacje.KAp_KntNumer
            AND deleted.KnM_MagNumer = CDN.KntAplikacje.KAp_MagMSNumer
            
       AND (CDN.KntAplikacje.KAp_MagMSNumer&lt;&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć przypisania tego magazynu, ponieważ jest on ustawiony jako domyślny dla Mobile Sprzedaż u tego kontrahenta./# [KntMagazynyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntOpiekun_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntOpiekun_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntOpiekun_InsertUpdateHandler
  ON CDN.KntOpiekun
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KtO_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KtO_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KtO_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KtO_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntOpiekun_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KtO_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KtO_KntTyp=948)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejony ON
                    inserted.KtO_KntNumer = CDN.Rejony.REJ_Id
              WHERE CDN.Rejony.REJ_Id IS NULL AND (inserted.KtO_KntTyp=948)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejony) [KntOpiekun_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KtO_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.KtO_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KtO_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [KntOpiekun_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntOpisy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntOpisy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntOpisy_InsertUpdateHandler
  ON CDN.KntOpisy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KnO_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KnO_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KnO_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KnO_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntOpisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntOsoby_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntOsoby_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntOsoby_DeleteHandler
  ON CDN.KntOsoby
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.CRMWizytyNag.CWN_KntTyp
            AND deleted.KnS_KntNumer = CDN.CRMWizytyNag.CWN_KntNumer
            AND deleted.KnS_KntLp = CDN.CRMWizytyNag.CWN_KntOsobaLp
            
       AND (CDN.CRMWizytyNag.CWN_KntOsobaLp&gt;0 and CDN.CRMWizytyNag.CWN_KntOsobaLp&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednej z wizyt handlowych./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsNag
    IF EXISTS
       ( SELECT * FROM CDN.SrsNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.SrsNag.SsN_KntNumer
            AND deleted.KnS_KntLp = CDN.SrsNag.SsN_OsobaLp
            
       AND (CDN.SrsNag.SsN_OsobaLp &gt; 0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z wątków konwersacji./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.SrwZlcNag.SZN_KnSTyp
            AND deleted.KnS_KntNumer = CDN.SrwZlcNag.SZN_KnSNumer
            AND deleted.KnS_KntLp = CDN.SrwZlcNag.SZN_KnSLp
            
       AND (CDN.SrwZlcNag.SZN_KnSTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zlecenia serwisowego./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.ImpNag.ImN_KnSNumer
            AND deleted.KnS_KntLp = CDN.ImpNag.ImN_KnSLp
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów handlowych./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMSrsKontrahenci
    IF EXISTS
       ( SELECT * FROM CDN.CRMSrsKontrahenci JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.CRMSrsKontrahenci.CSK_KnSNumer
            AND deleted.KnS_KntLp = CDN.CRMSrsKontrahenci.CSK_KnSLp
            
       AND (CDN.CRMSrsKontrahenci.CSK_KnSLp &gt; 0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na pozycji konwersacji lub zadaniu crm./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.CRMKntEtapy.CEK_KntNumer
            AND deleted.KnS_KntLp = CDN.CRMKntEtapy.CEK_KntOsobaLp
            
       AND (CDN.CRMKntEtapy.CEK_KntTyp=32 AND CDN.CRMKntEtapy.CEK_KntOsobaLp&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednej z kampanii marketingowej./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.ZlcRemNag.ZRN_KNONumerZ
            AND deleted.KnS_KntLp = CDN.ZlcRemNag.ZRN_KNOLpZ
            
       AND (CDN.ZlcRemNag.ZRN_KNOTypZ=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zleceń remontowych./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.TraNag.TrN_OdoNumer
            AND deleted.KnS_KntLp = CDN.TraNag.TrN_OdoLp
            
       AND (CDN.TraNag.TrN_OdoTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów handlowych./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Samochody
    IF EXISTS
       ( SELECT * FROM CDN.Samochody JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.Samochody.SaM_KierNumer
            AND deleted.KnS_KntLp = CDN.Samochody.SaM_KierLp
       AND (CDN.Samochody.SaM_KierTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Samochody) [KntOsoby_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wysylki
    IF EXISTS
       ( SELECT * FROM CDN.Wysylki JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.Wysylki.WYS_KierNumer
            AND deleted.KnS_KntLp = CDN.Wysylki.WYS_KierLP
       AND (CDN.Wysylki.WyS_KierTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wysylki) [KntOsoby_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TrasyNag
    IF EXISTS
       ( SELECT * FROM CDN.TrasyNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.TrasyNag.TsN_KierNumer
            AND deleted.KnS_KntLp = CDN.TrasyNag.TsN_KierLp
       AND (CDN.TrasyNag.TsN_KierTyp=32)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TrasyNag) [KntOsoby_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.ZamNag.ZaN_KnSTyp
            AND deleted.KnS_KntNumer = CDN.ZamNag.ZaN_KnSNumer
            AND deleted.KnS_KntLp = CDN.ZamNag.ZaN_KnSLp
            
       AND (CDN.ZamNag.ZaN_KnSTyp=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zamówień./# [KntOsoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOUpowaznienia
    IF EXISTS
       ( SELECT * FROM CDN.PDOUpowaznienia JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.PDOUpowaznienia.PDOU_ObiNumer
            AND deleted.KnS_KntLp = CDN.PDOUpowaznienia.PDOU_ObiLp
       AND (CDN.PDOUpowaznienia.PDOU_ObiTyp =32 and CDN.PDOUpowaznienia.PDOU_ObiLp &gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDOUpowaznienia) [KntOsoby_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyElemObiekty
    IF EXISTS(SELECT * FROM CDN.CRMWizytyElemObiekty JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND deleted.KnS_KntLp = CDN.CRMWizytyElemObiekty.CWO_ObiLp
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp = 32 AND CDN.CRMWizytyElemObiekty.CWO_ObiLp &gt; 0)
            )
        DELETE CDN.CRMWizytyElemObiekty
        FROM CDN.CRMWizytyElemObiekty JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND deleted.KnS_KntLp = CDN.CRMWizytyElemObiekty.CWO_ObiLp
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp = 32 AND CDN.CRMWizytyElemObiekty.CWO_ObiLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntOsobyKomunikatory
    IF EXISTS(SELECT * FROM CDN.KntOsobyKomunikatory JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.KntOsobyKomunikatory.KoK_KnSNumer
      AND deleted.KnS_KntLp = CDN.KntOsobyKomunikatory.KoK_KnSLp
      AND (CDN.KntOsobyKomunikatory.KOK_KnSTyp = 32)
            )
        DELETE CDN.KntOsobyKomunikatory
        FROM CDN.KntOsobyKomunikatory JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.KntOsobyKomunikatory.KoK_KnSNumer
      AND deleted.KnS_KntLp = CDN.KntOsobyKomunikatory.KoK_KnSLp
      AND (CDN.KntOsobyKomunikatory.KOK_KnSTyp = 32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.KnS_KntLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp = 32 AND CDN.DaneObiekty.DAO_ObiLp &gt; 0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.KnS_KntLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp = 32 AND CDN.DaneObiekty.DAO_ObiLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrcRole
    IF EXISTS(SELECT * FROM CDN.PrcRole JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.PrcRole.PrR_PrcNumer
      AND deleted.KnS_KntLp = CDN.PrcRole.PrR_PrcLp
      AND (CDN.PrcRole.PrR_PrcTyp=32)
            )
        DELETE CDN.PrcRole
        FROM CDN.PrcRole JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.PrcRole.PrR_PrcNumer
      AND deleted.KnS_KntLp = CDN.PrcRole.PrR_PrcLp
      AND (CDN.PrcRole.PrR_PrcTyp=32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KnS_KntTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.KnS_KntLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=32 AND CDN.Atrybuty.Atr_OBISubLp=8211)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KnS_KntTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.KnS_KntLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=32 AND CDN.Atrybuty.Atr_OBISubLp=8211)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.KnS_KntTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.KnS_KntNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.KnS_KntLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=32 AND CDN.AtrybutyHist.Ath_OBISubLp=8211)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.KnS_KntTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.KnS_KntNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.KnS_KntLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=32 AND CDN.AtrybutyHist.Ath_OBISubLp=8211)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MSKntOsoby
    IF EXISTS(SELECT * FROM CDN.MSKntOsoby JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.MSKntOsoby.MSKnS_KntNumer
      AND deleted.KnS_KntLp = CDN.MSKntOsoby.MSKnS_KntLp
      AND (isnull(CDN.MSKntOsoby.MSKnS_KntNumer,0)&lt;&gt;0 and isnull(CDN.MSKntOsoby.MSKnS_KntLp,0)&lt;&gt;0)
            )
        DELETE CDN.MSKntOsoby
        FROM CDN.MSKntOsoby JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.MSKntOsoby.MSKnS_KntNumer
      AND deleted.KnS_KntLp = CDN.MSKntOsoby.MSKnS_KntLp
      AND (isnull(CDN.MSKntOsoby.MSKnS_KntNumer,0)&lt;&gt;0 and isnull(CDN.MSKntOsoby.MSKnS_KntLp,0)&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrsAplikacje
    IF EXISTS(SELECT * FROM CDN.FrsAplikacje JOIN deleted
            ON 
          deleted.KnS_SyncID = CDN.FrsAplikacje.FrA_ObiNumer
      AND (CDN.FrsAplikacje.FrA_ObiTyp = 8211)
            )
        DELETE CDN.FrsAplikacje
        FROM CDN.FrsAplikacje JOIN deleted
        ON 
          deleted.KnS_SyncID = CDN.FrsAplikacje.FrA_ObiNumer
      AND (CDN.FrsAplikacje.FrA_ObiTyp = 8211)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PicoLog
    IF EXISTS(SELECT * FROM CDN.PicoLog JOIN deleted
            ON 
          deleted.KnS_SyncID = CDN.PicoLog.PcL_ObiNumer
      AND (CDN.PicoLog.PCL_ObiTyp =8211)
            )
        DELETE CDN.PicoLog
        FROM CDN.PicoLog JOIN deleted
        ON 
          deleted.KnS_SyncID = CDN.PicoLog.PcL_ObiNumer
      AND (CDN.PicoLog.PCL_ObiTyp =8211)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zgody
    IF EXISTS(SELECT * FROM CDN.Zgody JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.Zgody.Zgo_ObiNumer
      AND deleted.KnS_KntLp = CDN.Zgody.Zgo_ObiLp
      AND (CDN.Zgody.Zgo_ObiTyp = 8211)
            )
        DELETE CDN.Zgody
        FROM CDN.Zgody JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.Zgody.Zgo_ObiNumer
      AND deleted.KnS_KntLp = CDN.Zgody.Zgo_ObiLp
      AND (CDN.Zgody.Zgo_ObiTyp = 8211)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOAdministratorzy
    IF EXISTS(SELECT * FROM CDN.PDOAdministratorzy JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.PDOAdministratorzy.PDOA_ObiNumer
      AND deleted.KnS_KntLp = CDN.PDOAdministratorzy.PDOA_ObiLp
      AND (CDN.PDOAdministratorzy.PDOA_ObiTyp=32 AND CDN.PDOAdministratorzy.PDOA_ObiLp&gt;0)
            )
        DELETE CDN.PDOAdministratorzy
        FROM CDN.PDOAdministratorzy JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.PDOAdministratorzy.PDOA_ObiNumer
      AND deleted.KnS_KntLp = CDN.PDOAdministratorzy.PDOA_ObiLp
      AND (CDN.PDOAdministratorzy.PDOA_ObiTyp=32 AND CDN.PDOAdministratorzy.PDOA_ObiLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.PDOCzynnosci.PDOC_AdminNumer
      AND deleted.KnS_KntLp = CDN.PDOCzynnosci.PDOC_AdminLp
      AND (CDN.PDOCzynnosci.PDOC_AdminTyp=32 AND CDN.PDOCzynnosci.PDOC_AdminLp&gt;0)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.PDOCzynnosci.PDOC_AdminNumer
      AND deleted.KnS_KntLp = CDN.PDOCzynnosci.PDOC_AdminLp
      AND (CDN.PDOCzynnosci.PDOC_AdminTyp=32 AND CDN.PDOCzynnosci.PDOC_AdminLp&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntOsoby_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntOsoby_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntOsoby_InsertUpdateHandler
  ON CDN.KntOsoby
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KnS_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KnS_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KnS_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KnS_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntOsoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KnS_AdresId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.KnS_AdresId = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KnS_AdresId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [KntOsoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntOsobyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntOsobyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntOsobyAlias_DeleteHandler
  ON CDN.KntOsoby
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.SrwZlcNag.SZN_KnSTypD
            AND deleted.KnS_KntNumer = CDN.SrwZlcNag.SZN_KnSNumerD
            AND deleted.KnS_KntLp = CDN.SrwZlcNag.SZN_KnSLpD
            
       AND (CDN.SrwZlcNag.SZN_KnSTypD=32)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zlecenia serwisowego./# [KntOsobyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.ImpNag.ImN_KnSNumerD
            AND deleted.KnS_KntLp = CDN.ImpNag.ImN_KnSLpD
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów handlowych./# [KntOsobyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.TraNag.TrN_KnSNumerD
            AND deleted.KnS_KntLp = CDN.TraNag.TrN_KnSLpD
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów handlowych./# [KntOsobyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.ZamNag.ZaN_KnSTypP
            AND deleted.KnS_KntNumer = CDN.ZamNag.ZaN_KnSNumerP
            AND deleted.KnS_KntLp = CDN.ZamNag.ZaN_KnSLpP
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zamówień./# [KntOsobyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.CRMKntEtapy.CEK_KntNumer
            AND deleted.KnS_KntLp = CDN.CRMKntEtapy.CEK_KntOsobaLp
            
       AND (CDN.CRMKntEtapy.CEK_AkwTyp=32 AND CDN.CRMKntEtapy.CEK_AkwOsobaLp&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednej z kampanii marketingowej./# [KntOsobyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.UmwNag.UmN_KnSTypPlt
            AND deleted.KnS_KntNumer = CDN.UmwNag.UmN_KnSNumerPlt
            AND deleted.KnS_KntLp = CDN.UmwNag.UmN_KnSLpPlt
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów umów./# [KntOsobyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.PDOCzynnosci.PDOC_PrzedstNumer
      AND deleted.KnS_KntLp = CDN.PDOCzynnosci.PDOC_PrzedstLp
      AND (CDN.PDOCzynnosci.PDOC_PrzedstTyp=32 AND CDN.PDOCzynnosci.PDOC_PrzedstLp&gt;0)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.PDOCzynnosci.PDOC_PrzedstNumer
      AND deleted.KnS_KntLp = CDN.PDOCzynnosci.PDOC_PrzedstLp
      AND (CDN.PDOCzynnosci.PDOC_PrzedstTyp=32 AND CDN.PDOCzynnosci.PDOC_PrzedstLp&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntOsobyAlias2_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntOsobyAlias2_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntOsobyAlias2_DeleteHandler
  ON CDN.KntOsoby
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.UmwNag.UmN_KnSTypOdb
            AND deleted.KnS_KntNumer = CDN.UmwNag.UmN_KnSNumerOdb
            AND deleted.KnS_KntLp = CDN.UmwNag.UmN_KnSLpOdb
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zamówień./# [KntOsobyAlias2_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.ZamNag.ZaN_KnSTypPlt
            AND deleted.KnS_KntNumer = CDN.ZamNag.ZaN_KnSNumerPlt
            AND deleted.KnS_KntLp = CDN.ZamNag.ZaN_KnSLpPlt
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zamówień./# [KntOsobyAlias2_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntOsobyAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntOsobyAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntOsobyAlias1_DeleteHandler
  ON CDN.KntOsoby
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.UmwNag.UmN_KnSTyp
            AND deleted.KnS_KntNumer = CDN.UmwNag.UmN_KnSNumer
            AND deleted.KnS_KntLp = CDN.UmwNag.UmN_KnSLp
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zamówień./# [KntOsobyAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.ImpNag.ImN_KnSNumerP
            AND deleted.KnS_KntLp = CDN.ImpNag.ImN_KnSLpP
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów handlowych./# [KntOsobyAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.KnS_KntNumer = CDN.TraNag.TrN_KnSNumerP
            AND deleted.KnS_KntLp = CDN.TraNag.TrN_KnSLpP
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów handlowych./# [KntOsobyAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.KnS_KntTyp = CDN.ZamNag.ZaN_KnSTypOdb
            AND deleted.KnS_KntNumer = CDN.ZamNag.ZaN_KnSNumerOdb
            AND deleted.KnS_KntLp = CDN.ZamNag.ZaN_KnSLpOdb
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć osoby. Usuwana osoba jest wybrana na jednym z dokumentów zamówień./# [KntOsobyAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.KnS_KntNumer = CDN.PDOCzynnosci.PDOC_InspNumer
      AND deleted.KnS_KntLp = CDN.PDOCzynnosci.PDOC_InspLp
      AND (CDN.PDOCzynnosci.PDOC_InspTyp=32 AND CDN.PDOCzynnosci.PDOC_InspLp&gt;0)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.KnS_KntNumer = CDN.PDOCzynnosci.PDOC_InspNumer
      AND deleted.KnS_KntLp = CDN.PDOCzynnosci.PDOC_InspLp
      AND (CDN.PDOCzynnosci.PDOC_InspTyp=32 AND CDN.PDOCzynnosci.PDOC_InspLp&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntOsobyKomunikatory_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntOsobyKomunikatory_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntOsobyKomunikatory_InsertUpdateHandler
  ON CDN.KntOsobyKomunikatory
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KoK_KnSNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KOK_KnSTyp=848)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Firma ON
                    inserted.KoK_KnSNumer = CDN.Firma.Frm_GidNumer
              WHERE CDN.Firma.Frm_GidNumer IS NULL AND (inserted.KOK_KnSTyp=848)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Firma) [KntOsobyKomunikatory_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KoK_KnSNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KOK_KnSTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.KoK_KnSNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.KOK_KnSTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [KntOsobyKomunikatory_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KoK_KnSNumer )  OR UPDATE( KoK_KnSLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KOK_KnSTyp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.KoK_KnSNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.KoK_KnSLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.KOK_KnSTyp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [KntOsobyKomunikatory_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KoK_RodzajId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.KoK_RodzajId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.KoK_RodzajId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [KntOsobyKomunikatory_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KprPrm"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KprPrm */</I><BR>
ALTER TABLE CDN.KntPromocje ADD CONSTRAINT FK_KprPrm
 FOREIGN KEY
   (
                          KPR_PrmId                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntPromocje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntPromocje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntPromocje_InsertUpdateHandler
  ON CDN.KntPromocje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KPR_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPR_KntTyp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KPR_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KPR_KntTyp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KPR_KntTyp )  OR UPDATE( KPR_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPR_KntTyp&lt;0 AND inserted.KPR_KntNumer&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntGrupy ON
                    inserted.KPR_KntTyp = CDN.KntGrupy.KnG_GIDTyp
                AND inserted.KPR_KntNumer = CDN.KntGrupy.KnG_GIDNumer
              WHERE CDN.KntGrupy.KnG_GIDNumer IS NULL AND (inserted.KPR_KntTyp&lt;0 AND inserted.KPR_KntNumer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntGrupy) [KntPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntRejestr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntRejestr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntRejestr_InsertUpdateHandler
  ON CDN.KntRejestr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KRj_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KRj_ObiTyp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KRj_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KRj_ObiTyp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntRejestr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KRj_KarNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.KRj_KarNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KRj_KarNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [KntRejestr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KnRKontrah"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KnRKontrah */</I><BR>
ALTER TABLE CDN.KntRejony ADD CONSTRAINT FK_KnRKontrah
 FOREIGN KEY
   (
                          KnR_KntNumer                      
                         )
             REFERENCES CDN.KntKarty
                         (
                          Knt_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KnRRejon"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KnRRejon */</I><BR>
ALTER TABLE CDN.KntRejony ADD CONSTRAINT FK_KnRRejon
 FOREIGN KEY
   (
                          KnR_Rejon                         
                         )
             REFERENCES CDN.Rejony
                         (
                          REJ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KTwIlosc"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KTwIlosc */</I><BR>
ALTER TABLE CDN.KntTowary ADD CONSTRAINT FK_KTwIlosc
 FOREIGN KEY
   (
                          KTw_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntTowary_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntTowary_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntTowary_InsertUpdateHandler
  ON CDN.KntTowary
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KTw_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KTw_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KTw_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KTw_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntTowary_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WKUGrupa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WKUGrupa */</I><BR>
ALTER TABLE CDN.KntWzUpusty ADD CONSTRAINT FK_WKUGrupa
 FOREIGN KEY
   (
                          WKU_GrpTyp                        ,
                          WKU_GrpNumer                      
                         )
             REFERENCES CDN.KntWzorce
                         (
                          KnW_GrpTyp   ,
                          KnW_GrpNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntWzUpusty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntWzUpusty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntWzUpusty_InsertUpdateHandler
  ON CDN.KntWzUpusty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WKU_TwGNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WKU_TwGTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.WKU_TwGNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.WKU_TwGTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [KntWzUpusty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntWzorce_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntWzorce_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KntWzorce_DeleteHandler
  ON CDN.KntWzorce
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntAplikacje
    IF EXISTS(SELECT * FROM CDN.KntAplikacje JOIN deleted
            ON 
          deleted.KnW_GrpNumer = CDN.KntAplikacje.KAp_KntNumer
      AND deleted.KnW_GrpTyp = CDN.KntAplikacje.KAp_KntTyp
      AND (CDN.KntAplikacje.KAp_KntTyp=-32)
            )
        DELETE CDN.KntAplikacje
        FROM CDN.KntAplikacje JOIN deleted
        ON 
          deleted.KnW_GrpNumer = CDN.KntAplikacje.KAp_KntNumer
      AND deleted.KnW_GrpTyp = CDN.KntAplikacje.KAp_KntTyp
      AND (CDN.KntAplikacje.KAp_KntTyp=-32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntMagazyny
    IF EXISTS(SELECT * FROM CDN.KntMagazyny JOIN deleted
            ON 
          deleted.KnW_GrpTyp = CDN.KntMagazyny.KnM_KntTyp
      AND deleted.KnW_GrpNumer = CDN.KntMagazyny.KnM_KntNumer
      AND (CDN.KntMagazyny.KnM_KntTyp=-32)
            )
        DELETE CDN.KntMagazyny
        FROM CDN.KntMagazyny JOIN deleted
        ON 
          deleted.KnW_GrpTyp = CDN.KntMagazyny.KnM_KntTyp
      AND deleted.KnW_GrpNumer = CDN.KntMagazyny.KnM_KntNumer
      AND (CDN.KntMagazyny.KnM_KntTyp=-32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntKoncesje
    IF EXISTS(SELECT * FROM CDN.KntKoncesje JOIN deleted
            ON 
          deleted.KnW_GrpNumer = CDN.KntKoncesje.KKo_KntNumer
      AND deleted.KnW_GrpTyp = CDN.KntKoncesje.KKo_KntTyp
      AND (CDN.KntKoncesje.KKo_KntTyp=-32)
            )
        DELETE CDN.KntKoncesje
        FROM CDN.KntKoncesje JOIN deleted
        ON 
          deleted.KnW_GrpNumer = CDN.KntKoncesje.KKo_KntNumer
      AND deleted.KnW_GrpTyp = CDN.KntKoncesje.KKo_KntTyp
      AND (CDN.KntKoncesje.KKo_KntTyp=-32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntKonta
    IF EXISTS(SELECT * FROM CDN.KntKonta JOIN deleted
            ON 
          deleted.KnW_GrpTyp = CDN.KntKonta.KKT_KntTyp
      AND deleted.KnW_GrpNumer = CDN.KntKonta.KKT_KntNumer
      AND (CDN.KntKonta.KKT_KntTyp=-32)
            )
        DELETE CDN.KntKonta
        FROM CDN.KntKonta JOIN deleted
        ON 
          deleted.KnW_GrpTyp = CDN.KntKonta.KKT_KntTyp
      AND deleted.KnW_GrpNumer = CDN.KntKonta.KKT_KntNumer
      AND (CDN.KntKonta.KKT_KntTyp=-32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KnW_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KnW_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp=-32)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KnW_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KnW_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp=-32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.KnW_GrpTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.KnW_GrpNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=-32)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.KnW_GrpTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.KnW_GrpNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=-32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrsAplikacje
    IF EXISTS(SELECT * FROM CDN.FrsAplikacje JOIN deleted
            ON 
          deleted.KnW_GrpNumer = CDN.FrsAplikacje.FrA_ObiNumer
      AND (CDN.FrsAplikacje.FrA_ObiTyp = -32)
            )
        DELETE CDN.FrsAplikacje
        FROM CDN.FrsAplikacje JOIN deleted
        ON 
          deleted.KnW_GrpNumer = CDN.FrsAplikacje.FrA_ObiNumer
      AND (CDN.FrsAplikacje.FrA_ObiTyp = -32)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntWzorce_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntWzorce_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntWzorce_InsertUpdateHandler
  ON CDN.KntWzorce
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KnW_KnCTyp )  OR UPDATE( KnW_KnCNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KnW_KnCTyp=32 AND inserted.KnW_KnCNumer &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KnW_KnCTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.KnW_KnCNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KnW_KnCTyp=32 AND inserted.KnW_KnCNumer &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [KntWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KnW_KarNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.KnW_KarNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KnW_KarNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [KntWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KnW_BnkNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.KnW_BnkNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KnW_BnkNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [KntWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KnZTStamp"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KnZTStamp */</I><BR>
ALTER TABLE CDN.KntZasoby ADD CONSTRAINT FK_KnZTStamp
 FOREIGN KEY
   (
                          KnZ_KntTyp                        ,
                          KnZ_KntNumer                      ,
                          KnZ_TwrTyp                        ,
                          KnZ_TwrNumer                      
                         )
             REFERENCES CDN.KntTowary
                         (
                          KTw_KntTyp                        ,
                          KTw_KntNumer                      ,
                          KTw_TwrTyp                        ,
                          KTw_TwrNumer                      
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KntZasoby_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KntZasoby_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KntZasoby_InsertUpdateHandler
  ON CDN.KntZasoby
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KnZ_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.KnZ_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KnZ_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [KntZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KodyCN_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KodyCN_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KodyCN_DeleteHandler
  ON CDN.KodyCN
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Sent
    IF EXISTS
       ( SELECT * FROM CDN.Sent JOIN deleted
          ON
                deleted.KCN_ID = CDN.Sent.SnT_KCNId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Sent) [KodyCN_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KCNJKodJm"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KCNJKodJm */</I><BR>
ALTER TABLE CDN.KodyCNJednostkiSent ADD CONSTRAINT FK_KCNJKodJm
 FOREIGN KEY
   (
                          KCNJ_KCNId                         
                         )
             REFERENCES CDN.KodyCN
                         (
                          KCN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KodyCNJednostkiSent_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KodyCNJednostkiSent_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KodyCNJednostkiSent_InsertUpdateHandler
  ON CDN.KodyCNJednostkiSent
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KCNJ_Jm ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Nazwy ON
                    inserted.KCNJ_Jm = CDN.Nazwy.Naz_Nazwa
              WHERE CDN.Nazwy.Naz_Nazwa IS NULL AND (CDN.Nazwy.Naz_GIDTyp=144)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Nazwy) [KodyCNJednostkiSent_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KMEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KMEPrimary */</I><BR>
ALTER TABLE CDN.KompElem ADD CONSTRAINT FK_KMEPrimary
 FOREIGN KEY
   (
                          KME_KMNID                         
                         )
             REFERENCES CDN.KompNag
                         (
                          KMN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KMPPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KMPPrimary */</I><BR>
ALTER TABLE CDN.KompElemPlatnosci ADD CONSTRAINT FK_KMPPrimary
 FOREIGN KEY
   (
                          KMP_KMEID                         ,
                          KMP_KMELp                         
                         )
             REFERENCES CDN.KompElem
                         (
                          KME_KMNID                         ,
                          KME_KMELp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KompElemPlatnosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KompElemPlatnosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KompElemPlatnosci_DeleteHandler
  ON CDN.KompElemPlatnosci
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.KMP_KMEID = CDN.TraPlat.TrP_GIDNumer
      AND deleted.KMP_NalTRPLp = CDN.TraPlat.TrP_GIDLp
      AND (CDN.TraPlat.TRP_GIDTyp=434 AND CDN.TraPlat.TRP_Typ=2)
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.KMP_KMEID = CDN.TraPlat.TrP_GIDNumer
      AND deleted.KMP_NalTRPLp = CDN.TraPlat.TrP_GIDLp
      AND (CDN.TraPlat.TRP_GIDTyp=434 AND CDN.TraPlat.TRP_Typ=2)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KompElemPlatnosciAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KompElemPlatnosciAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KompElemPlatnosciAlias_DeleteHandler
  ON CDN.KompElemPlatnosci
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.KMP_KMEID = CDN.TraPlat.TrP_GIDNumer
      AND deleted.KMP_ZobTRPLp = CDN.TraPlat.TrP_GIDLp
      AND (CDN.TraPlat.TRP_GIDTyp=434 AND CDN.TraPlat.TRP_Typ=1)
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.KMP_KMEID = CDN.TraPlat.TrP_GIDNumer
      AND deleted.KMP_ZobTRPLp = CDN.TraPlat.TrP_GIDLp
      AND (CDN.TraPlat.TRP_GIDTyp=434 AND CDN.TraPlat.TRP_Typ=1)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KompNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KompNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KompNag_DeleteHandler
  ON CDN.KompNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.KMN_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (434))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.KMN_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (434))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KMN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=434 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KMN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=434 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.KMN_ID = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=434)
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.KMN_ID = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=434)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Komunikaty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Komunikaty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Komunikaty_InsertUpdateHandler
  ON CDN.Komunikaty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Kom_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.Kom_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.Kom_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [Komunikaty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KPEKPN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KPEKPN */</I><BR>
ALTER TABLE CDN.KonfProdElem ADD CONSTRAINT FK_KPEKPN
 FOREIGN KEY
   (
                          KPE_KPNId                         
                         )
             REFERENCES CDN.KonfProdNag
                         (
                          KPN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KonfProdElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KonfProdElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KonfProdElem_InsertUpdateHandler
  ON CDN.KonfProdElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KPE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPE_ObiTyp=14370)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.KPE_ObiNumer = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL AND (inserted.KPE_ObiTyp=14370)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [KonfProdElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KPE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPE_ObiTyp=14341)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaCzynnosci ON
                    inserted.KPE_ObiNumer = CDN.ProdTechnologiaCzynnosci.PTC_Id
              WHERE CDN.ProdTechnologiaCzynnosci.PTC_Id IS NULL AND (inserted.KPE_ObiTyp=14341)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaCzynnosci) [KonfProdElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KPE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPE_ObiTyp=14342)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.KPE_ObiNumer = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL AND (inserted.KPE_ObiTyp=14342)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [KonfProdElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KPE_AtkId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AtrybutyKlasy ON
                    inserted.KPE_AtkId = CDN.AtrybutyKlasy.AtK_ID
              WHERE CDN.AtrybutyKlasy.AtK_ID IS NULL
                AND (
                          IsNull(inserted.KPE_AtkId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AtrybutyKlasy) [KonfProdElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KEGKPG"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KEGKPG */</I><BR>
ALTER TABLE CDN.KonfProdGrupyElem ADD CONSTRAINT FK_KEGKPG
 FOREIGN KEY
   (
                          KEG_KPGId                         
                         )
             REFERENCES CDN.KonfProdGrupy
                         (
                          KPG_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KonfProdGrupyElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KonfProdGrupyElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KonfProdGrupyElem_InsertUpdateHandler
  ON CDN.KonfProdGrupyElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KEG_TwGNumer )  OR UPDATE( KEG_TwGTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KEG_TwGTyp=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.KEG_TwGNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.KEG_TwGTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (inserted.KEG_TwGTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [KonfProdGrupyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KGSKPG"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KGSKPG */</I><BR>
ALTER TABLE CDN.KonfProdGrupyStruktura ADD CONSTRAINT FK_KGSKPG
 FOREIGN KEY
   (
                          KGS_KPGId                         
                         )
             REFERENCES CDN.KonfProdGrupy
                         (
                          KPG_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KonfProdGrupyStruktura_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KonfProdGrupyStruktura_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KonfProdGrupyStruktura_DeleteHandler
  ON CDN.KonfProdGrupyStruktura
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KonfProdGrupyStruktura
    IF EXISTS(SELECT * FROM CDN.KonfProdGrupyStruktura JOIN deleted
            ON 
          deleted.KGS_Id = CDN.KonfProdGrupyStruktura.KGS_RodzicId
      AND (CDN.KonfProdGrupyStruktura.KGS_RodzicId&lt;&gt;0)
            )
        DELETE CDN.KonfProdGrupyStruktura
        FROM CDN.KonfProdGrupyStruktura JOIN deleted
        ON 
          deleted.KGS_Id = CDN.KonfProdGrupyStruktura.KGS_RodzicId
      AND (CDN.KonfProdGrupyStruktura.KGS_RodzicId&lt;&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KonfProdGrupyStruktura_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KonfProdGrupyStruktura_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KonfProdGrupyStruktura_InsertUpdateHandler
  ON CDN.KonfProdGrupyStruktura
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KGS_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.KGS_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KGS_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [KonfProdGrupyStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KonfProdGrupyStrukturaAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KonfProdGrupyStrukturaAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KonfProdGrupyStrukturaAlias_InsertUpdateHandler
  ON CDN.KonfProdGrupyStruktura
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KGS_RodzicId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KGS_RodzicId&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KonfProdGrupyStruktura ON
                    inserted.KGS_RodzicId = CDN.KonfProdGrupyStruktura.KGS_Id
              WHERE CDN.KonfProdGrupyStruktura.KGS_Id IS NULL AND (inserted.KGS_RodzicId&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KonfProdGrupyStruktura) [KonfProdGrupyStrukturaAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KPLKPG"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KPLKPG */</I><BR>
ALTER TABLE CDN.KonfProdLinki ADD CONSTRAINT FK_KPLKPG
 FOREIGN KEY
   (
                          KPL_KPGId                         
                         )
             REFERENCES CDN.KonfProdGrupy
                         (
                          KPG_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KonfProdLinki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KonfProdLinki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KonfProdLinki_InsertUpdateHandler
  ON CDN.KonfProdLinki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KPL_PTEId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPL_PTETyp=14370)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.KPL_PTEId = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL AND (inserted.KPL_PTETyp=14370)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [KonfProdLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KonfProdNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KonfProdNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KonfProdNag_InsertUpdateHandler
  ON CDN.KonfProdNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KPN_PTEId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.KPN_PTEId = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL
                AND (
                          IsNull(inserted.KPN_PTEId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [KonfProdNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KPN_DokTyp )  OR UPDATE( KPN_DokNumer )  OR UPDATE( KPN_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPN_DokTyp=960 and inserted.KPN_DokLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.KPN_DokTyp = CDN.ZamElem.ZaE_GIDTyp
                AND inserted.KPN_DokNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.KPN_DokLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.KPN_DokTyp=960 and inserted.KPN_DokLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [KonfProdNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KPN_TwGNumer )  OR UPDATE( KPN_TwGTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPN_TwGTyp=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.KPN_TwGNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.KPN_TwGTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (inserted.KPN_TwGTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [KonfProdNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KPN_PrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KPN_PrdTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.KPN_PrdNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.KPN_PrdTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [KonfProdNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KPN_KTPId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.KPN_KTPId = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL
                AND (
                          IsNull(inserted.KPN_KTPId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [KonfProdNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Konfig_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Konfig_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Konfig_DeleteHandler
  ON CDN.Konfig
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Tlumaczenia
    IF EXISTS(SELECT * FROM CDN.Tlumaczenia JOIN deleted
            ON 
          deleted.KON_Lp = CDN.Tlumaczenia.TLM_Numer
      AND deleted.KON_Numer = CDN.Tlumaczenia.TLM_Typ
      AND (CDN.Tlumaczenia.TLM_Typ = 736)
            )
        DELETE CDN.Tlumaczenia
        FROM CDN.Tlumaczenia JOIN deleted
        ON 
          deleted.KON_Lp = CDN.Tlumaczenia.TLM_Numer
      AND deleted.KON_Numer = CDN.Tlumaczenia.TLM_Typ
      AND (CDN.Tlumaczenia.TLM_Typ = 736)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrmObiekty
    IF EXISTS(SELECT * FROM CDN.FrmObiekty JOIN deleted
            ON 
          deleted.KON_Numer = CDN.FrmObiekty.FRO_GIDTyp
      AND deleted.KON_Lp = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=736)
            )
        DELETE CDN.FrmObiekty
        FROM CDN.FrmObiekty JOIN deleted
        ON 
          deleted.KON_Numer = CDN.FrmObiekty.FRO_GIDTyp
      AND deleted.KON_Lp = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=736)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroPlt
    IF EXISTS(SELECT * FROM CDN.RetroPlt JOIN deleted
            ON 
          deleted.KON_Lp = CDN.RetroPlt.RPl_PltLp
      AND (CDN.RetroPlt.RPl_PltTyp=736 AND CDN.RetroPlt.RPl_PltLp&gt;0)
            )
        DELETE CDN.RetroPlt
        FROM CDN.RetroPlt JOIN deleted
        ON 
          deleted.KON_Lp = CDN.RetroPlt.RPl_PltLp
      AND (CDN.RetroPlt.RPl_PltTyp=736 AND CDN.RetroPlt.RPl_PltLp&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KKSKontoFirma"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KKSKontoFirma */</I><BR>
ALTER TABLE CDN.Konta ADD CONSTRAINT FK_KKSKontoFirma
 FOREIGN KEY
   (
                          KKS_OkresID                       
                         )
             REFERENCES CDN.Okresy
                         (
                          OKR_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Konta_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Konta_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Konta_DeleteHandler
  ON CDN.Konta
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemElem
    IF EXISTS
       ( SELECT * FROM CDN.MemElem JOIN deleted
          ON
                deleted.KKS_GIDNumer = CDN.MemElem.MEE_KKSNumerDT
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemElem) [Konta_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Dekrety
    IF EXISTS
       ( SELECT * FROM CDN.Dekrety JOIN deleted
          ON
                deleted.KKS_GIDNumer = CDN.Dekrety.DT_KKSNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Konto nie może zostać usunięte. Istnieją dekrety na koncie./# [Konta_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.KKS_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.KKS_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (448))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.KKS_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.KKS_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (448))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.KKS_GIDNumer = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=448 or CDN.ProdKosztyElem.PKE_OBITyp=2896)
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.KKS_GIDNumer = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=448 or CDN.ProdKosztyElem.PKE_OBITyp=2896)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KKS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KKS_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( CDN.Atrybuty.Atr_OBITyp=448)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KKS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KKS_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( CDN.Atrybuty.Atr_OBITyp=448)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.KKS_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.KKS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=448)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.KKS_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.KKS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=448)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Konta_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Konta_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Konta_InsertUpdateHandler
  ON CDN.Konta
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KKS_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KKS_KNTTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.KKS_KNTNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.KKS_KNTTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Konta_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KKS_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KKS_KNTTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KKS_KNTNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KKS_KNTTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Konta_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KontaAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KontaAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KontaAlias_DeleteHandler
  ON CDN.Konta
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemElem
    IF EXISTS
       ( SELECT * FROM CDN.MemElem JOIN deleted
          ON
                deleted.KKS_GIDNumer = CDN.MemElem.MEE_KKSNumerCT
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemElem) [KontaAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KKZKksNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KKZKksNumer */</I><BR>
ALTER TABLE CDN.KontaNazwy ADD CONSTRAINT FK_KKZKksNumer
 FOREIGN KEY
   (
                          KKZ_KksNumer                      
                         )
             REFERENCES CDN.Konta
                         (
                          KKS_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Konwersacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Konwersacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Konwersacje_InsertUpdateHandler
  ON CDN.Konwersacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KXL_ID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UczestnicyKonwersacji ON
                    inserted.KXL_ID = CDN.UczestnicyKonwersacji.UKN_IDKonwersacji
              WHERE CDN.UczestnicyKonwersacji.UKN_IDKonwersacji IS NULL
                AND (
                          IsNull(inserted.KXL_ID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UczestnicyKonwersacji) [Konwersacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KrajeCelne_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KrajeCelne_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KrajeCelne_DeleteHandler
  ON CDN.KrajeCelne
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KategorieCelne
    IF EXISTS
       ( SELECT * FROM CDN.KategorieCelne JOIN deleted
          ON
                deleted.KPC_Kod = CDN.KategorieCelne.KC_Kraj
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KategorieCelne) [KrajeCelne_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KrajeCelne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KrajeCelne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KrajeCelne_InsertUpdateHandler
  ON CDN.KrajeCelne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KPC_GKrID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.GrupyKrajow ON
                    inserted.KPC_GKrID = CDN.GrupyKrajow.GKr_ID
              WHERE CDN.GrupyKrajow.GKr_ID IS NULL
                AND (
                          IsNull(inserted.KPC_GKrID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  GrupyKrajow) [KrajeCelne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KrENaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KrENaglowek */</I><BR>
ALTER TABLE CDN.KreatorKodowElem ADD CONSTRAINT FK_KrENaglowek
 FOREIGN KEY
   (
                          KrE_KrnId                         
                         )
             REFERENCES CDN.KreatorKodowNag
                         (
                          KrN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KreatorKodowNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KreatorKodowNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KreatorKodowNag_DeleteHandler
  ON CDN.KreatorKodowNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrWzorce
    IF EXISTS
       ( SELECT * FROM CDN.TwrWzorce JOIN deleted
          ON
                deleted.KrN_Id = CDN.TwrWzorce.TwW_KreatorId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Kreator został wykorzystany w jednym z wzorców towaru./# [KreatorKodowNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KKEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KKEPrimary */</I><BR>
ALTER TABLE CDN.KregiKosztowElem ADD CONSTRAINT FK_KKEPrimary
 FOREIGN KEY
   (
                          KKE_KKNID                         
                         )
             REFERENCES CDN.KregiKosztowNag
                         (
                          KKN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KSEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KSEPrimary */</I><BR>
ALTER TABLE CDN.KsoElem ADD CONSTRAINT FK_KSEPrimary
 FOREIGN KEY
   (
                          KSE_GIDNumer                      
                         )
             REFERENCES CDN.KsoNag
                         (
                          KSN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KsoElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KsoElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KsoElem_DeleteHandler
  ON CDN.KsoElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KSE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KSE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=2752 AND CDN.Atrybuty.Atr_ObiLp&gt;0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KSE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.KSE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=2752 AND CDN.Atrybuty.Atr_ObiLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.KSE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.KSE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=2752 AND CDN.AtrybutyHist.Ath_ObiLp&gt;0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.KSE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.KSE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=2752 AND CDN.AtrybutyHist.Ath_ObiLp&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KsoElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KsoElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.KsoElem_InsertUpdateHandler
  ON CDN.KsoElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KSE_KLNID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KluczeNag ON
                    inserted.KSE_KLNID = CDN.KluczeNag.KLN_ID
              WHERE CDN.KluczeNag.KLN_ID IS NULL
                AND (
                          IsNull(inserted.KSE_KLNID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KluczeNag) [KsoElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KSE_SIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KSE_SIDTyp=2392)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SISDefinicje ON
                    inserted.KSE_SIDNumer = CDN.SISDefinicje.SID_GIDNumer
              WHERE CDN.SISDefinicje.SID_GIDNumer IS NULL AND (inserted.KSE_SIDTyp=2392)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SISDefinicje) [KsoElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="KsoNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* KsoNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.KsoNag_DeleteHandler
  ON CDN.KsoNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KSN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=2752 AND CDN.Atrybuty.Atr_ObiLp=0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KSN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=2752 AND CDN.Atrybuty.Atr_ObiLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.KSN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=2752 AND CDN.AtrybutyHist.Ath_ObiLp=0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.KSN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=2752 AND CDN.AtrybutyHist.Ath_ObiLp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KSPParametr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KSPParametr */</I><BR>
ALTER TABLE CDN.KsoParametry ADD CONSTRAINT FK_KSPParametr
 FOREIGN KEY
   (
                          KSP_KLPID                         
                         )
             REFERENCES CDN.KluczeParametry
                         (
                          KLP_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KSPPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KSPPrimary */</I><BR>
ALTER TABLE CDN.KsoParametry ADD CONSTRAINT FK_KSPPrimary
 FOREIGN KEY
   (
                          KSP_GIDNumer                      ,
                          KSP_GIDLp                         
                         )
             REFERENCES CDN.KsoElem
                         (
                          KSE_GIDNumer                      ,
                          KSE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KSRKSE"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KSRKSE */</I><BR>
ALTER TABLE CDN.KsoRaty ADD CONSTRAINT FK_KSRKSE
 FOREIGN KEY
   (
                          KSR_KSENumer                      ,
                          KSR_KSELp                         
                         )
             REFERENCES CDN.KsoElem
                         (
                          KSE_GIDNumer                      ,
                          KSE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_LoDDokument"></A><PRE>
          <FONT SIZE="2"><I>/* FK_LoDDokument */</I><BR>
ALTER TABLE CDN.LokalizacjeDok ADD CONSTRAINT FK_LoDDokument
 FOREIGN KEY
   (
                          LoD_DokNumer                      
                         )
             REFERENCES CDN.SrsObiekty
                         (
                          SOb_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MESProfile_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MESProfile_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MESProfile_DeleteHandler
  ON CDN.MESProfile
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MESProfileOperatorzy
    IF EXISTS(SELECT * FROM CDN.MESProfileOperatorzy JOIN deleted
            ON 
          deleted.MESP_Id = CDN.MESProfileOperatorzy.MESPO_ProfilID
            )
        DELETE CDN.MESProfileOperatorzy
        FROM CDN.MESProfileOperatorzy JOIN deleted
        ON 
          deleted.MESP_Id = CDN.MESProfileOperatorzy.MESPO_ProfilID
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MESProfileOperatorzy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MESProfileOperatorzy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MESProfileOperatorzy_InsertUpdateHandler
  ON CDN.MESProfileOperatorzy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MESPO_ProfilID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MESProfile ON
                    inserted.MESPO_ProfilID = CDN.MESProfile.MESP_Id
              WHERE CDN.MESProfile.MESP_Id IS NULL
                AND (
                          IsNull(inserted.MESPO_ProfilID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MESProfile) [MESProfileOperatorzy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MESPO_OpeGidNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.MESPO_OpeGidNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MESPO_OpeGidNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [MESProfileOperatorzy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MSKntOsoby_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MSKntOsoby_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MSKntOsoby_InsertUpdateHandler
  ON CDN.MSKntOsoby
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MSKnS_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MSKnS_KntTyp=32 and inserted.MSKnS_KntLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.MSKnS_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.MSKnS_KntTyp=32 and inserted.MSKnS_KntLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [MSKntOsoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MSKnS_KntNumer )  OR UPDATE( MSKnS_KntLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE isnull(inserted.MSKnS_KntNumer,0)&lt;&gt;0 and isnull(inserted.MSKnS_KntLp,0)&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.MSKnS_KntNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.MSKnS_KntLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (isnull(inserted.MSKnS_KntNumer,0)&lt;&gt;0 and isnull(inserted.MSKnS_KntLp,0)&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [MSKntOsoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MnOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MnOPrimary */</I><BR>
ALTER TABLE CDN.MaNOpisy ADD CONSTRAINT FK_MnOPrimary
 FOREIGN KEY
   (
                          MnO_MaNNumer                      
                         )
             REFERENCES CDN.MagNag
                         (
                          MaN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagAdresy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagAdresy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagAdresy_DeleteHandler
  ON CDN.MagAdresy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwArk
    IF EXISTS
       ( SELECT * FROM CDN.InwArk JOIN deleted
          ON
                deleted.MgA_Id = CDN.InwArk.InA_MgAIdOd
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Adres został użyty w inwentaryzacji, nie może zostać usunięty./# [MagAdresy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwTwr
    IF EXISTS
       ( SELECT * FROM CDN.InwTwr JOIN deleted
          ON
                deleted.MgA_Id = CDN.InwTwr.InT_MgaId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą InwTwr) [MagAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrParMag
    IF EXISTS
       ( SELECT * FROM CDN.TwrParMag JOIN deleted
          ON
                deleted.MgA_Id = CDN.TwrParMag.TPM_MgAId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrParMag) [MagAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagPElem
    IF EXISTS
       ( SELECT * FROM CDN.MagPElem JOIN deleted
          ON
                deleted.MgA_Id = CDN.MagPElem.MaP_MgAId
       AND (CDN.MagPElem.MaP_MgAID&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagPElem) [MagAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagAdresy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagAdresy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagAdresy_InsertUpdateHandler
  ON CDN.MagAdresy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MgA_MgOId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagObszary ON
                    inserted.MgA_MgOId = CDN.MagObszary.MgO_Id
              WHERE CDN.MagObszary.MgO_Id IS NULL
                AND (
                          IsNull(inserted.MgA_MgOId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagObszary) [MagAdresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MgA_MPAId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagParAdr ON
                    inserted.MgA_MPAId = CDN.MagParAdr.MPA_Id
              WHERE CDN.MagParAdr.MPA_Id IS NULL
                AND (
                          IsNull(inserted.MgA_MPAId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagParAdr) [MagAdresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagAdresyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagAdresyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagAdresyAlias_DeleteHandler
  ON CDN.MagAdresy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwArk
    IF EXISTS
       ( SELECT * FROM CDN.InwArk JOIN deleted
          ON
                deleted.MgA_Id = CDN.InwArk.InA_MgAIdDo
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Adres został użyty w inwentaryzacji, nie może zostać usunięty./# [MagAdresyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MaEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MaEPrimary */</I><BR>
ALTER TABLE CDN.MagElem ADD CONSTRAINT FK_MaEPrimary
 FOREIGN KEY
   (
                          MaE_GIDNumer                      
                         )
             REFERENCES CDN.MagNag
                         (
                          MaN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagElem_DeleteHandler
  ON CDN.MagElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.MaE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.MaE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in (1089,1601,1602,1093,1605) AND  CDN.AtrybutyHist.Ath_OBILp&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.MaE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.MaE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in (1089,1601,1602,1093,1605) AND  CDN.AtrybutyHist.Ath_OBILp&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.MaE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.MaE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp in (1089,1601,1602,1093,1605) AND  CDN.Atrybuty.Atr_OBILp&gt;0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.MaE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.MaE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp in (1089,1601,1602,1093,1605) AND  CDN.Atrybuty.Atr_OBILp&gt;0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MagPElem
    IF EXISTS(SELECT * FROM CDN.MagPElem JOIN deleted
            ON 
          deleted.MaE_GIDNumer = CDN.MagPElem.MaP_GIDNumer
      AND deleted.MaE_GIDLp = CDN.MagPElem.MaP_GIDLp
      AND (CDN.MagPElem.MaP_GIDNumer&gt;0)
            )
        DELETE CDN.MagPElem
        FROM CDN.MagPElem JOIN deleted
        ON 
          deleted.MaE_GIDNumer = CDN.MagPElem.MaP_GIDNumer
      AND deleted.MaE_GIDLp = CDN.MagPElem.MaP_GIDLp
      AND (CDN.MagPElem.MaP_GIDNumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MagSElem
    IF EXISTS(SELECT * FROM CDN.MagSElem JOIN deleted
            ON 
          deleted.MaE_GIDNumer = CDN.MagSElem.MaS_GIDNumer
      AND deleted.MaE_GIDLp = CDN.MagSElem.MaS_GIDLp
      AND (CDN.MagSElem.MaS_GIDNumer&gt;0)
            )
        DELETE CDN.MagSElem
        FROM CDN.MagSElem JOIN deleted
        ON 
          deleted.MaE_GIDNumer = CDN.MagSElem.MaS_GIDNumer
      AND deleted.MaE_GIDLp = CDN.MagSElem.MaS_GIDLp
      AND (CDN.MagSElem.MaS_GIDNumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.MaE_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND deleted.MaE_GIDLp = CDN.WysRelacje.WYR_DokLp
      AND (CDN.WysRelacje.WyR_DokTyp in (1601,1089,1605,1093) and  CDN.WysRelacje.WyR_DokLp&gt;0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.MaE_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND deleted.MaE_GIDLp = CDN.WysRelacje.WYR_DokLp
      AND (CDN.WysRelacje.WyR_DokTyp in (1601,1089,1605,1093) and  CDN.WysRelacje.WyR_DokLp&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagElem_InsertUpdateHandler
  ON CDN.MagElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MaE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.MaE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MaE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [MagElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MaLPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MaLPrimary */</I><BR>
ALTER TABLE CDN.MagLElem ADD CONSTRAINT FK_MaLPrimary
 FOREIGN KEY
   (
                          MaL_MaENumer                      ,
                          MaL_MaELp                         
                         )
             REFERENCES CDN.MagElem
                         (
                          MaE_GIDNumer                      ,
                          MaE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MaLPOBID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MaLPOBID */</I><BR>
ALTER TABLE CDN.MagLElem ADD CONSTRAINT FK_MaLPOBID
 FOREIGN KEY
   (
                          MaL_POBID                         
                         )
             REFERENCES CDN.ProdObiekty
                         (
                          POB_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagNag_DeleteHandler
  ON CDN.MagNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwMag
    IF EXISTS
       ( SELECT * FROM CDN.InwMag JOIN deleted
          ON
                deleted.MaN_GIDNumer = CDN.InwMag.InM_WMNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Dokument WM został wygenerowany z inwentaryzacji, nie może zostać usunięty./# [MagNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.MaN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=1601)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.MaN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=1601)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_Procesy
    IF EXISTS(SELECT * FROM CDN.WF_Procesy JOIN deleted
            ON 
          deleted.MaN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (1089, 1601, 1602))
            )
        DELETE CDN.WF_Procesy
        FROM CDN.WF_Procesy JOIN deleted
        ON 
          deleted.MaN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (1089, 1601, 1602))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.MaN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (1089,1601,1602))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.MaN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (1089,1601,1602))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.MaN_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp in (1601,1089,1605,1093) and  CDN.WysRelacje.WyR_DokLp=0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.MaN_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp in (1601,1089,1605,1093) and  CDN.WysRelacje.WyR_DokLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.MaN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (1089,1601,1602,1093,1605) AND CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.MaN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (1089,1601,1602,1093,1605) AND CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.MaN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp in (1089,1601,1602,1093,1605) AND CDN.AtrybutyHist.Ath_OBILp=0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.MaN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp in (1089,1601,1602,1093,1605) AND CDN.AtrybutyHist.Ath_OBILp=0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Rezerwacje
    IF EXISTS(SELECT * FROM CDN.Rezerwacje JOIN deleted
            ON 
          deleted.MaN_GIDNumer = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=1605)
            )
        DELETE CDN.Rezerwacje
        FROM CDN.Rezerwacje JOIN deleted
        ON 
          deleted.MaN_GIDNumer = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=1605)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RezerwacjeWPrzyszlosc
    IF EXISTS(SELECT * FROM CDN.RezerwacjeWPrzyszlosc JOIN deleted
            ON 
          deleted.MaN_GIDNumer = CDN.RezerwacjeWPrzyszlosc.RezP_ZrdNumer
      AND (CDN.RezerwacjeWPrzyszlosc.RezP_ZrdTyp=1605)
            )
        DELETE CDN.RezerwacjeWPrzyszlosc
        FROM CDN.RezerwacjeWPrzyszlosc JOIN deleted
        ON 
          deleted.MaN_GIDNumer = CDN.RezerwacjeWPrzyszlosc.RezP_ZrdNumer
      AND (CDN.RezerwacjeWPrzyszlosc.RezP_ZrdTyp=1605)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagNag_InsertUpdateHandler
  ON CDN.MagNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MaN_TrasaId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TrasyNag ON
                    inserted.MaN_TrasaId = CDN.TrasyNag.TsN_Id
              WHERE CDN.TrasyNag.TsN_Id IS NULL
                AND (
                          IsNull(inserted.MaN_TrasaId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TrasyNag) [MagNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaN_MagDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.MaN_MagDNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MaN_MagDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [MagNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MaN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.MaN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.MaN_KntTyp=32)
                AND (
                          IsNull(inserted.MaN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [MagNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaN_KnATyp )  OR UPDATE( MaN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.MaN_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.MaN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MaN_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.MaN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [MagNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagNagAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagNagAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagNagAlias1_DeleteHandler
  ON CDN.MagNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwMag
    IF EXISTS
       ( SELECT * FROM CDN.InwMag JOIN deleted
          ON
                deleted.MaN_GIDNumer = CDN.InwMag.InM_MPNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Dokument MP został wygenerowany z inwentaryzacji, nie może zostać usunięty./# [MagNagAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagNagAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagNagAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagNagAlias_DeleteHandler
  ON CDN.MagNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwMag
    IF EXISTS
       ( SELECT * FROM CDN.InwMag JOIN deleted
          ON
                deleted.MaN_GIDNumer = CDN.InwMag.InM_PMNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Dokument PM został wygenerowany z inwentaryzacji, nie może zostać usunięty./# [MagNagAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagObszary_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagObszary_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagObszary_DeleteHandler
  ON CDN.MagObszary
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagStruktura
    IF EXISTS
       ( SELECT * FROM CDN.MagStruktura JOIN deleted
          ON
                deleted.MgO_Id = CDN.MagStruktura.MgS_MgOId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagStruktura) [MagObszary_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagAdresy
    IF EXISTS
       ( SELECT * FROM CDN.MagAdresy JOIN deleted
          ON
                deleted.MgO_Id = CDN.MagAdresy.MgA_MgOId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagAdresy) [MagObszary_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagObszary_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagObszary_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagObszary_InsertUpdateHandler
  ON CDN.MagObszary
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MgO_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.MgO_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MgO_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [MagObszary_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MOOMag"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MOOMag */</I><BR>
ALTER TABLE CDN.MagOsobyOdpowiedzialne ADD CONSTRAINT FK_MOOMag
 FOREIGN KEY
   (
                          MOO_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagOsobyOdpowiedzialne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagOsobyOdpowiedzialne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagOsobyOdpowiedzialne_InsertUpdateHandler
  ON CDN.MagOsobyOdpowiedzialne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MOO_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.MOO_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MOO_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [MagOsobyOdpowiedzialne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagPElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagPElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagPElem_DeleteHandler
  ON CDN.MagPElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.MaP_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.MaP_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.MaP_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in (-1089,-1601,-1602,-1093,-1605) AND  CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.MaP_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.MaP_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.MaP_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in (-1089,-1601,-1602,-1093,-1605) AND  CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.MaP_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.MaP_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.MaP_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND (CDN.Atrybuty.Atr_OBITyp in (-1089,-1601,-1602,-1093,-1605) AND  CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.MaP_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.MaP_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.MaP_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND (CDN.Atrybuty.Atr_OBITyp in (-1089,-1601,-1602,-1093,-1605) AND  CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagPElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagPElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagPElem_InsertUpdateHandler
  ON CDN.MagPElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MaP_MgAId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MaP_MgAID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagAdresy ON
                    inserted.MaP_MgAId = CDN.MagAdresy.MgA_Id
              WHERE CDN.MagAdresy.MgA_Id IS NULL AND (inserted.MaP_MgAID&gt;0)
                AND (
                          IsNull(inserted.MaP_MgAId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagAdresy) [MagPElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaP_GIDNumer )  OR UPDATE( MaP_GIDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MaP_GIDNumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagElem ON
                    inserted.MaP_GIDNumer = CDN.MagElem.MaE_GIDNumer
                AND inserted.MaP_GIDLp = CDN.MagElem.MaE_GIDLp
              WHERE CDN.MagElem.MaE_GIDLp IS NULL AND (inserted.MaP_GIDNumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagElem) [MagPElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AMaPPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AMaPPrimary */</I><BR>
ALTER TABLE CDN.MagPElemArc ADD CONSTRAINT FK_AMaPPrimary
 FOREIGN KEY
   (
                          AMaP_GIDNumer                      ,
                          AMaP_GIDLp                         
                         )
             REFERENCES CDN.MagElem
                         (
                          MaE_GIDNumer                      ,
                          MaE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagParAdr_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagParAdr_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagParAdr_DeleteHandler
  ON CDN.MagParAdr
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagAdresy
    IF EXISTS
       ( SELECT * FROM CDN.MagAdresy JOIN deleted
          ON
                deleted.MPA_Id = CDN.MagAdresy.MgA_MPAId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagAdresy) [MagParAdr_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MPJPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MPJPrimary */</I><BR>
ALTER TABLE CDN.MagParJednostki ADD CONSTRAINT FK_MPJPrimary
 FOREIGN KEY
   (
                          MPJ_MPAId                         
                         )
             REFERENCES CDN.MagParAdr
                         (
                          MPA_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagParJednostki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagParJednostki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagParJednostki_InsertUpdateHandler
  ON CDN.MagParJednostki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MPJ_JednostkaLog ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MPJ_JednostkaLog&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.MPJ_JednostkaLog = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.MPJ_JednostkaLog&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [MagParJednostki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MprPrmId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MprPrmId */</I><BR>
ALTER TABLE CDN.MagPromocje ADD CONSTRAINT FK_MprPrmId
 FOREIGN KEY
   (
                          MPR_PrmId                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagPromocje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagPromocje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagPromocje_InsertUpdateHandler
  ON CDN.MagPromocje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MPR_MagNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MpR_MagNumer &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.MPR_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.MpR_MagNumer &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [MagPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagSElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagSElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagSElem_DeleteHandler
  ON CDN.MagSElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.MaS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.MaS_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.MaS_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND (CDN.Atrybuty.Atr_OBITyp in (1089,1601,1602,1093,1605) AND  CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.MaS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.MaS_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.MaS_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND (CDN.Atrybuty.Atr_OBITyp in (1089,1601,1602,1093,1605) AND  CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.MaS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.MaS_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.MaS_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in (1089,1601,1602,1093,1605) AND  CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.MaS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.MaS_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.MaS_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in (1089,1601,1602,1093,1605) AND  CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagSElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagSElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagSElem_InsertUpdateHandler
  ON CDN.MagSElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MaS_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.MaS_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MaS_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [MagSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaS_ZlcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Mas_ZlcTyp=14346)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.MaS_ZlcNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.Mas_ZlcTyp=14346)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [MagSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaS_ZlcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MaS_ZLCTYP = 14345)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.MaS_ZlcNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.MaS_ZLCTYP = 14345)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [MagSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaS_GIDNumer )  OR UPDATE( MaS_GIDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MaS_GIDNumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagElem ON
                    inserted.MaS_GIDNumer = CDN.MagElem.MaE_GIDNumer
                AND inserted.MaS_GIDLp = CDN.MagElem.MaE_GIDLp
              WHERE CDN.MagElem.MaE_GIDLp IS NULL AND (inserted.MaS_GIDNumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagElem) [MagSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaS_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.MaS_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MaS_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [MagSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MaS_ZrdTyp )  OR UPDATE( MaS_ZrdNumer )  OR UPDATE( MaS_ZrdLp )  OR UPDATE( MaS_SubZrdLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Mas_ZrdTyp NOT IN (0, 2576, 2592))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraSElem ON
                    inserted.MaS_ZrdTyp = CDN.TraSElem.TrS_GIDTyp
                AND inserted.MaS_ZrdNumer = CDN.TraSElem.TrS_GIDNumer
                AND inserted.MaS_ZrdLp = CDN.TraSElem.TrS_GIDLp
                AND inserted.MaS_SubZrdLp = CDN.TraSElem.TrS_SubGIDLp
              WHERE CDN.TraSElem.TrS_SubGIDLp IS NULL AND (inserted.Mas_ZrdTyp NOT IN (0, 2576, 2592))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraSElem) [MagSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_AMaSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_AMaSPrimary */</I><BR>
ALTER TABLE CDN.MagSElemArc ADD CONSTRAINT FK_AMaSPrimary
 FOREIGN KEY
   (
                          AMaS_GIDNumer                      ,
                          AMaS_GIDLp                         
                         )
             REFERENCES CDN.MagElem
                         (
                          MaE_GIDNumer                      ,
                          MaE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagStruktura_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagStruktura_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagStruktura_InsertUpdateHandler
  ON CDN.MagStruktura
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MgS_MgOId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagObszary ON
                    inserted.MgS_MgOId = CDN.MagObszary.MgO_Id
              WHERE CDN.MagObszary.MgO_Id IS NULL
                AND (
                          IsNull(inserted.MgS_MgOId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagObszary) [MagStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MTOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MTOPrimary */</I><BR>
ALTER TABLE CDN.MagTwrObszary ADD CONSTRAINT FK_MTOPrimary
 FOREIGN KEY
   (
                          MTO_MgOId                         
                         )
             REFERENCES CDN.MagObszary
                         (
                          MgO_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagTwrObszary_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagTwrObszary_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MagTwrObszary_InsertUpdateHandler
  ON CDN.MagTwrObszary
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MTO_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MTO_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.MTO_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.MTO_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [MagTwrObszary_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MGWMagazyn"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MGWMagazyn */</I><BR>
ALTER TABLE CDN.MagWybor ADD CONSTRAINT FK_MGWMagazyn
 FOREIGN KEY
   (
                          MgW_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Magazyny_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Magazyny_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Magazyny_DeleteHandler
  ON CDN.Magazyny
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.KntAplikacje JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.KntAplikacje.KAp_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntAplikacje) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoLog
    IF EXISTS
       ( SELECT * FROM CDN.PicoLog JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.PicoLog.PcL_ObiNumer
            
       AND (CDN.PicoLog.PcL_OBITyp=208)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć magazynu ponieważ został on przesynchronizowany do Oddziału Offline. /# [Magazyny_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrAnalizaElem
    IF EXISTS
       ( SELECT * FROM CDN.TwrAnalizaElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TwrAnalizaElem.TAE_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrAnalizaElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ZlcNag.ZcN_MaZNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wolne
    IF EXISTS
       ( SELECT * FROM CDN.Wolne JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.Wolne.WOL_MagNumer
       AND (  CDN.Wolne.Wol_Typ in ( 8, 9 ,27))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wolne) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNMaterialy
    IF EXISTS
       ( SELECT * FROM CDN.ZRNMaterialy JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ZRNMaterialy.ZRM_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNMaterialy) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcElem
    IF EXISTS
       ( SELECT * FROM CDN.ZlcElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ZlcElem.ZcE_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ZamNag.ZaN_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamElem
    IF EXISTS
       ( SELECT * FROM CDN.ZamElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ZamElem.ZaE_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrStanyBufor
    IF EXISTS
       ( SELECT * FROM CDN.TwrStanyBufor JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TwrStanyBufor.TSB_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrStanyBufor) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrZasobyMag
    IF EXISTS
       ( SELECT * FROM CDN.TwrZasobyMag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TwrZasobyMag.TZM_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrZasobyMag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrWzorce
    IF EXISTS
       ( SELECT * FROM CDN.TwrWzorce JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TwrWzorce.TwW_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrWzorce) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrStany
    IF EXISTS
       ( SELECT * FROM CDN.TwrStany JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TwrStany.TWS_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrStany) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BstMagazyny
    IF EXISTS
       ( SELECT * FROM CDN.BstMagazyny JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.BstMagazyny.BsM_MagNumer
       AND (CDN.BstMagazyny.BsM_MagTyp = 208)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BstMagazyny) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrKarty
    IF EXISTS
       ( SELECT * FROM CDN.TwrKarty JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TwrKarty.Twr_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrKarty) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ZlcRemNag.ZRN_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraSElem
    IF EXISTS
       ( SELECT * FROM CDN.TraSElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TraSElem.TrS_MagNumer
       AND (CDN.TraSElem.Trs_MagTyp=208)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraSElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TKNag
    IF EXISTS
       ( SELECT * FROM CDN.TKNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TKNag.TKN_MagZNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TKNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TKSElem
    IF EXISTS
       ( SELECT * FROM CDN.TKSElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TKSElem.TKS_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TKSElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklElem
    IF EXISTS
       ( SELECT * FROM CDN.ReklElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ReklElem.RLE_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ReklElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rezerwacje
    IF EXISTS
       ( SELECT * FROM CDN.Rezerwacje JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.Rezerwacje.Rez_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rezerwacje) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.NtsNag
    IF EXISTS
       ( SELECT * FROM CDN.NtsNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.NtsNag.NtN_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą NtsNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdZasoby JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ProdZasoby.PZA_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZasoby) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagObszary
    IF EXISTS
       ( SELECT * FROM CDN.MagObszary JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.MagObszary.MgO_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagObszary) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagSElem
    IF EXISTS
       ( SELECT * FROM CDN.MagSElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.MagSElem.MaS_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagSElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntZasoby
    IF EXISTS
       ( SELECT * FROM CDN.KntZasoby JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.KntZasoby.KnZ_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntZasoby) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagNag
    IF EXISTS
       ( SELECT * FROM CDN.MagNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.MagNag.MaN_MagDNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BstNag
    IF EXISTS
       ( SELECT * FROM CDN.BstNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.BstNag.BsN_MagNNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BstNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.AtstNag
    IF EXISTS
       ( SELECT * FROM CDN.AtstNag JOIN deleted
          ON
                deleted.Mag_Kod = CDN.AtstNag.ATN_Magazyn
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą AtstNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TraNag.TrN_MagDNumer
       AND (CDN.TraNag.TrN_MagDTyp=208)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaZasoby JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ProdTechnologiaZasoby.PTZ_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologiaZasoby) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrParMag
    IF EXISTS
       ( SELECT * FROM CDN.TwrParMag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TwrParMag.TPM_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrParMag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.FrmStruktura.FRS_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RecNag
    IF EXISTS
       ( SELECT * FROM CDN.RecNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.RecNag.ReN_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą RecNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RecElem
    IF EXISTS
       ( SELECT * FROM CDN.RecElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.RecElem.ReE_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą RecElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KBNOdpowiedzialni
    IF EXISTS
       ( SELECT * FROM CDN.KBNOdpowiedzialni JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.KBNOdpowiedzialni.KBNO_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KBNOdpowiedzialni) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdRekomendacjeProdukty
    IF EXISTS
       ( SELECT * FROM CDN.ProdRekomendacjeProdukty JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ProdRekomendacjeProdukty.PREP_MagNumer
       AND (CDN.ProdRekomendacjeProdukty.PREP_MagNumer NOT IN (0,-1))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdRekomendacjeProdukty) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ProdPKJNag.PKJN_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RezerwacjeWPrzyszlosc
    IF EXISTS
       ( SELECT * FROM CDN.RezerwacjeWPrzyszlosc JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.RezerwacjeWPrzyszlosc.RezP_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą RezerwacjeWPrzyszlosc) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdProcesy
    IF EXISTS
       ( SELECT * FROM CDN.ProdProcesy JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ProdProcesy.PPC_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdProcesy) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecElem
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecElem JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ProdZlecElem.PZE_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZlecElem) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdOperacjeMagazyny
    IF EXISTS
       ( SELECT * FROM CDN.ProdOperacjeMagazyny JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ProdOperacjeMagazyny.POM_MagNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdOperacjeMagazyny) [Magazyny_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MagPromocje
    IF EXISTS(SELECT * FROM CDN.MagPromocje JOIN deleted
            ON 
          deleted.Mag_GIDNumer = CDN.MagPromocje.MPR_MagNumer
      AND (CDN.MagPromocje.MpR_MagNumer &gt; 0)
            )
        DELETE CDN.MagPromocje
        FROM CDN.MagPromocje JOIN deleted
        ON 
          deleted.Mag_GIDNumer = CDN.MagPromocje.MPR_MagNumer
      AND (CDN.MagPromocje.MpR_MagNumer &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrmObiekty
    IF EXISTS(SELECT * FROM CDN.FrmObiekty JOIN deleted
            ON 
          deleted.Mag_GIDNumer = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=208)
            )
        DELETE CDN.FrmObiekty
        FROM CDN.FrmObiekty JOIN deleted
        ON 
          deleted.Mag_GIDNumer = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=208)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokRelacje
    IF EXISTS(SELECT * FROM CDN.DokRelacje JOIN deleted
            ON 
          deleted.Mag_GIDNumer = CDN.DokRelacje.DoR_MSNumer
      AND (CDN.DokRelacje.DoR_MSTyp=208)
            )
        DELETE CDN.DokRelacje
        FROM CDN.DokRelacje JOIN deleted
        ON 
          deleted.Mag_GIDNumer = CDN.DokRelacje.DoR_MSNumer
      AND (CDN.DokRelacje.DoR_MSTyp=208)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroMagazyny
    IF EXISTS(SELECT * FROM CDN.RetroMagazyny JOIN deleted
            ON 
          deleted.Mag_GIDNumer = CDN.RetroMagazyny.Rtm_MagNumer
      AND (CDN.RetroMagazyny.Rtm_MagNumer&gt;0)
            )
        DELETE CDN.RetroMagazyny
        FROM CDN.RetroMagazyny JOIN deleted
        ON 
          deleted.Mag_GIDNumer = CDN.RetroMagazyny.Rtm_MagNumer
      AND (CDN.RetroMagazyny.Rtm_MagNumer&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Magazyny_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Magazyny_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Magazyny_InsertUpdateHandler
  ON CDN.Magazyny
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Mag_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Mag_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Mag_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Mag_KntTyp=32)
                AND (
                          IsNull(inserted.Mag_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Magazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MagazynyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MagazynyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MagazynyAlias_DeleteHandler
  ON CDN.Magazyny
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.KntAplikacje JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.KntAplikacje.KAp_MagMSNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntAplikacje) [MagazynyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ZlcNag.ZcN_MaDNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcNag) [MagazynyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.ZamNag.ZaN_MagDNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [MagazynyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TraNag.TrN_MagZNumer
       AND (CDN.TraNag.TrN_MagZTyp=208)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [MagazynyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TKNag
    IF EXISTS
       ( SELECT * FROM CDN.TKNag JOIN deleted
          ON
                deleted.Mag_GIDNumer = CDN.TKNag.TKN_MagDNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TKNag) [MagazynyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MdeSymbol"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MdeSymbol */</I><BR>
ALTER TABLE CDN.MemDokElem ADD CONSTRAINT FK_MdeSymbol
 FOREIGN KEY
   (
                          MDE_SymbolID                      
                         )
             REFERENCES CDN.MemSymbole
                         (
                          MES_SymbolID                      
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MdePrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MdePrimaryNoType */</I><BR>
ALTER TABLE CDN.MemDokElem ADD CONSTRAINT FK_MdePrimaryNoType
 FOREIGN KEY
   (
                          MDE_GIDNumer                      
                         )
             REFERENCES CDN.MemDokNag
                         (
                          MDN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MemDokNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MemDokNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MemDokNag_DeleteHandler
  ON CDN.MemDokNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemNag
    IF EXISTS
       ( SELECT * FROM CDN.MemNag JOIN deleted
          ON
                deleted.MDN_GIDNumer = CDN.MemNag.MEN_MDNNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemNag) [MemDokNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RodzajeBonow
    IF EXISTS
       ( SELECT * FROM CDN.RodzajeBonow JOIN deleted
          ON
                deleted.MDN_GIDNumer = CDN.RodzajeBonow.RBo_MdnNumer
       AND (CDN.RodzajeBonow.RBo_MdnTyp=4128)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą RodzajeBonow) [MemDokNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoKonfig
    IF EXISTS
       ( SELECT * FROM CDN.PicoKonfig JOIN deleted
          ON
                deleted.MDN_GIDNumer = CDN.PicoKonfig.PcK_MdNNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PicoKonfig) [MemDokNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_MeePrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_MeePrimaryNoType */</I><BR>
ALTER TABLE CDN.MemElem ADD CONSTRAINT FK_MeePrimaryNoType
 FOREIGN KEY
   (
                          MEE_GIDNumer                      
                         )
             REFERENCES CDN.MemNag
                         (
                          MEN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MemElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MemElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MemElem_DeleteHandler
  ON CDN.MemElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.MEE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.MEE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (4144,4145,4146) and CDN.DaneObiekty.DAO_ObiLp&lt;&gt;0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.MEE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.MEE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (4144,4145,4146) and CDN.DaneObiekty.DAO_ObiLp&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.MEE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.MEE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.MEE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=4144 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and         CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.MEE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.MEE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.MEE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=4144 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and         CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.MEE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.MEE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.MEE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4144 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.MEE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.MEE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.MEE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4144 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and         CDN.AtrybutyHist.Ath_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MemElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MemElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MemElem_InsertUpdateHandler
  ON CDN.MemElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MEE_KNDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.MEE_KNDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MEE_KNDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [MemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEE_KKSNumerDT ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konta ON
                    inserted.MEE_KKSNumerDT = CDN.Konta.KKS_GIDNumer
              WHERE CDN.Konta.KKS_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MEE_KKSNumerDT,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konta) [MemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEE_KKSNumerCT ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konta ON
                    inserted.MEE_KKSNumerCT = CDN.Konta.KKS_GIDNumer
              WHERE CDN.Konta.KKS_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MEE_KKSNumerCT,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konta) [MemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEE_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MEE_KntTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.MEE_KNTNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.MEE_KntTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [MemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEE_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MEE_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.MEE_KNTNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.MEE_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [MemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEE_SymbolID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemSymbole ON
                    inserted.MEE_SymbolID = CDN.MemSymbole.MES_SymbolID
              WHERE CDN.MemSymbole.MES_SymbolID IS NULL
                AND (
                          IsNull(inserted.MEE_SymbolID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemSymbole) [MemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEE_BbonID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Bony ON
                    inserted.MEE_BbonID = CDN.Bony.Bbon_Id
              WHERE CDN.Bony.Bbon_Id IS NULL
                AND (
                          IsNull(inserted.MEE_BbonID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Bony) [MemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MemNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MemNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MemNag_DeleteHandler
  ON CDN.MemNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemNag
    IF EXISTS
       ( SELECT * FROM CDN.MemNag JOIN deleted
          ON
                deleted.MEN_GIDNumer = CDN.MemNag.MEN_ORGNumer
            
       AND (CDN.MemNag.MEN_ORGTYP IN (4145, 4146))
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć. Nota posiada korektę/# [MemNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.MEN_GIDNumer = CDN.WydatkiPracownikow.WPR_DokNumer
       AND (  CDN.WydatkiPracownikow.WPR_DokTyp in ( 4144,4145,4146))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WydatkiPracownikow) [MemNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WysKoszty
    IF EXISTS
       ( SELECT * FROM CDN.WysKoszty JOIN deleted
          ON
                deleted.MEN_GIDNumer = CDN.WysKoszty.WyK_DokNumer
       AND (CDN.WysKoszty.WyK_DokTyp in (4144,4145,4146))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WysKoszty) [MemNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_Procesy
    IF EXISTS(SELECT * FROM CDN.WF_Procesy JOIN deleted
            ON 
          deleted.MEN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (4144, 4145, 4146))
            )
        DELETE CDN.WF_Procesy
        FROM CDN.WF_Procesy JOIN deleted
        ON 
          deleted.MEN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (4144, 4145, 4146))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.MEN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (4144,4145,4146) and CDN.DaneObiekty.DAO_ObiLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.MEN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (4144,4145,4146) and CDN.DaneObiekty.DAO_ObiLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrtDokZakupu
    IF EXISTS(SELECT * FROM CDN.SrtDokZakupu JOIN deleted
            ON 
          deleted.MEN_GIDNumer = CDN.SrtDokZakupu.SDZ_DokNumer
      AND (CDN.SrtDokZakupu.SDZ_DokTyp in (4144,4145,4146))
            )
        DELETE CDN.SrtDokZakupu
        FROM CDN.SrtDokZakupu JOIN deleted
        ON 
          deleted.MEN_GIDNumer = CDN.SrtDokZakupu.SDZ_DokNumer
      AND (CDN.SrtDokZakupu.SDZ_DokTyp in (4144,4145,4146))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OpisWymNag
    IF EXISTS(SELECT * FROM CDN.OpisWymNag JOIN deleted
            ON 
          deleted.MEN_GIDTyp = CDN.OpisWymNag.OWN_GIDTyp
      AND deleted.MEN_GIDNumer = CDN.OpisWymNag.OWN_GIDNumer
      AND (CDN.OpisWymNag.OWN_GIDTyp in (4144,4145,4146))
            )
        DELETE CDN.OpisWymNag
        FROM CDN.OpisWymNag JOIN deleted
        ON 
          deleted.MEN_GIDTyp = CDN.OpisWymNag.OWN_GIDTyp
      AND deleted.MEN_GIDNumer = CDN.OpisWymNag.OWN_GIDNumer
      AND (CDN.OpisWymNag.OWN_GIDTyp in (4144,4145,4146))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.MEN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (4144,4145))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.MEN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (4144,4145))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.MEN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_ObiTyp in (4144,4145,4146) and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.MEN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_ObiTyp in (4144,4145,4146) and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.MEN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp in (4144,4145,4146))
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.MEN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp in (4144,4145,4146))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.MEN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBILp = 0 and CDN.AtrybutyHist.Ath_OBITyp in (4144,4145,4146) and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.MEN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBILp = 0 and CDN.AtrybutyHist.Ath_OBITyp in (4144,4145,4146) and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.MEN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (4144,4145,4146))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.MEN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (4144,4145,4146))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MemNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MemNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MemNag_InsertUpdateHandler
  ON CDN.MemNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MEN_KNDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.MEN_KNDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MEN_KNDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [MemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEN_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MEN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.MEN_KNTNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.MEN_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [MemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEN_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MEN_KntTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.MEN_KNTNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.MEN_KntTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [MemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( MEN_MDNNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemDokNag ON
                    inserted.MEN_MDNNumer = CDN.MemDokNag.MDN_GIDNumer
              WHERE CDN.MemDokNag.MDN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.MEN_MDNNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemDokNag) [MemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MemNagAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MemNagAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.MemNagAlias_InsertUpdateHandler
  ON CDN.MemNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( MEN_ORGNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.MEN_ORGTYP IN (4145, 4146))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.MEN_ORGNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.MEN_ORGTYP IN (4145, 4146))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [MemNagAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="MemSymbole_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* MemSymbole_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.MemSymbole_DeleteHandler
  ON CDN.MemSymbole
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemElem
    IF EXISTS
       ( SELECT * FROM CDN.MemElem JOIN deleted
          ON
                deleted.MES_SymbolID = CDN.MemElem.MEE_SymbolID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemElem) [MemSymbole_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_NaRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_NaRPrimary */</I><BR>
ALTER TABLE CDN.NazRelacje ADD CONSTRAINT FK_NaRPrimary
 FOREIGN KEY
   (
                          NaR_NazTyp                        ,
                          NaR_NazLp                         
                         )
             REFERENCES CDN.Nazwy
                         (
                          Naz_GIDTyp                        ,
                          Naz_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Nazwy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Nazwy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Nazwy_DeleteHandler
  ON CDN.Nazwy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Tlumaczenia
    IF EXISTS(SELECT * FROM CDN.Tlumaczenia JOIN deleted
            ON 
          deleted.Naz_GIDLp = CDN.Tlumaczenia.TLM_Numer
      AND deleted.Naz_GIDTyp = CDN.Tlumaczenia.TLM_Typ
      AND (CDN.Tlumaczenia.TLM_Typ IN (144,64))
            )
        DELETE CDN.Tlumaczenia
        FROM CDN.Tlumaczenia JOIN deleted
        ON 
          deleted.Naz_GIDLp = CDN.Tlumaczenia.TLM_Numer
      AND deleted.Naz_GIDTyp = CDN.Tlumaczenia.TLM_Typ
      AND (CDN.Tlumaczenia.TLM_Typ IN (144,64))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SpDPromocje
    IF EXISTS(SELECT * FROM CDN.SpDPromocje JOIN deleted
            ON 
          deleted.Naz_GIDTyp = CDN.SpDPromocje.SpD_SpDTyp
      AND deleted.Naz_GIDLp = CDN.SpDPromocje.SpD_SpDLp
      AND (CDN.SpDPromocje.SpD_SpDTyp = 976 AND CDN.SpDPromocje.SpD_SpDLp &gt; 0)
            )
        DELETE CDN.SpDPromocje
        FROM CDN.SpDPromocje JOIN deleted
        ON 
          deleted.Naz_GIDTyp = CDN.SpDPromocje.SpD_SpDTyp
      AND deleted.Naz_GIDLp = CDN.SpDPromocje.SpD_SpDLp
      AND (CDN.SpDPromocje.SpD_SpDTyp = 976 AND CDN.SpDPromocje.SpD_SpDLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroSpD
    IF EXISTS(SELECT * FROM CDN.RetroSpD JOIN deleted
            ON 
          deleted.Naz_GIDTyp = CDN.RetroSpD.RtS_SpDTyp
      AND deleted.Naz_GIDLp = CDN.RetroSpD.RtS_SpDLp
      AND (CDN.RetroSpD.RtS_SpDTyp=976 AND CDN.RetroSpD.RtS_SpDLp&gt;0)
            )
        DELETE CDN.RetroSpD
        FROM CDN.RetroSpD JOIN deleted
        ON 
          deleted.Naz_GIDTyp = CDN.RetroSpD.RtS_SpDTyp
      AND deleted.Naz_GIDLp = CDN.RetroSpD.RtS_SpDLp
      AND (CDN.RetroSpD.RtS_SpDTyp=976 AND CDN.RetroSpD.RtS_SpDLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KodyCNJednostkiSent
    IF EXISTS(SELECT * FROM CDN.KodyCNJednostkiSent JOIN deleted
            ON 
          deleted.Naz_Nazwa = CDN.KodyCNJednostkiSent.KCNJ_Jm
      AND (deleted.Naz_GIDTyp=144)
            )
        DELETE CDN.KodyCNJednostkiSent
        FROM CDN.KodyCNJednostkiSent JOIN deleted
        ON 
          deleted.Naz_Nazwa = CDN.KodyCNJednostkiSent.KCNJ_Jm
      AND (deleted.Naz_GIDTyp=144)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RodzajUpomnieniaParametryProcesow
    IF EXISTS(SELECT * FROM CDN.RodzajUpomnieniaParametryProcesow JOIN deleted
            ON 
          deleted.Naz_GIDLp = CDN.RodzajUpomnieniaParametryProcesow.RUPP_RodzicLp
      AND deleted.Naz_GIDTyp = CDN.RodzajUpomnieniaParametryProcesow.RUPP_RodzicTyp
      AND (CDN.RodzajUpomnieniaParametryProcesow.RUPP_RodzicTyp=2688)
            )
        DELETE CDN.RodzajUpomnieniaParametryProcesow
        FROM CDN.RodzajUpomnieniaParametryProcesow JOIN deleted
        ON 
          deleted.Naz_GIDLp = CDN.RodzajUpomnieniaParametryProcesow.RUPP_RodzicLp
      AND deleted.Naz_GIDTyp = CDN.RodzajUpomnieniaParametryProcesow.RUPP_RodzicTyp
      AND (CDN.RodzajUpomnieniaParametryProcesow.RUPP_RodzicTyp=2688)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_NtEPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_NtEPrimaryNoType */</I><BR>
ALTER TABLE CDN.NtsElem ADD CONSTRAINT FK_NtEPrimaryNoType
 FOREIGN KEY
   (
                          NtE_GIDNumer                      
                         )
             REFERENCES CDN.NtsNag
                         (
                          NtN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="NtsElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* NtsElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.NtsElem_InsertUpdateHandler
  ON CDN.NtsElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( NtE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.NtE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.NtE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [NtsElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_NtKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_NtKPrimary */</I><BR>
ALTER TABLE CDN.NtsKnt ADD CONSTRAINT FK_NtKPrimary
 FOREIGN KEY
   (
                          NtK_NtNNumer                      
                         )
             REFERENCES CDN.NtsNag
                         (
                          NtN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="NtsKnt_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* NtsKnt_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.NtsKnt_InsertUpdateHandler
  ON CDN.NtsKnt
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( NtK_KntTyp )  OR UPDATE( NtK_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.NtK_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.NtK_KntTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.NtK_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.NtK_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [NtsKnt_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( NtK_KntTyp )  OR UPDATE( NtK_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.NtK_KntTyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntGrupy ON
                    inserted.NtK_KntTyp = CDN.KntGrupy.KnG_GIDTyp
                AND inserted.NtK_KntNumer = CDN.KntGrupy.KnG_GIDNumer
              WHERE CDN.KntGrupy.KnG_GIDNumer IS NULL AND (inserted.NtK_KntTyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntGrupy) [NtsKnt_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_NtNOperator"></A><PRE>
          <FONT SIZE="2"><I>/* FK_NtNOperator */</I><BR>
ALTER TABLE CDN.NtsNag ADD CONSTRAINT FK_NtNOperator
 FOREIGN KEY
   (
                          NtN_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="NtsNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* NtsNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.NtsNag_InsertUpdateHandler
  ON CDN.NtsNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( NtN_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.NtN_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.NtN_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [NtsNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="NumeryRachunkow_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* NumeryRachunkow_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.NumeryRachunkow_InsertUpdateHandler
  ON CDN.NumeryRachunkow
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( NRB_ObTyp )  OR UPDATE( NRB_ObNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.NrB_ObTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.NRB_ObTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.NRB_ObNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.NrB_ObTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [NumeryRachunkow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( NRB_ObNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.NrB_ObTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.NRB_ObNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.NrB_ObTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [NumeryRachunkow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( NRB_ObNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.NrB_ObTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.NRB_ObNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.NrB_ObTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [NumeryRachunkow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OLLGrupy"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OLLGrupy */</I><BR>
ALTER TABLE CDN.OLAPLinki ADD CONSTRAINT FK_OLLGrupy
 FOREIGN KEY
   (
                          OLL_OGRID                         
                         )
             REFERENCES CDN.OlapGrupy
                         (
                          OGR_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OLXPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OLXPrimary */</I><BR>
ALTER TABLE CDN.OLAPXMLData ADD CONSTRAINT FK_OLXPrimary
 FOREIGN KEY
   (
                          OLX_OWIID                         
                         )
             REFERENCES CDN.OlapWidoki
                         (
                          OWI_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ObiegNrDok_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ObiegNrDok_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ObiegNrDok_DeleteHandler
  ON CDN.ObiegNrDok
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.OND_DokID = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DOZ_DOKTyp=14455)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.OND_DokID = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DOZ_DOKTyp=14455)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ObiektyDomyslne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ObiektyDomyslne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ObiektyDomyslne_InsertUpdateHandler
  ON CDN.ObiektyDomyslne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ObD_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ObD_ObiTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ObD_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ObD_ObiTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ObiektyDomyslne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Odleglosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Odleglosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Odleglosci_InsertUpdateHandler
  ON CDN.Odleglosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Odl_OdTyp )  OR UPDATE( Odl_OdNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsObiekty ON
                    inserted.Odl_OdTyp = CDN.SrsObiekty.SOb_GIDTyp
                AND inserted.Odl_OdNumer = CDN.SrsObiekty.SOb_GIDNumer
              WHERE CDN.SrsObiekty.SOb_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Odl_OdTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.Odl_OdNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsObiekty) [Odleglosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Odl_DoTyp )  OR UPDATE( Odl_DoNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsObiekty ON
                    inserted.Odl_DoTyp = CDN.SrsObiekty.SOb_GIDTyp
                AND inserted.Odl_DoNumer = CDN.SrsObiekty.SOb_GIDNumer
              WHERE CDN.SrsObiekty.SOb_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Odl_DoTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.Odl_DoNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsObiekty) [Odleglosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OdzPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OdzPrimary */</I><BR>
ALTER TABLE CDN.OdpowiedziZadania ADD CONSTRAINT FK_OdzPrimary
 FOREIGN KEY
   (
                          ODZ_ZadId                         
                         )
             REFERENCES CDN.Zadania
                         (
                          Zad_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OZWPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OZWPrimary */</I><BR>
ALTER TABLE CDN.OdpowiedziZadaniaWielokrotne ADD CONSTRAINT FK_OZWPrimary
 FOREIGN KEY
   (
                          OZW_ZadId                         ,
                          OZW_PytId                         
                         )
             REFERENCES CDN.OdpowiedziZadania
                         (
                          ODZ_ZadId                         ,
                          ODZ_PytId                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Odsetki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Odsetki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Odsetki_InsertUpdateHandler
  ON CDN.Odsetki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ODS_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ODS_GIDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ODS_GIDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ODS_GIDTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Odsetki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Okresy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Okresy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Okresy_DeleteHandler
  ON CDN.Okresy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PodNag
    IF EXISTS
       ( SELECT * FROM CDN.PodNag JOIN deleted
          ON
                deleted.OKR_ID = CDN.PodNag.PON_OkresID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PodNag) [Okresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OkMOkrID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OkMOkrID */</I><BR>
ALTER TABLE CDN.OkresyMiesiace ADD CONSTRAINT FK_OkMOkrID
 FOREIGN KEY
   (
                          OKM_OkrID                         
                         )
             REFERENCES CDN.Okresy
                         (
                          OKR_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OpCPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OpCPrimary */</I><BR>
ALTER TABLE CDN.OpeCentra ADD CONSTRAINT FK_OpCPrimary
 FOREIGN KEY
   (
                          OpC_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OpCStruktura"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OpCStruktura */</I><BR>
ALTER TABLE CDN.OpeCentra ADD CONSTRAINT FK_OpCStruktura
 FOREIGN KEY
   (
                          OpC_FrSId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ODKDefinicjaKol"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ODKDefinicjaKol */</I><BR>
ALTER TABLE CDN.OpeDefKol ADD CONSTRAINT FK_ODKDefinicjaKol
 FOREIGN KEY
   (
                          ODK_DefID                         
                         )
             REFERENCES CDN.DefinicjeKolumn
                         (
                          DFK_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpeDefKol_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpeDefKol_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OpeDefKol_InsertUpdateHandler
  ON CDN.OpeDefKol
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ODK_OpeID )  OR UPDATE( ODK_OpeTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.ODK_OpeTyp=-4272)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmLinki ON
                    inserted.ODK_OpeID = CDN.FrmLinki.FrL_GIDNumer
                AND inserted.ODK_OpeTyp = CDN.FrmLinki.FrL_GIDTyp
              WHERE CDN.FrmLinki.FrL_GIDTyp IS NULL AND ( inserted.ODK_OpeTyp=-4272)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmLinki) [OpeDefKol_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ODK_OpeID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.ODK_OpeTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.ODK_OpeID = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND ( inserted.ODK_OpeTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [OpeDefKol_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpeKarty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpeKarty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OpeKarty_DeleteHandler
  ON CDN.OpeKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanyObciazeniaGniazd
    IF EXISTS
       ( SELECT * FROM CDN.PlanyObciazeniaGniazd JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PlanyObciazeniaGniazd.POG_OpeWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlanyObciazeniaGniazd) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPlany
    IF EXISTS
       ( SELECT * FROM CDN.ProdPlany JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdPlany.PPL_OpeWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPlany) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.KntAplikacje JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.KntAplikacje.KAp_OpeNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntAplikacje) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DaneBinarne
    IF EXISTS
       ( SELECT * FROM CDN.DaneBinarne JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.DaneBinarne.DAB_OpeNumerD
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie mozna usunąć operatora. Istnieją załączniki utworzone przez tego operatora./# [OpeKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UrzadzeniaZewnetrzneObiekty
    IF EXISTS
       ( SELECT * FROM CDN.UrzadzeniaZewnetrzneObiekty JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.UrzadzeniaZewnetrzneObiekty.UZO_ObiNumer
            
       AND (CDN.UrzadzeniaZewnetrzneObiekty.UZO_ObiTyp=128)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Operator nie może zostać usunięty, ponieważ został powiązany z urządzeniem zewnętrznym./# [OpeKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekStatusyDok
    IF EXISTS
       ( SELECT * FROM CDN.SekStatusyDok JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.SekStatusyDok.SOS_WprowadzilNumer
       AND (CDN.SekStatusyDok.SoS_WprowadzilTyp=128)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SekStatusyDok) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsElem
    IF EXISTS
       ( SELECT * FROM CDN.SrsElem JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.SrsElem.SsE_OpePNumer
       AND (CDN.SrsElem.SSE_OpePTyp=128)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsElem) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecenia JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdZlecenia.PZL_OpWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZlecenia) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanNag
    IF EXISTS
       ( SELECT * FROM CDN.PlanNag JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PlanNag.PLN_OpeNumerW
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlanNag) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.FrmStruktura.FRS_GIDNumer
       AND (CDN.FrmStruktura.FRS_GIDTyp=128)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNPlanyNag
    IF EXISTS
       ( SELECT * FROM CDN.ZRNPlanyNag JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ZRNPlanyNag.ZPN_OpeNumerW
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNPlanyNag) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsNag
    IF EXISTS
       ( SELECT * FROM CDN.SrsNag JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.SrsNag.SsN_OpeNumer
       AND (CDN.SrsNag.SsN_OpeTyp=128)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsNag) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OpePromocje
    IF EXISTS
       ( SELECT * FROM CDN.OpePromocje JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.OpePromocje.OPm_OpeNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OpePromocje) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZleceniaZabiegi
    IF EXISTS
       ( SELECT * FROM CDN.ProdZleceniaZabiegi JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdZleceniaZabiegi.PZZ_OpeW
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZleceniaZabiegi) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDONaruszenia
    IF EXISTS
       ( SELECT * FROM CDN.PDONaruszenia JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PDONaruszenia.PDON_OpeNumerW
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDONaruszenia) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.PDOCzynnosci JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PDOCzynnosci.PDOC_OpeNumerW
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDOCzynnosci) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOUpowaznienia
    IF EXISTS
       ( SELECT * FROM CDN.PDOUpowaznienia JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PDOUpowaznienia.PDOU_ObiNumer
       AND (CDN.PDOUpowaznienia.PDOU_ObiTyp=128)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDOUpowaznienia) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdNadzlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdNadzlecenia JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdNadzlecenia.PNZ_OpWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdNadzlecenia) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Bony
    IF EXISTS
       ( SELECT * FROM CDN.Bony JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.Bony.Bbon_OpeWydalNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Bony) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdOperacjePauzy
    IF EXISTS
       ( SELECT * FROM CDN.ProdOperacjePauzy JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdOperacjePauzy.PPY_OpeNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdOperacjePauzy) [OpeKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OpeDefKol
    IF EXISTS(SELECT * FROM CDN.OpeDefKol JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.OpeDefKol.ODK_OpeID
      AND ( CDN.OpeDefKol.ODK_OpeTyp=128)
            )
        DELETE CDN.OpeDefKol
        FROM CDN.OpeDefKol JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.OpeDefKol.ODK_OpeID
      AND ( CDN.OpeDefKol.ODK_OpeTyp=128)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CDCCertyfikaty
    IF EXISTS(SELECT * FROM CDN.CDCCertyfikaty JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.CDCCertyfikaty.CDC_OpeNumer
      AND (CDN.CDCCertyfikaty.CDC_OpeNumer != 0)
            )
        DELETE CDN.CDCCertyfikaty
        FROM CDN.CDCCertyfikaty JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.CDCCertyfikaty.CDC_OpeNumer
      AND (CDN.CDCCertyfikaty.CDC_OpeNumer != 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=128)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=128)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=128)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=128)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=128)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=128)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OpePulpity
    IF EXISTS(SELECT * FROM CDN.OpePulpity JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.OpePulpity.XLD_OpeNumer
      AND (CDN.OpePulpity.XLD_OpeNumer &gt; 0)
            )
        DELETE CDN.OpePulpity
        FROM CDN.OpePulpity JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.OpePulpity.XLD_OpeNumer
      AND (CDN.OpePulpity.XLD_OpeNumer &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyUprawnienia
    IF EXISTS(SELECT * FROM CDN.AtrybutyUprawnienia JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.AtrybutyUprawnienia.AtU_OpeNumer
      AND (CDN.AtrybutyUprawnienia.AtU_OpeNumer&gt;0)
            )
        DELETE CDN.AtrybutyUprawnienia
        FROM CDN.AtrybutyUprawnienia JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.AtrybutyUprawnienia.AtU_OpeNumer
      AND (CDN.AtrybutyUprawnienia.AtU_OpeNumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.UczestnicyKonwersacji
    IF EXISTS(SELECT * FROM CDN.UczestnicyKonwersacji JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.UczestnicyKonwersacji.UKN_IDOperatora
      AND (CDN.UczestnicyKonwersacji.UKN_IDOperatora &gt; 0)
            )
        DELETE CDN.UczestnicyKonwersacji
        FROM CDN.UczestnicyKonwersacji JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.UczestnicyKonwersacji.UKN_IDOperatora
      AND (CDN.UczestnicyKonwersacji.UKN_IDOperatora &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BIPointRaportOpeCentra
    IF EXISTS(SELECT * FROM CDN.BIPointRaportOpeCentra JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.BIPointRaportOpeCentra.BRO_Numer
      AND (CDN.BIPointRaportOpeCentra.BRO_Typ=128)
            )
        DELETE CDN.BIPointRaportOpeCentra
        FROM CDN.BIPointRaportOpeCentra JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.BIPointRaportOpeCentra.BRO_Numer
      AND (CDN.BIPointRaportOpeCentra.BRO_Typ=128)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MESProfileOperatorzy
    IF EXISTS(SELECT * FROM CDN.MESProfileOperatorzy JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.MESProfileOperatorzy.MESPO_OpeGidNumer
            )
        DELETE CDN.MESProfileOperatorzy
        FROM CDN.MESProfileOperatorzy JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.MESProfileOperatorzy.MESPO_OpeGidNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.HistoriaUruchomien
    IF EXISTS(SELECT * FROM CDN.HistoriaUruchomien JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.HistoriaUruchomien.HtU_OpeNumer
            )
        DELETE CDN.HistoriaUruchomien
        FROM CDN.HistoriaUruchomien JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.HistoriaUruchomien.HtU_OpeNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdIoTOdbiorcyPowiadomien
    IF EXISTS(SELECT * FROM CDN.ProdIoTOdbiorcyPowiadomien JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.ProdIoTOdbiorcyPowiadomien.PIOK_ObiNumer
      AND (CDN.ProdIoTOdbiorcyPowiadomien.PIOK_ObiTyp=128)
            )
        DELETE CDN.ProdIoTOdbiorcyPowiadomien
        FROM CDN.ProdIoTOdbiorcyPowiadomien JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.ProdIoTOdbiorcyPowiadomien.PIOK_ObiNumer
      AND (CDN.ProdIoTOdbiorcyPowiadomien.PIOK_ObiTyp=128)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpeKarty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpeKarty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OpeKarty_InsertUpdateHandler
  ON CDN.OpeKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Ope_Jezyk ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.Ope_Jezyk = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.Ope_Jezyk,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [OpeKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Ope_MESNrKartyAtkId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AtrybutyKlasy ON
                    inserted.Ope_MESNrKartyAtkId = CDN.AtrybutyKlasy.AtK_ID
              WHERE CDN.AtrybutyKlasy.AtK_ID IS NULL
                AND (
                          IsNull(inserted.Ope_MESNrKartyAtkId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AtrybutyKlasy) [OpeKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpeKartyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpeKartyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OpeKartyAlias_DeleteHandler
  ON CDN.OpeKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanyObciazeniaGniazd
    IF EXISTS
       ( SELECT * FROM CDN.PlanyObciazeniaGniazd JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PlanyObciazeniaGniazd.POG_OpeMNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlanyObciazeniaGniazd) [OpeKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.KntAplikacje JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.KntAplikacje.KAp_OpeONumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntAplikacje) [OpeKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanNag
    IF EXISTS
       ( SELECT * FROM CDN.PlanNag JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PlanNag.PLN_OpeNumerZ
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlanNag) [OpeKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNPlanyNag
    IF EXISTS
       ( SELECT * FROM CDN.ZRNPlanyNag JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ZRNPlanyNag.ZPN_OpeNumerZ
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNPlanyNag) [OpeKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdWzorceKosztow
    IF EXISTS
       ( SELECT * FROM CDN.ProdWzorceKosztow JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdWzorceKosztow.PWK_OpeM
       AND (CDN.ProdWzorceKosztow.PWK_OpeM&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdWzorceKosztow) [OpeKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDONaruszenia
    IF EXISTS
       ( SELECT * FROM CDN.PDONaruszenia JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PDONaruszenia.PDON_OpeNumerM
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDONaruszenia) [OpeKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.PDOCzynnosci JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.PDOCzynnosci.PDOC_OpeNumerM
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDOCzynnosci) [OpeKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrsAplikacje
    IF EXISTS(SELECT * FROM CDN.FrsAplikacje JOIN deleted
            ON 
          deleted.Ope_GIDNumer = CDN.FrsAplikacje.FrA_ObiNumer
      AND (CDN.FrsAplikacje.FrA_ObiTyp = -128)
            )
        DELETE CDN.FrsAplikacje
        FROM CDN.FrsAplikacje JOIN deleted
        ON 
          deleted.Ope_GIDNumer = CDN.FrsAplikacje.FrA_ObiNumer
      AND (CDN.FrsAplikacje.FrA_ObiTyp = -128)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpeKartyWystawiajacy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpeKartyWystawiajacy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OpeKartyWystawiajacy_DeleteHandler
  ON CDN.OpeKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdPKJNag.PKJN_OpWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [OpeKartyWystawiajacy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Bony
    IF EXISTS
       ( SELECT * FROM CDN.Bony JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.Bony.Bbon_OpeWNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Bony) [OpeKartyWystawiajacy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpeKartyZatwierdzajacy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpeKartyZatwierdzajacy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OpeKartyZatwierdzajacy_DeleteHandler
  ON CDN.OpeKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdPKJNag.PKJN_OpZNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [OpeKartyZatwierdzajacy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Bony
    IF EXISTS
       ( SELECT * FROM CDN.Bony JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.Bony.Bbon_OpeZNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Bony) [OpeKartyZatwierdzajacy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpeKartyModyfikujacy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpeKartyModyfikujacy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OpeKartyModyfikujacy_DeleteHandler
  ON CDN.OpeKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.ProdPKJNag.PKJN_OpMNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [OpeKartyModyfikujacy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Bony
    IF EXISTS
       ( SELECT * FROM CDN.Bony JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.Bony.Bbon_OpeMNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Bony) [OpeKartyModyfikujacy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpeKartyArchiwizujacy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpeKartyArchiwizujacy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OpeKartyArchiwizujacy_DeleteHandler
  ON CDN.OpeKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Bony
    IF EXISTS
       ( SELECT * FROM CDN.Bony JOIN deleted
          ON
                deleted.Ope_GIDNumer = CDN.Bony.Bbon_OpeBNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Bony) [OpeKartyArchiwizujacy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OpOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OpOPrimary */</I><BR>
ALTER TABLE CDN.OpeOpisy ADD CONSTRAINT FK_OpOPrimary
 FOREIGN KEY
   (
                          OpO_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OPmPrmId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OPmPrmId */</I><BR>
ALTER TABLE CDN.OpePromocje ADD CONSTRAINT FK_OPmPrmId
 FOREIGN KEY
   (
                          OPm_PrmId                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpePromocje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpePromocje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OpePromocje_InsertUpdateHandler
  ON CDN.OpePromocje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OPm_OpeNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.OPm_OpeNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.OPm_OpeNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [OpePromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpePulpity_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpePulpity_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OpePulpity_InsertUpdateHandler
  ON CDN.OpePulpity
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( XLD_OpeNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.XLD_OpeNumer &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.XLD_OpeNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.XLD_OpeNumer &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [OpePulpity_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OsgOperator"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OsgOperator */</I><BR>
ALTER TABLE CDN.OpeSkillGrupa ADD CONSTRAINT FK_OsgOperator
 FOREIGN KEY
   (
                          OSG_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OpZPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OpZPrimary */</I><BR>
ALTER TABLE CDN.OpeZakazy ADD CONSTRAINT FK_OpZPrimary
 FOREIGN KEY
   (
                          OpZ_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Operacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Operacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Operacje_InsertUpdateHandler
  ON CDN.Operacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KAO_SCHTyp )  OR UPDATE( KAO_SCHNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Schematy ON
                    inserted.KAO_SCHTyp = CDN.Schematy.SCH_GIDTyp
                AND inserted.KAO_SCHNumer = CDN.Schematy.SCH_GIDNumer
              WHERE CDN.Schematy.SCH_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KAO_SCHTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.KAO_SCHNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Schematy) [Operacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OWEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OWEPrimary */</I><BR>
ALTER TABLE CDN.OpisWymElem ADD CONSTRAINT FK_OWEPrimary
 FOREIGN KEY
   (
                          OWE_GIDTyp                        ,
                          OWE_GIDNumer                      
                         )
             REFERENCES CDN.OpisWymNag
                         (
                          OWN_GIDTyp                        ,
                          OWN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpisWymNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpisWymNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OpisWymNag_InsertUpdateHandler
  ON CDN.OpisWymNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OWN_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.OWN_GIDTyp IN(7941))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpisWzorce ON
                    inserted.OWN_GIDNumer = CDN.OpisWzorce.OWW_ID
              WHERE CDN.OpisWzorce.OWW_ID IS NULL AND (inserted.OWN_GIDTyp IN(7941))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpisWzorce) [OpisWymNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OWN_GIDTyp )  OR UPDATE( OWN_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.OWN_GIDTyp in (4144,4145,4146))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.OWN_GIDTyp = CDN.MemNag.MEN_GIDTyp
                AND inserted.OWN_GIDNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.OWN_GIDTyp in (4144,4145,4146))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [OpisWymNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OWSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OWSPrimary */</I><BR>
ALTER TABLE CDN.OpisWymSElem ADD CONSTRAINT FK_OWSPrimary
 FOREIGN KEY
   (
                          OWS_GIDTyp                        ,
                          OWS_GIDNumer                      ,
                          OWS_GIDLp                         
                         )
             REFERENCES CDN.OpisWymElem
                         (
                          OWE_GIDTyp                        ,
                          OWE_GIDNumer                      ,
                          OWE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpisWzorce_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpisWzorce_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OpisWzorce_DeleteHandler
  ON CDN.OpisWzorce
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OpisWymNag
    IF EXISTS(SELECT * FROM CDN.OpisWymNag JOIN deleted
            ON 
          deleted.OWW_ID = CDN.OpisWymNag.OWN_GIDNumer
      AND (CDN.OpisWymNag.OWN_GIDTyp IN(7941))
            )
        DELETE CDN.OpisWymNag
        FROM CDN.OpisWymNag JOIN deleted
        ON 
          deleted.OWW_ID = CDN.OpisWymNag.OWN_GIDNumer
      AND (CDN.OpisWymNag.OWN_GIDTyp IN(7941))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OpisWzorce_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OpisWzorce_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OpisWzorce_InsertUpdateHandler
  ON CDN.OpisWzorce
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OWW_FrsID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.OWW_FrsID = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.OWW_FrsID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [OpisWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OsAOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OsAOsoba */</I><BR>
ALTER TABLE CDN.OsoAdresy ADD CONSTRAINT FK_OsAOsoba
 FOREIGN KEY
   (
                          OsA_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoAdresy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoAdresy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OsoAdresy_DeleteHandler
  ON CDN.OsoAdresy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekDokumenty
    IF EXISTS
       ( SELECT * FROM CDN.SekDokumenty JOIN deleted
          ON
                deleted.OsA_Id = CDN.SekDokumenty.SDD_NadawcaAdrNumer
       AND (CDN.SekDokumenty.SDD_NadawcaAdrTyp in (897,898,899))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SekDokumenty) [OsoAdresy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OCPOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OCPOsoba */</I><BR>
ALTER TABLE CDN.OsoCzasPracy ADD CONSTRAINT FK_OCPOsoba
 FOREIGN KEY
   (
                          OCP_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoCzasPracy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoCzasPracy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoCzasPracy_InsertUpdateHandler
  ON CDN.OsoCzasPracy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OCP_RodzajPracy ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OCP_RodzajPracy = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OCP_RodzajPracy,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoCzasPracy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OCROsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OCROsoba */</I><BR>
ALTER TABLE CDN.OsoCzasRazem ADD CONSTRAINT FK_OCROsoba
 FOREIGN KEY
   (
                          OCR_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoCzasRazem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoCzasRazem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoCzasRazem_InsertUpdateHandler
  ON CDN.OsoCzasRazem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OCR_RodzajPracy ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OCR_RodzajPracy = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OCR_RodzajPracy,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoCzasRazem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoDodatki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoDodatki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoDodatki_InsertUpdateHandler
  ON CDN.OsoDodatki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OsD_PEWId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceElementyWyplat ON
                    inserted.OsD_PEWId = CDN.PlaceElementyWyplat.PEW_Id
              WHERE CDN.PlaceElementyWyplat.PEW_Id IS NULL
                AND (
                          IsNull(inserted.OsD_PEWId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceElementyWyplat) [OsoDodatki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsD_OsoNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.OsD_OsoNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.OsD_OsoNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [OsoDodatki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsD_OsoNumer )  OR UPDATE( OsD_OsUNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.OsD_OsUNumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OsoUmowy ON
                    inserted.OsD_OsoNumer = CDN.OsoUmowy.OsU_OsoNumer
                AND inserted.OsD_OsUNumer = CDN.OsoUmowy.OsU_GIDNumer
              WHERE CDN.OsoUmowy.OsU_GIDNumer IS NULL AND (inserted.OsD_OsUNumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OsoUmowy) [OsoDodatki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OHZOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OHZOsoba */</I><BR>
ALTER TABLE CDN.OsoHistZatrudnienia ADD CONSTRAINT FK_OHZOsoba
 FOREIGN KEY
   (
                          OHZ_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoHistZatrudnienia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoHistZatrudnienia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OsoHistZatrudnienia_DeleteHandler
  ON CDN.OsoHistZatrudnienia
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoRodzajStaz
    IF EXISTS(SELECT * FROM CDN.OsoRodzajStaz JOIN deleted
            ON 
          deleted.OHZ_Id = CDN.OsoRodzajStaz.ORS_OWZNumer
      AND (CDN.OsoRodzajStaz.ORS_OWZTyp=14501)
            )
        DELETE CDN.OsoRodzajStaz
        FROM CDN.OsoRodzajStaz JOIN deleted
        ON 
          deleted.OHZ_Id = CDN.OsoRodzajStaz.ORS_OWZNumer
      AND (CDN.OsoRodzajStaz.ORS_OWZTyp=14501)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoHistZatrudnienia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoHistZatrudnienia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoHistZatrudnienia_InsertUpdateHandler
  ON CDN.OsoHistZatrudnienia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OHZ_OstStanowisko ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrStanowiska ON
                    inserted.OHZ_OstStanowisko = CDN.KadrStanowiska.KSt_Id
              WHERE CDN.KadrStanowiska.KSt_Id IS NULL
                AND (
                          IsNull(inserted.OHZ_OstStanowisko,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrStanowiska) [OsoHistZatrudnienia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoKarty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoKarty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoKarty_InsertUpdateHandler
  ON CDN.OsoKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Oso_GIDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.Oso_GIDNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Oso_GIDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [OsoKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Oso_StanCywilny ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.Oso_StanCywilny = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.Oso_StanCywilny,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Oso_PropStanowisko ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrStanowiska ON
                    inserted.Oso_PropStanowisko = CDN.KadrStanowiska.KSt_Id
              WHERE CDN.KadrStanowiska.KSt_Id IS NULL
                AND (
                          IsNull(inserted.Oso_PropStanowisko,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrStanowiska) [OsoKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Oso_Rodzaj ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.Oso_Rodzaj = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.Oso_Rodzaj,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [OsoKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoKompZakres_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoKompZakres_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoKompZakres_InsertUpdateHandler
  ON CDN.OsoKompZakres
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OKZ_StopienZnajomosci ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OKZ_StopienZnajomosci = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OKZ_StopienZnajomosci,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoKompZakres_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OKZ_OsKId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OsoKompetencje ON
                    inserted.OKZ_OsKId = CDN.OsoKompetencje.OsK_Id
              WHERE CDN.OsoKompetencje.OsK_Id IS NULL
                AND (
                          IsNull(inserted.OKZ_OsKId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OsoKompetencje) [OsoKompZakres_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OKZ_Zakres ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OKZ_Zakres = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OKZ_Zakres,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoKompZakres_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OsKOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OsKOsoba */</I><BR>
ALTER TABLE CDN.OsoKompetencje ADD CONSTRAINT FK_OsKOsoba
 FOREIGN KEY
   (
                          OsK_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoKompetencje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoKompetencje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OsoKompetencje_DeleteHandler
  ON CDN.OsoKompetencje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoKompZakres
    IF EXISTS(SELECT * FROM CDN.OsoKompZakres JOIN deleted
            ON 
          deleted.OsK_Id = CDN.OsoKompZakres.OKZ_OsKId
            )
        DELETE CDN.OsoKompZakres
        FROM CDN.OsoKompZakres JOIN deleted
        ON 
          deleted.OsK_Id = CDN.OsoKompZakres.OKZ_OsKId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoKompetencje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoKompetencje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoKompetencje_InsertUpdateHandler
  ON CDN.OsoKompetencje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OsK_KSLId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OsK_KSLId = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OsK_KSLId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoKompetencje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsK_StopienZnajomosci ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OsK_StopienZnajomosci = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OsK_StopienZnajomosci,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoKompetencje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsK_Zakres ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OsK_Zakres = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OsK_Zakres,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoKompetencje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ONBOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ONBOsoba */</I><BR>
ALTER TABLE CDN.OsoNieobecnosci ADD CONSTRAINT FK_ONBOsoba
 FOREIGN KEY
   (
                          ONB_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoNieobecnosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoNieobecnosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoNieobecnosci_InsertUpdateHandler
  ON CDN.OsoNieobecnosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ONB_Definicja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DefNieobecnosci ON
                    inserted.ONB_Definicja = CDN.DefNieobecnosci.DNB_Id
              WHERE CDN.DefNieobecnosci.DNB_Id IS NULL
                AND (
                          IsNull(inserted.ONB_Definicja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DefNieobecnosci) [OsoNieobecnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OSEOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OSEOsoba */</I><BR>
ALTER TABLE CDN.OsoPlatElem ADD CONSTRAINT FK_OSEOsoba
 FOREIGN KEY
   (
                          OSE_OSNId                         
                         )
             REFERENCES CDN.OsoPlatNag
                         (
                          OSN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OSNOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OSNOsoba */</I><BR>
ALTER TABLE CDN.OsoPlatNag ADD CONSTRAINT FK_OSNOsoba
 FOREIGN KEY
   (
                          OSN_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OPPOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OPPOsoba */</I><BR>
ALTER TABLE CDN.OsoPrzekPodstawy ADD CONSTRAINT FK_OPPOsoba
 FOREIGN KEY
   (
                          OPP_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoRodzajStaz_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoRodzajStaz_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoRodzajStaz_InsertUpdateHandler
  ON CDN.OsoRodzajStaz
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ORS_OWZNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ORS_OWZTyp=14503)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceElementyWyplat ON
                    inserted.ORS_OWZNumer = CDN.PlaceElementyWyplat.PEW_Id
              WHERE CDN.PlaceElementyWyplat.PEW_Id IS NULL AND (inserted.ORS_OWZTyp=14503)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceElementyWyplat) [OsoRodzajStaz_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ORS_OWZNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ORS_OWZTyp=14500)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OsoWyksztalcenie ON
                    inserted.ORS_OWZNumer = CDN.OsoWyksztalcenie.OsW_Id
              WHERE CDN.OsoWyksztalcenie.OsW_Id IS NULL AND (inserted.ORS_OWZTyp=14500)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OsoWyksztalcenie) [OsoRodzajStaz_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ORS_OWZNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ORS_OWZTyp=14501)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OsoHistZatrudnienia ON
                    inserted.ORS_OWZNumer = CDN.OsoHistZatrudnienia.OHZ_Id
              WHERE CDN.OsoHistZatrudnienia.OHZ_Id IS NULL AND (inserted.ORS_OWZTyp=14501)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OsoHistZatrudnienia) [OsoRodzajStaz_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OsROsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OsROsoba */</I><BR>
ALTER TABLE CDN.OsoRodzina ADD CONSTRAINT FK_OsROsoba
 FOREIGN KEY
   (
                          OsR_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoRodzina_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoRodzina_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoRodzina_InsertUpdateHandler
  ON CDN.OsoRodzina
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OsR_KodNiepelnosprawnosci ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.OsR_KodNiepelnosprawnosci = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.OsR_KodNiepelnosprawnosci,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [OsoRodzina_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsR_KodPokrewienstwa ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.OsR_KodPokrewienstwa = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.OsR_KodPokrewienstwa,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [OsoRodzina_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoStaleRoczne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoStaleRoczne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoStaleRoczne_InsertUpdateHandler
  ON CDN.OsoStaleRoczne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ORo_KosztUzyskaniaZTytulu ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.ORo_KosztUzyskaniaZTytulu = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.ORo_KosztUzyskaniaZTytulu,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [OsoStaleRoczne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ORo_Urzad ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.ORo_Urzad = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ORo_Urzad,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [OsoStaleRoczne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OUbOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OUbOsoba */</I><BR>
ALTER TABLE CDN.OsoUbezpieczenia ADD CONSTRAINT FK_OUbOsoba
 FOREIGN KEY
   (
                          OUb_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoUbezpieczenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoUbezpieczenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoUbezpieczenia_InsertUpdateHandler
  ON CDN.OsoUbezpieczenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OUb_FEP ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.OUb_FEP = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.OUb_FEP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [OsoUbezpieczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OUb_KodNiepelnosprawnosci ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.OUb_KodNiepelnosprawnosci = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.OUb_KodNiepelnosprawnosci,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [OsoUbezpieczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OUb_TytulUbezpieczenia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.OUb_TytulUbezpieczenia = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.OUb_TytulUbezpieczenia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [OsoUbezpieczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OUb_OsoNumer )  OR UPDATE( OUb_Umowa ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.OUb_Umowa&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OsoUmowy ON
                    inserted.OUb_OsoNumer = CDN.OsoUmowy.OsU_OsoNumer
                AND inserted.OUb_Umowa = CDN.OsoUmowy.OsU_GIDNumer
              WHERE CDN.OsoUmowy.OsU_GIDNumer IS NULL AND (inserted.OUb_Umowa&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OsoUmowy) [OsoUbezpieczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoUmowy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoUmowy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OsoUmowy_DeleteHandler
  ON CDN.OsoUmowy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoDodatki
    IF EXISTS(SELECT * FROM CDN.OsoDodatki JOIN deleted
            ON 
          deleted.OsU_OsoNumer = CDN.OsoDodatki.OsD_OsoNumer
      AND deleted.OsU_GIDNumer = CDN.OsoDodatki.OsD_OsUNumer
      AND (CDN.OsoDodatki.OsD_OsUNumer&gt;0)
            )
        DELETE CDN.OsoDodatki
        FROM CDN.OsoDodatki JOIN deleted
        ON 
          deleted.OsU_OsoNumer = CDN.OsoDodatki.OsD_OsoNumer
      AND deleted.OsU_GIDNumer = CDN.OsoDodatki.OsD_OsUNumer
      AND (CDN.OsoDodatki.OsD_OsUNumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoUbezpieczenia
    IF EXISTS(SELECT * FROM CDN.OsoUbezpieczenia JOIN deleted
            ON 
          deleted.OsU_OsoNumer = CDN.OsoUbezpieczenia.OUb_OsoNumer
      AND deleted.OsU_GIDNumer = CDN.OsoUbezpieczenia.OUb_Umowa
      AND (CDN.OsoUbezpieczenia.OUb_Umowa&gt;0)
            )
        DELETE CDN.OsoUbezpieczenia
        FROM CDN.OsoUbezpieczenia JOIN deleted
        ON 
          deleted.OsU_OsoNumer = CDN.OsoUbezpieczenia.OUb_OsoNumer
      AND deleted.OsU_GIDNumer = CDN.OsoUbezpieczenia.OUb_Umowa
      AND (CDN.OsoUbezpieczenia.OUb_Umowa&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoUmowy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoUmowy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoUmowy_InsertUpdateHandler
  ON CDN.OsoUmowy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OsU_Harmonogram ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdKalendarze ON
                    inserted.OsU_Harmonogram = CDN.ProdKalendarze.PKA_Id
              WHERE CDN.ProdKalendarze.PKA_Id IS NULL
                AND (
                          IsNull(inserted.OsU_Harmonogram,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdKalendarze) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_Funkcja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdFunkcje ON
                    inserted.OsU_Funkcja = CDN.ProdFunkcje.PFU_Id
              WHERE CDN.ProdFunkcje.PFU_Id IS NULL
                AND (
                          IsNull(inserted.OsU_Funkcja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdFunkcje) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_TytulUmowy ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OsU_TytulUmowy = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OsU_TytulUmowy,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_CentrumPodleglosci ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.OsU_CentrumPodleglosci = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.OsU_CentrumPodleglosci,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_CentrumKosztow ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.OsU_CentrumKosztow = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.OsU_CentrumKosztow,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_TypPracownika ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OsU_TypPracownika = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OsU_TypPracownika,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_PrzyczynaRozwUm ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OsU_PrzyczynaRozwUm = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OsU_PrzyczynaRozwUm,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_Stanowisko ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrStanowiska ON
                    inserted.OsU_Stanowisko = CDN.KadrStanowiska.KSt_Id
              WHERE CDN.KadrStanowiska.KSt_Id IS NULL
                AND (
                          IsNull(inserted.OsU_Stanowisko,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrStanowiska) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_Zaszeregowanie ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrZaszeregowania ON
                    inserted.OsU_Zaszeregowanie = CDN.KadrZaszeregowania.KZa_Id
              WHERE CDN.KadrZaszeregowania.KZa_Id IS NULL
                AND (
                          IsNull(inserted.OsU_Zaszeregowanie,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrZaszeregowania) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsU_OsoNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.OsU_OsoNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.OsU_OsoNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [OsoUmowy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OWkORoId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OWkORoId */</I><BR>
ALTER TABLE CDN.OsoWskazniki ADD CONSTRAINT FK_OWkORoId
 FOREIGN KEY
   (
                          OWk_ORoId                         
                         )
             REFERENCES CDN.OsoStaleRoczne
                         (
                          ORo_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_OsWOsoba"></A><PRE>
          <FONT SIZE="2"><I>/* FK_OsWOsoba */</I><BR>
ALTER TABLE CDN.OsoWyksztalcenie ADD CONSTRAINT FK_OsWOsoba
 FOREIGN KEY
   (
                          OsW_OsoNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoWyksztalcenie_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoWyksztalcenie_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.OsoWyksztalcenie_DeleteHandler
  ON CDN.OsoWyksztalcenie
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoRodzajStaz
    IF EXISTS(SELECT * FROM CDN.OsoRodzajStaz JOIN deleted
            ON 
          deleted.OsW_Id = CDN.OsoRodzajStaz.ORS_OWZNumer
      AND (CDN.OsoRodzajStaz.ORS_OWZTyp=14500)
            )
        DELETE CDN.OsoRodzajStaz
        FROM CDN.OsoRodzajStaz JOIN deleted
        ON 
          deleted.OsW_Id = CDN.OsoRodzajStaz.ORS_OWZNumer
      AND (CDN.OsoRodzajStaz.ORS_OWZTyp=14500)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="OsoWyksztalcenie_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* OsoWyksztalcenie_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.OsoWyksztalcenie_InsertUpdateHandler
  ON CDN.OsoWyksztalcenie
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( OsW_Specjalizacja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OsW_Specjalizacja = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OsW_Specjalizacja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoWyksztalcenie_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( OsW_Kierunek ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.OsW_Kierunek = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.OsW_Kierunek,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [OsoWyksztalcenie_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PDOAdministratorzy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PDOAdministratorzy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PDOAdministratorzy_InsertUpdateHandler
  ON CDN.PDOAdministratorzy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PDOA_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOA_ObiTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PDOA_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PDOA_ObiTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PDOAdministratorzy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOA_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOA_ObiTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.PDOA_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.PDOA_ObiTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [PDOAdministratorzy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOA_AdrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.PDOA_AdrNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PDOA_AdrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [PDOAdministratorzy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOA_ObiNumer )  OR UPDATE( PDOA_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOA_ObiTyp=32 AND inserted.PDOA_ObiLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.PDOA_ObiNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.PDOA_ObiLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.PDOA_ObiTyp=32 AND inserted.PDOA_ObiLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [PDOAdministratorzy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PDOCzynnosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PDOCzynnosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PDOCzynnosci_DeleteHandler
  ON CDN.PDOCzynnosci
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PDOC_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=6562 and CDN.Atrybuty.Atr_ObiNumer&gt;0 and CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp=0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PDOC_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=6562 and CDN.Atrybuty.Atr_ObiNumer&gt;0 and CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PDOC_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=6562 AND CDN.DaneObiekty.DAO_ObiNumer&gt;0 AND CDN.DaneObiekty.DAO_ObiLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PDOC_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=6562 AND CDN.DaneObiekty.DAO_ObiNumer&gt;0 AND CDN.DaneObiekty.DAO_ObiLp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PDOCzynnosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PDOCzynnosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PDOCzynnosci_InsertUpdateHandler
  ON CDN.PDOCzynnosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PDOC_OpeNumerW ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PDOC_OpeNumerW = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PDOC_OpeNumerW,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_OpeNumerM ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PDOC_OpeNumerM = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PDOC_OpeNumerM,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_Kategoria ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PDOC_Kategoria = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PDOC_Kategoria,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_AdminNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_AdminTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PDOC_AdminNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PDOC_AdminTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_PrzedstNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_PrzedstTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PDOC_PrzedstNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PDOC_PrzedstTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_InspNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_InspTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PDOC_InspNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PDOC_InspTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_AdminAdr ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.PDOC_AdminAdr = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PDOC_AdminAdr,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_PrzedstAdr ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.PDOC_PrzedstAdr = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PDOC_PrzedstAdr,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_InspAdr ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.PDOC_InspAdr = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PDOC_InspAdr,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_AdminNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_AdminTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.PDOC_AdminNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.PDOC_AdminTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_PrzedstNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_PrzedstTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.PDOC_PrzedstNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.PDOC_PrzedstTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_InspNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_InspTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.PDOC_InspNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.PDOC_InspTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_AdminNumer )  OR UPDATE( PDOC_AdminLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_AdminTyp=32 AND inserted.PDOC_AdminLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.PDOC_AdminNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.PDOC_AdminLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.PDOC_AdminTyp=32 AND inserted.PDOC_AdminLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_PrzedstNumer )  OR UPDATE( PDOC_PrzedstLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_PrzedstTyp=32 AND inserted.PDOC_PrzedstLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.PDOC_PrzedstNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.PDOC_PrzedstLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.PDOC_PrzedstTyp=32 AND inserted.PDOC_PrzedstLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOC_InspNumer )  OR UPDATE( PDOC_InspLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOC_InspTyp=32 AND inserted.PDOC_InspLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.PDOC_InspNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.PDOC_InspLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.PDOC_InspTyp=32 AND inserted.PDOC_InspLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [PDOCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PDOCKCzynnosc"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PDOCKCzynnosc */</I><BR>
ALTER TABLE CDN.PDOCzynnosciKraje ADD CONSTRAINT FK_PDOCKCzynnosc
 FOREIGN KEY
   (
                          PDOCK_PDOCId                        
                         )
             REFERENCES CDN.PDOCzynnosci
                         (
                          PDOC_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PDOCzynnosciKraje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PDOCzynnosciKraje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PDOCzynnosciKraje_InsertUpdateHandler
  ON CDN.PDOCzynnosciKraje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PDOCK_UzasadnienieId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PDOCK_UzasadnienieId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PDOCK_UzasadnienieId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [PDOCzynnosciKraje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PDONaruszenia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PDONaruszenia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PDONaruszenia_DeleteHandler
  ON CDN.PDONaruszenia
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PDON_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=6563 and CDN.Atrybuty.Atr_ObiNumer&gt;0 and CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp=0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PDON_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=6563 and CDN.Atrybuty.Atr_ObiNumer&gt;0 and CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PDON_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=6563 AND CDN.DaneObiekty.DAO_ObiNumer&gt;0 AND CDN.DaneObiekty.DAO_ObiLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PDON_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=6563 AND CDN.DaneObiekty.DAO_ObiNumer&gt;0 AND CDN.DaneObiekty.DAO_ObiLp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PDONaruszenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PDONaruszenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PDONaruszenia_InsertUpdateHandler
  ON CDN.PDONaruszenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PDON_InsNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDON_InsTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PDON_InsNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PDON_InsTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PDONaruszenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDON_InsNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDON_InsTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.PDON_InsNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.PDON_InsTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [PDONaruszenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDON_OpeNumerW ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PDON_OpeNumerW = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PDON_OpeNumerW,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PDONaruszenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDON_OpeNumerM ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PDON_OpeNumerM = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PDON_OpeNumerM,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PDONaruszenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PDOUpowaznienia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PDOUpowaznienia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PDOUpowaznienia_DeleteHandler
  ON CDN.PDOUpowaznienia
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PDOU_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=6561 AND CDN.DaneObiekty.DAO_ObiNumer&gt;0 AND CDN.DaneObiekty.DAO_ObiLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PDOU_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=6561 AND CDN.DaneObiekty.DAO_ObiNumer&gt;0 AND CDN.DaneObiekty.DAO_ObiLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PDOU_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=6561 and CDN.Atrybuty.Atr_ObiNumer&gt;0 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp=0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PDOU_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=6561 and CDN.Atrybuty.Atr_ObiNumer&gt;0 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PDOUpowaznienia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PDOUpowaznienia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PDOUpowaznienia_InsertUpdateHandler
  ON CDN.PDOUpowaznienia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PDOU_ObiNumer )  OR UPDATE( PDOU_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOU_ObiTyp =32 and inserted.PDOU_ObiLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.PDOU_ObiNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.PDOU_ObiLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.PDOU_ObiTyp =32 and inserted.PDOU_ObiLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [PDOUpowaznienia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOU_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOU_ObiTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.PDOU_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.PDOU_ObiTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [PDOUpowaznienia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOU_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOU_ObiTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PDOU_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PDOU_ObiTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PDOUpowaznienia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOU_RodzajUpowaznieniaId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PDOU_RodzajUpowaznieniaId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PDOU_RodzajUpowaznieniaId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [PDOUpowaznienia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDOU_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDOU_ObiTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PDOU_ObiNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.PDOU_ObiTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PDOUpowaznienia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PIEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PIEPrimary */</I><BR>
ALTER TABLE CDN.PIKElem ADD CONSTRAINT FK_PIEPrimary
 FOREIGN KEY
   (
                          PIE_GIDNumer                      
                         )
             REFERENCES CDN.PIKNag
                         (
                          PIN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PIKElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PIKElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PIKElem_InsertUpdateHandler
  ON CDN.PIKElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PIE_FrSId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PIE_FrSId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PIE_FrSId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [PIKElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PIKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PIKPrimary */</I><BR>
ALTER TABLE CDN.PIKKwoty ADD CONSTRAINT FK_PIKPrimary
 FOREIGN KEY
   (
                          PIK_GIDNumer                      ,
                          PIK_GIDLp                         
                         )
             REFERENCES CDN.PIKElem
                         (
                          PIE_GIDNumer                      ,
                          PIE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PIKNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PIKNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PIKNag_DeleteHandler
  ON CDN.PIKNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PIN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (  CDN.Atrybuty.Atr_OBITyp IN (2976,2977)  AND  CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PIN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (  CDN.Atrybuty.Atr_OBITyp IN (2976,2977)  AND  CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PIN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (  CDN.AtrybutyHist.Ath_OBITyp IN (2976,2977)  AND  CDN.AtrybutyHist.Ath_OBILp=0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PIN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (  CDN.AtrybutyHist.Ath_OBITyp IN (2976,2977)  AND  CDN.AtrybutyHist.Ath_OBILp=0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.PIN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp IN(2976,2977))
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.PIN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp IN(2976,2977))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.PIN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp IN (2976,2977))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.PIN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp IN (2976,2977))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PIKNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PIKNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PIKNag_InsertUpdateHandler
  ON CDN.PIKNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PIN_PDNNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PodzielnikNag ON
                    inserted.PIN_PDNNumer = CDN.PodzielnikNag.PDN_GIDNumer
              WHERE CDN.PodzielnikNag.PDN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PIN_PDNNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PodzielnikNag) [PIKNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRbDok"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRbDok */</I><BR>
ALTER TABLE CDN.POSRozbieznosciMMP ADD CONSTRAINT FK_PRbDok
 FOREIGN KEY
   (
                          PRb_DokNumer                      
                         )
             REFERENCES CDN.TraNag
                         (
                          TrN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRbTpa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRbTpa */</I><BR>
ALTER TABLE CDN.POSRozbieznosciMMP ADD CONSTRAINT FK_PRbTpa
 FOREIGN KEY
   (
                          PRb_TpaId                         
                         )
             REFERENCES CDN.TwrPartie
                         (
                          TpA_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRbTwr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRbTwr */</I><BR>
ALTER TABLE CDN.POSRozbieznosciMMP ADD CONSTRAINT FK_PRbTwr
 FOREIGN KEY
   (
                          PRb_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ParamRozKonf_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ParamRozKonf_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ParamRozKonf_InsertUpdateHandler
  ON CDN.ParamRozKonf
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PRK_ObiNumer )  OR UPDATE( PRK_ObiTyp )  OR UPDATE( PRK_ObiLp )  OR UPDATE( PRK_ObiSubLp )  OR UPDATE( PRK_AtkId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRK_ObiTyp &lt;&gt; -16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Atrybuty ON
                    inserted.PRK_ObiNumer = CDN.Atrybuty.Atr_ObiNumer
                AND inserted.PRK_ObiTyp = CDN.Atrybuty.Atr_ObiTyp
                AND inserted.PRK_ObiLp = CDN.Atrybuty.Atr_ObiLp
                AND inserted.PRK_ObiSubLp = CDN.Atrybuty.Atr_ObiSubLp
                AND inserted.PRK_AtkId = CDN.Atrybuty.Atr_AtkId
              WHERE CDN.Atrybuty.Atr_AtkId IS NULL AND (inserted.PRK_ObiTyp &lt;&gt; -16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Atrybuty) [ParamRozKonf_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PRK_ObiNumer )  OR UPDATE( PRK_ObiTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRK_ObiTyp = -16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.PRK_ObiNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.PRK_ObiTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (inserted.PRK_ObiTyp = -16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [ParamRozKonf_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PRK_DefPytId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PRK_DefPytId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PRK_DefPytId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ParamRozKonf_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PRK_AtkId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AtrybutyKlasy ON
                    inserted.PRK_AtkId = CDN.AtrybutyKlasy.AtK_ID
              WHERE CDN.AtrybutyKlasy.AtK_ID IS NULL
                AND (
                          IsNull(inserted.PRK_AtkId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AtrybutyKlasy) [ParamRozKonf_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PRK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRK_ObiTyp = 14341)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaCzynnosci ON
                    inserted.PRK_ObiNumer = CDN.ProdTechnologiaCzynnosci.PTC_Id
              WHERE CDN.ProdTechnologiaCzynnosci.PTC_Id IS NULL AND (inserted.PRK_ObiTyp = 14341)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaCzynnosci) [ParamRozKonf_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PRK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRK_ObiTyp = 14370)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.PRK_ObiNumer = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL AND (inserted.PRK_ObiTyp = 14370)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [ParamRozKonf_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PRK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRK_ObiTyp = 14342)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.PRK_ObiNumer = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL AND (inserted.PRK_ObiTyp = 14342)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [ParamRozKonf_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PcCOddzial"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PcCOddzial */</I><BR>
ALTER TABLE CDN.PicoCenniki ADD CONSTRAINT FK_PcCOddzial
 FOREIGN KEY
   (
                          PcC_PcKID                         
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PicoCenniki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PicoCenniki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PicoCenniki_InsertUpdateHandler
  ON CDN.PicoCenniki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PcC_TwCTwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PcC_TwCTwrTyp = 64 and inserted.PcC_TwCTwrLp = 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrCeny ON
                    inserted.PcC_TwCTwrNumer = CDN.TwrCeny.TwC_ID
              WHERE CDN.TwrCeny.TwC_ID IS NULL AND (inserted.PcC_TwCTwrTyp = 64 and inserted.PcC_TwCTwrLp = 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrCeny) [PicoCenniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKRRodzaj"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKRRodzaj */</I><BR>
ALTER TABLE CDN.PicoKntRodzaje ADD CONSTRAINT FK_PKRRodzaj
 FOREIGN KEY
   (
                          PKR_RodzajID                      
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKROddzial"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKROddzial */</I><BR>
ALTER TABLE CDN.PicoKntRodzaje ADD CONSTRAINT FK_PKROddzial
 FOREIGN KEY
   (
                          PKR_PcKID                         
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PicoKntRodzajeAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PicoKntRodzajeAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PicoKntRodzajeAlias_DeleteHandler
  ON CDN.PicoKntRodzaje
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoKonfig
    IF EXISTS
       ( SELECT * FROM CDN.PicoKonfig JOIN deleted
          ON
                deleted.PKR_PcKID = CDN.PicoKonfig.PcK_PicoID
            AND deleted.PKR_RodzajID = CDN.PicoKonfig.PcK_ImpKntRodzajID
       AND (CDN.PicoKonfig.PcK_ImpKntRodzajID &gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PicoKonfig) [PicoKntRodzajeAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PicoKonfig_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PicoKonfig_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PicoKonfig_InsertUpdateHandler
  ON CDN.PicoKonfig
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PcK_PicoID )  OR UPDATE( PcK_ImpKntRodzajID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PcK_ImpKntRodzajID &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PicoKntRodzaje ON
                    inserted.PcK_PicoID = CDN.PicoKntRodzaje.PKR_PcKID
                AND inserted.PcK_ImpKntRodzajID = CDN.PicoKntRodzaje.PKR_RodzajID
              WHERE CDN.PicoKntRodzaje.PKR_RodzajID IS NULL AND (inserted.PcK_ImpKntRodzajID &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PicoKntRodzaje) [PicoKonfig_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PcK_CentrumID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Pck_Typ &lt;&gt; 6 AND inserted.Pck_CentrumId &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PcK_CentrumID = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL AND (inserted.Pck_Typ &lt;&gt; 6 AND inserted.Pck_CentrumId &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [PicoKonfig_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PcK_CentrumID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Pck_Typ = 6 AND inserted.Pck_CentrumId &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UrzadzeniaZewnetrzne ON
                    inserted.PcK_CentrumID = CDN.UrzadzeniaZewnetrzne.UZ_Id
              WHERE CDN.UrzadzeniaZewnetrzne.UZ_Id IS NULL AND (inserted.Pck_Typ = 6 AND inserted.Pck_CentrumId &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UrzadzeniaZewnetrzne) [PicoKonfig_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PcK_MdNNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemDokNag ON
                    inserted.PcK_MdNNumer = CDN.MemDokNag.MDN_GIDNumer
              WHERE CDN.MemDokNag.MDN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PcK_MdNNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemDokNag) [PicoKonfig_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKTOddzial"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKTOddzial */</I><BR>
ALTER TABLE CDN.PicoKontrahenci ADD CONSTRAINT FK_PKTOddzial
 FOREIGN KEY
   (
                          PKT_PcKID                         
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKTRodzaj"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKTRodzaj */</I><BR>
ALTER TABLE CDN.PicoKontrahenci ADD CONSTRAINT FK_PKTRodzaj
 FOREIGN KEY
   (
                          PKT_RodzajID                      
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PcLObiektXL"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PcLObiektXL */</I><BR>
ALTER TABLE CDN.PicoLog ADD CONSTRAINT FK_PcLObiektXL
 FOREIGN KEY
   (
                          PcL_PcKID                         
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PicoLog_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PicoLog_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PicoLog_InsertUpdateHandler
  ON CDN.PicoLog
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PcL_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PcL_OBITyp=96 AND ISNULL(inserted.PcL_ObiNumer,0)&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PicoWaluty ON
                    inserted.PcL_ObiNumer = CDN.PicoWaluty.PwL_ID
              WHERE CDN.PicoWaluty.PwL_ID IS NULL AND (inserted.PcL_OBITyp=96 AND ISNULL(inserted.PcL_ObiNumer,0)&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PicoWaluty) [PicoLog_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PcL_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PcL_OBITyp=208)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.PcL_ObiNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.PcL_OBITyp=208)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [PicoLog_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PcL_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PCL_ObiTyp =8211)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.PcL_ObiNumer = CDN.KntOsoby.KnS_SyncID
              WHERE CDN.KntOsoby.KnS_SyncID IS NULL AND (inserted.PCL_ObiTyp =8211)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [PicoLog_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PcL_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PCL_ObiTyp = -6560)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PcL_ObiNumer = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.PCL_ObiTyp = -6560)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [PicoLog_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PcEPcNID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PcEPcNID */</I><BR>
ALTER TABLE CDN.PicoLogElem ADD CONSTRAINT FK_PcEPcNID
 FOREIGN KEY
   (
                          PcE_PcNID                         
                         )
             REFERENCES CDN.PicoLogNag
                         (
                          PcN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PcRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PcRPrimary */</I><BR>
ALTER TABLE CDN.PicoRelacje ADD CONSTRAINT FK_PcRPrimary
 FOREIGN KEY
   (
                          PcR_ID                            
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PicoRelacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PicoRelacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PicoRelacje_InsertUpdateHandler
  ON CDN.PicoRelacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PcR_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PcR_OBITyp=4181)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWzorceWizyt ON
                    inserted.PcR_OBINumer = CDN.CRMWzorceWizyt.CWW_Id
              WHERE CDN.CRMWzorceWizyt.CWW_Id IS NULL AND (inserted.PcR_OBITyp=4181)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWzorceWizyt) [PicoRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PcR_OBINumer )  OR UPDATE( PcR_OBITyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PcR_OBITyp=4182)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyElem ON
                    inserted.PcR_OBINumer = CDN.CRMWizytyElem.CWE_GidNumer
                AND inserted.PcR_OBITyp = CDN.CRMWizytyElem.CWE_GidTyp
              WHERE CDN.CRMWizytyElem.CWE_GidTyp IS NULL AND (inserted.PcR_OBITyp=4182)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyElem) [PicoRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PcR_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PcR_OBITyp=-6560)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PcR_OBINumer = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.PcR_OBITyp=-6560)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [PicoRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSDOddzial"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSDOddzial */</I><BR>
ALTER TABLE CDN.PicoSposobyDst ADD CONSTRAINT FK_PSDOddzial
 FOREIGN KEY
   (
                          PSD_PicoId                        
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSDSposob"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSDSposob */</I><BR>
ALTER TABLE CDN.PicoSposobyDst ADD CONSTRAINT FK_PSDSposob
 FOREIGN KEY
   (
                          PSD_SposobTyp                     ,
                          PSD_SposobLp                      
                         )
             REFERENCES CDN.Nazwy
                         (
                          Naz_GIDTyp                        ,
                          Naz_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSaOddzial"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSaOddzial */</I><BR>
ALTER TABLE CDN.PicoStanowiska ADD CONSTRAINT FK_PSaOddzial
 FOREIGN KEY
   (
                          PSa_PcKID                         
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PFPStanowisko"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PFPStanowisko */</I><BR>
ALTER TABLE CDN.PicoStanowiskaFormyPl ADD CONSTRAINT FK_PFPStanowisko
 FOREIGN KEY
   (
                          PFP_PSaID                         
                         )
             REFERENCES CDN.PicoStanowiska
                         (
                          PSa_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PicoStanowiskaFormyPl_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PicoStanowiskaFormyPl_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PicoStanowiskaFormyPl_InsertUpdateHandler
  ON CDN.PicoStanowiskaFormyPl
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PFP_KARNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.PFP_KARNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PFP_KARNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [PicoStanowiskaFormyPl_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKnStanowisko"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKnStanowisko */</I><BR>
ALTER TABLE CDN.PicoStanowiskaOperatorzy ADD CONSTRAINT FK_PKnStanowisko
 FOREIGN KEY
   (
                          PKn_PSaID                         
                         )
             REFERENCES CDN.PicoStanowiska
                         (
                          PSa_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKnOperatorNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKnOperatorNoType */</I><BR>
ALTER TABLE CDN.PicoStanowiskaOperatorzy ADD CONSTRAINT FK_PKnOperatorNoType
 FOREIGN KEY
   (
                          PKn_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PWrStanowisko"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PWrStanowisko */</I><BR>
ALTER TABLE CDN.PicoStanowiskaWydruki ADD CONSTRAINT FK_PWrStanowisko
 FOREIGN KEY
   (
                          PWr_PSaID                         
                         )
             REFERENCES CDN.PicoStanowiska
                         (
                          PSa_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSSPrimary */</I><BR>
ALTER TABLE CDN.PicoSzybkaSprzedaz ADD CONSTRAINT FK_PSSPrimary
 FOREIGN KEY
   (
                          PSS_PicoID                        
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSSTwrGrupy"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSSTwrGrupy */</I><BR>
ALTER TABLE CDN.PicoSzybkaSprzedaz ADD CONSTRAINT FK_PSSTwrGrupy
 FOREIGN KEY
   (
                          PSS_TwgSyncID                     
                         )
             REFERENCES CDN.TwrGrupy
                         (
                          TwG_SyncId   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PcSOddzial"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PcSOddzial */</I><BR>
ALTER TABLE CDN.PicoTimestamp ADD CONSTRAINT FK_PcSOddzial
 FOREIGN KEY
   (
                          PcS_PcKID                         
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PUTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PUTPrimary */</I><BR>
ALTER TABLE CDN.PicoUlubioneTwr ADD CONSTRAINT FK_PUTPrimary
 FOREIGN KEY
   (
                          PUT_PicoID                        
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PUTTwr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PUTTwr */</I><BR>
ALTER TABLE CDN.PicoUlubioneTwr ADD CONSTRAINT FK_PUTTwr
 FOREIGN KEY
   (
                          PUT_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PcUOddzial"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PcUOddzial */</I><BR>
ALTER TABLE CDN.PicoUsuniete ADD CONSTRAINT FK_PcUOddzial
 FOREIGN KEY
   (
                          PcU_PcKId                         
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PwLOddzial"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PwLOddzial */</I><BR>
ALTER TABLE CDN.PicoWaluty ADD CONSTRAINT FK_PwLOddzial
 FOREIGN KEY
   (
                          PwL_PckId                         
                         )
             REFERENCES CDN.PicoKonfig
                         (
                          PcK_PicoID                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PicoWaluty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PicoWaluty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PicoWaluty_DeleteHandler
  ON CDN.PicoWaluty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoLog
    IF EXISTS
       ( SELECT * FROM CDN.PicoLog JOIN deleted
          ON
                deleted.PwL_ID = CDN.PicoLog.PcL_ObiNumer
            
       AND (CDN.PicoLog.PcL_OBITyp=96 AND ISNULL(CDN.PicoLog.PcL_ObiNumer,0)&lt;&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kursu waluty ponieważ został on przesynchronizowany do Oddziału Offline./# [PicoWaluty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlaceElementyGrupy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlaceElementyGrupy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlaceElementyGrupy_DeleteHandler
  ON CDN.PlaceElementyGrupy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlaceElementyWyplat
    IF EXISTS
       ( SELECT * FROM CDN.PlaceElementyWyplat JOIN deleted
          ON
                deleted.PEG_Id = CDN.PlaceElementyWyplat.PEW_PEGId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlaceElementyWyplat) [PlaceElementyGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PEPPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PEPPrimary */</I><BR>
ALTER TABLE CDN.PlaceElementyProgi ADD CONSTRAINT FK_PEPPrimary
 FOREIGN KEY
   (
                          PEP_PEWId                         
                         )
             REFERENCES CDN.PlaceElementyWyplat
                         (
                          PEW_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlaceElementySkladniki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlaceElementySkladniki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlaceElementySkladniki_DeleteHandler
  ON CDN.PlaceElementySkladniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WypSElem
    IF EXISTS
       ( SELECT * FROM CDN.WypSElem JOIN deleted
          ON
                deleted.PES_Id = CDN.WypSElem.WPS_PESId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WypSElem) [PlaceElementySkladniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlaceElementySkladniki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlaceElementySkladniki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlaceElementySkladniki_InsertUpdateHandler
  ON CDN.PlaceElementySkladniki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PES_PEWId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceElementyWyplat ON
                    inserted.PES_PEWId = CDN.PlaceElementyWyplat.PEW_Id
              WHERE CDN.PlaceElementyWyplat.PEW_Id IS NULL
                AND (
                          IsNull(inserted.PES_PEWId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceElementyWyplat) [PlaceElementySkladniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlaceElementyWyplat_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlaceElementyWyplat_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlaceElementyWyplat_DeleteHandler
  ON CDN.PlaceElementyWyplat
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoDodatki
    IF EXISTS
       ( SELECT * FROM CDN.OsoDodatki JOIN deleted
          ON
                deleted.PEW_Id = CDN.OsoDodatki.OsD_PEWId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoDodatki) [PlaceElementyWyplat_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DefNieobecnosci
    IF EXISTS
       ( SELECT * FROM CDN.DefNieobecnosci JOIN deleted
          ON
                deleted.PEW_Id = CDN.DefNieobecnosci.DNB_WynagrodzeniePEWId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą DefNieobecnosci) [PlaceElementyWyplat_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WypElem
    IF EXISTS
       ( SELECT * FROM CDN.WypElem JOIN deleted
          ON
                deleted.PEW_Id = CDN.WypElem.WPE_PEWId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WypElem) [PlaceElementyWyplat_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoRodzajStaz
    IF EXISTS(SELECT * FROM CDN.OsoRodzajStaz JOIN deleted
            ON 
          deleted.PEW_Id = CDN.OsoRodzajStaz.ORS_OWZNumer
      AND (CDN.OsoRodzajStaz.ORS_OWZTyp=14503)
            )
        DELETE CDN.OsoRodzajStaz
        FROM CDN.OsoRodzajStaz JOIN deleted
        ON 
          deleted.PEW_Id = CDN.OsoRodzajStaz.ORS_OWZNumer
      AND (CDN.OsoRodzajStaz.ORS_OWZTyp=14503)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PEW_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14503 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PEW_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14503 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlaceElementySkladniki
    IF EXISTS(SELECT * FROM CDN.PlaceElementySkladniki JOIN deleted
            ON 
          deleted.PEW_Id = CDN.PlaceElementySkladniki.PES_PEWId
            )
        DELETE CDN.PlaceElementySkladniki
        FROM CDN.PlaceElementySkladniki JOIN deleted
        ON 
          deleted.PEW_Id = CDN.PlaceElementySkladniki.PES_PEWId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlaceElementyWyplat_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlaceElementyWyplat_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlaceElementyWyplat_InsertUpdateHandler
  ON CDN.PlaceElementyWyplat
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PEW_PSWId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceSkladkiWzorce ON
                    inserted.PEW_PSWId = CDN.PlaceSkladkiWzorce.PSW_Id
              WHERE CDN.PlaceSkladkiWzorce.PSW_Id IS NULL
                AND (
                          IsNull(inserted.PEW_PSWId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceSkladkiWzorce) [PlaceElementyWyplat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PEW_PEGId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceElementyGrupy ON
                    inserted.PEW_PEGId = CDN.PlaceElementyGrupy.PEG_Id
              WHERE CDN.PlaceElementyGrupy.PEG_Id IS NULL
                AND (
                          IsNull(inserted.PEW_PEGId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceElementyGrupy) [PlaceElementyWyplat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlaceSkladkiWzorce_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlaceSkladkiWzorce_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlaceSkladkiWzorce_DeleteHandler
  ON CDN.PlaceSkladkiWzorce
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlaceElementyWyplat
    IF EXISTS
       ( SELECT * FROM CDN.PlaceElementyWyplat JOIN deleted
          ON
                deleted.PSW_Id = CDN.PlaceElementyWyplat.PEW_PSWId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlaceElementyWyplat) [PlaceSkladkiWzorce_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlanElem_DeleteHandler
  ON CDN.PlanElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanyObciazeniaPozycje
    IF EXISTS(SELECT * FROM CDN.PlanyObciazeniaPozycje JOIN deleted
            ON 
          deleted.Ple_Id = CDN.PlanyObciazeniaPozycje.PPO_DokZrdNumer
      AND (CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp=14347)
            )
        DELETE CDN.PlanyObciazeniaPozycje
        FROM CDN.PlanyObciazeniaPozycje JOIN deleted
        ON 
          deleted.Ple_Id = CDN.PlanyObciazeniaPozycje.PPO_DokZrdNumer
      AND (CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp=14347)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.Ple_Id = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (CDN.DokZwiazane.DoZ_ZrdTyp=14347)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.Ple_Id = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (CDN.DokZwiazane.DoZ_ZrdTyp=14347)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanElem_InsertUpdateHandler
  ON CDN.PlanElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PLE_Okres ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanOkres ON
                    inserted.PLE_Okres = CDN.PlanOkres.PLO_Id
              WHERE CDN.PlanOkres.PLO_Id IS NULL
                AND (
                          IsNull(inserted.PLE_Okres,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanOkres) [PlanElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PLE_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PLE_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PLE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PLE_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [PlanElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlanNag_DeleteHandler
  ON CDN.PlanNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPlanyProdukty
    IF EXISTS
       ( SELECT * FROM CDN.ProdPlanyProdukty JOIN deleted
          ON
                deleted.PLN_Id = CDN.ProdPlanyProdukty.PPP_DokZrdNumer
       AND (CDN.ProdPlanyProdukty.PPP_DokZrdTyp = 14347)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPlanyProdukty) [PlanNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanOkres
    IF EXISTS(SELECT * FROM CDN.PlanOkres JOIN deleted
            ON 
          deleted.PLN_Id = CDN.PlanOkres.PLO_Plan
            )
        DELETE CDN.PlanOkres
        FROM CDN.PlanOkres JOIN deleted
        ON 
          deleted.PLN_Id = CDN.PlanOkres.PLO_Plan
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanNag_InsertUpdateHandler
  ON CDN.PlanNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PLN_PlanZrodlowy ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanNag ON
                    inserted.PLN_PlanZrodlowy = CDN.PlanNag.PLN_Id
              WHERE CDN.PlanNag.PLN_Id IS NULL
                AND (
                          IsNull(inserted.PLN_PlanZrodlowy,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanNag) [PlanNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PLN_OpeNumerW ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PLN_OpeNumerW = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PLN_OpeNumerW,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PlanNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PLN_OpeNumerZ ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PLN_OpeNumerZ = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PLN_OpeNumerZ,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PlanNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanNagAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanNagAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlanNagAlias_DeleteHandler
  ON CDN.PlanNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanNag
    IF EXISTS
       ( SELECT * FROM CDN.PlanNag JOIN deleted
          ON
                deleted.PLN_Id = CDN.PlanNag.PLN_PlanZrodlowy
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlanNag) [PlanNagAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanOkres_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanOkres_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlanOkres_DeleteHandler
  ON CDN.PlanOkres
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanElem
    IF EXISTS(SELECT * FROM CDN.PlanElem JOIN deleted
            ON 
          deleted.PLO_Id = CDN.PlanElem.PLE_Okres
            )
        DELETE CDN.PlanElem
        FROM CDN.PlanElem JOIN deleted
        ON 
          deleted.PLO_Id = CDN.PlanElem.PLE_Okres
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanOkres_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanOkres_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanOkres_InsertUpdateHandler
  ON CDN.PlanOkres
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PLO_Plan ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanNag ON
                    inserted.PLO_Plan = CDN.PlanNag.PLN_Id
              WHERE CDN.PlanNag.PLN_Id IS NULL
                AND (
                          IsNull(inserted.PLO_Plan,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanNag) [PlanOkres_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSKPrimary */</I><BR>
ALTER TABLE CDN.PlanSprzedazyKnt ADD CONSTRAINT FK_PSKPrimary
 FOREIGN KEY
   (
                          PSK_PSpID                         
                         )
             REFERENCES CDN.PlanSprzedazy
                         (
                          PsP_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanSprzedazyKnt_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanSprzedazyKnt_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanSprzedazyKnt_InsertUpdateHandler
  ON CDN.PlanSprzedazyKnt
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PSK_KntTyp )  OR UPDATE( PSK_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PSK_KntTyp&lt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntGrupy ON
                    inserted.PSK_KntTyp = CDN.KntGrupy.KnG_GIDTyp
                AND inserted.PSK_KntNumer = CDN.KntGrupy.KnG_GIDNumer
              WHERE CDN.KntGrupy.KnG_GIDNumer IS NULL AND (inserted.PSK_KntTyp&lt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntGrupy) [PlanSprzedazyKnt_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PSK_KntTyp )  OR UPDATE( PSK_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PSK_KntTyp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PSK_KntTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.PSK_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PSK_KntTyp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PlanSprzedazyKnt_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSRPrimary */</I><BR>
ALTER TABLE CDN.PlanSprzedazyRej ADD CONSTRAINT FK_PSRPrimary
 FOREIGN KEY
   (
                          PSR_PSpID                         
                         )
             REFERENCES CDN.PlanSprzedazy
                         (
                          PsP_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSRRejID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSRRejID */</I><BR>
ALTER TABLE CDN.PlanSprzedazyRej ADD CONSTRAINT FK_PSRRejID
 FOREIGN KEY
   (
                          PSR_RejID                         
                         )
             REFERENCES CDN.Rejony
                         (
                          REJ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSTPrimary */</I><BR>
ALTER TABLE CDN.PlanSprzedazyTwr ADD CONSTRAINT FK_PSTPrimary
 FOREIGN KEY
   (
                          PST_PSpID                         
                         )
             REFERENCES CDN.PlanSprzedazy
                         (
                          PsP_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanSprzedazyTwr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanSprzedazyTwr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanSprzedazyTwr_InsertUpdateHandler
  ON CDN.PlanSprzedazyTwr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PST_TwrTyp )  OR UPDATE( PST_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PST_TwrTyp&lt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.PST_TwrTyp = CDN.TwrGrupy.TwG_GIDTyp
                AND inserted.PST_TwrNumer = CDN.TwrGrupy.TwG_GIDNumer
              WHERE CDN.TwrGrupy.TwG_GIDNumer IS NULL AND (inserted.PST_TwrTyp&lt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [PlanSprzedazyTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PST_TwrTyp )  OR UPDATE( PST_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PST_TwrTyp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PST_TwrTyp = CDN.TwrKarty.Twr_GIDTyp
                AND inserted.PST_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PST_TwrTyp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [PlanSprzedazyTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PGPPGS"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PGPPGS */</I><BR>
ALTER TABLE CDN.PlanyElementyProdukty ADD CONSTRAINT FK_PGPPGS
 FOREIGN KEY
   (
                          PGP_PGSId                         
                         )
             REFERENCES CDN.PlanyElementySkladnikow
                         (
                          PGS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanyElementyProdukty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanyElementyProdukty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanyElementyProdukty_InsertUpdateHandler
  ON CDN.PlanyElementyProdukty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PGP_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PGP_ObiTyp=14346)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.PGP_ObiNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.PGP_ObiTyp=14346)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [PlanyElementyProdukty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PGP_ObiTyp )  OR UPDATE( PGP_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PGP_ObiTyp=2592)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rezerwacje ON
                    inserted.PGP_ObiTyp = CDN.Rezerwacje.Rez_GIDTyp
                AND inserted.PGP_ObiNumer = CDN.Rezerwacje.Rez_GIDNumer
              WHERE CDN.Rezerwacje.Rez_GIDNumer IS NULL AND (inserted.PGP_ObiTyp=2592)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rezerwacje) [PlanyElementyProdukty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PGSPSO"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PGSPSO */</I><BR>
ALTER TABLE CDN.PlanyElementySkladnikow ADD CONSTRAINT FK_PGSPSO
 FOREIGN KEY
   (
                          PGS_PSOId                         
                         )
             REFERENCES CDN.PlanySkladnikiObciazenia
                         (
                          PSO_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanyElementySkladnikow_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanyElementySkladnikow_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanyElementySkladnikow_InsertUpdateHandler
  ON CDN.PlanyElementySkladnikow
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PGS_PFuId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdFunkcje ON
                    inserted.PGS_PFuId = CDN.ProdFunkcje.PFU_Id
              WHERE CDN.ProdFunkcje.PFU_Id IS NULL
                AND (
                          IsNull(inserted.PGS_PFuId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdFunkcje) [PlanyElementySkladnikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanyObciazeniaGniazd_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanyObciazeniaGniazd_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlanyObciazeniaGniazd_DeleteHandler
  ON CDN.PlanyObciazeniaGniazd
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.POG_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14362 and CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp=0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.POG_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14362 and CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.POG_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14362 AND CDN.DaneObiekty.DAO_ObiLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.POG_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14362 AND CDN.DaneObiekty.DAO_ObiLp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanyObciazeniaGniazd_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanyObciazeniaGniazd_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanyObciazeniaGniazd_InsertUpdateHandler
  ON CDN.PlanyObciazeniaGniazd
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POG_PTOId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanyTypyOkresow ON
                    inserted.POG_PTOId = CDN.PlanyTypyOkresow.PTO_Id
              WHERE CDN.PlanyTypyOkresow.PTO_Id IS NULL
                AND (
                          IsNull(inserted.POG_PTOId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanyTypyOkresow) [PlanyObciazeniaGniazd_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POG_OpeWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.POG_OpeWNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.POG_OpeWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PlanyObciazeniaGniazd_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POG_OpeMNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.POG_OpeMNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.POG_OpeMNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [PlanyObciazeniaGniazd_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPOPOG"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPOPOG */</I><BR>
ALTER TABLE CDN.PlanyObciazeniaPozycje ADD CONSTRAINT FK_PPOPOG
 FOREIGN KEY
   (
                          PPO_POGId                         
                         )
             REFERENCES CDN.PlanyObciazeniaGniazd
                         (
                          POG_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanyObciazeniaPozycje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanyObciazeniaPozycje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanyObciazeniaPozycje_InsertUpdateHandler
  ON CDN.PlanyObciazeniaPozycje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPO_DokZrdNumer )  OR UPDATE( PPO_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPO_DokZrdTyp=14448)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BstElem ON
                    inserted.PPO_DokZrdNumer = CDN.BstElem.BsE_BsNID
                AND inserted.PPO_TwrNumer = CDN.BstElem.BsE_TwrNumer
              WHERE CDN.BstElem.BsE_TwrNumer IS NULL AND (inserted.PPO_DokZrdTyp=14448)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BstElem) [PlanyObciazeniaPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPO_DokZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPO_DokZrdTyp=14347)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanElem ON
                    inserted.PPO_DokZrdNumer = CDN.PlanElem.Ple_Id
              WHERE CDN.PlanElem.Ple_Id IS NULL AND (inserted.PPO_DokZrdTyp=14347)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanElem) [PlanyObciazeniaPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPO_DokZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPO_DokZrdTyp=14348)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecElem ON
                    inserted.PPO_DokZrdNumer = CDN.ProdZlecElem.PZE_Id
              WHERE CDN.ProdZlecElem.PZE_Id IS NULL AND (inserted.PPO_DokZrdTyp=14348)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecElem) [PlanyObciazeniaPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPO_DokZrdTyp )  OR UPDATE( PPO_DokZrdNumer )  OR UPDATE( PPO_DokZrdLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPO_DokZrdTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.PPO_DokZrdTyp = CDN.ZamElem.ZaE_GIDTyp
                AND inserted.PPO_DokZrdNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.PPO_DokZrdLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.PPO_DokZrdTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [PlanyObciazeniaPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPO_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPO_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PPO_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PPO_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [PlanyObciazeniaPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPSPrimary */</I><BR>
ALTER TABLE CDN.PlanyPozycjeSkladniki ADD CONSTRAINT FK_PPSPrimary
 FOREIGN KEY
   (
                          PPS_PPOId                         
                         )
             REFERENCES CDN.PlanyObciazeniaPozycje
                         (
                          PPO_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PSOPOG"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PSOPOG */</I><BR>
ALTER TABLE CDN.PlanySkladnikiObciazenia ADD CONSTRAINT FK_PSOPOG
 FOREIGN KEY
   (
                          PSO_POGId                         
                         )
             REFERENCES CDN.PlanyObciazeniaGniazd
                         (
                          POG_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanySkladnikiObciazenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanySkladnikiObciazenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PlanySkladnikiObciazenia_InsertUpdateHandler
  ON CDN.PlanySkladnikiObciazenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PSO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PSO_ObiTyp=14345)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.PSO_ObiNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.PSO_ObiTyp=14345)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [PlanySkladnikiObciazenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PSO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PSO_ObiTyp=14341)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaCzynnosci ON
                    inserted.PSO_ObiNumer = CDN.ProdTechnologiaCzynnosci.PTC_Id
              WHERE CDN.ProdTechnologiaCzynnosci.PTC_Id IS NULL AND (inserted.PSO_ObiTyp=14341)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaCzynnosci) [PlanySkladnikiObciazenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PlanyTypyOkresow_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PlanyTypyOkresow_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PlanyTypyOkresow_DeleteHandler
  ON CDN.PlanyTypyOkresow
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanyObciazeniaGniazd
    IF EXISTS
       ( SELECT * FROM CDN.PlanyObciazeniaGniazd JOIN deleted
          ON
                deleted.PTO_Id = CDN.PlanyObciazeniaGniazd.POG_PTOId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlanyObciazeniaGniazd) [PlanyTypyOkresow_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PprPrmId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PprPrmId */</I><BR>
ALTER TABLE CDN.PltPromocje ADD CONSTRAINT FK_PprPrmId
 FOREIGN KEY
   (
                          PPr_PrmID                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_POEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_POEPrimary */</I><BR>
ALTER TABLE CDN.PodElem ADD CONSTRAINT FK_POEPrimary
 FOREIGN KEY
   (
                          POE_GIDNumer                      
                         )
             REFERENCES CDN.PodNag
                         (
                          PON_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PEDKontrahent"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PEDKontrahent */</I><BR>
ALTER TABLE CDN.PodElemDok ADD CONSTRAINT FK_PEDKontrahent
 FOREIGN KEY
   (
                          PED_KntNumer                      
                         )
             REFERENCES CDN.KntKarty
                         (
                          Knt_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PEDKontrahentArd"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PEDKontrahentArd */</I><BR>
ALTER TABLE CDN.PodElemDok ADD CONSTRAINT FK_PEDKontrahentArd
 FOREIGN KEY
   (
                          PED_KnANumer                      
                         )
             REFERENCES CDN.KntAdresy
                         (
                          KnA_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PEVPlatnosci"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PEVPlatnosci */</I><BR>
ALTER TABLE CDN.PodElemDok ADD CONSTRAINT FK_PEVPlatnosci
 FOREIGN KEY
   (
                          PED_TRPTyp                        ,
                          PED_TRPNumer                      ,
                          PED_TRPLp                         
                         )
             REFERENCES CDN.TraPlat
                         (
                          TrP_GIDTyp   ,
                          TrP_GIDNumer   ,
                          TrP_GIDLp   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PodElemDok_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PodElemDok_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PodElemDok_InsertUpdateHandler
  ON CDN.PodElemDok
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PED_PONNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PED_PONNumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PodNag ON
                    inserted.PED_PONNumer = CDN.PodNag.PON_GIDNumer
              WHERE CDN.PodNag.PON_GIDNumer IS NULL AND (inserted.PED_PONNumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PodNag) [PodElemDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRIMARY"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRIMARY */</I><BR>
ALTER TABLE CDN.PodElemDokVat ADD CONSTRAINT FK_PRIMARY
 FOREIGN KEY
   (
                          PEV_PONNumer                      ,
                          PEV_PEDLp                         
                         )
             REFERENCES CDN.PodElemDok
                         (
                          PED_PONNumer                      ,
                          PED_Lp                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PELPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PELPrimary */</I><BR>
ALTER TABLE CDN.PodElemListy ADD CONSTRAINT FK_PELPrimary
 FOREIGN KEY
   (
                          PEL_PONTyp                        ,
                          PEL_PONNumer                      ,
                          PEL_POELp                         ,
                          PEL_PENId                         
                         )
             REFERENCES CDN.PodElemNagListy
                         (
                          PEN_PONTyp                        ,
                          PEN_PONNumer                      ,
                          PEN_POELp                         ,
                          PEN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PENPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PENPrimary */</I><BR>
ALTER TABLE CDN.PodElemNagListy ADD CONSTRAINT FK_PENPrimary
 FOREIGN KEY
   (
                          PEN_PONTyp                        ,
                          PEN_PONNumer                      ,
                          PEN_POELp                         
                         )
             REFERENCES CDN.PodElem
                         (
                          POE_GIDTyp                        ,
                          POE_GIDNumer                      ,
                          POE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PVGPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PVGPrimary */</I><BR>
ALTER TABLE CDN.PodElemVUEGrupy ADD CONSTRAINT FK_PVGPrimary
 FOREIGN KEY
   (
                          PVG_POETyp                        ,
                          PVG_POENumer                      ,
                          PVG_POELp                         
                         )
             REFERENCES CDN.PodElem
                         (
                          POE_GIDTyp                        ,
                          POE_GIDNumer                      ,
                          POE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PVPPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PVPPrimary */</I><BR>
ALTER TABLE CDN.PodElemVUEPozycje ADD CONSTRAINT FK_PVPPrimary
 FOREIGN KEY
   (
                          PVP_POETyp                        ,
                          PVP_POENumer                      ,
                          PVP_POELp                         
                         )
             REFERENCES CDN.PodElem
                         (
                          POE_GIDTyp                        ,
                          POE_GIDNumer                      ,
                          POE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PodNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PodNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PodNag_DeleteHandler
  ON CDN.PodNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PodElemDok
    IF EXISTS(SELECT * FROM CDN.PodElemDok JOIN deleted
            ON 
          deleted.PON_GIDNumer = CDN.PodElemDok.PED_PONNumer
      AND (CDN.PodElemDok.PED_PONNumer&gt;0)
            )
        DELETE CDN.PodElemDok
        FROM CDN.PodElemDok JOIN deleted
        ON 
          deleted.PON_GIDNumer = CDN.PodElemDok.PED_PONNumer
      AND (CDN.PodElemDok.PED_PONNumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PON_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.PON_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (2768, 7712, 7696, 7686, 7692, 7689, 7693, 7691))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PON_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.PON_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (2768, 7712, 7696, 7686, 7692, 7689, 7693, 7691))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.PON_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.PON_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp IN(6272,6400,7691))
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.PON_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.PON_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp IN(6272,6400,7691))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.PON_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.PON_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp IN(6272,6400,2768,7691,7696,7712,6402))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.PON_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.PON_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp IN(6272,6400,2768,7691,7696,7712,6402))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PodNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PodNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PodNag_InsertUpdateHandler
  ON CDN.PodNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PON_POZId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PON_GIDTyp = 6401)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PodZestawy ON
                    inserted.PON_POZId = CDN.PodZestawy.POZ_ID
              WHERE CDN.PodZestawy.POZ_ID IS NULL AND (inserted.PON_GIDTyp = 6401)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PodZestawy) [PodNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PON_DPNID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PON_GIDTyp=7691)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DefPodNag ON
                    inserted.PON_DPNID = CDN.DefPodNag.DPN_ID
              WHERE CDN.DefPodNag.DPN_ID IS NULL AND (inserted.PON_GIDTyp=7691)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DefPodNag) [PodNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PON_OkresID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Okresy ON
                    inserted.PON_OkresID = CDN.Okresy.OKR_ID
              WHERE CDN.Okresy.OKR_ID IS NULL
                AND (
                          IsNull(inserted.PON_OkresID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Okresy) [PodNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_POSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_POSPrimary */</I><BR>
ALTER TABLE CDN.PodSElem ADD CONSTRAINT FK_POSPrimary
 FOREIGN KEY
   (
                          POS_GIDTyp                        ,
                          POS_GIDNumer                      ,
                          POS_GIDLp                         
                         )
             REFERENCES CDN.PodElem
                         (
                          POE_GIDTyp                        ,
                          POE_GIDNumer                      ,
                          POE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PodZestawy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PodZestawy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PodZestawy_DeleteHandler
  ON CDN.PodZestawy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PodNag
    IF EXISTS(SELECT * FROM CDN.PodNag JOIN deleted
            ON 
          deleted.POZ_ID = CDN.PodNag.PON_POZId
      AND (CDN.PodNag.PON_GIDTyp = 6401)
            )
        DELETE CDN.PodNag
        FROM CDN.PodNag JOIN deleted
        ON 
          deleted.POZ_ID = CDN.PodNag.PON_POZId
      AND (CDN.PodNag.PON_GIDTyp = 6401)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PDEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PDEPrimary */</I><BR>
ALTER TABLE CDN.PodzielnikElem ADD CONSTRAINT FK_PDEPrimary
 FOREIGN KEY
   (
                          PDE_GIDNumer                      
                         )
             REFERENCES CDN.PodzielnikNag
                         (
                          PDN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PDMPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PDMPrimary */</I><BR>
ALTER TABLE CDN.PodzielnikMElem ADD CONSTRAINT FK_PDMPrimary
 FOREIGN KEY
   (
                          PDM_PdNNumer                      
                         )
             REFERENCES CDN.PodzielnikNag
                         (
                          PDN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PodzielnikNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PodzielnikNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PodzielnikNag_DeleteHandler
  ON CDN.PodzielnikNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PIKNag
    IF EXISTS
       ( SELECT * FROM CDN.PIKNag JOIN deleted
          ON
                deleted.PDN_GIDNumer = CDN.PIKNag.PIN_PDNNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PIKNag) [PodzielnikNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PdpPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PdpPrimaryNoType */</I><BR>
ALTER TABLE CDN.PodzielnikPrac ADD CONSTRAINT FK_PdpPrimaryNoType
 FOREIGN KEY
   (
                          PDP_PdnNumer                      
                         )
             REFERENCES CDN.PodzielnikNag
                         (
                          PDN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PdpPracownik"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PdpPracownik */</I><BR>
ALTER TABLE CDN.PodzielnikPrac ADD CONSTRAINT FK_PdpPracownik
 FOREIGN KEY
   (
                          PDP_PrcNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PDSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PDSPrimary */</I><BR>
ALTER TABLE CDN.PodzielnikSElem ADD CONSTRAINT FK_PDSPrimary
 FOREIGN KEY
   (
                          PDS_GIDNumer                      ,
                          PDS_GIDLp                         
                         )
             REFERENCES CDN.PodzielnikElem
                         (
                          PDE_GIDNumer                      ,
                          PDE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PDZPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PDZPrimary */</I><BR>
ALTER TABLE CDN.PodzielnikZElem ADD CONSTRAINT FK_PDZPrimary
 FOREIGN KEY
   (
                          PDZ_PdNNumer                      
                         )
             REFERENCES CDN.PodzielnikNag
                         (
                          PDN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_POTPoleceniaGlowne"></A><PRE>
          <FONT SIZE="2"><I>/* FK_POTPoleceniaGlowne */</I><BR>
ALTER TABLE CDN.PoleceniaTozsame ADD CONSTRAINT FK_POTPoleceniaGlowne
 FOREIGN KEY
   (
                          POT_PGLId                         
                         )
             REFERENCES CDN.PoleceniaGlowne
                         (
                          PGL_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRAEPrcNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRAEPrcNumer */</I><BR>
ALTER TABLE CDN.PrcAdresyEmail ADD CONSTRAINT FK_PRAEPrcNumer
 FOREIGN KEY
   (
                          PRAE_PrcNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrcHist_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrcHist_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PrcHist_InsertUpdateHandler
  ON CDN.PrcHist
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PHi_PrcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PHi_PrcNumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.PHi_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.PHi_PrcNumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [PrcHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrcKarty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrcKarty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PrcKarty_DeleteHandler
  ON CDN.PrcKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImtOdczytyElem
    IF EXISTS
       ( SELECT * FROM CDN.ImtOdczytyElem JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ImtOdczytyElem.IOE_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImtOdczytyElem) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.UmwNag.UmN_OpiekunNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekOpiekunowieDok
    IF EXISTS
       ( SELECT * FROM CDN.SekOpiekunowieDok JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SekOpiekunowieDok.SOD_OpiekunGidNumer
       AND (CDN.SekOpiekunowieDok.SOD_OpiekunGidTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SekOpiekunowieDok) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekStatusyDok
    IF EXISTS
       ( SELECT * FROM CDN.SekStatusyDok JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SekStatusyDok.SOS_WprowadzilNumer
       AND (CDN.SekStatusyDok.SoS_WprowadzilTyp=994)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SekStatusyDok) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.WydatkiPracownikow.WPR_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WydatkiPracownikow) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntOpiekun
    IF EXISTS
       ( SELECT * FROM CDN.KntOpiekun JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.KntOpiekun.KtO_PrcNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pracownika. Usuwany pracownik jest wybrany na jednym z rejonów lub jest opiekunem kontrahenta../# [PrcKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.CRMWizytyNag.CWN_Obsluga
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wyplaty
    IF EXISTS
       ( SELECT * FROM CDN.Wyplaty JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.Wyplaty.WPL_OsoNumer
            
       AND (deleted.Prc_GIDTyp=944)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pracownika, który posiada naliczone wypłaty./# [PrcKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SrwZlcNag.SZN_OpiNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzWlasc
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzWlasc JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SrwUrzWlasc.SUW_WlaNumer
       AND (CDN.SrwUrzWlasc.SUW_WlaTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwUrzWlasc) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SamPrzejazdy
    IF EXISTS
       ( SELECT * FROM CDN.SamPrzejazdy JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SamPrzejazdy.SaP_KierNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SamPrzejazdy) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Samochody
    IF EXISTS
       ( SELECT * FROM CDN.Samochody JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.Samochody.SaM_KierNumer
       AND (CDN.Samochody.SaM_KierTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Samochody) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wysylki
    IF EXISTS
       ( SELECT * FROM CDN.Wysylki JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.Wysylki.WYS_KierNumer
       AND (CDN.Wysylki.WyS_KierTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wysylki) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TrasyNag
    IF EXISTS
       ( SELECT * FROM CDN.TrasyNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.TrasyNag.TsN_KierNumer
       AND (CDN.TrasyNag.TsN_KierTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TrasyNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiektyUzycie
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiektyUzycie JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ProdObiektyUzycie.POU_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiektyUzycie) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiekty JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ProdObiekty.POB_ObiNumer
       AND (CDN.ProdObiekty.POB_ObiTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiekty) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ImpNag.ImN_KnPNumer
       AND (CDN.ImpNag.ImN_KnPTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.KntKarty.Knt_KnPNumer
       AND (CDN.KntKarty.Knt_KnPTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ZlcRemNag.ZRN_OpiNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.KntKarty.Knt_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SadNag.SaN_PrcTypZ
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ZlcNag.ZcN_OpiNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UpoNag
    IF EXISTS
       ( SELECT * FROM CDN.UpoNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.UpoNag.UPN_KNTNumer
       AND (CDN.UpoNag.UPN_KntTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UpoNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ZamNag.ZaN_AkwNumer
       AND (CDN.ZamNag.ZaN_AkwTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.TraNag.TrN_AkwNumer
       AND (CDN.TraNag.TRN_AkwTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsObiekty
    IF EXISTS
       ( SELECT * FROM CDN.SrsObiekty JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SrsObiekty.SOb_PrcNumerO
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsObiekty) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.FrmStruktura.FRS_GIDNumer
       AND (CDN.FrmStruktura.FRS_GIDTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNKartyPracyPrc
    IF EXISTS
       ( SELECT * FROM CDN.ZRNKartyPracyPrc JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ZRNKartyPracyPrc.ZRP_PRCNumer
       AND (CDN.ZRNKartyPracyPrc.ZrP_PrcTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNKartyPracyPrc) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DtsZestawy
    IF EXISTS
       ( SELECT * FROM CDN.DtsZestawy JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.DtsZestawy.DZE_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą DtsZestawy) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraPlat
    IF EXISTS
       ( SELECT * FROM CDN.TraPlat JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.TraPlat.TrP_KntNumer
       AND (CDN.TraPlat.TRP_KntTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraPlat) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemElem
    IF EXISTS
       ( SELECT * FROM CDN.MemElem JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.MemElem.MEE_KNTNumer
       AND (CDN.MemElem.MEE_KntTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemElem) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MemNag
    IF EXISTS
       ( SELECT * FROM CDN.MemNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.MemNag.MEN_KNTNumer
       AND (CDN.MemNag.MEN_KntTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MemNag) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.CRMKntEtapy.CEK_AkwNumer
       AND (CDN.CRMKntEtapy.CEK_AkwTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMKntEtapy) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Zapisy
    IF EXISTS
       ( SELECT * FROM CDN.Zapisy JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.Zapisy.KAZ_KNTNumer
       AND (CDN.Zapisy.KAZ_KNTTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Zapisy) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Konta
    IF EXISTS
       ( SELECT * FROM CDN.Konta JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.Konta.KKS_KNTNumer
       AND (CDN.Konta.KKS_KNTTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Konta) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtHistElem
    IF EXISTS
       ( SELECT * FROM CDN.SrtHistElem JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SrtHistElem.SHE_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtHistElem) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtKarty
    IF EXISTS
       ( SELECT * FROM CDN.SrtKarty JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SrtKarty.Srt_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtKarty) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wnioski
    IF EXISTS
       ( SELECT * FROM CDN.Wnioski JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.Wnioski.WNO_PRCNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wnioski) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Delegacje
    IF EXISTS
       ( SELECT * FROM CDN.Delegacje JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.Delegacje.DLG_PRCNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Delegacje) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagOsobyOdpowiedzialne
    IF EXISTS
       ( SELECT * FROM CDN.MagOsobyOdpowiedzialne JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.MagOsobyOdpowiedzialne.MOO_PrcNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pracownika, który jest odpowiedzialny za magazyn./# [PrcKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KBNOdpowiedzialni
    IF EXISTS
       ( SELECT * FROM CDN.KBNOdpowiedzialni JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.KBNOdpowiedzialni.KBNO_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KBNOdpowiedzialni) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOUpowaznienia
    IF EXISTS
       ( SELECT * FROM CDN.PDOUpowaznienia JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.PDOUpowaznienia.PDOU_ObiNumer
       AND (CDN.PDOUpowaznienia.PDOU_ObiTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDOUpowaznienia) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDONaruszenia
    IF EXISTS
       ( SELECT * FROM CDN.PDONaruszenia JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.PDONaruszenia.PDON_InsNumer
       AND (CDN.PDONaruszenia.PDON_InsTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDONaruszenia) [PrcKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.NumeryRachunkow
    IF EXISTS(SELECT * FROM CDN.NumeryRachunkow JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.NumeryRachunkow.NRB_ObNumer
      AND (CDN.NumeryRachunkow.NrB_ObTyp=944)
            )
        DELETE CDN.NumeryRachunkow
        FROM CDN.NumeryRachunkow JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.NumeryRachunkow.NRB_ObNumer
      AND (CDN.NumeryRachunkow.NrB_ObTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZadaniaPrcPodl
    IF EXISTS(SELECT * FROM CDN.ZadaniaPrcPodl JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.ZadaniaPrcPodl.ZPP_PrcNumer
      AND (CDN.ZadaniaPrcPodl.ZPP_PrcTyp=944)
            )
        DELETE CDN.ZadaniaPrcPodl
        FROM CDN.ZadaniaPrcPodl JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.ZadaniaPrcPodl.ZPP_PrcNumer
      AND (CDN.ZadaniaPrcPodl.ZPP_PrcTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoKarty
    IF EXISTS(SELECT * FROM CDN.OsoKarty JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.OsoKarty.Oso_GIDNumer
            )
        DELETE CDN.OsoKarty
        FROM CDN.OsoKarty JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.OsoKarty.Oso_GIDNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntOsobyKomunikatory
    IF EXISTS(SELECT * FROM CDN.KntOsobyKomunikatory JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.KntOsobyKomunikatory.KoK_KnSNumer
      AND (CDN.KntOsobyKomunikatory.KOK_KnSTyp=944)
            )
        DELETE CDN.KntOsobyKomunikatory
        FROM CDN.KntOsobyKomunikatory JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.KntOsobyKomunikatory.KoK_KnSNumer
      AND (CDN.KntOsobyKomunikatory.KOK_KnSTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoDodatki
    IF EXISTS(SELECT * FROM CDN.OsoDodatki JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.OsoDodatki.OsD_OsoNumer
            )
        DELETE CDN.OsoDodatki
        FROM CDN.OsoDodatki JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.OsoDodatki.OsD_OsoNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.OsoUmowy
    IF EXISTS(SELECT * FROM CDN.OsoUmowy JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.OsoUmowy.OsU_OsoNumer
            )
        DELETE CDN.OsoUmowy
        FROM CDN.OsoUmowy JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.OsoUmowy.OsU_OsoNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcObiekty
    IF EXISTS(SELECT * FROM CDN.SrwZlcObiekty JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.SrwZlcObiekty.SZO_ObiNumer
      AND (CDN.SrwZlcObiekty.SZO_OBITyp=944)
            )
        DELETE CDN.SrwZlcObiekty
        FROM CDN.SrwZlcObiekty JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.SrwZlcObiekty.SZO_ObiNumer
      AND (CDN.SrwZlcObiekty.SZO_OBITyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdOkresy
    IF EXISTS(SELECT * FROM CDN.ProdOkresy JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.ProdOkresy.POK_ObiNumer
      AND (CDN.ProdOkresy.POK_ObiTyp=944)
            )
        DELETE CDN.ProdOkresy
        FROM CDN.ProdOkresy JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.ProdOkresy.POK_ObiNumer
      AND (CDN.ProdOkresy.POK_ObiTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=944)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrcHist
    IF EXISTS(SELECT * FROM CDN.PrcHist JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.PrcHist.PHi_PrcNumer
      AND (CDN.PrcHist.PHi_PrcNumer&gt;0)
            )
        DELETE CDN.PrcHist
        FROM CDN.PrcHist JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.PrcHist.PHi_PrcNumer
      AND (CDN.PrcHist.PHi_PrcNumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrcRole
    IF EXISTS(SELECT * FROM CDN.PrcRole JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.PrcRole.PrR_PrcNumer
      AND (CDN.PrcRole.PrR_PrcTyp=944)
            )
        DELETE CDN.PrcRole
        FROM CDN.PrcRole JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.PrcRole.PrR_PrcNumer
      AND (CDN.PrcRole.PrR_PrcTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=944)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=944)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOAdministratorzy
    IF EXISTS(SELECT * FROM CDN.PDOAdministratorzy JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.PDOAdministratorzy.PDOA_ObiNumer
      AND (CDN.PDOAdministratorzy.PDOA_ObiTyp=944)
            )
        DELETE CDN.PDOAdministratorzy
        FROM CDN.PDOAdministratorzy JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.PDOAdministratorzy.PDOA_ObiNumer
      AND (CDN.PDOAdministratorzy.PDOA_ObiTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zgody
    IF EXISTS(SELECT * FROM CDN.Zgody JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.Zgody.Zgo_ObiNumer
      AND (CDN.Zgody.Zgo_ObiTyp = 944)
            )
        DELETE CDN.Zgody
        FROM CDN.Zgody JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.Zgody.Zgo_ObiNumer
      AND (CDN.Zgody.Zgo_ObiTyp = 944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.PDOCzynnosci.PDOC_AdminNumer
      AND (CDN.PDOCzynnosci.PDOC_AdminTyp=944)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.PDOCzynnosci.PDOC_AdminNumer
      AND (CDN.PDOCzynnosci.PDOC_AdminTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwObiektyReceptury
    IF EXISTS(SELECT * FROM CDN.SrwObiektyReceptury JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.SrwObiektyReceptury.SOR_ObiNumer
      AND (CDN.SrwObiektyReceptury.SOR_ObiTyp=944)
            )
        DELETE CDN.SrwObiektyReceptury
        FROM CDN.SrwObiektyReceptury JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.SrwObiektyReceptury.SOR_ObiNumer
      AND (CDN.SrwObiektyReceptury.SOR_ObiTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RachunkiBankowe
    IF EXISTS(SELECT * FROM CDN.RachunkiBankowe JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.RachunkiBankowe.RkB_ObiNumer
      AND (CDN.RachunkiBankowe.RkB_ObiTyp = 944)
            )
        DELETE CDN.RachunkiBankowe
        FROM CDN.RachunkiBankowe JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.RachunkiBankowe.RkB_ObiNumer
      AND (CDN.RachunkiBankowe.RkB_ObiTyp = 944)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrcKarty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrcKarty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PrcKarty_InsertUpdateHandler
  ON CDN.PrcKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Prc_PoziomWyksztalcenia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrSlowniki ON
                    inserted.Prc_PoziomWyksztalcenia = CDN.KadrSlowniki.KSl_Id
              WHERE CDN.KadrSlowniki.KSl_Id IS NULL
                AND (
                          IsNull(inserted.Prc_PoziomWyksztalcenia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrSlowniki) [PrcKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Prc_PKAId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdKalendarze ON
                    inserted.Prc_PKAId = CDN.ProdKalendarze.PKA_Id
              WHERE CDN.ProdKalendarze.PKA_Id IS NULL
                AND (
                          IsNull(inserted.Prc_PKAId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdKalendarze) [PrcKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Prc_BnkNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.Prc_BnkNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Prc_BnkNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [PrcKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrcKartyAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrcKartyAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PrcKartyAlias1_DeleteHandler
  ON CDN.PrcKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImtArkuszeElem
    IF EXISTS
       ( SELECT * FROM CDN.ImtArkuszeElem JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ImtArkuszeElem.IAE_PrcNumerEwidencja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImtArkuszeElem) [PrcKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SadNag.SaN_AkwNumer
       AND (CDN.SadNag.SaN_AkwTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [PrcKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.TraNag.TrN_KnPNumer
       AND (CDN.TraNag.TrN_KnPTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [PrcKartyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.PDOCzynnosci.PDOC_InspNumer
      AND (CDN.PDOCzynnosci.PDOC_InspTyp=944)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.PDOCzynnosci.PDOC_InspNumer
      AND (CDN.PDOCzynnosci.PDOC_InspTyp=944)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrcKartyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrcKartyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PrcKartyAlias_DeleteHandler
  ON CDN.PrcKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImtArkuszeElem
    IF EXISTS
       ( SELECT * FROM CDN.ImtArkuszeElem JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ImtArkuszeElem.IAE_PrcNumerSpis
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImtArkuszeElem) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImtOdczytyElem
    IF EXISTS
       ( SELECT * FROM CDN.ImtOdczytyElem JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ImtOdczytyElem.IOE_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImtOdczytyElem) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.CRMWizytyNag.CWN_Opiekun
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SrwZlcNag.SZN_KnPNumer
       AND (CDN.SrwZlcNag.SZN_KnPTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ImpNag.ImN_AkwNumer
       AND (CDN.ImpNag.ImN_AkwTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SadNag.SaN_KnPNumer
       AND (CDN.SadNag.SaN_KnPTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ZlcRemNag.ZRN_AkwNumer
       AND (CDN.ZlcRemNag.ZrN_AkwTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemNag) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.KntKarty.Knt_AkwNumer
       AND (CDN.KntKarty.Knt_AkwTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ZlcNag.ZcN_AkwNumer
       AND (CDN.ZlcNag.ZcN_AkwTyp=944)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcNag) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.TraNag.TrN_OpiNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.ZamNag.ZaN_OpiNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.FrmStruktura.FRS_PrcNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsObiekty
    IF EXISTS
       ( SELECT * FROM CDN.SrsObiekty JOIN deleted
          ON
                deleted.Prc_GIDNumer = CDN.SrsObiekty.SOb_PrcNumerS
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsObiekty) [PrcKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZadaniaPrcPodl
    IF EXISTS(SELECT * FROM CDN.ZadaniaPrcPodl JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.ZadaniaPrcPodl.ZPP_PrcPodlNumer
      AND (CDN.ZadaniaPrcPodl.ZPP_PrcPodlTyp=944)
            )
        DELETE CDN.ZadaniaPrcPodl
        FROM CDN.ZadaniaPrcPodl JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.ZadaniaPrcPodl.ZPP_PrcPodlNumer
      AND (CDN.ZadaniaPrcPodl.ZPP_PrcPodlTyp=944)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PDOCzynnosci
    IF EXISTS(SELECT * FROM CDN.PDOCzynnosci JOIN deleted
            ON 
          deleted.Prc_GIDNumer = CDN.PDOCzynnosci.PDOC_PrzedstNumer
      AND (CDN.PDOCzynnosci.PDOC_PrzedstTyp=944)
            )
        DELETE CDN.PDOCzynnosci
        FROM CDN.PDOCzynnosci JOIN deleted
        ON 
          deleted.Prc_GIDNumer = CDN.PDOCzynnosci.PDOC_PrzedstNumer
      AND (CDN.PDOCzynnosci.PDOC_PrzedstTyp=944)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrcRole_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrcRole_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PrcRole_InsertUpdateHandler
  ON CDN.PrcRole
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PrR_PrcNumer )  OR UPDATE( PrR_PrcLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PrR_PrcTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.PrR_PrcNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.PrR_PrcLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.PrR_PrcTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [PrcRole_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrR_PrcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PrR_PrcTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.PrR_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.PrR_PrcTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [PrcRole_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrR_FrSId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PrR_FrSId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PrR_FrSId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [PrcRole_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrR_RolId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Role ON
                    inserted.PrR_RolId = CDN.Role.Rol_Id
              WHERE CDN.Role.Rol_Id IS NULL
                AND (
                          IsNull(inserted.PrR_RolId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Role) [PrcRole_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRWPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRWPrimaryNoType */</I><BR>
ALTER TABLE CDN.PrcWarunki ADD CONSTRAINT FK_PRWPrimaryNoType
 FOREIGN KEY
   (
                          PRW_GIDNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Predekrety_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Predekrety_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Predekrety_InsertUpdateHandler
  ON CDN.Predekrety
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp=434)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KompNag ON
                    inserted.PDT_GIDNumer = CDN.KompNag.KMN_ID
              WHERE CDN.KompNag.KMN_ID IS NULL AND (inserted.PDT_GIDTyp=434)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KompNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDT_GIDTyp )  OR UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp IN(6272,6400,7691))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PodNag ON
                    inserted.PDT_GIDTyp = CDN.PodNag.PON_GIDTyp
                AND inserted.PDT_GIDNumer = CDN.PodNag.PON_GIDNumer
              WHERE CDN.PodNag.PON_GIDNumer IS NULL AND (inserted.PDT_GIDTyp IN(6272,6400,7691))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PodNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp IN(2976,2977))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PIKNag ON
                    inserted.PDT_GIDNumer = CDN.PIKNag.PIN_GIDNumer
              WHERE CDN.PIKNag.PIN_GIDNumer IS NULL AND (inserted.PDT_GIDTyp IN(2976,2977))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PIKNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDT_GIDTyp )  OR UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp=2832)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UpoNag ON
                    inserted.PDT_GIDTyp = CDN.UpoNag.UPN_GIDTyp
                AND inserted.PDT_GIDNumer = CDN.UpoNag.UPN_GIDNumer
              WHERE CDN.UpoNag.UPN_GIDNumer IS NULL AND (inserted.PDT_GIDTyp=2832)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UpoNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp in (4144,4145,4146))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.PDT_GIDNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.PDT_GIDTyp in (4144,4145,4146))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp=3344)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.PDT_GIDNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.PDT_GIDTyp=3344)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDT_GIDTyp )  OR UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp=3376 OR inserted.PDT_GIDTyp=3377)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.PDT_GIDTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.PDT_GIDNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (inserted.PDT_GIDTyp=3376 OR inserted.PDT_GIDTyp=3377)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDT_GIDTyp )  OR UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp=2048 OR inserted.PDT_GIDTyp=2064  OR           inserted.PDT_GIDTyp=2080 OR inserted.PDT_GIDTyp=2096 OR inserted.PDT_GIDTyp=2112 OR          inserted.PDT_GIDTyp=2128 OR inserted.PDT_GIDTyp=2144)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtHistNag ON
                    inserted.PDT_GIDTyp = CDN.SrtHistNag.SHN_GIDTyp
                AND inserted.PDT_GIDNumer = CDN.SrtHistNag.SHN_GIDNumer
              WHERE CDN.SrtHistNag.SHN_GIDNumer IS NULL AND (inserted.PDT_GIDTyp=2048 OR inserted.PDT_GIDTyp=2064  OR           inserted.PDT_GIDTyp=2080 OR inserted.PDT_GIDTyp=2096 OR inserted.PDT_GIDTyp=2112 OR          inserted.PDT_GIDTyp=2128 OR inserted.PDT_GIDTyp=2144)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtHistNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDT_GIDTyp )  OR UPDATE( PDT_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDT_GIDTyp  IN(1489,1497,2001,2009,1520,1528,1521,1529,2033,2041,2034,2042,2035,2043,2039,2047,1616,1617,1936,1937,2008,2010))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.PDT_GIDTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.PDT_GIDNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.PDT_GIDTyp  IN(1489,1497,2001,2009,1520,1528,1521,1529,2033,2041,2034,2042,2035,2043,2039,2047,1616,1617,1936,1937,2008,2010))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [Predekrety_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Preliminarz_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Preliminarz_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Preliminarz_DeleteHandler
  ON CDN.Preliminarz
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PRL_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=12300 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PRL_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=12300 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.PRL_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp IN(7684,7690))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.PRL_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp IN(7684,7690))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrjStruktura_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrjStruktura_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PrjStruktura_DeleteHandler
  ON CDN.PrjStruktura
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.PRJ_Id = CDN.UmwNag.UmN_PrjId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie projektu nie jest możliwe. Projekt jest powiązany z dokumentem./# [PrjStruktura_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.PRJ_Id = CDN.ZamNag.ZaN_PrjId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie projektu nie jest możliwe. Projekt jest powiązany z dokumentem./# [PrjStruktura_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.PRJ_Id = CDN.TraNag.TrN_PrjId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [PrjStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologia
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologia JOIN deleted
          ON
                deleted.PRJ_Id = CDN.ProdTechnologia.PTE_PrjId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologia) [PrjStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecenia JOIN deleted
          ON
                deleted.PRJ_Id = CDN.ProdZlecenia.PZL_Projekt
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZlecenia) [PrjStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjNag
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjNag JOIN deleted
          ON
                deleted.PRJ_Id = CDN.BudzetPrjNag.BPN_PrjId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie projektu nie jest możliwe. Projekt jest powiązany z budżetem./# [PrjStruktura_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjElem
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjElem JOIN deleted
          ON
                deleted.PRJ_Id = CDN.BudzetPrjElem.BPE_PrjID
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie projektu nie jest możliwe. Projekt jest powiązany z budżetem./# [PrjStruktura_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwPlanPrzegladu
    IF EXISTS
       ( SELECT * FROM CDN.SrwPlanPrzegladu JOIN deleted
          ON
                deleted.PRJ_Id = CDN.SrwPlanPrzegladu.SPP_PrjId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie projektu nie jest możliwe. Projekt jest powiązany z dokumentem./# [PrjStruktura_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.PRJ_Id = CDN.SrwZlcNag.SZN_PrjId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie projektu nie jest możliwe. Projekt jest powiązany z dokumentem./# [PrjStruktura_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdNadzlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdNadzlecenia JOIN deleted
          ON
                deleted.PRJ_Id = CDN.ProdNadzlecenia.PNZ_Projekt
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdNadzlecenia) [PrjStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.PRJ_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (4592,-4592))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.PRJ_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (4592,-4592))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PRJ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp= -4592 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PRJ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp= -4592 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PRJ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp= -4592 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PRJ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp= -4592 and CDN.AtrybutyHist.Ath_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrjStruktura_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrjStruktura_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PrjStruktura_InsertUpdateHandler
  ON CDN.PrjStruktura
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PRJ_KntNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PRJ_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PRJ_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PrjStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PRJ_KndNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PRJ_KndNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PRJ_KndNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PrjStruktura_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRLNOPRIMARY"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRLNOPRIMARY */</I><BR>
ALTER TABLE CDN.PrlnOpisy ADD CONSTRAINT FK_PRLNOPRIMARY
 FOREIGN KEY
   (
                          PrlnO_PrlnID                        
                         )
             REFERENCES CDN.ProlongNag
                         (
                          PRLN_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrmHistoria_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrmHistoria_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PrmHistoria_InsertUpdateHandler
  ON CDN.PrmHistoria
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PrH_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRH_GIDTyp = 4702 and inserted.PRH_GIDLp&lt;&gt;-1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.PrH_GIDNumer = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL AND (inserted.PRH_GIDTyp = 4702 and inserted.PRH_GIDLp&lt;&gt;-1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [PrmHistoria_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrH_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRH_GIDTyp = 4703 and inserted.PRH_GIDLp&lt;&gt;-1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcSkladniki ON
                    inserted.PrH_GIDNumer = CDN.SrwZlcSkladniki.SZS_Id
              WHERE CDN.SrwZlcSkladniki.SZS_Id IS NULL AND (inserted.PRH_GIDTyp = 4703 and inserted.PRH_GIDLp&lt;&gt;-1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcSkladniki) [PrmHistoria_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrH_IDPrm ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRH_IDPrm&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrmKarty ON
                    inserted.PrH_IDPrm = CDN.PrmKarty.PRM_Id
              WHERE CDN.PrmKarty.PRM_Id IS NULL AND (inserted.PRH_IDPrm&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrmKarty) [PrmHistoria_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrH_GIDTyp )  OR UPDATE( PrH_GIDNumer )  OR UPDATE( PrH_GIDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRH_GIDTyp not in (960,4702,4703,4803) and inserted.PRH_GIDLp&lt;&gt;-1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.PrH_GIDTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.PrH_GIDNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.PrH_GIDLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.PRH_GIDTyp not in (960,4702,4703,4803) and inserted.PRH_GIDLp&lt;&gt;-1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [PrmHistoria_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrH_GIDTyp )  OR UPDATE( PrH_GIDNumer )  OR UPDATE( PrH_GIDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRH_GIDTyp=960 and inserted.PRH_GIDLp&lt;&gt;-1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.PrH_GIDTyp = CDN.ZamElem.ZaE_GIDTyp
                AND inserted.PrH_GIDNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.PrH_GIDLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.PRH_GIDTyp=960 and inserted.PRH_GIDLp&lt;&gt;-1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [PrmHistoria_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrH_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRH_GIDTyp = 4803 and inserted.PRH_GIDLp&lt;&gt;-1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwPozycje ON
                    inserted.PrH_GIDNumer = CDN.UmwPozycje.UmP_Id
              WHERE CDN.UmwPozycje.UmP_Id IS NULL AND (inserted.PRH_GIDTyp = 4803 and inserted.PRH_GIDLp&lt;&gt;-1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwPozycje) [PrmHistoria_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrmKarty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrmKarty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PrmKarty_DeleteHandler
  ON CDN.PrmKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraElem
    IF EXISTS
       ( SELECT * FROM CDN.TraElem JOIN deleted
          ON
                deleted.PRM_Id = CDN.TraElem.TrE_PakietId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraElem) [PrmKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PrmHistoria
    IF EXISTS
       ( SELECT * FROM CDN.PrmHistoria JOIN deleted
          ON
                deleted.PRM_Id = CDN.PrmHistoria.PrH_IDPrm
       AND (CDN.PrmHistoria.PRH_IDPrm&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PrmHistoria) [PrmKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrmTransakcje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrmTransakcje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PrmTransakcje_InsertUpdateHandler
  ON CDN.PrmTransakcje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PrT_KntNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PrT_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PrT_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [PrmTransakcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrT_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PrT_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PrT_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [PrmTransakcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PrT_DokTyp )  OR UPDATE( PrT_DokNumer )  OR UPDATE( PrT_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PrT_DokTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2000,2008,1521,1529,1489,1497,1520,1528,2002,2010,1490,1498))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.PrT_DokTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.PrT_DokNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.PrT_DokLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.PrT_DokTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2000,2008,1521,1529,1489,1497,1520,1528,2002,2010,1490,1498))
                AND (
                          IsNull(inserted.PrT_DokTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.PrT_DokNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.PrT_DokLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [PrmTransakcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdCzynnosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdCzynnosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdCzynnosci_DeleteHandler
  ON CDN.ProdCzynnosci
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagSElem
    IF EXISTS
       ( SELECT * FROM CDN.MagSElem JOIN deleted
          ON
                deleted.PCZ_Id = CDN.MagSElem.MaS_ZlcNumer
            
       AND (CDN.MagSElem.MaS_ZLCTYP = 14345)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć. Z planu zlecenia wygenerowano dokumenty magazynowe (WM/PM)./# [ProdCzynnosci_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraSElem
    IF EXISTS
       ( SELECT * FROM CDN.TraSElem JOIN deleted
          ON
                deleted.PCZ_Id = CDN.TraSElem.TrS_ZlcNumer
            
       AND (CDN.TraSElem.TRS_ZLCTYP = 14345)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć. Z planu zlecenia wygenerowano dokumenty handlowe (RW/PW)./# [ProdCzynnosci_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdCzynnosciMaterialy
    IF EXISTS(SELECT * FROM CDN.ProdCzynnosciMaterialy JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.ProdCzynnosciMaterialy.PCM_PCZId
            )
        DELETE CDN.ProdCzynnosciMaterialy
        FROM CDN.ProdCzynnosciMaterialy JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.ProdCzynnosciMaterialy.PCM_PCZId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanySkladnikiObciazenia
    IF EXISTS(SELECT * FROM CDN.PlanySkladnikiObciazenia JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.PlanySkladnikiObciazenia.PSO_ObiNumer
      AND (CDN.PlanySkladnikiObciazenia.PSO_ObiTyp=14345)
            )
        DELETE CDN.PlanySkladnikiObciazenia
        FROM CDN.PlanySkladnikiObciazenia JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.PlanySkladnikiObciazenia.PSO_ObiNumer
      AND (CDN.PlanySkladnikiObciazenia.PSO_ObiTyp=14345)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdOperacjePowiazane
    IF EXISTS(SELECT * FROM CDN.ProdOperacjePowiazane JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.ProdOperacjePowiazane.POP_PczId
            )
        DELETE CDN.ProdOperacjePowiazane
        FROM CDN.ProdOperacjePowiazane JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.ProdOperacjePowiazane.POP_PczId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=14345)
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=14345)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.ZamZamLinki.ZZL_ZSGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZSGIDTyp=14345)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.ZamZamLinki.ZZL_ZSGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZSGIDTyp=14345)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14345)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14345)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14345 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14345 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14345 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14345 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElemO
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElemO JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_OBITyp=14345)
            )
        DELETE CDN.ProdKosztyElemO
        FROM CDN.ProdKosztyElemO JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_OBITyp=14345)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdOperacjePominiete
    IF EXISTS(SELECT * FROM CDN.ProdOperacjePominiete JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.ProdOperacjePominiete.POPP_PCZId
            )
        DELETE CDN.ProdOperacjePominiete
        FROM CDN.ProdOperacjePominiete JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.ProdOperacjePominiete.POPP_PCZId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Rezerwacje
    IF EXISTS(SELECT * FROM CDN.Rezerwacje JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=14345)
            )
        DELETE CDN.Rezerwacje
        FROM CDN.Rezerwacje JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=14345)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdOperacjeMagazyny
    IF EXISTS(SELECT * FROM CDN.ProdOperacjeMagazyny JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.ProdOperacjeMagazyny.POM_PCZId
            )
        DELETE CDN.ProdOperacjeMagazyny
        FROM CDN.ProdOperacjeMagazyny JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.ProdOperacjeMagazyny.POM_PCZId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdCzynnosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdCzynnosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdCzynnosci_InsertUpdateHandler
  ON CDN.ProdCzynnosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PCZ_Oddzial ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PCZ_Oddzial = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PCZ_Oddzial,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PCZ_Proces ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdProcesy ON
                    inserted.PCZ_Proces = CDN.ProdProcesy.PPC_Id
              WHERE CDN.ProdProcesy.PPC_Id IS NULL
                AND (
                          IsNull(inserted.PCZ_Proces,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdProcesy) [ProdCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PCZ_TechnologiaCzynnosc ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaCzynnosci ON
                    inserted.PCZ_TechnologiaCzynnosc = CDN.ProdTechnologiaCzynnosci.PTC_Id
              WHERE CDN.ProdTechnologiaCzynnosci.PTC_Id IS NULL
                AND (
                          IsNull(inserted.PCZ_TechnologiaCzynnosc,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaCzynnosci) [ProdCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PCZ_Stan ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PCZ_Stan&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PCZ_Stan = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.PCZ_Stan&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdCzynnosciAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdCzynnosciAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdCzynnosciAlias1_DeleteHandler
  ON CDN.ProdCzynnosci
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdOperacjePowiazane
    IF EXISTS(SELECT * FROM CDN.ProdOperacjePowiazane JOIN deleted
            ON 
          deleted.PCZ_Id = CDN.ProdOperacjePowiazane.POP_PrzedPczId
            )
        DELETE CDN.ProdOperacjePowiazane
        FROM CDN.ProdOperacjePowiazane JOIN deleted
        ON 
          deleted.PCZ_Id = CDN.ProdOperacjePowiazane.POP_PrzedPczId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdCzynnosciMaterialy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdCzynnosciMaterialy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdCzynnosciMaterialy_InsertUpdateHandler
  ON CDN.ProdCzynnosciMaterialy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PCM_PCZId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.PCM_PCZId = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL
                AND (
                          IsNull(inserted.PCM_PCZId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [ProdCzynnosciMaterialy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PCOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PCOPrimary */</I><BR>
ALTER TABLE CDN.ProdCzynnosciObiekty ADD CONSTRAINT FK_PCOPrimary
 FOREIGN KEY
   (
                          PCO_Czynnosc                      
                         )
             REFERENCES CDN.ProdCzynnosci
                         (
                          PCZ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdCzynnosciObiekty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdCzynnosciObiekty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdCzynnosciObiekty_DeleteHandler
  ON CDN.ProdCzynnosciObiekty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.PCO_Id = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=14337)
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.PCO_Id = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=14337)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElemO
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElemO JOIN deleted
            ON 
          deleted.PCO_Id = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_OBITyp=14337)
            )
        DELETE CDN.ProdKosztyElemO
        FROM CDN.ProdKosztyElemO JOIN deleted
        ON 
          deleted.PCO_Id = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_OBITyp=14337)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdCzynnosciObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdCzynnosciObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdCzynnosciObiekty_InsertUpdateHandler
  ON CDN.ProdCzynnosciObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PCO_Czynnosc )  OR UPDATE( PCO_Termin ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PCO_Termin&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosciTerminy ON
                    inserted.PCO_Czynnosc = CDN.ProdCzynnosciTerminy.PCT_Czynnosc
                AND inserted.PCO_Termin = CDN.ProdCzynnosciTerminy.PCT_Id
              WHERE CDN.ProdCzynnosciTerminy.PCT_Id IS NULL AND (inserted.PCO_Termin&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosciTerminy) [ProdCzynnosciObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PCO_Obiekt ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.PCO_Obiekt = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL
                AND (
                          IsNull(inserted.PCO_Obiekt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [ProdCzynnosciObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PCO_Funkcja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdFunkcje ON
                    inserted.PCO_Funkcja = CDN.ProdFunkcje.PFU_Id
              WHERE CDN.ProdFunkcje.PFU_Id IS NULL
                AND (
                          IsNull(inserted.PCO_Funkcja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdFunkcje) [ProdCzynnosciObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PCTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PCTPrimary */</I><BR>
ALTER TABLE CDN.ProdCzynnosciTerminy ADD CONSTRAINT FK_PCTPrimary
 FOREIGN KEY
   (
                          PCT_Czynnosc                      
                         )
             REFERENCES CDN.ProdCzynnosci
                         (
                          PCZ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdCzynnosciTerminy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdCzynnosciTerminy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdCzynnosciTerminy_DeleteHandler
  ON CDN.ProdCzynnosciTerminy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zadania
    IF EXISTS(SELECT * FROM CDN.Zadania JOIN deleted
            ON 
          deleted.PCT_Id = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=14345 AND CDN.Zadania.ZAD_ZrdLP=0)
            )
        DELETE CDN.Zadania
        FROM CDN.Zadania JOIN deleted
        ON 
          deleted.PCT_Id = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=14345 AND CDN.Zadania.ZAD_ZrdLP=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdCzynnosciObiekty
    IF EXISTS(SELECT * FROM CDN.ProdCzynnosciObiekty JOIN deleted
            ON 
          deleted.PCT_Czynnosc = CDN.ProdCzynnosciObiekty.PCO_Czynnosc
      AND deleted.PCT_Id = CDN.ProdCzynnosciObiekty.PCO_Termin
      AND (CDN.ProdCzynnosciObiekty.PCO_Termin&lt;&gt;0)
            )
        DELETE CDN.ProdCzynnosciObiekty
        FROM CDN.ProdCzynnosciObiekty JOIN deleted
        ON 
          deleted.PCT_Czynnosc = CDN.ProdCzynnosciObiekty.PCO_Czynnosc
      AND deleted.PCT_Id = CDN.ProdCzynnosciObiekty.PCO_Termin
      AND (CDN.ProdCzynnosciObiekty.PCO_Termin&lt;&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdDoPrzeliczenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdDoPrzeliczenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdDoPrzeliczenia_InsertUpdateHandler
  ON CDN.ProdDoPrzeliczenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PDL_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDL_GIDTyp = 14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.PDL_GIDNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.PDL_GIDTyp = 14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [ProdDoPrzeliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PDL_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PDL_GIDTyp = 4192)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcNag ON
                    inserted.PDL_GIDNumer = CDN.ZlcNag.ZcN_GIDNumer
              WHERE CDN.ZlcNag.ZcN_GIDNumer IS NULL AND (inserted.PDL_GIDTyp = 4192)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcNag) [ProdDoPrzeliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdFunkcje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdFunkcje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdFunkcje_DeleteHandler
  ON CDN.ProdFunkcje
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanyElementySkladnikow
    IF EXISTS
       ( SELECT * FROM CDN.PlanyElementySkladnikow JOIN deleted
          ON
                deleted.PFU_Id = CDN.PlanyElementySkladnikow.PGS_PFuId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlanyElementySkladnikow) [ProdFunkcje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.PFU_Id = CDN.OsoUmowy.OsU_Funkcja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoUmowy) [ProdFunkcje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdCzynnosciObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdCzynnosciObiekty JOIN deleted
          ON
                deleted.PFU_Id = CDN.ProdCzynnosciObiekty.PCO_Funkcja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdCzynnosciObiekty) [ProdFunkcje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaFunkcje
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaFunkcje JOIN deleted
          ON
                deleted.PFU_Id = CDN.ProdTechnologiaFunkcje.PTF_Funkcja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologiaFunkcje) [ProdFunkcje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiektyDoPlanu
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiektyDoPlanu JOIN deleted
          ON
                deleted.PFU_Id = CDN.ProdObiektyDoPlanu.POPL_PFUId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiektyDoPlanu) [ProdFunkcje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PFU_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14504 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PFU_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14504 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdObiektyFunkcje
    IF EXISTS(SELECT * FROM CDN.ProdObiektyFunkcje JOIN deleted
            ON 
          deleted.PFU_Id = CDN.ProdObiektyFunkcje.POF_Funkcja
            )
        DELETE CDN.ProdObiektyFunkcje
        FROM CDN.ProdObiektyFunkcje JOIN deleted
        ON 
          deleted.PFU_Id = CDN.ProdObiektyFunkcje.POF_Funkcja
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdIoTAkcje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdIoTAkcje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdIoTAkcje_DeleteHandler
  ON CDN.ProdIoTAkcje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdIoTAkcjeZdarzenia
    IF EXISTS(SELECT * FROM CDN.ProdIoTAkcjeZdarzenia JOIN deleted
            ON 
          deleted.PIAK_Id = CDN.ProdIoTAkcjeZdarzenia.PIAZ_AkcjaNumer
      AND (CDN.ProdIoTAkcjeZdarzenia.PIAZ_AkcjaTyp=14391)
            )
        DELETE CDN.ProdIoTAkcjeZdarzenia
        FROM CDN.ProdIoTAkcjeZdarzenia JOIN deleted
        ON 
          deleted.PIAK_Id = CDN.ProdIoTAkcjeZdarzenia.PIAZ_AkcjaNumer
      AND (CDN.ProdIoTAkcjeZdarzenia.PIAZ_AkcjaTyp=14391)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdIoTAkcjeZdarzenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdIoTAkcjeZdarzenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdIoTAkcjeZdarzenia_InsertUpdateHandler
  ON CDN.ProdIoTAkcjeZdarzenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PIAZ_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PIAZ_ObiTyp=14392)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdIoTZdarzeniaDefinicje ON
                    inserted.PIAZ_ObiNumer = CDN.ProdIoTZdarzeniaDefinicje.PCZZD_Id
              WHERE CDN.ProdIoTZdarzeniaDefinicje.PCZZD_Id IS NULL AND (inserted.PIAZ_ObiTyp=14392)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdIoTZdarzeniaDefinicje) [ProdIoTAkcjeZdarzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PIAZ_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PIAZ_ObiTyp=14393)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdIoTZdarzenia ON
                    inserted.PIAZ_ObiNumer = CDN.ProdIoTZdarzenia.PCZZ_Id
              WHERE CDN.ProdIoTZdarzenia.PCZZ_Id IS NULL AND (inserted.PIAZ_ObiTyp=14393)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdIoTZdarzenia) [ProdIoTAkcjeZdarzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PIAZ_AkcjaNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PIAZ_AkcjaTyp=14391)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdIoTAkcje ON
                    inserted.PIAZ_AkcjaNumer = CDN.ProdIoTAkcje.PIAK_Id
              WHERE CDN.ProdIoTAkcje.PIAK_Id IS NULL AND (inserted.PIAZ_AkcjaTyp=14391)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdIoTAkcje) [ProdIoTAkcjeZdarzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PIAZ_AkcjaNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PIAZ_AkcjaTyp=12288)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefProcesy ON
                    inserted.PIAZ_AkcjaNumer = CDN.WF_DefProcesy.WDP_ID
              WHERE CDN.WF_DefProcesy.WDP_ID IS NULL AND (inserted.PIAZ_AkcjaTyp=12288)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefProcesy) [ProdIoTAkcjeZdarzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PIKZDefZdarzenia"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PIKZDefZdarzenia */</I><BR>
ALTER TABLE CDN.ProdIoTKomunikatyZdarzenia ADD CONSTRAINT FK_PIKZDefZdarzenia
 FOREIGN KEY
   (
                          PIKZ_DefZdarzeniaId                
                         )
             REFERENCES CDN.ProdIoTZdarzeniaDefinicje
                         (
                          PCZZD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PIKZKomunikatIoT"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PIKZKomunikatIoT */</I><BR>
ALTER TABLE CDN.ProdIoTKomunikatyZdarzenia ADD CONSTRAINT FK_PIKZKomunikatIoT
 FOREIGN KEY
   (
                          PIKZ_KomunikatIoTId                
                         )
             REFERENCES CDN.ProdIoTKomunikaty
                         (
                          PIKO_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PIOKDefZdarzenia"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PIOKDefZdarzenia */</I><BR>
ALTER TABLE CDN.ProdIoTOdbiorcyPowiadomien ADD CONSTRAINT FK_PIOKDefZdarzenia
 FOREIGN KEY
   (
                          PIOK_DefZdarzeniaId                
                         )
             REFERENCES CDN.ProdIoTZdarzeniaDefinicje
                         (
                          PCZZD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdIoTOdbiorcyPowiadomien_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdIoTOdbiorcyPowiadomien_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdIoTOdbiorcyPowiadomien_InsertUpdateHandler
  ON CDN.ProdIoTOdbiorcyPowiadomien
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PIOK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PIOK_ObiTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PIOK_ObiNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.PIOK_ObiTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdIoTOdbiorcyPowiadomien_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PIOK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PIOK_ObiTyp=-4272)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PIOK_ObiNumer = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL AND (inserted.PIOK_ObiTyp=-4272)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdIoTOdbiorcyPowiadomien_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PIRDDefZdarzenia"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PIRDDefZdarzenia */</I><BR>
ALTER TABLE CDN.ProdIoTRegulyDefinicji ADD CONSTRAINT FK_PIRDDefZdarzenia
 FOREIGN KEY
   (
                          PIRD_DefZdarzeniaId                
                         )
             REFERENCES CDN.ProdIoTZdarzeniaDefinicje
                         (
                          PCZZD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PCZZCzujnik"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PCZZCzujnik */</I><BR>
ALTER TABLE CDN.ProdIoTZdarzenia ADD CONSTRAINT FK_PCZZCzujnik
 FOREIGN KEY
   (
                          PCZZ_PCZUId                        
                         )
             REFERENCES CDN.ProdIoTCzujniki
                         (
                          PCZU_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PCZZDefZdarzenia"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PCZZDefZdarzenia */</I><BR>
ALTER TABLE CDN.ProdIoTZdarzenia ADD CONSTRAINT FK_PCZZDefZdarzenia
 FOREIGN KEY
   (
                          PCZZ_DefZdarzeniaId                
                         )
             REFERENCES CDN.ProdIoTZdarzeniaDefinicje
                         (
                          PCZZD_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdIoTZdarzenia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdIoTZdarzenia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdIoTZdarzenia_DeleteHandler
  ON CDN.ProdIoTZdarzenia
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdIoTAkcjeZdarzenia
    IF EXISTS(SELECT * FROM CDN.ProdIoTAkcjeZdarzenia JOIN deleted
            ON 
          deleted.PCZZ_Id = CDN.ProdIoTAkcjeZdarzenia.PIAZ_ObiNumer
      AND (CDN.ProdIoTAkcjeZdarzenia.PIAZ_ObiTyp=14393)
            )
        DELETE CDN.ProdIoTAkcjeZdarzenia
        FROM CDN.ProdIoTAkcjeZdarzenia JOIN deleted
        ON 
          deleted.PCZZ_Id = CDN.ProdIoTAkcjeZdarzenia.PIAZ_ObiNumer
      AND (CDN.ProdIoTAkcjeZdarzenia.PIAZ_ObiTyp=14393)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdIoTZdarzeniaDefinicje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdIoTZdarzeniaDefinicje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdIoTZdarzeniaDefinicje_DeleteHandler
  ON CDN.ProdIoTZdarzeniaDefinicje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdIoTAkcjeZdarzenia
    IF EXISTS(SELECT * FROM CDN.ProdIoTAkcjeZdarzenia JOIN deleted
            ON 
          deleted.PCZZD_Id = CDN.ProdIoTAkcjeZdarzenia.PIAZ_ObiNumer
      AND (CDN.ProdIoTAkcjeZdarzenia.PIAZ_ObiTyp=14392)
            )
        DELETE CDN.ProdIoTAkcjeZdarzenia
        FROM CDN.ProdIoTAkcjeZdarzenia JOIN deleted
        ON 
          deleted.PCZZD_Id = CDN.ProdIoTAkcjeZdarzenia.PIAZ_ObiNumer
      AND (CDN.ProdIoTAkcjeZdarzenia.PIAZ_ObiTyp=14392)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdKalendarze_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdKalendarze_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdKalendarze_DeleteHandler
  ON CDN.ProdKalendarze
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUmowy
    IF EXISTS
       ( SELECT * FROM CDN.OsoUmowy JOIN deleted
          ON
                deleted.PKA_Id = CDN.OsoUmowy.OsU_Harmonogram
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kalendarza, jest powiązany umową./# [ProdKalendarze_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PrcKarty
    IF EXISTS
       ( SELECT * FROM CDN.PrcKarty JOIN deleted
          ON
                deleted.PKA_Id = CDN.PrcKarty.Prc_PKAId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kalendarza, jest powiązany z kartą pracownika./# [ProdKalendarze_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiekty JOIN deleted
          ON
                deleted.PKA_Id = CDN.ProdObiekty.POB_Kalendarz
            
       AND (CDN.ProdObiekty.POB_Kalendarz&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć kalendarza, jest powiązany z zasobem./# [ProdKalendarze_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdOkresy
    IF EXISTS(SELECT * FROM CDN.ProdOkresy JOIN deleted
            ON 
          deleted.PKA_Id = CDN.ProdOkresy.POK_ObiNumer
      AND (CDN.ProdOkresy.POK_ObiTyp=14339)
            )
        DELETE CDN.ProdOkresy
        FROM CDN.ProdOkresy JOIN deleted
        ON 
          deleted.PKA_Id = CDN.ProdOkresy.POK_ObiNumer
      AND (CDN.ProdOkresy.POK_ObiTyp=14339)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKKTechnologia"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKKTechnologia */</I><BR>
ALTER TABLE CDN.ProdKalkulacjaKosztu ADD CONSTRAINT FK_PKKTechnologia
 FOREIGN KEY
   (
                          PKK_Technologia                   
                         )
             REFERENCES CDN.ProdTechnologia
                         (
                          PTE_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdKalkulacjaKosztu_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdKalkulacjaKosztu_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdKalkulacjaKosztu_InsertUpdateHandler
  ON CDN.ProdKalkulacjaKosztu
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PKK_ObiNumer )  OR UPDATE( PKK_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKK_ObiTyp=960 AND inserted.PKK_ObiLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.PKK_ObiNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.PKK_ObiLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.PKK_ObiTyp=960 AND inserted.PKK_ObiLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [ProdKalkulacjaKosztu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKK_ObiTyp=14348)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecElem ON
                    inserted.PKK_ObiNumer = CDN.ProdZlecElem.PZE_Id
              WHERE CDN.ProdZlecElem.PZE_Id IS NULL AND (inserted.PKK_ObiTyp=14348)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecElem) [ProdKalkulacjaKosztu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKK_ObiTyp IN(14344,14353))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdProcesy ON
                    inserted.PKK_ObiNumer = CDN.ProdProcesy.PPC_Id
              WHERE CDN.ProdProcesy.PPC_Id IS NULL AND (inserted.PKK_ObiTyp IN(14344,14353))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdProcesy) [ProdKalkulacjaKosztu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKSKalkulacja"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKSKalkulacja */</I><BR>
ALTER TABLE CDN.ProdKalkulacjaKosztuElem ADD CONSTRAINT FK_PKSKalkulacja
 FOREIGN KEY
   (
                          PKS_PKK                           
                         )
             REFERENCES CDN.ProdKalkulacjaKosztu
                         (
                          PKK_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdKoszty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdKoszty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdKoszty_InsertUpdateHandler
  ON CDN.ProdKoszty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PKO_Kategoria ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKO_Kategoria&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PKO_Kategoria = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.PKO_Kategoria&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKO_PWKId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKO_PWKId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdWzorceKosztow ON
                    inserted.PKO_PWKId = CDN.ProdWzorceKosztow.PWK_Id
              WHERE CDN.ProdWzorceKosztow.PWK_Id IS NULL AND (inserted.PKO_PWKId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdWzorceKosztow) [ProdKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKE_Primary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKE_Primary */</I><BR>
ALTER TABLE CDN.ProdKosztyElem ADD CONSTRAINT FK_PKE_Primary
 FOREIGN KEY
   (
                          PKE_PKOId                         
                         )
             REFERENCES CDN.ProdKoszty
                         (
                          PKO_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdKosztyElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdKosztyElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdKosztyElem_InsertUpdateHandler
  ON CDN.ProdKosztyElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.PKE_OBITyp in (3344,3352))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.PKE_ObiNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (  inserted.PKE_OBITyp in (3344,3352))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKE_ObiTyp=14346)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.PKE_ObiNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.PKE_ObiTyp=14346)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKE_OBITyp=432)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Dziennik ON
                    inserted.PKE_ObiNumer = CDN.Dziennik.DZK_GIDNumer
              WHERE CDN.Dziennik.DZK_GIDNumer IS NULL AND (inserted.PKE_OBITyp=432)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Dziennik) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKE_OBITyp=14343 or inserted.PKE_OBITyp=4592)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.PKE_ObiNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.PKE_OBITyp=14343 or inserted.PKE_OBITyp=4592)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKE_OBITyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosciObiekty ON
                    inserted.PKE_ObiNumer = CDN.ProdCzynnosciObiekty.PCO_Id
              WHERE CDN.ProdCzynnosciObiekty.PCO_Id IS NULL AND (inserted.PKE_OBITyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosciObiekty) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKE_OBITyp=14345)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.PKE_ObiNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.PKE_OBITyp=14345)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKE_OBITyp=448 or inserted.PKE_OBITyp=2896)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konta ON
                    inserted.PKE_ObiNumer = CDN.Konta.KKS_GIDNumer
              WHERE CDN.Konta.KKS_GIDNumer IS NULL AND (inserted.PKE_OBITyp=448 or inserted.PKE_OBITyp=2896)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konta) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKE_ObiTyp )  OR UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.PKE_OBITyp in ( 1521,1529,1497,1489,1520,1528,1490,1498,1616,1624))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.PKE_ObiTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.PKE_ObiNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (  inserted.PKE_OBITyp in ( 1521,1529,1497,1489,1520,1528,1490,1498,1616,1624))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKE_ObiTyp=14344)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdProcesy ON
                    inserted.PKE_ObiNumer = CDN.ProdProcesy.PPC_Id
              WHERE CDN.ProdProcesy.PPC_Id IS NULL AND (inserted.PKE_ObiTyp=14344)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdProcesy) [ProdKosztyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKEOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKEOPrimary */</I><BR>
ALTER TABLE CDN.ProdKosztyElemO ADD CONSTRAINT FK_PKEOPrimary
 FOREIGN KEY
   (
                          PKEO_PKOId                         
                         )
             REFERENCES CDN.ProdKoszty
                         (
                          PKO_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdKosztyElemO_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdKosztyElemO_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdKosztyElemO_InsertUpdateHandler
  ON CDN.ProdKosztyElemO
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PKEO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKEO_OBITyp=14343 or inserted.PKEO_OBITyp=4592)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.PKEO_ObiNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.PKEO_OBITyp=14343 or inserted.PKEO_OBITyp=4592)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [ProdKosztyElemO_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKEO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKEO_ObiTyp=14344)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdProcesy ON
                    inserted.PKEO_ObiNumer = CDN.ProdProcesy.PPC_Id
              WHERE CDN.ProdProcesy.PPC_Id IS NULL AND (inserted.PKEO_ObiTyp=14344)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdProcesy) [ProdKosztyElemO_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKEO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKEO_OBITyp=14345)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.PKEO_ObiNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.PKEO_OBITyp=14345)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [ProdKosztyElemO_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKEO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKEO_OBITyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosciObiekty ON
                    inserted.PKEO_ObiNumer = CDN.ProdCzynnosciObiekty.PCO_Id
              WHERE CDN.ProdCzynnosciObiekty.PCO_Id IS NULL AND (inserted.PKEO_OBITyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosciObiekty) [ProdKosztyElemO_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKEO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKEO_ObiTyp=14346)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.PKEO_ObiNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.PKEO_ObiTyp=14346)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [ProdKosztyElemO_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KOPPKOId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KOPPKOId */</I><BR>
ALTER TABLE CDN.ProdKosztyParametry ADD CONSTRAINT FK_KOPPKOId
 FOREIGN KEY
   (
                          KOP_PKOId                         
                         )
             REFERENCES CDN.ProdKoszty
                         (
                          PKO_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdKosztyParametry_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdKosztyParametry_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdKosztyParametry_InsertUpdateHandler
  ON CDN.ProdKosztyParametry
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KOP_SlpId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KOP_SlpId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SlwKosztyParametry ON
                    inserted.KOP_SlpId = CDN.SlwKosztyParametry.SLP_Id
              WHERE CDN.SlwKosztyParametry.SLP_Id IS NULL AND (inserted.KOP_SlpId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SlwKosztyParametry) [ProdKosztyParametry_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PLKPZEId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PLKPZEId */</I><BR>
ALTER TABLE CDN.ProdLinki ADD CONSTRAINT FK_PLKPZEId
 FOREIGN KEY
   (
                          PLK_PZEId                         
                         )
             REFERENCES CDN.ProdZlecElem
                         (
                          PZE_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdLinki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdLinki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdLinki_InsertUpdateHandler
  ON CDN.ProdLinki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PLK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PLK_ObiTyp=14346)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.PLK_ObiNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.PLK_ObiTyp=14346)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [ProdLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PLK_ObiTyp )  OR UPDATE( PLK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PLK_ObiTyp=2592)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rezerwacje ON
                    inserted.PLK_ObiTyp = CDN.Rezerwacje.Rez_GIDTyp
                AND inserted.PLK_ObiNumer = CDN.Rezerwacje.Rez_GIDNumer
              WHERE CDN.Rezerwacje.Rez_GIDNumer IS NULL AND (inserted.PLK_ObiTyp=2592)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rezerwacje) [ProdLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdNadzlecenia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdNadzlecenia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdNadzlecenia_DeleteHandler
  ON CDN.ProdNadzlecenia
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PNZ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14368 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PNZ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14368 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PNZ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14368 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PNZ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14368 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PNZ_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14348)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PNZ_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14348)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdNadzlecenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdNadzlecenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdNadzlecenia_InsertUpdateHandler
  ON CDN.ProdNadzlecenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PNZ_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PNZ_KntTyp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PNZ_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PNZ_KntTyp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdNadzlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PNZ_KnDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PNZ_KnDTyp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PNZ_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PNZ_KnDTyp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdNadzlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PNZ_Projekt ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.PNZ_Projekt = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.PNZ_Projekt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [ProdNadzlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PNZ_Oddzial ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PNZ_Oddzial = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PNZ_Oddzial,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdNadzlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PNZ_OpWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PNZ_OpWNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PNZ_OpWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdNadzlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PNZ_Status ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PNZ_Status = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PNZ_Status,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdNadzlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PNLPZL"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PNLPZL */</I><BR>
ALTER TABLE CDN.ProdNadzleceniaLinki ADD CONSTRAINT FK_PNLPZL
 FOREIGN KEY
   (
                          PNL_PZLId                         
                         )
             REFERENCES CDN.ProdZlecenia
                         (
                          PZL_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PNLPNZ"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PNLPNZ */</I><BR>
ALTER TABLE CDN.ProdNadzleceniaLinki ADD CONSTRAINT FK_PNLPNZ
 FOREIGN KEY
   (
                          PNL_PNZId                         
                         )
             REFERENCES CDN.ProdNadzlecenia
                         (
                          PNZ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_NRCKeyNormatywId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_NRCKeyNormatywId */</I><BR>
ALTER TABLE CDN.ProdNormatywRealizacjaCzynnosci ADD CONSTRAINT FK_NRCKeyNormatywId
 FOREIGN KEY
   (
                          NRC_NormatywId                    
                         )
             REFERENCES CDN.ProdNormatywRealizacja
                         (
                          NRZ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_NRENRZ"></A><PRE>
          <FONT SIZE="2"><I>/* FK_NRENRZ */</I><BR>
ALTER TABLE CDN.ProdNormatywRealizacjaElem ADD CONSTRAINT FK_NRENRZ
 FOREIGN KEY
   (
                          NRE_NormatywId                    
                         )
             REFERENCES CDN.ProdNormatywRealizacja
                         (
                          NRZ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_NRONRZ"></A><PRE>
          <FONT SIZE="2"><I>/* FK_NRONRZ */</I><BR>
ALTER TABLE CDN.ProdNormatywRealizacjaOperElem ADD CONSTRAINT FK_NRONRZ
 FOREIGN KEY
   (
                          NRO_NormatywId                    
                         )
             REFERENCES CDN.ProdNormatywRealizacja
                         (
                          NRZ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_NZPNormatyw"></A><PRE>
          <FONT SIZE="2"><I>/* FK_NZPNormatyw */</I><BR>
ALTER TABLE CDN.ProdNormatywZlecenia ADD CONSTRAINT FK_NZPNormatyw
 FOREIGN KEY
   (
                          NZP_NormatywId                    
                         )
             REFERENCES CDN.ProdNormatywRealizacja
                         (
                          NRZ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdObiekty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdObiekty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdObiekty_DeleteHandler
  ON CDN.ProdObiekty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.POB_Id = CDN.SrwUrzadzenia.SrU_ObiNumer
            
       AND (CDN.SrwUrzadzenia.SrU_ObiTyp=14337)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Obiekt został przypisany do urządzenia serwisowanego. Nie może być usunięty./# [ProdObiekty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcObiekty
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcObiekty JOIN deleted
          ON
                deleted.POB_Id = CDN.SrwZlcObiekty.SZO_ObiNumer
            
       AND (CDN.SrwZlcObiekty.SZO_OBITyp=14337)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Obiekt został przypisany do zlecenia serwisowego. Nie może być usunięty./# [ProdObiekty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemElem
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemElem JOIN deleted
          ON
                deleted.POB_Id = CDN.ZlcRemElem.ZRE_TwrNumer
            
       AND (CDN.ZlcRemElem.ZrE_TwrTyp=14337)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Obiekt został przypisany do pozycji zlecenia serwisowego lub remontowego. Nie może być usunięty./# [ProdObiekty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNKartyPracyPrc
    IF EXISTS
       ( SELECT * FROM CDN.ZRNKartyPracyPrc JOIN deleted
          ON
                deleted.POB_Id = CDN.ZRNKartyPracyPrc.ZRP_PRCNumer
       AND (CDN.ZRNKartyPracyPrc.ZrP_PrcTyp=14337)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNKartyPracyPrc) [ProdObiekty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdCzynnosciObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdCzynnosciObiekty JOIN deleted
          ON
                deleted.POB_Id = CDN.ProdCzynnosciObiekty.PCO_Obiekt
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Obiekt został przypisany do czynności zlecenia produkcyjnego. Nie może być usunięty../# [ProdObiekty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.POB_Id = CDN.TraNag.TrN_KntNumer
       AND (CDN.TraNag.TrN_KntTyp=14337)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [ProdObiekty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklElem
    IF EXISTS
       ( SELECT * FROM CDN.ReklElem JOIN deleted
          ON
                deleted.POB_Id = CDN.ReklElem.RLE_POBId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ReklElem) [ProdObiekty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwObiektyReceptury
    IF EXISTS
       ( SELECT * FROM CDN.SrwObiektyReceptury JOIN deleted
          ON
                deleted.POB_Id = CDN.SrwObiektyReceptury.SOR_ObiNumer
       AND (CDN.SrwObiektyReceptury.SOR_ObiTyp=14337)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwObiektyReceptury) [ProdObiekty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiektyDoPlanu
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiektyDoPlanu JOIN deleted
          ON
                deleted.POB_Id = CDN.ProdObiektyDoPlanu.POPL_POBId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiektyDoPlanu) [ProdObiekty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdOkresy
    IF EXISTS(SELECT * FROM CDN.ProdOkresy JOIN deleted
            ON 
          deleted.POB_Id = CDN.ProdOkresy.POK_ObiNumer
      AND (CDN.ProdOkresy.POK_ObiTyp=14337)
            )
        DELETE CDN.ProdOkresy
        FROM CDN.ProdOkresy JOIN deleted
        ON 
          deleted.POB_Id = CDN.ProdOkresy.POK_ObiNumer
      AND (CDN.ProdOkresy.POK_ObiTyp=14337)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdObiektyFunkcje
    IF EXISTS(SELECT * FROM CDN.ProdObiektyFunkcje JOIN deleted
            ON 
          deleted.POB_Id = CDN.ProdObiektyFunkcje.POF_Obiekt
      AND (CDN.ProdObiektyFunkcje.POF_OBITyp=14337)
            )
        DELETE CDN.ProdObiektyFunkcje
        FROM CDN.ProdObiektyFunkcje JOIN deleted
        ON 
          deleted.POB_Id = CDN.ProdObiektyFunkcje.POF_Obiekt
      AND (CDN.ProdObiektyFunkcje.POF_OBITyp=14337)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.POB_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14337 and CDN.Atrybuty.Atr_OBINumer&gt;0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.POB_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14337 and CDN.Atrybuty.Atr_OBINumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.POB_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14337 and CDN.AtrybutyHist.Ath_OBINumer&gt;0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.POB_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14337 and CDN.AtrybutyHist.Ath_OBINumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.POB_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14337)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.POB_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14337)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdObiekty_InsertUpdateHandler
  ON CDN.ProdObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POB_Kalendarz ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POB_Kalendarz&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdKalendarze ON
                    inserted.POB_Kalendarz = CDN.ProdKalendarze.PKA_Id
              WHERE CDN.ProdKalendarze.PKA_Id IS NULL AND (inserted.POB_Kalendarz&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdKalendarze) [ProdObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POB_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POB_ObiTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.POB_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.POB_ObiTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POB_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POB_ObiTyp=368)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.POB_ObiNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL AND (inserted.POB_ObiTyp=368)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [ProdObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POB_ObiNumer )  OR UPDATE( POB_ObiTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POB_ObiTyp=-4272)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.POB_ObiNumer = CDN.FrmStruktura.FRS_GIDNumer
                AND inserted.POB_ObiTyp = CDN.FrmStruktura.FRS_GIDTyp
              WHERE CDN.FrmStruktura.FRS_GIDTyp IS NULL AND (inserted.POB_ObiTyp=-4272)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POB_ObiNumer )  OR UPDATE( POB_ObiTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POB_ObiTyp=-368)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtGrupy ON
                    inserted.POB_ObiNumer = CDN.SrtGrupy.SrG_GIDNumer
                AND inserted.POB_ObiTyp = CDN.SrtGrupy.SrG_GIDTyp
              WHERE CDN.SrtGrupy.SrG_GIDTyp IS NULL AND (inserted.POB_ObiTyp=-368)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtGrupy) [ProdObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POB_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POB_ObiTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.POB_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.POB_ObiTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ProdObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POB_Oddzial ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.POB_Oddzial = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.POB_Oddzial,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POB_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POB_ObiTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.POB_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.POB_ObiTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_POCCzujnik"></A><PRE>
          <FONT SIZE="2"><I>/* FK_POCCzujnik */</I><BR>
ALTER TABLE CDN.ProdObiektyCzujniki ADD CONSTRAINT FK_POCCzujnik
 FOREIGN KEY
   (
                          POC_PCZUId                        
                         )
             REFERENCES CDN.ProdIoTCzujniki
                         (
                          PCZU_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_POCObiekt"></A><PRE>
          <FONT SIZE="2"><I>/* FK_POCObiekt */</I><BR>
ALTER TABLE CDN.ProdObiektyCzujniki ADD CONSTRAINT FK_POCObiekt
 FOREIGN KEY
   (
                          POC_POBId                         
                         )
             REFERENCES CDN.ProdObiekty
                         (
                          POB_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_POPLPZLId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_POPLPZLId */</I><BR>
ALTER TABLE CDN.ProdObiektyDoPlanu ADD CONSTRAINT FK_POPLPZLId
 FOREIGN KEY
   (
                          POPL_PZLId                         
                         )
             REFERENCES CDN.ProdZlecenia
                         (
                          PZL_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_POPLPTCId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_POPLPTCId */</I><BR>
ALTER TABLE CDN.ProdObiektyDoPlanu ADD CONSTRAINT FK_POPLPTCId
 FOREIGN KEY
   (
                          POPL_PTCId                         
                         )
             REFERENCES CDN.ProdTechnologiaCzynnosci
                         (
                          PTC_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdObiektyDoPlanu_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdObiektyDoPlanu_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdObiektyDoPlanu_InsertUpdateHandler
  ON CDN.ProdObiektyDoPlanu
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POPL_POBId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.POPL_POBId = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL
                AND (
                          IsNull(inserted.POPL_POBId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [ProdObiektyDoPlanu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POPL_PFUId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdFunkcje ON
                    inserted.POPL_PFUId = CDN.ProdFunkcje.PFU_Id
              WHERE CDN.ProdFunkcje.PFU_Id IS NULL
                AND (
                          IsNull(inserted.POPL_PFUId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdFunkcje) [ProdObiektyDoPlanu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdObiektyFunkcje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdObiektyFunkcje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdObiektyFunkcje_InsertUpdateHandler
  ON CDN.ProdObiektyFunkcje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POF_Obiekt ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POF_OBITyp=14502)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KadrStanowiska ON
                    inserted.POF_Obiekt = CDN.KadrStanowiska.KSt_Id
              WHERE CDN.KadrStanowiska.KSt_Id IS NULL AND (inserted.POF_OBITyp=14502)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KadrStanowiska) [ProdObiektyFunkcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POF_Funkcja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdFunkcje ON
                    inserted.POF_Funkcja = CDN.ProdFunkcje.PFU_Id
              WHERE CDN.ProdFunkcje.PFU_Id IS NULL
                AND (
                          IsNull(inserted.POF_Funkcja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdFunkcje) [ProdObiektyFunkcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POF_Oddzial ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.POF_Oddzial = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.POF_Oddzial,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdObiektyFunkcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POF_Obiekt ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POF_OBITyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.POF_Obiekt = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.POF_OBITyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [ProdObiektyFunkcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_pou_ObiektTermin"></A><PRE>
          <FONT SIZE="2"><I>/* FK_pou_ObiektTermin */</I><BR>
ALTER TABLE CDN.ProdObiektyUzycie ADD CONSTRAINT FK_pou_ObiektTermin
 FOREIGN KEY
   (
                          POU_Obiekt                        
                         )
             REFERENCES CDN.ProdObiekty
                         (
                          POB_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdObiektyUzycie_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdObiektyUzycie_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdObiektyUzycie_InsertUpdateHandler
  ON CDN.ProdObiektyUzycie
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POU_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.POU_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.POU_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ProdObiektyUzycie_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdOkresy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdOkresy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdOkresy_DeleteHandler
  ON CDN.ProdOkresy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdZwiazane
    IF EXISTS(SELECT * FROM CDN.ProdZwiazane JOIN deleted
            ON 
          deleted.POK_Id = CDN.ProdZwiazane.PZW_ZrdNumer
      AND (CDN.ProdZwiazane.PZW_ZrdTyp=14336)
            )
        DELETE CDN.ProdZwiazane
        FROM CDN.ProdZwiazane JOIN deleted
        ON 
          deleted.POK_Id = CDN.ProdZwiazane.PZW_ZrdNumer
      AND (CDN.ProdZwiazane.PZW_ZrdTyp=14336)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdOkresy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdOkresy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdOkresy_InsertUpdateHandler
  ON CDN.ProdOkresy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POK_ObiTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.POK_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.POK_ObiTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ProdOkresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POK_ObiTyp=14339)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdKalendarze ON
                    inserted.POK_ObiNumer = CDN.ProdKalendarze.PKA_Id
              WHERE CDN.ProdKalendarze.PKA_Id IS NULL AND (inserted.POK_ObiTyp=14339)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdKalendarze) [ProdOkresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POK_ObiTyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.POK_ObiNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.POK_ObiTyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [ProdOkresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POK_PrzyczynaPrzestoju ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POK_PrzyczynaPrzestoju&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.POK_PrzyczynaPrzestoju = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.POK_PrzyczynaPrzestoju&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdOkresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POK_Status ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POK_Status&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.POK_Status = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.POK_Status&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdOkresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdOkresyAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdOkresyAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdOkresyAlias_InsertUpdateHandler
  ON CDN.ProdOkresy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.POK_ObiTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.POK_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.POK_ObiTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdOkresyAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdOperacjeMagazyny_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdOperacjeMagazyny_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdOperacjeMagazyny_InsertUpdateHandler
  ON CDN.ProdOperacjeMagazyny
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POM_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.POM_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.POM_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ProdOperacjeMagazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POM_PTZId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.POM_PTZId = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL
                AND (
                          IsNull(inserted.POM_PTZId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [ProdOperacjeMagazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POM_PCZId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.POM_PCZId = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL
                AND (
                          IsNull(inserted.POM_PCZId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [ProdOperacjeMagazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPYPCZ"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPYPCZ */</I><BR>
ALTER TABLE CDN.ProdOperacjePauzy ADD CONSTRAINT FK_PPYPCZ
 FOREIGN KEY
   (
                          PPY_PCZId                         
                         )
             REFERENCES CDN.ProdCzynnosci
                         (
                          PCZ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdOperacjePauzy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdOperacjePauzy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdOperacjePauzy_InsertUpdateHandler
  ON CDN.ProdOperacjePauzy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPY_PrzyczynaPauzy ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PPY_PrzyczynaPauzy = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PPY_PrzyczynaPauzy,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdOperacjePauzy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPY_OpeNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PPY_OpeNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PPY_OpeNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdOperacjePauzy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdOperacjePominiete_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdOperacjePominiete_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdOperacjePominiete_InsertUpdateHandler
  ON CDN.ProdOperacjePominiete
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POPP_PCZId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.POPP_PCZId = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL
                AND (
                          IsNull(inserted.POPP_PCZId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [ProdOperacjePominiete_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POPP_PrzyczynaPominiecia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.POPP_PrzyczynaPominiecia = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.POPP_PrzyczynaPominiecia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdOperacjePominiete_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdOperacjePowiazane_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdOperacjePowiazane_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdOperacjePowiazane_InsertUpdateHandler
  ON CDN.ProdOperacjePowiazane
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( POP_PrzedPczId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.POP_PrzedPczId = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL
                AND (
                          IsNull(inserted.POP_PrzedPczId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [ProdOperacjePowiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( POP_PczId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.POP_PczId = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL
                AND (
                          IsNull(inserted.POP_PczId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [ProdOperacjePowiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKJHPKJ"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKJHPKJ */</I><BR>
ALTER TABLE CDN.ProdPKJHistoriaZmian ADD CONSTRAINT FK_PKJHPKJ
 FOREIGN KEY
   (
                          PKJH_PKJId                         
                         )
             REFERENCES CDN.ProdPKJNag
                         (
                          PKJN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPKJNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPKJNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdPKJNag_DeleteHandler
  ON CDN.ProdPKJNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdZasoby JOIN deleted
          ON
                deleted.PKJN_Id = CDN.ProdZasoby.PZA_PKJNId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Brak możliwości usunięcia dokumentu. Na podstawie dokumentu utworzono wyrób niezgodny./# [ProdPKJNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PKJN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14383 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PKJN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14383 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PKJN_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14383 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PKJN_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14383 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdParamKJNormyObiektow
    IF EXISTS(SELECT * FROM CDN.ProdParamKJNormyObiektow JOIN deleted
            ON 
          deleted.PKJN_Id = CDN.ProdParamKJNormyObiektow.PPKO_OGidNumer
      AND (CDN.ProdParamKJNormyObiektow.PPKO_OGidTyp=14383)
            )
        DELETE CDN.ProdParamKJNormyObiektow
        FROM CDN.ProdParamKJNormyObiektow JOIN deleted
        ON 
          deleted.PKJN_Id = CDN.ProdParamKJNormyObiektow.PPKO_OGidNumer
      AND (CDN.ProdParamKJNormyObiektow.PPKO_OGidTyp=14383)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PKJN_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14383)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PKJN_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14383)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Rezerwacje
    IF EXISTS(SELECT * FROM CDN.Rezerwacje JOIN deleted
            ON 
          deleted.PKJN_Id = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=14383)
            )
        DELETE CDN.Rezerwacje
        FROM CDN.Rezerwacje JOIN deleted
        ON 
          deleted.PKJN_Id = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=14383)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPKJNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPKJNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdPKJNag_InsertUpdateHandler
  ON CDN.ProdPKJNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PKJN_Status ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PKJN_Status = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PKJN_Status,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_PTZId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.PKJN_PTZId = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL
                AND (
                          IsNull(inserted.PKJN_PTZId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PKJN_TwrTyp = 16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PKJN_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PKJN_TwrTyp = 16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.PKJN_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PKJN_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_OpWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PKJN_OpWNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PKJN_OpWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_OpMNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PKJN_OpMNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PKJN_OpMNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_OpZNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PKJN_OpZNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PKJN_OpZNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_PrzyczynaOdrzucenia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PKJN_PrzyczynaOdrzucenia = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PKJN_PrzyczynaOdrzucenia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_WynikKJ ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PKJN_WynikKJ = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PKJN_WynikKJ,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_ObiTyp )  OR UPDATE( PKJN_ObiNumer )  OR UPDATE( PKJN_ObiLp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.PKJN_ObiTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.PKJN_ObiNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.PKJN_ObiLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL
                AND (
                          IsNull(inserted.PKJN_ObiTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.PKJN_ObiNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.PKJN_ObiLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PKJN_ObiTyp )  OR UPDATE( PKJN_ObiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.PKJN_ObiTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.PKJN_ObiNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PKJN_ObiTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.PKJN_ObiNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [ProdPKJNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKJSPKJ"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKJSPKJ */</I><BR>
ALTER TABLE CDN.ProdPKJSubelem ADD CONSTRAINT FK_PKJSPKJ
 FOREIGN KEY
   (
                          PKJS_PKJNId                        
                         )
             REFERENCES CDN.ProdPKJNag
                         (
                          PKJN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPKJSubelem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPKJSubelem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdPKJSubelem_InsertUpdateHandler
  ON CDN.ProdPKJSubelem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PKJS_GIDTyp )  OR UPDATE( PKJS_GIDNumer )  OR UPDATE( PKJS_GIDLp )  OR UPDATE( PKJS_SubGIDLp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraSElem ON
                    inserted.PKJS_GIDTyp = CDN.TraSElem.TrS_GIDTyp
                AND inserted.PKJS_GIDNumer = CDN.TraSElem.TrS_GIDNumer
                AND inserted.PKJS_GIDLp = CDN.TraSElem.TrS_GIDLp
                AND inserted.PKJS_SubGIDLp = CDN.TraSElem.TrS_SubGIDLp
              WHERE CDN.TraSElem.TrS_SubGIDLp IS NULL
                AND (
                          IsNull(inserted.PKJS_GIDTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.PKJS_GIDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.PKJS_GIDLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.PKJS_SubGIDLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraSElem) [ProdPKJSubelem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKJZPKJN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKJZPKJN */</I><BR>
ALTER TABLE CDN.ProdPKJZas ADD CONSTRAINT FK_PKJZPKJN
 FOREIGN KEY
   (
                          PKJZ_PKJNId                        
                         )
             REFERENCES CDN.ProdPKJNag
                         (
                          PKJN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PKJZPZA"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PKJZPZA */</I><BR>
ALTER TABLE CDN.ProdPKJZas ADD CONSTRAINT FK_PKJZPZA
 FOREIGN KEY
   (
                          PKJZ_PZAId                         
                         )
             REFERENCES CDN.ProdZasoby
                         (
                          PZA_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPKOPKJId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPKOPKJId */</I><BR>
ALTER TABLE CDN.ProdParamKJNormyObiektow ADD CONSTRAINT FK_PPKOPKJId
 FOREIGN KEY
   (
                          PPKO_PKJId                         
                         )
             REFERENCES CDN.ProdParametryKJ
                         (
                          PKJ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdParamKJNormyObiektow_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdParamKJNormyObiektow_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdParamKJNormyObiektow_DeleteHandler
  ON CDN.ProdParamKJNormyObiektow
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PPKO_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14380 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PPKO_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14380 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PPKO_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14380 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PPKO_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14380 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PPKO_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14380)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PPKO_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14380)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdParamKJNormyObiektow_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdParamKJNormyObiektow_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdParamKJNormyObiektow_InsertUpdateHandler
  ON CDN.ProdParamKJNormyObiektow
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPKO_OGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPKO_OGidTyp=14383)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPKJNag ON
                    inserted.PPKO_OGidNumer = CDN.ProdPKJNag.PKJN_Id
              WHERE CDN.ProdPKJNag.PKJN_Id IS NULL AND (inserted.PPKO_OGidTyp=14383)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPKJNag) [ProdParamKJNormyObiektow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPKO_OGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPKO_OGidTyp=14382)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.PPKO_OGidNumer = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL AND (inserted.PPKO_OGidTyp=14382)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [ProdParamKJNormyObiektow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPKO_OGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPKO_OGidTyp=14381)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdWzorceKJ ON
                    inserted.PPKO_OGidNumer = CDN.ProdWzorceKJ.WKJ_Id
              WHERE CDN.ProdWzorceKJ.WKJ_Id IS NULL AND (inserted.PPKO_OGidTyp=14381)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdWzorceKJ) [ProdParamKJNormyObiektow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KJNPPKOId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KJNPPKOId */</I><BR>
ALTER TABLE CDN.ProdParametryKJNormy ADD CONSTRAINT FK_KJNPPKOId
 FOREIGN KEY
   (
                          KJN_PPKOId                        
                         )
             REFERENCES CDN.ProdParamKJNormyObiektow
                         (
                          PPKO_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPlany_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPlany_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdPlany_DeleteHandler
  ON CDN.ProdPlany
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PPL_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14360)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PPL_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14360)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PPL_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14360 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PPL_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14360 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPlany_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPlany_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdPlany_InsertUpdateHandler
  ON CDN.ProdPlany
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPL_OpeWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PPL_OpeWNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PPL_OpeWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdPlany_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPL_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PPL_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PPL_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdPlany_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPDPPL"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPDPPL */</I><BR>
ALTER TABLE CDN.ProdPlanyDokumenty ADD CONSTRAINT FK_PPDPPL
 FOREIGN KEY
   (
                          PPD_PPLId                         
                         )
             REFERENCES CDN.ProdPlany
                         (
                          PPL_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPlanyDokumenty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPlanyDokumenty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdPlanyDokumenty_InsertUpdateHandler
  ON CDN.ProdPlanyDokumenty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPD_DokTyp=14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.PPD_DokNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.PPD_DokTyp=14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [ProdPlanyDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPD_DokTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.PPD_DokNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.PPD_DokTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [ProdPlanyDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPMPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPMPrimary */</I><BR>
ALTER TABLE CDN.ProdPlanyMag ADD CONSTRAINT FK_PPMPrimary
 FOREIGN KEY
   (
                          PPM_PPLId                         
                         )
             REFERENCES CDN.ProdPlany
                         (
                          PPL_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPMMagNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPMMagNumer */</I><BR>
ALTER TABLE CDN.ProdPlanyMag ADD CONSTRAINT FK_PPMMagNumer
 FOREIGN KEY
   (
                          PPM_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPTProdPlanProdukt"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPTProdPlanProdukt */</I><BR>
ALTER TABLE CDN.ProdPlanyMaterialy ADD CONSTRAINT FK_PPTProdPlanProdukt
 FOREIGN KEY
   (
                          PPT_PPPId                         
                         )
             REFERENCES CDN.ProdPlanyProdukty
                         (
                          PPP_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPlanyMaterialy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPlanyMaterialy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdPlanyMaterialy_InsertUpdateHandler
  ON CDN.ProdPlanyMaterialy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPT_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PPT_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PPT_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdPlanyMaterialy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPTGPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPTGPrimary */</I><BR>
ALTER TABLE CDN.ProdPlanyMaterialyGrupy ADD CONSTRAINT FK_PPTGPrimary
 FOREIGN KEY
   (
                          PPTG_PPTId                         
                         )
             REFERENCES CDN.ProdPlanyMaterialy
                         (
                          PPT_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPTGId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPTGId */</I><BR>
ALTER TABLE CDN.ProdPlanyMaterialyGrupy ADD CONSTRAINT FK_PPTGId
 FOREIGN KEY
   (
                          PPTG_Id                            
                         )
             REFERENCES CDN.ProdPlanyMaterialyDoZamowienia
                         (
                          PPTZ_PPTGId                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPPTwrKarty"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPPTwrKarty */</I><BR>
ALTER TABLE CDN.ProdPlanyProdukty ADD CONSTRAINT FK_PPPTwrKarty
 FOREIGN KEY
   (
                          PPP_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPPProdPlan"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPPProdPlan */</I><BR>
ALTER TABLE CDN.ProdPlanyProdukty ADD CONSTRAINT FK_PPPProdPlan
 FOREIGN KEY
   (
                          PPP_PPLId                         
                         )
             REFERENCES CDN.ProdPlany
                         (
                          PPL_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPlanyProdukty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPlanyProdukty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdPlanyProdukty_DeleteHandler
  ON CDN.ProdPlanyProdukty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.PPP_Id = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (CDN.DokZwiazane.DoZ_ZrdTyp=14361)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.PPP_Id = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (CDN.DokZwiazane.DoZ_ZrdTyp=14361)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPlanyProdukty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPlanyProdukty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdPlanyProdukty_InsertUpdateHandler
  ON CDN.ProdPlanyProdukty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPP_DokZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPP_DokZrdTyp = 14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.PPP_DokZrdNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.PPP_DokZrdTyp = 14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [ProdPlanyProdukty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPP_DokZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPP_DokZrdTyp = 960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.PPP_DokZrdNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.PPP_DokZrdTyp = 960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [ProdPlanyProdukty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPP_DokZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPP_DokZrdTyp = 14347)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlanNag ON
                    inserted.PPP_DokZrdNumer = CDN.PlanNag.PLN_Id
              WHERE CDN.PlanNag.PLN_Id IS NULL AND (inserted.PPP_DokZrdTyp = 14347)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlanNag) [ProdPlanyProdukty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPGPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPGPrimary */</I><BR>
ALTER TABLE CDN.ProdPlanyTwG ADD CONSTRAINT FK_PPGPrimary
 FOREIGN KEY
   (
                          PPG_PPLId                         
                         )
             REFERENCES CDN.ProdPlany
                         (
                          PPL_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdPlanyTwG_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdPlanyTwG_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdPlanyTwG_InsertUpdateHandler
  ON CDN.ProdPlanyTwG
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPG_TwGNumer )  OR UPDATE( PPG_TwGTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PPG_TwGTyp=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.PPG_TwGNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.PPG_TwGTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (inserted.PPG_TwGTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [ProdPlanyTwG_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPZPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPZPrimary */</I><BR>
ALTER TABLE CDN.ProdPlanyZrdDok ADD CONSTRAINT FK_PPZPrimary
 FOREIGN KEY
   (
                          PPZ_PPPId                         
                         )
             REFERENCES CDN.ProdPlanyProdukty
                         (
                          PPP_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPCZlecenie"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPCZlecenie */</I><BR>
ALTER TABLE CDN.ProdProcesy ADD CONSTRAINT FK_PPCZlecenie
 FOREIGN KEY
   (
                          PPC_Zlecenie                      
                         )
             REFERENCES CDN.ProdZlecenia                     -- oryginalnie ProdZleceniaAlias
                         (
                          PZL_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdProcesy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdProcesy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdProcesy_DeleteHandler
  ON CDN.ProdProcesy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PPC_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14344)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PPC_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14344)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PPC_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14344 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PPC_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14344 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdCzynnosci
    IF EXISTS(SELECT * FROM CDN.ProdCzynnosci JOIN deleted
            ON 
          deleted.PPC_Id = CDN.ProdCzynnosci.PCZ_Proces
            )
        DELETE CDN.ProdCzynnosci
        FROM CDN.ProdCzynnosci JOIN deleted
        ON 
          deleted.PPC_Id = CDN.ProdCzynnosci.PCZ_Proces
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PPC_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14344 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PPC_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14344 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKalkulacjaKosztu
    IF EXISTS(SELECT * FROM CDN.ProdKalkulacjaKosztu JOIN deleted
            ON 
          deleted.PPC_Id = CDN.ProdKalkulacjaKosztu.PKK_ObiNumer
      AND (CDN.ProdKalkulacjaKosztu.PKK_ObiTyp IN(14344,14353))
            )
        DELETE CDN.ProdKalkulacjaKosztu
        FROM CDN.ProdKalkulacjaKosztu JOIN deleted
        ON 
          deleted.PPC_Id = CDN.ProdKalkulacjaKosztu.PKK_ObiNumer
      AND (CDN.ProdKalkulacjaKosztu.PKK_ObiTyp IN(14344,14353))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.PPC_Id = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_ObiTyp=14344)
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.PPC_Id = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_ObiTyp=14344)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElemO
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElemO JOIN deleted
            ON 
          deleted.PPC_Id = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_ObiTyp=14344)
            )
        DELETE CDN.ProdKosztyElemO
        FROM CDN.ProdKosztyElemO JOIN deleted
        ON 
          deleted.PPC_Id = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_ObiTyp=14344)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdProcesy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdProcesy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdProcesy_InsertUpdateHandler
  ON CDN.ProdProcesy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PPC_Oddzial ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PPC_Oddzial = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PPC_Oddzial,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdProcesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPC_Zlecenie ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.PPC_Zlecenie = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL
                AND (
                          IsNull(inserted.PPC_Zlecenie,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [ProdProcesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPC_Technologia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.PPC_Technologia = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL
                AND (
                          IsNull(inserted.PPC_Technologia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [ProdProcesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PPC_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.PPC_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PPC_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ProdProcesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PREFrsId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PREFrsId */</I><BR>
ALTER TABLE CDN.ProdRekomendacje ADD CONSTRAINT FK_PREFrsId
 FOREIGN KEY
   (
                          PRE_FrsId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PREOpeW"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PREOpeW */</I><BR>
ALTER TABLE CDN.ProdRekomendacje ADD CONSTRAINT FK_PREOpeW
 FOREIGN KEY
   (
                          PRE_OpeWNumer                     
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdRekomendacje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdRekomendacje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdRekomendacje_DeleteHandler
  ON CDN.ProdRekomendacje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PRE_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp IN(14363,14364) and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PRE_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp IN(14363,14364) and CDN.Atrybuty.Atr_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdRekomendacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdRekomendacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdRekomendacje_InsertUpdateHandler
  ON CDN.ProdRekomendacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PRE_WzorzecId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdRekomendacjeWzorce ON
                    inserted.PRE_WzorzecId = CDN.ProdRekomendacjeWzorce.PREW_Id
              WHERE CDN.ProdRekomendacjeWzorce.PREW_Id IS NULL
                AND (
                          IsNull(inserted.PRE_WzorzecId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdRekomendacjeWzorce) [ProdRekomendacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PREDPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PREDPrimary */</I><BR>
ALTER TABLE CDN.ProdRekomendacjeDokumenty ADD CONSTRAINT FK_PREDPrimary
 FOREIGN KEY
   (
                          PRED_PREPId                        
                         )
             REFERENCES CDN.ProdRekomendacjeProdukty
                         (
                          PREP_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdRekomendacjeDokumenty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdRekomendacjeDokumenty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdRekomendacjeDokumenty_InsertUpdateHandler
  ON CDN.ProdRekomendacjeDokumenty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PRED_DokNumer )  OR UPDATE( PRED_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRED_DokTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.PRED_DokNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.PRED_DokLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.PRED_DokTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [ProdRekomendacjeDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PRED_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PRED_DokTyp=14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecElem ON
                    inserted.PRED_DokLp = CDN.ProdZlecElem.PZE_Id
              WHERE CDN.ProdZlecElem.PZE_Id IS NULL AND (inserted.PRED_DokTyp=14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecElem) [ProdRekomendacjeDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PREPProdRekomendacje"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PREPProdRekomendacje */</I><BR>
ALTER TABLE CDN.ProdRekomendacjeProdukty ADD CONSTRAINT FK_PREPProdRekomendacje
 FOREIGN KEY
   (
                          PREP_PREId                         
                         )
             REFERENCES CDN.ProdRekomendacje
                         (
                          PRE_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PREPTwrKarty"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PREPTwrKarty */</I><BR>
ALTER TABLE CDN.ProdRekomendacjeProdukty ADD CONSTRAINT FK_PREPTwrKarty
 FOREIGN KEY
   (
                          PREP_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdRekomendacjeProdukty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdRekomendacjeProdukty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdRekomendacjeProdukty_InsertUpdateHandler
  ON CDN.ProdRekomendacjeProdukty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PREP_MagNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PREP_MagNumer NOT IN (0,-1))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.PREP_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.PREP_MagNumer NOT IN (0,-1))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ProdRekomendacjeProdukty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PEWOpeW"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PEWOpeW */</I><BR>
ALTER TABLE CDN.ProdRekomendacjeWzorce ADD CONSTRAINT FK_PEWOpeW
 FOREIGN KEY
   (
                          PREW_OpeWNumer                     
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdRekomendacjeWzorce_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdRekomendacjeWzorce_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdRekomendacjeWzorce_DeleteHandler
  ON CDN.ProdRekomendacjeWzorce
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdRekomendacje
    IF EXISTS
       ( SELECT * FROM CDN.ProdRekomendacje JOIN deleted
          ON
                deleted.PREW_Id = CDN.ProdRekomendacje.PRE_WzorzecId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdRekomendacje) [ProdRekomendacjeWzorce_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PREWWTwrWarunek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PREWWTwrWarunek */</I><BR>
ALTER TABLE CDN.ProdRekomendacjeWzorceWarunki ADD CONSTRAINT FK_PREWWTwrWarunek
 FOREIGN KEY
   (
                          PREWW_PREWTId                       
                         )
             REFERENCES CDN.ProdRekomendacjeWzorceWarunkiTwr
                         (
                          PREWT_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PREWTWzorzec"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PREWTWzorzec */</I><BR>
ALTER TABLE CDN.ProdRekomendacjeWzorceWarunkiTwr ADD CONSTRAINT FK_PREWTWzorzec
 FOREIGN KEY
   (
                          PREWT_PREWId                        
                         )
             REFERENCES CDN.ProdRekomendacjeWzorce
                         (
                          PREW_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdRekomendacjeWzorceWarunkiTwr_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdRekomendacjeWzorceWarunkiTwr_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdRekomendacjeWzorceWarunkiTwr_InsertUpdateHandler
  ON CDN.ProdRekomendacjeWzorceWarunkiTwr
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PREWT_TWRNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PREWT_TwRTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PREWT_TWRNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PREWT_TwRTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdRekomendacjeWzorceWarunkiTwr_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdSegmenty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdSegmenty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdSegmenty_DeleteHandler
  ON CDN.ProdSegmenty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdSegmentyWlasciwosci
    IF EXISTS(SELECT * FROM CDN.ProdSegmentyWlasciwosci JOIN deleted
            ON 
          deleted.PSG_Id = CDN.ProdSegmentyWlasciwosci.PSGW_PSGId
      AND (CDN.ProdSegmentyWlasciwosci.PSGW_ObiTyp=0)
            )
        DELETE CDN.ProdSegmentyWlasciwosci
        FROM CDN.ProdSegmentyWlasciwosci JOIN deleted
        ON 
          deleted.PSG_Id = CDN.ProdSegmentyWlasciwosci.PSGW_PSGId
      AND (CDN.ProdSegmentyWlasciwosci.PSGW_ObiTyp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdSegmentyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdSegmentyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdSegmentyAlias_DeleteHandler
  ON CDN.ProdSegmenty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdSegmentyWlasciwosci
    IF EXISTS
       ( SELECT * FROM CDN.ProdSegmentyWlasciwosci JOIN deleted
          ON
                deleted.PSG_Id = CDN.ProdSegmentyWlasciwosci.PSGW_PSGId
       AND (CDN.ProdSegmentyWlasciwosci.PSGW_ObiTyp=1)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdSegmentyWlasciwosci) [ProdSegmentyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdSegmentyWlasciwosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdSegmentyWlasciwosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdSegmentyWlasciwosci_InsertUpdateHandler
  ON CDN.ProdSegmentyWlasciwosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PSGW_PSGId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PSGW_ObiTyp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdSegmenty ON
                    inserted.PSGW_PSGId = CDN.ProdSegmenty.PSG_Id
              WHERE CDN.ProdSegmenty.PSG_Id IS NULL AND (inserted.PSGW_ObiTyp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdSegmenty) [ProdSegmentyWlasciwosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PSGW_PSGId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PSGW_ObiTyp=1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdSegmenty ON
                    inserted.PSGW_PSGId = CDN.ProdSegmenty.PSG_Id
              WHERE CDN.ProdSegmenty.PSG_Id IS NULL AND (inserted.PSGW_ObiTyp=1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdSegmenty) [ProdSegmentyWlasciwosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PSGW_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PSGW_ObiTyp=1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdWzorceNumerowPartii ON
                    inserted.PSGW_ObiNumer = CDN.ProdWzorceNumerowPartii.WNP_Id
              WHERE CDN.ProdWzorceNumerowPartii.WNP_Id IS NULL AND (inserted.PSGW_ObiTyp=1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdWzorceNumerowPartii) [ProdSegmentyWlasciwosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologia_DeleteHandler
  ON CDN.ProdTechnologia
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdElem
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdElem JOIN deleted
          ON
                deleted.PTE_Id = CDN.KonfProdElem.KPE_ObiNumer
       AND (CDN.KonfProdElem.KPE_ObiTyp=14370)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KonfProdElem) [ProdTechnologia_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdNag
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdNag JOIN deleted
          ON
                deleted.PTE_Id = CDN.KonfProdNag.KPN_KTPId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć konfiguratora, ponieważ występuje on na konfiguracji produktu elementu dokumentu./# [ProdTechnologia_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecElem
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecElem JOIN deleted
          ON
                deleted.PTE_Id = CDN.ProdZlecElem.PZE_Technologia
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Technologia została wykorzystana w zleceniu produkcyjnym. Nie można jej usunąć../# [ProdTechnologia_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdProcesy
    IF EXISTS
       ( SELECT * FROM CDN.ProdProcesy JOIN deleted
          ON
                deleted.PTE_Id = CDN.ProdProcesy.PPC_Technologia
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Technologia została wykorzystana w zleceniu produkcyjnym. Nie można jej usunąć../# [ProdTechnologia_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KonfProdLinki
    IF EXISTS(SELECT * FROM CDN.KonfProdLinki JOIN deleted
            ON 
          deleted.PTE_Id = CDN.KonfProdLinki.KPL_PTEId
      AND (CDN.KonfProdLinki.KPL_PTETyp=14370)
            )
        DELETE CDN.KonfProdLinki
        FROM CDN.KonfProdLinki JOIN deleted
        ON 
          deleted.PTE_Id = CDN.KonfProdLinki.KPL_PTEId
      AND (CDN.KonfProdLinki.KPL_PTETyp=14370)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdTechnologiaKoszty
    IF EXISTS(SELECT * FROM CDN.ProdTechnologiaKoszty JOIN deleted
            ON 
          deleted.PTE_Id = CDN.ProdTechnologiaKoszty.PTK_PTEId
            )
        DELETE CDN.ProdTechnologiaKoszty
        FROM CDN.ProdTechnologiaKoszty JOIN deleted
        ON 
          deleted.PTE_Id = CDN.ProdTechnologiaKoszty.PTK_PTEId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PTE_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14340)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PTE_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14340)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PTE_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (14340,14370) and CDN.Atrybuty.Atr_OBINumer&gt;0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PTE_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (14340,14370) and CDN.Atrybuty.Atr_OBINumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdTechnologiaCzynnosci
    IF EXISTS(SELECT * FROM CDN.ProdTechnologiaCzynnosci JOIN deleted
            ON 
          deleted.PTE_Id = CDN.ProdTechnologiaCzynnosci.PTC_Technologia
            )
        DELETE CDN.ProdTechnologiaCzynnosci
        FROM CDN.ProdTechnologiaCzynnosci JOIN deleted
        ON 
          deleted.PTE_Id = CDN.ProdTechnologiaCzynnosci.PTC_Technologia
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PTE_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14340 and CDN.AtrybutyHist.Ath_OBINumer&gt;0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PTE_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14340 and CDN.AtrybutyHist.Ath_OBINumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ParamRozKonf
    IF EXISTS(SELECT * FROM CDN.ParamRozKonf JOIN deleted
            ON 
          deleted.PTE_Id = CDN.ParamRozKonf.PRK_ObiNumer
      AND (CDN.ParamRozKonf.PRK_ObiTyp = 14370)
            )
        DELETE CDN.ParamRozKonf
        FROM CDN.ParamRozKonf JOIN deleted
        ON 
          deleted.PTE_Id = CDN.ParamRozKonf.PRK_ObiNumer
      AND (CDN.ParamRozKonf.PRK_ObiTyp = 14370)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologia_InsertUpdateHandler
  ON CDN.ProdTechnologia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PTE_TwrNumer )  OR UPDATE( PTE_TwrTyp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.PTE_TwrNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.PTE_TwrTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (EXISTS(SELECT * FROM CDN.TwrGrupyDom where TGD_GIDTyp=CDN.TwrGrupy.TwG_GIDTyp AND TGD_GIDNumer = CDN.TwrGrupy.TwG_GIDNumer AND TGD_GrOTyp = CDN.TwrGrupy.TwG_GrOTyp AND TGD_GrONumer = CDN.TwrGrupy.TwG_GrONumer))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [ProdTechnologia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTE_Id ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.PTE_Id = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL
                AND (
                          IsNull(inserted.PTE_Id,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [ProdTechnologia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTE_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PTE_ZrdTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.PTE_ZrdNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.PTE_ZrdTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [ProdTechnologia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTE_PrjId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.PTE_PrjId = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.PTE_PrjId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [ProdTechnologia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTE_Oddzial ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PTE_Oddzial = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PTE_Oddzial,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdTechnologia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTE_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PTE_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PTE_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PTE_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdTechnologia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTE_KnDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PTE_KnDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PTE_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PTE_KnDTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdTechnologia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaAlias_DeleteHandler
  ON CDN.ProdTechnologia
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdNag
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdNag JOIN deleted
          ON
                deleted.PTE_Id = CDN.KonfProdNag.KPN_PTEId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć technologii, ponieważ występuje ona na konfiguracji produktu elementu dokumentu./# [ProdTechnologiaAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologia
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologia JOIN deleted
          ON
                deleted.PTE_Id = CDN.ProdTechnologia.PTE_Id
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologia) [ProdTechnologiaAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaCzynnosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaCzynnosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaCzynnosci_DeleteHandler
  ON CDN.ProdTechnologiaCzynnosci
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdElem
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdElem JOIN deleted
          ON
                deleted.PTC_Id = CDN.KonfProdElem.KPE_ObiNumer
       AND (CDN.KonfProdElem.KPE_ObiTyp=14341)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KonfProdElem) [ProdTechnologiaCzynnosci_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.ProdCzynnosci JOIN deleted
          ON
                deleted.PTC_Id = CDN.ProdCzynnosci.PCZ_TechnologiaCzynnosc
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdCzynnosci) [ProdTechnologiaCzynnosci_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanySkladnikiObciazenia
    IF EXISTS(SELECT * FROM CDN.PlanySkladnikiObciazenia JOIN deleted
            ON 
          deleted.PTC_Id = CDN.PlanySkladnikiObciazenia.PSO_ObiNumer
      AND (CDN.PlanySkladnikiObciazenia.PSO_ObiTyp=14341)
            )
        DELETE CDN.PlanySkladnikiObciazenia
        FROM CDN.PlanySkladnikiObciazenia JOIN deleted
        ON 
          deleted.PTC_Id = CDN.PlanySkladnikiObciazenia.PSO_ObiNumer
      AND (CDN.PlanySkladnikiObciazenia.PSO_ObiTyp=14341)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PTC_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14341)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PTC_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14341)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PTC_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14341 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PTC_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14341 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PTC_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14341 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PTC_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14341 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ParamRozKonf
    IF EXISTS(SELECT * FROM CDN.ParamRozKonf JOIN deleted
            ON 
          deleted.PTC_Id = CDN.ParamRozKonf.PRK_ObiNumer
      AND (CDN.ParamRozKonf.PRK_ObiTyp = 14341)
            )
        DELETE CDN.ParamRozKonf
        FROM CDN.ParamRozKonf JOIN deleted
        ON 
          deleted.PTC_Id = CDN.ParamRozKonf.PRK_ObiNumer
      AND (CDN.ParamRozKonf.PRK_ObiTyp = 14341)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaCzynnosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaCzynnosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaCzynnosci_InsertUpdateHandler
  ON CDN.ProdTechnologiaCzynnosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PTC_Oddzial ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PTC_Oddzial = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PTC_Oddzial,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdTechnologiaCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTC_Technologia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.PTC_Technologia = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL
                AND (
                          IsNull(inserted.PTC_Technologia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [ProdTechnologiaCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTC_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PTC_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PTC_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PTC_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdTechnologiaCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PTFPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PTFPrimary */</I><BR>
ALTER TABLE CDN.ProdTechnologiaFunkcje ADD CONSTRAINT FK_PTFPrimary
 FOREIGN KEY
   (
                          PTF_TechnologiaCzynnosc           
                         )
             REFERENCES CDN.ProdTechnologiaCzynnosci
                         (
                          PTC_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaFunkcje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaFunkcje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaFunkcje_InsertUpdateHandler
  ON CDN.ProdTechnologiaFunkcje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PTF_Funkcja ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdFunkcje ON
                    inserted.PTF_Funkcja = CDN.ProdFunkcje.PFU_Id
              WHERE CDN.ProdFunkcje.PFU_Id IS NULL
                AND (
                          IsNull(inserted.PTF_Funkcja,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdFunkcje) [ProdTechnologiaFunkcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaKoszty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaKoszty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaKoszty_InsertUpdateHandler
  ON CDN.ProdTechnologiaKoszty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PTK_SLWId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PTK_SLWId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.PTK_SLWId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdTechnologiaKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTK_PTEId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.PTK_PTEId = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL
                AND (
                          IsNull(inserted.PTK_PTEId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [ProdTechnologiaKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PTRKeyTechnologiaOdDo"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PTRKeyTechnologiaOdDo */</I><BR>
ALTER TABLE CDN.ProdTechnologiaTerminy ADD CONSTRAINT FK_PTRKeyTechnologiaOdDo
 FOREIGN KEY
   (
                          PTR_TechnologiaId                 
                         )
             REFERENCES CDN.ProdTechnologia
                         (
                          PTE_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PTZKod"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PTZKod */</I><BR>
ALTER TABLE CDN.ProdTechnologiaZasoby ADD CONSTRAINT FK_PTZKod
 FOREIGN KEY
   (
                          PTZ_TechnologiaCzynnosc           
                         )
             REFERENCES CDN.ProdTechnologiaCzynnosci
                         (
                          PTC_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaZasoby_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaZasoby_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaZasoby_DeleteHandler
  ON CDN.ProdTechnologiaZasoby
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdElem
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdElem JOIN deleted
          ON
                deleted.PTZ_Id = CDN.KonfProdElem.KPE_ObiNumer
       AND (CDN.KonfProdElem.KPE_ObiTyp=14342)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KonfProdElem) [ProdTechnologiaZasoby_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdZasoby JOIN deleted
          ON
                deleted.PTZ_Id = CDN.ProdZasoby.PZA_TechnologiaZasob
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć produktu z czynności, ponieważ technologia została już wykorzystana na zleceniu produkcyjnym./# [ProdTechnologiaZasoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.PTZ_Id = CDN.ProdPKJNag.PKJN_PTZId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [ProdTechnologiaZasoby_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdOperacjeMagazyny
    IF EXISTS
       ( SELECT * FROM CDN.ProdOperacjeMagazyny JOIN deleted
          ON
                deleted.PTZ_Id = CDN.ProdOperacjeMagazyny.POM_PTZId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdOperacjeMagazyny) [ProdTechnologiaZasoby_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PTZ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14342 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PTZ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14342 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PTZ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14342 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PTZ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14342 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ParamRozKonf
    IF EXISTS(SELECT * FROM CDN.ParamRozKonf JOIN deleted
            ON 
          deleted.PTZ_Id = CDN.ParamRozKonf.PRK_ObiNumer
      AND (CDN.ParamRozKonf.PRK_ObiTyp = 14342)
            )
        DELETE CDN.ParamRozKonf
        FROM CDN.ParamRozKonf JOIN deleted
        ON 
          deleted.PTZ_Id = CDN.ParamRozKonf.PRK_ObiNumer
      AND (CDN.ParamRozKonf.PRK_ObiTyp = 14342)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdParamKJNormyObiektow
    IF EXISTS(SELECT * FROM CDN.ProdParamKJNormyObiektow JOIN deleted
            ON 
          deleted.PTZ_Id = CDN.ProdParamKJNormyObiektow.PPKO_OGidNumer
      AND (CDN.ProdParamKJNormyObiektow.PPKO_OGidTyp=14382)
            )
        DELETE CDN.ProdParamKJNormyObiektow
        FROM CDN.ProdParamKJNormyObiektow JOIN deleted
        ON 
          deleted.PTZ_Id = CDN.ProdParamKJNormyObiektow.PPKO_OGidNumer
      AND (CDN.ProdParamKJNormyObiektow.PPKO_OGidTyp=14382)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaZasoby_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaZasoby_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaZasoby_InsertUpdateHandler
  ON CDN.ProdTechnologiaZasoby
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PTZ_TechnologiaZasob ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.PTZ_TechnologiaZasob = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL
                AND (
                          IsNull(inserted.PTZ_TechnologiaZasob,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [ProdTechnologiaZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTZ_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PTZ_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PTZ_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PTZ_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdTechnologiaZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTZ_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.PTZ_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PTZ_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ProdTechnologiaZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PTZ_IdWzorcaNrPartii ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdWzorceNumerowPartii ON
                    inserted.PTZ_IdWzorcaNrPartii = CDN.ProdWzorceNumerowPartii.WNP_Id
              WHERE CDN.ProdWzorceNumerowPartii.WNP_Id IS NULL
                AND (
                          IsNull(inserted.PTZ_IdWzorcaNrPartii,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdWzorceNumerowPartii) [ProdTechnologiaZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaZasobyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaZasobyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaZasobyAlias_DeleteHandler
  ON CDN.ProdTechnologiaZasoby
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaZasoby JOIN deleted
          ON
                deleted.PTZ_Id = CDN.ProdTechnologiaZasoby.PTZ_TechnologiaZasob
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologiaZasoby) [ProdTechnologiaZasobyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PTTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PTTPrimary */</I><BR>
ALTER TABLE CDN.ProdTechnologiaZasobyTwX ADD CONSTRAINT FK_PTTPrimary
 FOREIGN KEY
   (
                          PTT_PTZId                         
                         )
             REFERENCES CDN.ProdTechnologiaZasoby
                         (
                          PTZ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdTechnologiaZasobyTwX_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdTechnologiaZasobyTwX_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdTechnologiaZasobyTwX_InsertUpdateHandler
  ON CDN.ProdTechnologiaZasobyTwX
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PTT_TwXNumer )  OR UPDATE( PTT_TwXTyp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.PTT_TwXNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.PTT_TwXTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (EXISTS(SELECT * FROM CDN.TwrGrupyDom where TGD_GIDTyp=CDN.TwrGrupy.TwG_GIDTyp AND TGD_GIDNumer = CDN.TwrGrupy.TwG_GIDNumer AND TGD_GrOTyp = CDN.TwrGrupy.TwG_GrOTyp AND TGD_GrONumer = CDN.TwrGrupy.TwG_GrONumer))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [ProdTechnologiaZasobyTwX_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PTDPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PTDPrimary */</I><BR>
ALTER TABLE CDN.ProdTechnologieDomyslne ADD CONSTRAINT FK_PTDPrimary
 FOREIGN KEY
   (
                          PTD_PTEID                         
                         )
             REFERENCES CDN.ProdTechnologia
                         (
                          PTE_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PTGTechnologiaOperacje"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PTGTechnologiaOperacje */</I><BR>
ALTER TABLE CDN.ProdTechnologieZasobyGniazd ADD CONSTRAINT FK_PTGTechnologiaOperacje
 FOREIGN KEY
   (
                          PTG_TechnologiaOperacje           
                         )
             REFERENCES CDN.ProdTechnologiaCzynnosci
                         (
                          PTC_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PTGZasob"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PTGZasob */</I><BR>
ALTER TABLE CDN.ProdTechnologieZasobyGniazd ADD CONSTRAINT FK_PTGZasob
 FOREIGN KEY
   (
                          PTG_ZasobGniazda                  
                         )
             REFERENCES CDN.ProdObiekty
                         (
                          POB_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdWzorceKJ_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdWzorceKJ_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdWzorceKJ_DeleteHandler
  ON CDN.ProdWzorceKJ
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.WKJ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14381 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.WKJ_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14381 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.WKJ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14381 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.WKJ_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14381 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdParamKJNormyObiektow
    IF EXISTS(SELECT * FROM CDN.ProdParamKJNormyObiektow JOIN deleted
            ON 
          deleted.WKJ_Id = CDN.ProdParamKJNormyObiektow.PPKO_OGidNumer
      AND (CDN.ProdParamKJNormyObiektow.PPKO_OGidTyp=14381)
            )
        DELETE CDN.ProdParamKJNormyObiektow
        FROM CDN.ProdParamKJNormyObiektow JOIN deleted
        ON 
          deleted.WKJ_Id = CDN.ProdParamKJNormyObiektow.PPKO_OGidNumer
      AND (CDN.ProdParamKJNormyObiektow.PPKO_OGidTyp=14381)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PWTWzorzec"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PWTWzorzec */</I><BR>
ALTER TABLE CDN.ProdWzorceKJTowary ADD CONSTRAINT FK_PWTWzorzec
 FOREIGN KEY
   (
                          PWT_WKJId                         
                         )
             REFERENCES CDN.ProdWzorceKJ
                         (
                          WKJ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdWzorceKJTowary_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdWzorceKJTowary_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdWzorceKJTowary_InsertUpdateHandler
  ON CDN.ProdWzorceKJTowary
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PWT_TwrGIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PWT_TwrGIDTyp = 16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PWT_TwrGIDNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PWT_TwrGIDTyp = 16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdWzorceKJTowary_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PWT_TwrGIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PWT_TwrGIDTyp = -16 AND inserted.PWT_TwrGIDNumer &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupyDom ON
                    inserted.PWT_TwrGIDNumer = CDN.TwrGrupyDom.TGD_GIDNumer
              WHERE CDN.TwrGrupyDom.TGD_GIDNumer IS NULL AND (inserted.PWT_TwrGIDTyp = -16 AND inserted.PWT_TwrGIDNumer &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupyDom) [ProdWzorceKJTowary_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PWKOpeW"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PWKOpeW */</I><BR>
ALTER TABLE CDN.ProdWzorceKosztow ADD CONSTRAINT FK_PWKOpeW
 FOREIGN KEY
   (
                          PWK_OpeW                          
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdWzorceKosztow_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdWzorceKosztow_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdWzorceKosztow_DeleteHandler
  ON CDN.ProdWzorceKosztow
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdKoszty
    IF EXISTS
       ( SELECT * FROM CDN.ProdKoszty JOIN deleted
          ON
                deleted.PWK_Id = CDN.ProdKoszty.PKO_PWKId
       AND (CDN.ProdKoszty.PKO_PWKId&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdKoszty) [ProdWzorceKosztow_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdWzorceKosztow_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdWzorceKosztow_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdWzorceKosztow_InsertUpdateHandler
  ON CDN.ProdWzorceKosztow
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PWK_Kategoria ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PWK_Kategoria&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PWK_Kategoria = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.PWK_Kategoria&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdWzorceKosztow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PWK_OpeM ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PWK_OpeM&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PWK_OpeM = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.PWK_OpeM&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdWzorceKosztow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PWWPWKId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PWWPWKId */</I><BR>
ALTER TABLE CDN.ProdWzorceKosztowWarunki ADD CONSTRAINT FK_PWWPWKId
 FOREIGN KEY
   (
                          PWW_PWKId                         
                         )
             REFERENCES CDN.ProdWzorceKosztow
                         (
                          PWK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdWzorceNumerowPartii_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdWzorceNumerowPartii_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdWzorceNumerowPartii_DeleteHandler
  ON CDN.ProdWzorceNumerowPartii
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaZasoby JOIN deleted
          ON
                deleted.WNP_Id = CDN.ProdTechnologiaZasoby.PTZ_IdWzorcaNrPartii
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologiaZasoby) [ProdWzorceNumerowPartii_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdZasoby JOIN deleted
          ON
                deleted.WNP_Id = CDN.ProdZasoby.PZA_IdWzorcaNrPartii
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć wzorca, ponieważ jest ustawiony na obiektach/# [ProdWzorceNumerowPartii_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecElem
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecElem JOIN deleted
          ON
                deleted.WNP_Id = CDN.ProdZlecElem.PZE_IdWzorcaNrPartii
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć wzorca, ponieważ jest ustawiony na obiektach/# [ProdWzorceNumerowPartii_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdSegmentyWlasciwosci
    IF EXISTS(SELECT * FROM CDN.ProdSegmentyWlasciwosci JOIN deleted
            ON 
          deleted.WNP_Id = CDN.ProdSegmentyWlasciwosci.PSGW_ObiNumer
      AND (CDN.ProdSegmentyWlasciwosci.PSGW_ObiTyp=1)
            )
        DELETE CDN.ProdSegmentyWlasciwosci
        FROM CDN.ProdSegmentyWlasciwosci JOIN deleted
        ON 
          deleted.WNP_Id = CDN.ProdSegmentyWlasciwosci.PSGW_ObiNumer
      AND (CDN.ProdSegmentyWlasciwosci.PSGW_ObiTyp=1)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdWzorceNumerowPartii_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdWzorceNumerowPartii_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdWzorceNumerowPartii_InsertUpdateHandler
  ON CDN.ProdWzorceNumerowPartii
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WNP_Separator ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.WNP_Separator = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.WNP_Separator,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdWzorceNumerowPartii_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PZOKeyPTCID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PZOKeyPTCID */</I><BR>
ALTER TABLE CDN.ProdZabiegiOperacji ADD CONSTRAINT FK_PZOKeyPTCID
 FOREIGN KEY
   (
                          PZO_TechnologiaCzynnosc           
                         )
             REFERENCES CDN.ProdTechnologiaCzynnosci
                         (
                          PTC_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZabiegiOperacji_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZabiegiOperacji_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdZabiegiOperacji_DeleteHandler
  ON CDN.ProdZabiegiOperacji
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PZO_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14356)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PZO_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14356)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PZACzynnosc"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PZACzynnosc */</I><BR>
ALTER TABLE CDN.ProdZasoby ADD CONSTRAINT FK_PZACzynnosc
 FOREIGN KEY
   (
                          PZA_Czynnosc                      
                         )
             REFERENCES CDN.ProdCzynnosci
                         (
                          PCZ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZasoby_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZasoby_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdZasoby_DeleteHandler
  ON CDN.ProdZasoby
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagSElem
    IF EXISTS
       ( SELECT * FROM CDN.MagSElem JOIN deleted
          ON
                deleted.PZA_ID = CDN.MagSElem.MaS_ZlcNumer
            
       AND (CDN.MagSElem.Mas_ZlcTyp=14346)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć. Z realizacji zlecenia wygenerowano dokumenty magazynowe (WM/PM)./# [ProdZasoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraSElem
    IF EXISTS
       ( SELECT * FROM CDN.TraSElem JOIN deleted
          ON
                deleted.PZA_ID = CDN.TraSElem.TrS_ZlcNumer
            
       AND (CDN.TraSElem.Trs_ZlcTyp=14346)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć. Z realizacji zlecenia wygenerowano dokumenty handlowe (RW/PW)./# [ProdZasoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdZasoby JOIN deleted
          ON
                deleted.PZA_ID = CDN.ProdZasoby.PZA_Zasob
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć. Półprodukt wykorzystano w innej operacji./# [ProdZasoby_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanyElementyProdukty
    IF EXISTS(SELECT * FROM CDN.PlanyElementyProdukty JOIN deleted
            ON 
          deleted.PZA_ID = CDN.PlanyElementyProdukty.PGP_ObiNumer
      AND (CDN.PlanyElementyProdukty.PGP_ObiTyp=14346)
            )
        DELETE CDN.PlanyElementyProdukty
        FROM CDN.PlanyElementyProdukty JOIN deleted
        ON 
          deleted.PZA_ID = CDN.PlanyElementyProdukty.PGP_ObiNumer
      AND (CDN.PlanyElementyProdukty.PGP_ObiTyp=14346)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdZwiazanePolprodukty
    IF EXISTS(SELECT * FROM CDN.ProdZwiazanePolprodukty JOIN deleted
            ON 
          deleted.PZA_ID = CDN.ProdZwiazanePolprodukty.PZP_PZAIDWykonany
            )
        DELETE CDN.ProdZwiazanePolprodukty
        FROM CDN.ProdZwiazanePolprodukty JOIN deleted
        ON 
          deleted.PZA_ID = CDN.ProdZwiazanePolprodukty.PZP_PZAIDWykonany
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdLinki
    IF EXISTS(SELECT * FROM CDN.ProdLinki JOIN deleted
            ON 
          deleted.PZA_ID = CDN.ProdLinki.PLK_ObiNumer
      AND (CDN.ProdLinki.PLK_ObiTyp=14346)
            )
        DELETE CDN.ProdLinki
        FROM CDN.ProdLinki JOIN deleted
        ON 
          deleted.PZA_ID = CDN.ProdLinki.PLK_ObiNumer
      AND (CDN.ProdLinki.PLK_ObiTyp=14346)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.PZA_ID = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_ObiTyp=14346)
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.PZA_ID = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_ObiTyp=14346)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PZA_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14346 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PZA_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14346 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PZA_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14346 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PZA_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14346 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PZA_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14346)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PZA_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14346)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElemO
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElemO JOIN deleted
            ON 
          deleted.PZA_ID = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_ObiTyp=14346)
            )
        DELETE CDN.ProdKosztyElemO
        FROM CDN.ProdKosztyElemO JOIN deleted
        ON 
          deleted.PZA_ID = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_ObiTyp=14346)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Rezerwacje
    IF EXISTS(SELECT * FROM CDN.Rezerwacje JOIN deleted
            ON 
          deleted.PZA_ID = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=14346)
            )
        DELETE CDN.Rezerwacje
        FROM CDN.Rezerwacje JOIN deleted
        ON 
          deleted.PZA_ID = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=14346)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZasoby_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZasoby_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdZasoby_InsertUpdateHandler
  ON CDN.ProdZasoby
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PZA_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.PZA_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PZA_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ProdZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZA_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZA_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PZA_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PZA_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZA_TechnologiaZasob ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologiaZasoby ON
                    inserted.PZA_TechnologiaZasob = CDN.ProdTechnologiaZasoby.PTZ_Id
              WHERE CDN.ProdTechnologiaZasoby.PTZ_Id IS NULL
                AND (
                          IsNull(inserted.PZA_TechnologiaZasob,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologiaZasoby) [ProdZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZA_RodzajUbocznego ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZA_RodzajUbocznego&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PZA_RodzajUbocznego = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.PZA_RodzajUbocznego&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZA_KodNiezgodnosci ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZA_KodNiezgodnosci&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.PZA_KodNiezgodnosci = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.PZA_KodNiezgodnosci&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ProdZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZA_PKJNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPKJNag ON
                    inserted.PZA_PKJNId = CDN.ProdPKJNag.PKJN_Id
              WHERE CDN.ProdPKJNag.PKJN_Id IS NULL
                AND (
                          IsNull(inserted.PZA_PKJNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPKJNag) [ProdZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZA_IdWzorcaNrPartii ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdWzorceNumerowPartii ON
                    inserted.PZA_IdWzorcaNrPartii = CDN.ProdWzorceNumerowPartii.WNP_Id
              WHERE CDN.ProdWzorceNumerowPartii.WNP_Id IS NULL
                AND (
                          IsNull(inserted.PZA_IdWzorcaNrPartii,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdWzorceNumerowPartii) [ProdZasoby_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZasobyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZasobyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdZasobyAlias_DeleteHandler
  ON CDN.ProdZasoby
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdZwiazanePolprodukty
    IF EXISTS(SELECT * FROM CDN.ProdZwiazanePolprodukty JOIN deleted
            ON 
          deleted.PZA_ID = CDN.ProdZwiazanePolprodukty.PZP_PZAIDPlanowany
            )
        DELETE CDN.ProdZwiazanePolprodukty
        FROM CDN.ProdZwiazanePolprodukty JOIN deleted
        ON 
          deleted.PZA_ID = CDN.ProdZwiazanePolprodukty.PZP_PZAIDPlanowany
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZasobyAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZasobyAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdZasobyAlias_InsertUpdateHandler
  ON CDN.ProdZasoby
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PZA_Zasob ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.PZA_Zasob = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL
                AND (
                          IsNull(inserted.PZA_Zasob,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [ProdZasobyAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PZEZlecenie"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PZEZlecenie */</I><BR>
ALTER TABLE CDN.ProdZlecElem ADD CONSTRAINT FK_PZEZlecenie
 FOREIGN KEY
   (
                          PZE_Zlecenie                      
                         )
             REFERENCES CDN.ProdZlecenia
                         (
                          PZL_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZlecElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZlecElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdZlecElem_DeleteHandler
  ON CDN.ProdZlecElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanyObciazeniaPozycje
    IF EXISTS(SELECT * FROM CDN.PlanyObciazeniaPozycje JOIN deleted
            ON 
          deleted.PZE_Id = CDN.PlanyObciazeniaPozycje.PPO_DokZrdNumer
      AND (CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp=14348)
            )
        DELETE CDN.PlanyObciazeniaPozycje
        FROM CDN.PlanyObciazeniaPozycje JOIN deleted
        ON 
          deleted.PZE_Id = CDN.PlanyObciazeniaPozycje.PPO_DokZrdNumer
      AND (CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp=14348)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.PZE_Id = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DoZ_DokTyp=14343)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.PZE_Id = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DoZ_DokTyp=14343)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.PZE_Id = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=14343)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.PZE_Id = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=14343)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKalkulacjaKosztu
    IF EXISTS(SELECT * FROM CDN.ProdKalkulacjaKosztu JOIN deleted
            ON 
          deleted.PZE_Id = CDN.ProdKalkulacjaKosztu.PKK_ObiNumer
      AND (CDN.ProdKalkulacjaKosztu.PKK_ObiTyp=14348)
            )
        DELETE CDN.ProdKalkulacjaKosztu
        FROM CDN.ProdKalkulacjaKosztu JOIN deleted
        ON 
          deleted.PZE_Id = CDN.ProdKalkulacjaKosztu.PKK_ObiNumer
      AND (CDN.ProdKalkulacjaKosztu.PKK_ObiTyp=14348)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PZE_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp IN(14343,14350) and CDN.Atrybuty.Atr_OBILp = 1)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PZE_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp IN(14343,14350) and CDN.Atrybuty.Atr_OBILp = 1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PZE_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14348 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PZE_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14348 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdRekomendacjeDokumenty
    IF EXISTS(SELECT * FROM CDN.ProdRekomendacjeDokumenty JOIN deleted
            ON 
          deleted.PZE_Id = CDN.ProdRekomendacjeDokumenty.PRED_DokLp
      AND (CDN.ProdRekomendacjeDokumenty.PRED_DokTyp=14343)
            )
        DELETE CDN.ProdRekomendacjeDokumenty
        FROM CDN.ProdRekomendacjeDokumenty JOIN deleted
        ON 
          deleted.PZE_Id = CDN.ProdRekomendacjeDokumenty.PRED_DokLp
      AND (CDN.ProdRekomendacjeDokumenty.PRED_DokTyp=14343)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdZwiazane
    IF EXISTS(SELECT * FROM CDN.ProdZwiazane JOIN deleted
            ON 
          deleted.PZE_Id = CDN.ProdZwiazane.PZW_DokNumer
      AND (CDN.ProdZwiazane.PZW_DokTyp=14348)
            )
        DELETE CDN.ProdZwiazane
        FROM CDN.ProdZwiazane JOIN deleted
        ON 
          deleted.PZE_Id = CDN.ProdZwiazane.PZW_DokNumer
      AND (CDN.ProdZwiazane.PZW_DokTyp=14348)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZlecElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZlecElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdZlecElem_InsertUpdateHandler
  ON CDN.ProdZlecElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PZE_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZE_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PZE_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PZE_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdZlecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZE_Technologia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdTechnologia ON
                    inserted.PZE_Technologia = CDN.ProdTechnologia.PTE_Id
              WHERE CDN.ProdTechnologia.PTE_Id IS NULL
                AND (
                          IsNull(inserted.PZE_Technologia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdTechnologia) [ProdZlecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PZE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PZE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ProdZlecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZE_KnDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZE_KnDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PZE_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PZE_KnDTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdZlecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZE_IdWzorcaNrPartii ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdWzorceNumerowPartii ON
                    inserted.PZE_IdWzorcaNrPartii = CDN.ProdWzorceNumerowPartii.WNP_Id
              WHERE CDN.ProdWzorceNumerowPartii.WNP_Id IS NULL
                AND (
                          IsNull(inserted.PZE_IdWzorcaNrPartii,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdWzorceNumerowPartii) [ProdZlecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZE_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.PZE_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PZE_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ProdZlecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZlecenia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZlecenia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdZlecenia_DeleteHandler
  ON CDN.ProdZlecenia
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPlanyProdukty
    IF EXISTS
       ( SELECT * FROM CDN.ProdPlanyProdukty JOIN deleted
          ON
                deleted.PZL_Id = CDN.ProdPlanyProdukty.PPP_DokZrdNumer
       AND (CDN.ProdPlanyProdukty.PPP_DokZrdTyp = 14343)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPlanyProdukty) [ProdZlecenia_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdPlanyDokumenty
    IF EXISTS(SELECT * FROM CDN.ProdPlanyDokumenty JOIN deleted
            ON 
          deleted.PZL_Id = CDN.ProdPlanyDokumenty.PPD_DokNumer
      AND (CDN.ProdPlanyDokumenty.PPD_DokTyp=14343)
            )
        DELETE CDN.ProdPlanyDokumenty
        FROM CDN.ProdPlanyDokumenty JOIN deleted
        ON 
          deleted.PZL_Id = CDN.ProdPlanyDokumenty.PPD_DokNumer
      AND (CDN.ProdPlanyDokumenty.PPD_DokTyp=14343)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.PZL_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (14343,     14350))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.PZL_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (14343,     14350))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.PZL_Id = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=14343 or CDN.ProdKosztyElem.PKE_OBITyp=4592)
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.PZL_Id = CDN.ProdKosztyElem.PKE_ObiNumer
      AND (CDN.ProdKosztyElem.PKE_OBITyp=14343 or CDN.ProdKosztyElem.PKE_OBITyp=4592)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BstDokumenty
    IF EXISTS(SELECT * FROM CDN.BstDokumenty JOIN deleted
            ON 
          deleted.PZL_Id = CDN.BstDokumenty.BsD_DokNumer
      AND (CDN.BstDokumenty.BsD_DokTyp=14343)
            )
        DELETE CDN.BstDokumenty
        FROM CDN.BstDokumenty JOIN deleted
        ON 
          deleted.PZL_Id = CDN.BstDokumenty.BsD_DokNumer
      AND (CDN.BstDokumenty.BsD_DokTyp=14343)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PZL_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14343)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PZL_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14343)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PZL_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14343 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PZL_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=14343 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdProcesy
    IF EXISTS(SELECT * FROM CDN.ProdProcesy JOIN deleted
            ON 
          deleted.PZL_Id = CDN.ProdProcesy.PPC_Zlecenie
            )
        DELETE CDN.ProdProcesy
        FROM CDN.ProdProcesy JOIN deleted
        ON 
          deleted.PZL_Id = CDN.ProdProcesy.PPC_Zlecenie
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.PZL_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14343 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.PZL_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=14343 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdDoPrzeliczenia
    IF EXISTS(SELECT * FROM CDN.ProdDoPrzeliczenia JOIN deleted
            ON 
          deleted.PZL_Id = CDN.ProdDoPrzeliczenia.PDL_GIDNumer
      AND (CDN.ProdDoPrzeliczenia.PDL_GIDTyp = 14343)
            )
        DELETE CDN.ProdDoPrzeliczenia
        FROM CDN.ProdDoPrzeliczenia JOIN deleted
        ON 
          deleted.PZL_Id = CDN.ProdDoPrzeliczenia.PDL_GIDNumer
      AND (CDN.ProdDoPrzeliczenia.PDL_GIDTyp = 14343)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_Procesy
    IF EXISTS(SELECT * FROM CDN.WF_Procesy JOIN deleted
            ON 
          deleted.PZL_Id = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (14343,14350))
            )
        DELETE CDN.WF_Procesy
        FROM CDN.WF_Procesy JOIN deleted
        ON 
          deleted.PZL_Id = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (14343,14350))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdZwiazane
    IF EXISTS(SELECT * FROM CDN.ProdZwiazane JOIN deleted
            ON 
          deleted.PZL_Id = CDN.ProdZwiazane.PZW_ZrdNumer
      AND (CDN.ProdZwiazane.PZW_ZrdTyp=14343)
            )
        DELETE CDN.ProdZwiazane
        FROM CDN.ProdZwiazane JOIN deleted
        ON 
          deleted.PZL_Id = CDN.ProdZwiazane.PZW_ZrdNumer
      AND (CDN.ProdZwiazane.PZW_ZrdTyp=14343)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElemO
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElemO JOIN deleted
            ON 
          deleted.PZL_Id = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_OBITyp=14343 or CDN.ProdKosztyElemO.PKEO_OBITyp=4592)
            )
        DELETE CDN.ProdKosztyElemO
        FROM CDN.ProdKosztyElemO JOIN deleted
        ON 
          deleted.PZL_Id = CDN.ProdKosztyElemO.PKEO_ObiNumer
      AND (CDN.ProdKosztyElemO.PKEO_OBITyp=14343 or CDN.ProdKosztyElemO.PKEO_OBITyp=4592)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZlecenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZlecenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdZlecenia_InsertUpdateHandler
  ON CDN.ProdZlecenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PZL_OpWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PZL_OpWNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PZL_OpWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdZlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZL_Projekt ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.PZL_Projekt = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.PZL_Projekt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [ProdZlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZL_Oddzial ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PZL_Oddzial = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.PZL_Oddzial,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ProdZlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZL_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZL_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PZL_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PZL_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdZlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZL_KnDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZL_KnDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.PZL_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.PZL_KnDTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ProdZlecenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PZZPCZId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PZZPCZId */</I><BR>
ALTER TABLE CDN.ProdZleceniaZabiegi ADD CONSTRAINT FK_PZZPCZId
 FOREIGN KEY
   (
                          PZZ_PczId                         
                         )
             REFERENCES CDN.ProdCzynnosci
                         (
                          PCZ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZleceniaZabiegi_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZleceniaZabiegi_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProdZleceniaZabiegi_DeleteHandler
  ON CDN.ProdZleceniaZabiegi
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.PZZ_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14357)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.PZZ_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=14357)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZleceniaZabiegi_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZleceniaZabiegi_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdZleceniaZabiegi_InsertUpdateHandler
  ON CDN.ProdZleceniaZabiegi
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PZZ_OpeW ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.PZZ_OpeW = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.PZZ_OpeW,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ProdZleceniaZabiegi_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PZGPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PZGPrimary */</I><BR>
ALTER TABLE CDN.ProdZmianyGantta ADD CONSTRAINT FK_PZGPrimary
 FOREIGN KEY
   (
                          PZG_FRSId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PZNPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PZNPrimary */</I><BR>
ALTER TABLE CDN.ProdZuzycieNarzedzia ADD CONSTRAINT FK_PZNPrimary
 FOREIGN KEY
   (
                          PZN_POBId                         
                         )
             REFERENCES CDN.ProdObiekty
                         (
                          POB_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZwiazane_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZwiazane_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdZwiazane_InsertUpdateHandler
  ON CDN.ProdZwiazane
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PZW_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZW_ZrdTyp=14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.PZW_ZrdNumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.PZW_ZrdTyp=14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [ProdZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZW_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZW_DokTyp=14348)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecElem ON
                    inserted.PZW_DokNumer = CDN.ProdZlecElem.PZE_Id
              WHERE CDN.ProdZlecElem.PZE_Id IS NULL AND (inserted.PZW_DokTyp=14348)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecElem) [ProdZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZW_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZW_DokTyp IN(1616,1624))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.PZW_DokNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.PZW_DokTyp IN(1616,1624))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [ProdZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZW_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZW_ZrdTyp=14336)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdOkresy ON
                    inserted.PZW_ZrdNumer = CDN.ProdOkresy.POK_Id
              WHERE CDN.ProdOkresy.POK_Id IS NULL AND (inserted.PZW_ZrdTyp=14336)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdOkresy) [ProdZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZW_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PZW_DokTyp=4700)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.PZW_DokNumer = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL AND (inserted.PZW_DokTyp=4700)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [ProdZwiazane_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProdZwiazanePolprodukty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProdZwiazanePolprodukty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProdZwiazanePolprodukty_InsertUpdateHandler
  ON CDN.ProdZwiazanePolprodukty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PZP_PZAIDPlanowany ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.PZP_PZAIDPlanowany = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL
                AND (
                          IsNull(inserted.PZP_PZAIDPlanowany,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [ProdZwiazanePolprodukty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PZP_PZAIDWykonany ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.PZP_PZAIDWykonany = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL
                AND (
                          IsNull(inserted.PZP_PZAIDWykonany,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [ProdZwiazanePolprodukty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProgiIloscAp_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProgiIloscAp_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProgiIloscAp_DeleteHandler
  ON CDN.ProgiIloscAp
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Tlumaczenia
    IF EXISTS(SELECT * FROM CDN.Tlumaczenia JOIN deleted
            ON 
          deleted.PIA_Id = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ=5057)
            )
        DELETE CDN.Tlumaczenia
        FROM CDN.Tlumaczenia JOIN deleted
        ON 
          deleted.PIA_Id = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ=5057)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProgiIloscAp_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProgiIloscAp_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProgiIloscAp_InsertUpdateHandler
  ON CDN.ProgiIloscAp
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PIA_ObiNumer )  OR UPDATE( PIA_ObiTyp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.PIA_ObiNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.PIA_ObiTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (EXISTS(SELECT * FROM CDN.TwrGrupyDom where TGD_GIDTyp=CDN.TwrGrupy.TwG_GIDTyp AND TGD_GIDNumer = CDN.TwrGrupy.TwG_GIDNumer AND TGD_GrOTyp = CDN.TwrGrupy.TwG_GrOTyp AND TGD_GrONumer = CDN.TwrGrupy.TwG_GrONumer))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [ProgiIloscAp_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRPPrm"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRPPrm */</I><BR>
ALTER TABLE CDN.ProgiPromocje ADD CONSTRAINT FK_PRPPrm
 FOREIGN KEY
   (
                          PRP_PrmID                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProgiPromocje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProgiPromocje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProgiPromocje_DeleteHandler
  ON CDN.ProgiPromocje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.GratisyPromocje
    IF EXISTS(SELECT * FROM CDN.GratisyPromocje JOIN deleted
            ON 
          deleted.PRP_ID = CDN.GratisyPromocje.GPR_PrPID
            )
        DELETE CDN.GratisyPromocje
        FROM CDN.GratisyPromocje JOIN deleted
        ON 
          deleted.PRP_ID = CDN.GratisyPromocje.GPR_PrPID
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PTPProgiPromocje"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PTPProgiPromocje */</I><BR>
ALTER TABLE CDN.ProgiTwrPromocje ADD CONSTRAINT FK_PTPProgiPromocje
 FOREIGN KEY
   (
                          PTP_PRPId                         
                         )
             REFERENCES CDN.ProgiPromocje
                         (
                          PRP_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProgiTwrPromocje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProgiTwrPromocje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ProgiTwrPromocje_InsertUpdateHandler
  ON CDN.ProgiTwrPromocje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PTP_TPRId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PTP_TprId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrPromocje ON
                    inserted.PTP_TPRId = CDN.TwrPromocje.TPR_Id
              WHERE CDN.TwrPromocje.TPR_Id IS NULL AND (inserted.PTP_TprId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrPromocje) [ProgiTwrPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PRLEPrln"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PRLEPrln */</I><BR>
ALTER TABLE CDN.ProlongElem ADD CONSTRAINT FK_PRLEPrln
 FOREIGN KEY
   (
                          PRLE_PrlnId                        
                         )
             REFERENCES CDN.ProlongNag
                         (
                          PRLN_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ProlongNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ProlongNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ProlongNag_DeleteHandler
  ON CDN.ProlongNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.PRLN_ID = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (7942,7943))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.PRLN_ID = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (7942,7943))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPXPrzelewyElem"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPXPrzelewyElem */</I><BR>
ALTER TABLE CDN.Przelewy ADD CONSTRAINT FK_PPXPrzelewyElem
 FOREIGN KEY
   (
                          PPX_PPNID                         ,
                          PPX_PPELp                         
                         )
             REFERENCES CDN.PrzelewyElem
                         (
                          PPE_PPNID                         ,
                          PPE_PPELp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPXTRP"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPXTRP */</I><BR>
ALTER TABLE CDN.Przelewy ADD CONSTRAINT FK_PPXTRP
 FOREIGN KEY
   (
                          PPX_TRPTyp                        ,
                          PPX_TRPNumer                      ,
                          PPX_TRPLp                         
                         )
             REFERENCES CDN.TraPlat
                         (
                          TrP_GIDTyp   ,
                          TrP_GIDNumer   ,
                          TrP_GIDLp   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPAOpeNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPAOpeNumer */</I><BR>
ALTER TABLE CDN.PrzelewyAutoryzacje ADD CONSTRAINT FK_PPAOpeNumer
 FOREIGN KEY
   (
                          PPA_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPAPPNID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPAPPNID */</I><BR>
ALTER TABLE CDN.PrzelewyAutoryzacje ADD CONSTRAINT FK_PPAPPNID
 FOREIGN KEY
   (
                          PPA_PPNID                         
                         )
             REFERENCES CDN.PrzelewyNag
                         (
                          PPN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPEPrimary */</I><BR>
ALTER TABLE CDN.PrzelewyElem ADD CONSTRAINT FK_PPEPrimary
 FOREIGN KEY
   (
                          PPE_PPNID                         
                         )
             REFERENCES CDN.PrzelewyNag
                         (
                          PPN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPEModyfOpe"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPEModyfOpe */</I><BR>
ALTER TABLE CDN.PrzelewyElem ADD CONSTRAINT FK_PPEModyfOpe
 FOREIGN KEY
   (
                          PPE_ModyfOpeNumer                 
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPNNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPNNumer */</I><BR>
ALTER TABLE CDN.PrzelewyNag ADD CONSTRAINT FK_PPNNumer
 FOREIGN KEY
   (
                          PPN_Rejestr                       
                         )
             REFERENCES CDN.Rejestry
                         (
                          KAR_Seria                         
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PrzelewyNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PrzelewyNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.PrzelewyNag_DeleteHandler
  ON CDN.PrzelewyNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_Procesy
    IF EXISTS(SELECT * FROM CDN.WF_Procesy JOIN deleted
            ON 
          deleted.PPN_ID = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp = 880)
            )
        DELETE CDN.WF_Procesy
        FROM CDN.WF_Procesy JOIN deleted
        ON 
          deleted.PPN_ID = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp = 880)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.PPN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_ObiTyp=880 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.PPN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_ObiTyp=880 and CDN.Atrybuty.Atr_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PPNPPPNID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PPNPPPNID */</I><BR>
ALTER TABLE CDN.PrzelewyNagPodpisy ADD CONSTRAINT FK_PPNPPPNID
 FOREIGN KEY
   (
                          PPNP_PPNID                         
                         )
             REFERENCES CDN.PrzelewyNag
                         (
                          PPN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PsePrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PsePrimary */</I><BR>
ALTER TABLE CDN.PrzeszacElem ADD CONSTRAINT FK_PsePrimary
 FOREIGN KEY
   (
                          PSE_GIDNumer                      
                         )
             REFERENCES CDN.PrzeszacNag
                         (
                          PSN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="PunktyKonfig_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* PunktyKonfig_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.PunktyKonfig_InsertUpdateHandler
  ON CDN.PunktyKonfig
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( PuK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PuK_ObiTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.PuK_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.PuK_ObiTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [PunktyKonfig_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PuK_ObiTyp )  OR UPDATE( PuK_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PuK_ObiTyp=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzorce ON
                    inserted.PuK_ObiTyp = CDN.TwrWzorce.TwW_GrpTyp
                AND inserted.PuK_ObiNumer = CDN.TwrWzorce.TwW_GrpNumer
              WHERE CDN.TwrWzorce.TwW_GrpNumer IS NULL AND (inserted.PuK_ObiTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzorce) [PunktyKonfig_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( PuK_ObiNumer )  OR UPDATE( PuK_ObiTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.PuK_ObiTyp=-4272)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.PuK_ObiNumer = CDN.FrmStruktura.FRS_GIDNumer
                AND inserted.PuK_ObiTyp = CDN.FrmStruktura.FRS_GIDTyp
              WHERE CDN.FrmStruktura.FRS_GIDTyp IS NULL AND (inserted.PuK_ObiTyp=-4272)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [PunktyKonfig_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PanPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PanPrimary */</I><BR>
ALTER TABLE CDN.PytaniaAnkiety ADD CONSTRAINT FK_PanPrimary
 FOREIGN KEY
   (
                          PAN_AntId                         
                         )
             REFERENCES CDN.Ankiety
                         (
                          ANT_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PYZPytanie"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PYZPytanie */</I><BR>
ALTER TABLE CDN.PytaniaZadania ADD CONSTRAINT FK_PYZPytanie
 FOREIGN KEY
   (
                          PYZ_PytId                         
                         )
             REFERENCES CDN.Pytania
                         (
                          PYT_Id                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_PyzPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_PyzPrimary */</I><BR>
ALTER TABLE CDN.PytaniaZadania ADD CONSTRAINT FK_PyzPrimary
 FOREIGN KEY
   (
                          PYZ_ZadId                         
                         )
             REFERENCES CDN.Zadania
                         (
                          Zad_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RcKRcZOpis"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RcKRcZOpis */</I><BR>
ALTER TABLE CDN.RCPKorekty ADD CONSTRAINT FK_RcKRcZOpis
 FOREIGN KEY
   (
                          RcK_RcZRcOId                      
                         )
             REFERENCES CDN.RCPOpisy
                         (
                          RcO_Id                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RcKZapis"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RcKZapis */</I><BR>
ALTER TABLE CDN.RCPKorekty ADD CONSTRAINT FK_RcKZapis
 FOREIGN KEY
   (
                          RcK_RcZId                         
                         )
             REFERENCES CDN.RCPZapisy
                         (
                          RcZ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RcNOpis"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RcNOpis */</I><BR>
ALTER TABLE CDN.RCPNorma ADD CONSTRAINT FK_RcNOpis
 FOREIGN KEY
   (
                          RcN_RcOId                         
                         )
             REFERENCES CDN.RCPOpisy
                         (
                          RcO_Id                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RcZPracownik"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RcZPracownik */</I><BR>
ALTER TABLE CDN.RCPZapisy ADD CONSTRAINT FK_RcZPracownik
 FOREIGN KEY
   (
                          RcZ_PrcNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RcZOpis"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RcZOpis */</I><BR>
ALTER TABLE CDN.RCPZapisy ADD CONSTRAINT FK_RcZOpis
 FOREIGN KEY
   (
                          RcZ_RcOId                         
                         )
             REFERENCES CDN.RCPOpisy
                         (
                          RcO_Id                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RZEPracownik"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RZEPracownik */</I><BR>
ALTER TABLE CDN.RCPZatwElem ADD CONSTRAINT FK_RZEPracownik
 FOREIGN KEY
   (
                          RZE_PrcNumer                      
                         )
             REFERENCES CDN.PrcKarty
                         (
                          Prc_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RZERZNId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RZERZNId */</I><BR>
ALTER TABLE CDN.RCPZatwElem ADD CONSTRAINT FK_RZERZNId
 FOREIGN KEY
   (
                          RZE_RZNId                         
                         )
             REFERENCES CDN.RCPZatwNag
                         (
                          RZN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RachunkiBankowe_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RachunkiBankowe_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.RachunkiBankowe_DeleteHandler
  ON CDN.RachunkiBankowe
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraPlat
    IF EXISTS
       ( SELECT * FROM CDN.TraPlat JOIN deleted
          ON
                deleted.RkB_Id = CDN.TraPlat.TrP_RachBank
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć numeru rachunku, który jest juz powiązany z płatnościami./# [RachunkiBankowe_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.RkB_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp =1648  and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.RkB_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp =1648  and CDN.Atrybuty.Atr_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RachunkiBankowe_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RachunkiBankowe_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RachunkiBankowe_InsertUpdateHandler
  ON CDN.RachunkiBankowe
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RkB_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RkB_ObiTyp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.RkB_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.RkB_ObiTyp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [RachunkiBankowe_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RkB_BnkNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RkB_BnkTyp = 48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.RkB_BnkNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.RkB_BnkTyp = 48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [RachunkiBankowe_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RkB_KntAdres ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.RkB_KntAdres = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.RkB_KntAdres,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [RachunkiBankowe_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RkB_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RkB_ObiTyp = 944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.RkB_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.RkB_ObiTyp = 944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [RachunkiBankowe_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RkB_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RkB_ObiTyp = 4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.RkB_ObiNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.RkB_ObiTyp = 4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [RachunkiBankowe_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RBVRkb"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RBVRkb */</I><BR>
ALTER TABLE CDN.RachunkiBankoweVat ADD CONSTRAINT FK_RBVRkb
 FOREIGN KEY
   (
                          RBV_RkbId                         
                         )
             REFERENCES CDN.RachunkiBankowe
                         (
                          RkB_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KRPSeria"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KRPSeria */</I><BR>
ALTER TABLE CDN.Raporty ADD CONSTRAINT FK_KRPSeria
 FOREIGN KEY
   (
                          KRP_Seria                         
                         )
             REFERENCES CDN.Rejestry
                         (
                          KAR_Seria                         
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Raporty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Raporty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Raporty_DeleteHandler
  ON CDN.Raporty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Zapisy
    IF EXISTS
       ( SELECT * FROM CDN.Zapisy JOIN deleted
          ON
                deleted.KRP_GIDNumer = CDN.Zapisy.KAZ_KRPNumer
       AND (CDN.Zapisy.KAZ_KRPTyp=800)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Zapisy) [Raporty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.KRP_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp in (800))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.KRP_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp in (800))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ReEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ReEPrimary */</I><BR>
ALTER TABLE CDN.RecElem ADD CONSTRAINT FK_ReEPrimary
 FOREIGN KEY
   (
                          ReE_GIDNumer                      
                         )
             REFERENCES CDN.RecNag
                         (
                          ReN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RecElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RecElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.RecElem_DeleteHandler
  ON CDN.RecElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ReE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ReE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=112 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ReE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ReE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp=112 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ReE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ReE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=112 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ReE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ReE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp=112 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RecElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RecElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RecElem_InsertUpdateHandler
  ON CDN.RecElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ReE_MagProdId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.ReE_MagProdId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.ReE_MagProdId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [RecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ReE_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ReE_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ReE_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [RecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ReE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.ReE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ReE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [RecElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ReNTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ReNTowar */</I><BR>
ALTER TABLE CDN.RecNag ADD CONSTRAINT FK_ReNTowar
 FOREIGN KEY
   (
                          ReN_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RecNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RecNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.RecNag_DeleteHandler
  ON CDN.RecNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamElem
    IF EXISTS
       ( SELECT * FROM CDN.ZamElem JOIN deleted
          ON
                deleted.ReN_GIDNumer = CDN.ZamElem.ZaE_ReNNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamElem) [RecNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ReN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=112 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ReN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=112 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ReN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=112 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ReN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=112 and CDN.AtrybutyHist.Ath_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RecNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RecNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RecNag_InsertUpdateHandler
  ON CDN.RecNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ReN_MagProdId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.ReN_MagProdId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.ReN_MagProdId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [RecNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ReN_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ReN_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ReN_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [RecNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RPrTPR"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RPrTPR */</I><BR>
ALTER TABLE CDN.RefPromocje ADD CONSTRAINT FK_RPrTPR
 FOREIGN KEY
   (
                          RPr_TPRID                         
                         )
             REFERENCES CDN.TwrPromocje
                         (
                          TPR_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RNTelOperator"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RNTelOperator */</I><BR>
ALTER TABLE CDN.RegulyNormTel ADD CONSTRAINT FK_RNTelOperator
 FOREIGN KEY
   (
                          RNTel_OpTelOrgID                    
                         )
             REFERENCES CDN.OperatorTel
                         (
                          OPTel_OrgID                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KROOperacja"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KROOperacja */</I><BR>
ALTER TABLE CDN.RejOp ADD CONSTRAINT FK_KROOperacja
 FOREIGN KEY
   (
                          KRO_KAONumer                      ,
                          KRO_KAOLp                         
                         )
             REFERENCES CDN.Operacje
                         (
                          KAO_GIDNumer                      ,
                          KAO_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KRORejestr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KRORejestr */</I><BR>
ALTER TABLE CDN.RejOp ADD CONSTRAINT FK_KRORejestr
 FOREIGN KEY
   (
                          KRO_KARNumer                      
                         )
             REFERENCES CDN.Rejestry
                         (
                          KAR_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Rejestry_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Rejestry_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Rejestry_DeleteHandler
  ON CDN.Rejestry
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.KAR_GIDNumer = CDN.FrmStruktura.FRS_KaRNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [Rejestry_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.KAR_GIDNumer = CDN.KntKarty.Knt_KarNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [Rejestry_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntWzorce
    IF EXISTS
       ( SELECT * FROM CDN.KntWzorce JOIN deleted
          ON
                deleted.KAR_GIDNumer = CDN.KntWzorce.KnW_KarNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntWzorce) [Rejestry_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Zapisy
    IF EXISTS
       ( SELECT * FROM CDN.Zapisy JOIN deleted
          ON
                deleted.KAR_GIDNumer = CDN.Zapisy.KAZ_KRPNumer
       AND (CDN.Zapisy.KAZ_KRPTyp=752)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Zapisy) [Rejestry_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Firma
    IF EXISTS
       ( SELECT * FROM CDN.Firma JOIN deleted
          ON
                deleted.KAR_GIDNumer = CDN.Firma.Frm_KARNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Firma) [Rejestry_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraPlat
    IF EXISTS
       ( SELECT * FROM CDN.TraPlat JOIN deleted
          ON
                deleted.KAR_GIDNumer = CDN.TraPlat.TrP_KARNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraPlat) [Rejestry_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntRejestr
    IF EXISTS
       ( SELECT * FROM CDN.KntRejestr JOIN deleted
          ON
                deleted.KAR_GIDNumer = CDN.KntRejestr.KRj_KarNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntRejestr) [Rejestry_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoStanowiskaFormyPl
    IF EXISTS
       ( SELECT * FROM CDN.PicoStanowiskaFormyPl JOIN deleted
          ON
                deleted.KAR_GIDNumer = CDN.PicoStanowiskaFormyPl.PFP_KARNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PicoStanowiskaFormyPl) [Rejestry_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrmObiekty
    IF EXISTS(SELECT * FROM CDN.FrmObiekty JOIN deleted
            ON 
          deleted.KAR_GIDNumer = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=752)
            )
        DELETE CDN.FrmObiekty
        FROM CDN.FrmObiekty JOIN deleted
        ON 
          deleted.KAR_GIDNumer = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=752)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Rejestry_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Rejestry_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Rejestry_InsertUpdateHandler
  ON CDN.Rejestry
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KAR_BNKNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.KAR_BNKNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KAR_BNKNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [Rejestry_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RDWWaluta"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RDWWaluta */</I><BR>
ALTER TABLE CDN.RejestryDomyslne ADD CONSTRAINT FK_RDWWaluta
 FOREIGN KEY
   (
                          RDW_WanID                         
                         )
             REFERENCES CDN.WalNag
                         (
                          WaN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RDWRejestr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RDWRejestr */</I><BR>
ALTER TABLE CDN.RejestryDomyslne ADD CONSTRAINT FK_RDWRejestr
 FOREIGN KEY
   (
                          RDW_KarNumer                      
                         )
             REFERENCES CDN.Rejestry
                         (
                          KAR_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RDWStruktura"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RDWStruktura */</I><BR>
ALTER TABLE CDN.RejestryDomyslne ADD CONSTRAINT FK_RDWStruktura
 FOREIGN KEY
   (
                          RDW_FrsID                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RejestryDomyslne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RejestryDomyslne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RejestryDomyslne_InsertUpdateHandler
  ON CDN.RejestryDomyslne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RDW_KarNumer )  OR UPDATE( RDW_FrsID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmObiekty ON
                    inserted.RDW_KarNumer = CDN.FrmObiekty.FRO_GIDNumer
                AND inserted.RDW_FrsID = CDN.FrmObiekty.FRO_FRMID
              WHERE CDN.FrmObiekty.FRO_FRMID IS NULL AND (CDN.FrmObiekty.Fro_GIDTyp=752)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmObiekty) [RejestryDomyslne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KRHPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KRHPrimary */</I><BR>
ALTER TABLE CDN.RejestryHistoria ADD CONSTRAINT FK_KRHPrimary
 FOREIGN KEY
   (
                          KRH_KARNumer                      
                         )
             REFERENCES CDN.Rejestry
                         (
                          KAR_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Rejony_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Rejony_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Rejony_DeleteHandler
  ON CDN.Rejony
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.REJ_Id = CDN.KntKarty.Knt_RegionCRM
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć rejonu, jest powiązany z kartą kontrahenta./# [Rejony_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntOpiekun
    IF EXISTS(SELECT * FROM CDN.KntOpiekun JOIN deleted
            ON 
          deleted.REJ_Id = CDN.KntOpiekun.KtO_KntNumer
      AND (CDN.KntOpiekun.KtO_KntTyp=948)
            )
        DELETE CDN.KntOpiekun
        FROM CDN.KntOpiekun JOIN deleted
        ON 
          deleted.REJ_Id = CDN.KntOpiekun.KtO_KntNumer
      AND (CDN.KntOpiekun.KtO_KntTyp=948)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RleRlnId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RleRlnId */</I><BR>
ALTER TABLE CDN.ReklElem ADD CONSTRAINT FK_RleRlnId
 FOREIGN KEY
   (
                          RLE_RLNId                         
                         )
             REFERENCES CDN.ReklNag
                         (
                          RLN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ReklElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ReklElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ReklElem_DeleteHandler
  ON CDN.ReklElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.RLE_Id = CDN.CRMDokumentyPozycje.CDP_DokLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp in (3584,3585))
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.RLE_Id = CDN.CRMDokumentyPozycje.CDP_DokLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp in (3584,3585))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.RLE_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (3584,3585) and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 3586)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.RLE_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (3584,3585) and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 3586)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.RLE_Id = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp=3586 and  CDN.WysRelacje.WyR_DokLp=0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.RLE_Id = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp=3586 and  CDN.WysRelacje.WyR_DokLp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ReklElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ReklElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ReklElem_InsertUpdateHandler
  ON CDN.ReklElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RLE_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.RLE_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.RLE_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ReklElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RLE_Zadanie ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.RLE_Zadanie = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.RLE_Zadanie,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ReklElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RLE_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RLE_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.RLE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.RLE_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ReklElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RLE_POBId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.RLE_POBId = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL
                AND (
                          IsNull(inserted.RLE_POBId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [ReklElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RLE_SrtId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.RLE_SrtId = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.RLE_SrtId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [ReklElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ReklNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ReklNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ReklNag_DeleteHandler
  ON CDN.ReklNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.RLN_Id = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp in (3584,3585) and  CDN.WysRelacje.WyR_DokLp=0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.RLN_Id = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp in (3584,3585) and  CDN.WysRelacje.WyR_DokLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.RLN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (3584,3585) and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.RLN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (3584,3585) and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.RLN_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (3584,3585))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.RLN_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (3584,3585))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.RLN_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (3584,3585))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.RLN_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (3584,3585))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ReklNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ReklNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ReklNag_InsertUpdateHandler
  ON CDN.ReklNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RLN_KntNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.RLN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.RLN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ReklNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RLN_KnDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.RLN_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.RLN_KnDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ReklNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RLN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.RLN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.RLN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [ReklNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ReklOperacjeDef_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ReklOperacjeDef_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ReklOperacjeDef_DeleteHandler
  ON CDN.ReklOperacjeDef
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklRealizacja
    IF EXISTS
       ( SELECT * FROM CDN.ReklRealizacja JOIN deleted
          ON
                deleted.ROD_Id = CDN.ReklRealizacja.RLR_RODId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ReklRealizacja) [ReklOperacjeDef_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RlrRleId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RlrRleId */</I><BR>
ALTER TABLE CDN.ReklRealizacja ADD CONSTRAINT FK_RlrRleId
 FOREIGN KEY
   (
                          RLR_RLEId                         
                         )
             REFERENCES CDN.ReklElem
                         (
                          RLE_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ReklRealizacja_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ReklRealizacja_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ReklRealizacja_DeleteHandler
  ON CDN.ReklRealizacja
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.RLR_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (3584,3585) and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 3587)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.RLR_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (3584,3585) and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 3587)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ReklRealizacja_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ReklRealizacja_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ReklRealizacja_InsertUpdateHandler
  ON CDN.ReklRealizacja
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RLR_RODId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklOperacjeDef ON
                    inserted.RLR_RODId = CDN.ReklOperacjeDef.ROD_Id
              WHERE CDN.ReklOperacjeDef.ROD_Id IS NULL
                AND (
                          IsNull(inserted.RLR_RODId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklOperacjeDef) [ReklRealizacja_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RlSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RlSPrimary */</I><BR>
ALTER TABLE CDN.ReklSElem ADD CONSTRAINT FK_RlSPrimary
 FOREIGN KEY
   (
                          RLS_RLEId                         
                         )
             REFERENCES CDN.ReklElem
                         (
                          RLE_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RelTraImp_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RelTraImp_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RelTraImp_InsertUpdateHandler
  ON CDN.RelTraImp
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RTI_ZrdTyp )  OR UPDATE( RTI_ZrdNumer )  OR UPDATE( RTI_ZrdLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RTI_ZrdTyp in (1490, 1498))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.RTI_ZrdTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.RTI_ZrdNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.RTI_ZrdLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.RTI_ZrdTyp in (1490, 1498))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [RelTraImp_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RTI_ZrdTyp )  OR UPDATE( RTI_ZrdNumer )  OR UPDATE( RTI_ZrdLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RTI_ZrdTyp in (3344, 3352))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpElem ON
                    inserted.RTI_ZrdTyp = CDN.ImpElem.ImE_GIDTyp
                AND inserted.RTI_ZrdNumer = CDN.ImpElem.ImE_GIDNumer
                AND inserted.RTI_ZrdLp = CDN.ImpElem.ImE_GIDLp
              WHERE CDN.ImpElem.ImE_GIDLp IS NULL AND (inserted.RTI_ZrdTyp in (3344, 3352))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpElem) [RelTraImp_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RelTraImpAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RelTraImpAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RelTraImpAlias_InsertUpdateHandler
  ON CDN.RelTraImp
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RTI_DocTyp )  OR UPDATE( RTI_DocNumer )  OR UPDATE( RTI_DocLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RTI_DocTyp in (3344, 3352))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpElem ON
                    inserted.RTI_DocTyp = CDN.ImpElem.ImE_GIDTyp
                AND inserted.RTI_DocNumer = CDN.ImpElem.ImE_GIDNumer
                AND inserted.RTI_DocLp = CDN.ImpElem.ImE_GIDLp
              WHERE CDN.ImpElem.ImE_GIDLp IS NULL AND (inserted.RTI_DocTyp in (3344, 3352))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpElem) [RelTraImpAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RTI_DocTyp )  OR UPDATE( RTI_DocNumer )  OR UPDATE( RTI_DocLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RTI_DocTyp in (1490, 1498))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.RTI_DocTyp = CDN.TraElem.TrE_GIDTyp
                AND inserted.RTI_DocNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.RTI_DocLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.RTI_DocTyp in (1490, 1498))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [RelTraImpAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RtFPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RtFPrimary */</I><BR>
ALTER TABLE CDN.RetroFrs ADD CONSTRAINT FK_RtFPrimary
 FOREIGN KEY
   (
                          RtF_RtKId                         
                         )
             REFERENCES CDN.RetroKarty
                         (
                          RtK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RtFFrs"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RtFFrs */</I><BR>
ALTER TABLE CDN.RetroFrs ADD CONSTRAINT FK_RtFFrs
 FOREIGN KEY
   (
                          RtF_FrSId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RetroKarty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RetroKarty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RetroKarty_InsertUpdateHandler
  ON CDN.RetroKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RtK_TypID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.RtK_TypID = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.RtK_TypID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [RetroKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RKOKnt"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RKOKnt */</I><BR>
ALTER TABLE CDN.RetroKntOkresy ADD CONSTRAINT FK_RKOKnt
 FOREIGN KEY
   (
                          RKO_KntNumer                      ,
                          RKO_KntTyp                        ,
                          RKO_RtKId                         
                         )
             REFERENCES CDN.RetroKontrahenci
                         (
                          RKt_KntNumer                      ,
                          RKt_KntTyp                        ,
                          RKt_RtKId                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RetroKntOkresy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RetroKntOkresy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RetroKntOkresy_InsertUpdateHandler
  ON CDN.RetroKntOkresy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RKO_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RKO_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.RKO_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.RKO_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [RetroKntOkresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RKO_KntNumer )  OR UPDATE( RKO_KntTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RKO_KntTyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntGrupy ON
                    inserted.RKO_KntNumer = CDN.KntGrupy.KnG_GIDTyp
                AND inserted.RKO_KntTyp = CDN.KntGrupy.KnG_GIDNumer
              WHERE CDN.KntGrupy.KnG_GIDNumer IS NULL AND (inserted.RKO_KntTyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntGrupy) [RetroKntOkresy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RKtRtK"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RKtRtK */</I><BR>
ALTER TABLE CDN.RetroKontrahenci ADD CONSTRAINT FK_RKtRtK
 FOREIGN KEY
   (
                          RKt_RtKId                         
                         )
             REFERENCES CDN.RetroKarty
                         (
                          RtK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RetroKontrahenci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RetroKontrahenci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RetroKontrahenci_InsertUpdateHandler
  ON CDN.RetroKontrahenci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RKt_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RKt_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.RKt_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.RKt_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [RetroKontrahenci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RKt_KntTyp )  OR UPDATE( RKt_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RKt_KntTyp=-32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntGrupy ON
                    inserted.RKt_KntTyp = CDN.KntGrupy.KnG_GIDTyp
                AND inserted.RKt_KntNumer = CDN.KntGrupy.KnG_GIDNumer
              WHERE CDN.KntGrupy.KnG_GIDNumer IS NULL AND (inserted.RKt_KntTyp=-32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntGrupy) [RetroKontrahenci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KtMPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KtMPrimary */</I><BR>
ALTER TABLE CDN.RetroMagazyny ADD CONSTRAINT FK_KtMPrimary
 FOREIGN KEY
   (
                          RtM_RtKId                         
                         )
             REFERENCES CDN.RetroKarty
                         (
                          RtK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RetroMagazyny_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RetroMagazyny_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RetroMagazyny_InsertUpdateHandler
  ON CDN.RetroMagazyny
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Rtm_MagNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rtm_MagNumer&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.Rtm_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.Rtm_MagNumer&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [RetroMagazyny_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RtORtK"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RtORtK */</I><BR>
ALTER TABLE CDN.RetroOdbiorcy ADD CONSTRAINT FK_RtORtK
 FOREIGN KEY
   (
                          RtO_RtKId                         
                         )
             REFERENCES CDN.RetroKarty
                         (
                          RtK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RetroOdbiorcy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RetroOdbiorcy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RetroOdbiorcy_InsertUpdateHandler
  ON CDN.RetroOdbiorcy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RtO_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RtO_KntTyp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.RtO_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.RtO_KntTyp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [RetroOdbiorcy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RtO_KntTyp )  OR UPDATE( RtO_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RtO_KntTyp&lt;0 AND inserted.RtO_KntNumer&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntGrupy ON
                    inserted.RtO_KntTyp = CDN.KntGrupy.KnG_GIDTyp
                AND inserted.RtO_KntNumer = CDN.KntGrupy.KnG_GIDNumer
              WHERE CDN.KntGrupy.KnG_GIDNumer IS NULL AND (inserted.RtO_KntTyp&lt;0 AND inserted.RtO_KntNumer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntGrupy) [RetroOdbiorcy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RPlRtK"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RPlRtK */</I><BR>
ALTER TABLE CDN.RetroPlt ADD CONSTRAINT FK_RPlRtK
 FOREIGN KEY
   (
                          RPl_RtKId                         
                         )
             REFERENCES CDN.RetroKarty
                         (
                          RtK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RetroPlt_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RetroPlt_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RetroPlt_InsertUpdateHandler
  ON CDN.RetroPlt
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RPl_PltLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RPl_PltTyp=736 AND inserted.RPl_PltLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konfig ON
                    inserted.RPl_PltLp = CDN.Konfig.KON_Lp
              WHERE CDN.Konfig.KON_Lp IS NULL AND (inserted.RPl_PltTyp=736 AND inserted.RPl_PltLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konfig) [RetroPlt_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RtPRtK"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RtPRtK */</I><BR>
ALTER TABLE CDN.RetroProgi ADD CONSTRAINT FK_RtPRtK
 FOREIGN KEY
   (
                          RtP_RtKId                         
                         )
             REFERENCES CDN.RetroKarty
                         (
                          RtK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RtSRtK"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RtSRtK */</I><BR>
ALTER TABLE CDN.RetroSpD ADD CONSTRAINT FK_RtSRtK
 FOREIGN KEY
   (
                          RtS_RtKId                         
                         )
             REFERENCES CDN.RetroKarty
                         (
                          RtK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RetroSpD_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RetroSpD_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RetroSpD_InsertUpdateHandler
  ON CDN.RetroSpD
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RtS_SpDTyp )  OR UPDATE( RtS_SpDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RtS_SpDTyp=976 AND inserted.RtS_SpDLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Nazwy ON
                    inserted.RtS_SpDTyp = CDN.Nazwy.Naz_GIDTyp
                AND inserted.RtS_SpDLp = CDN.Nazwy.Naz_GIDLp
              WHERE CDN.Nazwy.Naz_GIDLp IS NULL AND (inserted.RtS_SpDTyp=976 AND inserted.RtS_SpDLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Nazwy) [RetroSpD_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RsrRKO"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RsrRKO */</I><BR>
ALTER TABLE CDN.RetroStrukturaRabatu ADD CONSTRAINT FK_RsrRKO
 FOREIGN KEY
   (
                          Rsr_RKOId                         
                         )
             REFERENCES CDN.RetroKntOkresy
                         (
                          RKO_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RsrGID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RsrGID */</I><BR>
ALTER TABLE CDN.RetroStrukturaRabatu ADD CONSTRAINT FK_RsrGID
 FOREIGN KEY
   (
                          Rsr_GIDNumer                      ,
                          Rsr_GIDLp                         
                         )
             REFERENCES CDN.TraElem
                         (
                          TrE_GIDNumer   ,
                          TrE_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RtTRtK"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RtTRtK */</I><BR>
ALTER TABLE CDN.RetroTowary ADD CONSTRAINT FK_RtTRtK
 FOREIGN KEY
   (
                          RtT_RtKId                         
                         )
             REFERENCES CDN.RetroKarty
                         (
                          RtK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RetroTowary_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RetroTowary_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RetroTowary_InsertUpdateHandler
  ON CDN.RetroTowary
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RtT_TwrNumer )  OR UPDATE( RtT_TwrTyp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RtT_TwrTyp=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.RtT_TwrNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.RtT_TwrTyp = CDN.TwrGrupy.TwG_GIDTyp
              WHERE CDN.TwrGrupy.TwG_GIDTyp IS NULL AND (inserted.RtT_TwrTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [RetroTowary_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RtT_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RtT_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.RtT_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.RtT_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [RetroTowary_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RezMagNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RezMagNumer */</I><BR>
ALTER TABLE CDN.RezMagazyny ADD CONSTRAINT FK_RezMagNumer
 FOREIGN KEY
   (
                          ReM_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ReMPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ReMPrimary */</I><BR>
ALTER TABLE CDN.RezMagazyny ADD CONSTRAINT FK_ReMPrimary
 FOREIGN KEY
   (
                          ReM_RezNumer                      
                         )
             REFERENCES CDN.Rezerwacje
                         (
                          Rez_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Rezerwacje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Rezerwacje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Rezerwacje_DeleteHandler
  ON CDN.Rezerwacje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanyElementyProdukty
    IF EXISTS(SELECT * FROM CDN.PlanyElementyProdukty JOIN deleted
            ON 
          deleted.Rez_GIDNumer = CDN.PlanyElementyProdukty.PGP_ObiNumer
      AND deleted.Rez_GIDTyp = CDN.PlanyElementyProdukty.PGP_ObiTyp
      AND (CDN.PlanyElementyProdukty.PGP_ObiTyp=2592)
            )
        DELETE CDN.PlanyElementyProdukty
        FROM CDN.PlanyElementyProdukty JOIN deleted
        ON 
          deleted.Rez_GIDNumer = CDN.PlanyElementyProdukty.PGP_ObiNumer
      AND deleted.Rez_GIDTyp = CDN.PlanyElementyProdukty.PGP_ObiTyp
      AND (CDN.PlanyElementyProdukty.PGP_ObiTyp=2592)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdLinki
    IF EXISTS(SELECT * FROM CDN.ProdLinki JOIN deleted
            ON 
          deleted.Rez_GIDTyp = CDN.ProdLinki.PLK_ObiTyp
      AND deleted.Rez_GIDNumer = CDN.ProdLinki.PLK_ObiNumer
      AND (CDN.ProdLinki.PLK_ObiTyp=2592)
            )
        DELETE CDN.ProdLinki
        FROM CDN.ProdLinki JOIN deleted
        ON 
          deleted.Rez_GIDTyp = CDN.ProdLinki.PLK_ObiTyp
      AND deleted.Rez_GIDNumer = CDN.ProdLinki.PLK_ObiNumer
      AND (CDN.ProdLinki.PLK_ObiTyp=2592)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Rezerwacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Rezerwacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Rezerwacje_InsertUpdateHandler
  ON CDN.Rezerwacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Rez_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.Rez_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Rez_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_FrsID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.Rez_FrsID = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.Rez_FrsID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.Rez_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Rez_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rez_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Rez_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Rez_KntTyp=32)
                AND (
                          IsNull(inserted.Rez_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rez_ZrdTyp=14345)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.Rez_ZrdNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.Rez_ZrdTyp=14345)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rez_ZrdTyp=14346)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.Rez_ZrdNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.Rez_ZrdTyp=14346)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rez_ZrdTyp=4702)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.Rez_ZrdNumer = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL AND (inserted.Rez_ZrdTyp=4702)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rez_ZrdTyp=4703)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcSkladniki ON
                    inserted.Rez_ZrdNumer = CDN.SrwZlcSkladniki.SZS_Id
              WHERE CDN.SrwZlcSkladniki.SZS_Id IS NULL AND (inserted.Rez_ZrdTyp=4703)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcSkladniki) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rez_ZrdTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.Rez_ZrdNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.Rez_ZrdTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rez_ZrdTyp=14383)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdPKJNag ON
                    inserted.Rez_ZrdNumer = CDN.ProdPKJNag.PKJN_Id
              WHERE CDN.ProdPKJNag.PKJN_Id IS NULL AND (inserted.Rez_ZrdTyp=14383)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdPKJNag) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Rez_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Rez_ZrdTyp=1605)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.Rez_ZrdNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL AND (inserted.Rez_ZrdTyp=1605)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [Rezerwacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RezerwacjeWPrzyszlosc_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RezerwacjeWPrzyszlosc_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RezerwacjeWPrzyszlosc_InsertUpdateHandler
  ON CDN.RezerwacjeWPrzyszlosc
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RezP_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.RezP_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.RezP_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [RezerwacjeWPrzyszlosc_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RezP_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.RezP_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.RezP_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [RezerwacjeWPrzyszlosc_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RezP_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RezP_ZrdTyp=1605)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.RezP_ZrdNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL AND (inserted.RezP_ZrdTyp=1605)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [RezerwacjeWPrzyszlosc_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RodzajUpomnieniaParametryProcesow_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RodzajUpomnieniaParametryProcesow_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RodzajUpomnieniaParametryProcesow_InsertUpdateHandler
  ON CDN.RodzajUpomnieniaParametryProcesow
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RUPP_RodzicTyp )  OR UPDATE( RUPP_RodzicLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RUPP_RodzicTyp=2688)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Nazwy ON
                    inserted.RUPP_RodzicTyp = CDN.Nazwy.Naz_GIDTyp
                AND inserted.RUPP_RodzicLp = CDN.Nazwy.Naz_GIDLp
              WHERE CDN.Nazwy.Naz_GIDLp IS NULL AND (inserted.RUPP_RodzicTyp=2688)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Nazwy) [RodzajUpomnieniaParametryProcesow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RodzajeBonow_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RodzajeBonow_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.RodzajeBonow_DeleteHandler
  ON CDN.RodzajeBonow
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Bony
    IF EXISTS
       ( SELECT * FROM CDN.Bony JOIN deleted
          ON
                deleted.RBo_Id = CDN.Bony.Bbon_RBoId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Bony) [RodzajeBonow_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrmObiekty
    IF EXISTS(SELECT * FROM CDN.FrmObiekty JOIN deleted
            ON 
          deleted.RBo_Id = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=14551)
            )
        DELETE CDN.FrmObiekty
        FROM CDN.FrmObiekty JOIN deleted
        ON 
          deleted.RBo_Id = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=14551)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RodzajeBonow_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RodzajeBonow_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.RodzajeBonow_InsertUpdateHandler
  ON CDN.RodzajeBonow
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RBo_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RBo_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.RBo_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.RBo_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [RodzajeBonow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( RBo_MdnNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.RBo_MdnTyp=4128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemDokNag ON
                    inserted.RBo_MdnNumer = CDN.MemDokNag.MDN_GIDNumer
              WHERE CDN.MemDokNag.MDN_GIDNumer IS NULL AND (inserted.RBo_MdnTyp=4128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemDokNag) [RodzajeBonow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Role_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Role_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Role_DeleteHandler
  ON CDN.Role
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PrcRole
    IF EXISTS
       ( SELECT * FROM CDN.PrcRole JOIN deleted
          ON
                deleted.Rol_Id = CDN.PrcRole.PrR_RolId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PrcRole) [Role_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RlPRola"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RlPRola */</I><BR>
ALTER TABLE CDN.RolePrawa ADD CONSTRAINT FK_RlPRola
 FOREIGN KEY
   (
                          RlP_RolId                         
                         )
             REFERENCES CDN.Role
                         (
                          Rol_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RlPPrawo"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RlPPrawo */</I><BR>
ALTER TABLE CDN.RolePrawa ADD CONSTRAINT FK_RlPPrawo
 FOREIGN KEY
   (
                          RlP_PraId                         
                         )
             REFERENCES CDN.Prawa
                         (
                          Pra_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Rozliczenia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Rozliczenia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Rozliczenia_DeleteHandler
  ON CDN.Rozliczenia
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraSVat
    IF EXISTS(SELECT * FROM CDN.TraSVat JOIN deleted
            ON 
          deleted.R2_ID = CDN.TraSVat.TSV_R2ID
            )
        DELETE CDN.TraSVat
        FROM CDN.TraSVat JOIN deleted
        ON 
          deleted.R2_ID = CDN.TraSVat.TSV_R2ID
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Rozliczenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Rozliczenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Rozliczenia_InsertUpdateHandler
  ON CDN.Rozliczenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( R2_Dok1Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.R2_Dok1Typ=435)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RozniceKursowe ON
                    inserted.R2_Dok1Numer = CDN.RozniceKursowe.RKN_ID
              WHERE CDN.RozniceKursowe.RKN_ID IS NULL AND (inserted.R2_Dok1Typ=435)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RozniceKursowe) [Rozliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( R2_Dok2Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.R2_Dok2Typ=435)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RozniceKursowe ON
                    inserted.R2_Dok2Numer = CDN.RozniceKursowe.RKN_ID
              WHERE CDN.RozniceKursowe.RKN_ID IS NULL AND (inserted.R2_Dok2Typ=435)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RozniceKursowe) [Rozliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( R2_Dok1Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.R2_Dok1Typ=784)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zapisy ON
                    inserted.R2_Dok1Numer = CDN.Zapisy.KAZ_GIDNumer
              WHERE CDN.Zapisy.KAZ_GIDNumer IS NULL AND (inserted.R2_Dok1Typ=784)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zapisy) [Rozliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( R2_Dekret2Numer )  OR UPDATE( R2_Dekret2Lp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.R2_Dekret2Numer&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DziennikElem ON
                    inserted.R2_Dekret2Numer = CDN.DziennikElem.DEL_GIDNumer
                AND inserted.R2_Dekret2Lp = CDN.DziennikElem.DEL_GIDLp
              WHERE CDN.DziennikElem.DEL_GIDLp IS NULL AND (inserted.R2_Dekret2Numer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DziennikElem) [Rozliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( R2_Dekret1Numer )  OR UPDATE( R2_Dekret1Lp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.R2_Dekret1Numer&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DziennikElem ON
                    inserted.R2_Dekret1Numer = CDN.DziennikElem.DEL_GIDNumer
                AND inserted.R2_Dekret1Lp = CDN.DziennikElem.DEL_GIDLp
              WHERE CDN.DziennikElem.DEL_GIDLp IS NULL AND (inserted.R2_Dekret1Numer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DziennikElem) [Rozliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( R2_Dok2Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.R2_Dok2Typ=784)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Zapisy ON
                    inserted.R2_Dok2Numer = CDN.Zapisy.KAZ_GIDNumer
              WHERE CDN.Zapisy.KAZ_GIDNumer IS NULL AND (inserted.R2_Dok2Typ=784)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Zapisy) [Rozliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( R2_Dok1Typ )  OR UPDATE( R2_Dok1Numer )  OR UPDATE( R2_Dok1Lp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.R2_Dok1Typ&lt;&gt;784 AND inserted.R2_Dok1Typ&lt;&gt;0 AND  inserted.R2_Dok1Typ&lt;&gt;435)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraPlat ON
                    inserted.R2_Dok1Typ = CDN.TraPlat.TrP_GIDTyp
                AND inserted.R2_Dok1Numer = CDN.TraPlat.TrP_GIDNumer
                AND inserted.R2_Dok1Lp = CDN.TraPlat.TrP_GIDLp
              WHERE CDN.TraPlat.TrP_GIDLp IS NULL AND (inserted.R2_Dok1Typ&lt;&gt;784 AND inserted.R2_Dok1Typ&lt;&gt;0 AND  inserted.R2_Dok1Typ&lt;&gt;435)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraPlat) [Rozliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( R2_Dok2Typ )  OR UPDATE( R2_Dok2Numer )  OR UPDATE( R2_Dok2Lp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.R2_Dok2Typ&lt;&gt;784 AND inserted.R2_Dok2Typ&lt;&gt;0 AND  inserted.R2_Dok2Typ&lt;&gt;435)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraPlat ON
                    inserted.R2_Dok2Typ = CDN.TraPlat.TrP_GIDTyp
                AND inserted.R2_Dok2Numer = CDN.TraPlat.TrP_GIDNumer
                AND inserted.R2_Dok2Lp = CDN.TraPlat.TrP_GIDLp
              WHERE CDN.TraPlat.TrP_GIDLp IS NULL AND (inserted.R2_Dok2Typ&lt;&gt;784 AND inserted.R2_Dok2Typ&lt;&gt;0 AND  inserted.R2_Dok2Typ&lt;&gt;435)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraPlat) [Rozliczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RTelBiling"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RTelBiling */</I><BR>
ALTER TABLE CDN.RozmowaTel ADD CONSTRAINT FK_RTelBiling
 FOREIGN KEY
   (
                          RTel_BTelID                        
                         )
             REFERENCES CDN.BilingTel
                         (
                          BTel_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RozniceKursowe_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RozniceKursowe_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.RozniceKursowe_DeleteHandler
  ON CDN.RozniceKursowe
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rozliczenia
    IF EXISTS
       ( SELECT * FROM CDN.Rozliczenia JOIN deleted
          ON
                deleted.RKN_ID = CDN.Rozliczenia.R2_Dok1Numer
       AND (CDN.Rozliczenia.R2_Dok1Typ=435)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rozliczenia) [RozniceKursowe_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.RKN_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (435))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.RKN_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (435))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.RKN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=435)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.RKN_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=435)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.RKN_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=435)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.RKN_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=435)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="RozniceKursoweAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* RozniceKursoweAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.RozniceKursoweAlias_DeleteHandler
  ON CDN.RozniceKursowe
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rozliczenia
    IF EXISTS
       ( SELECT * FROM CDN.Rozliczenia JOIN deleted
          ON
                deleted.RKN_ID = CDN.Rozliczenia.R2_Dok2Numer
       AND (CDN.Rozliczenia.R2_Dok2Typ=435)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rozliczenia) [RozniceKursoweAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RpD2Primary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RpD2Primary */</I><BR>
ALTER TABLE CDN.RptDefinicje2 ADD CONSTRAINT FK_RpD2Primary
 FOREIGN KEY
   (
                          RpD2_RpWId                         ,
                          RpD2_RpFId                         
                         )
             REFERENCES CDN.RptFormaty2
                         (
                          RpF2_RpWId                         ,
                          RpF2_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RpF2Primary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RpF2Primary */</I><BR>
ALTER TABLE CDN.RptFormaty2 ADD CONSTRAINT FK_RpF2Primary
 FOREIGN KEY
   (
                          RpF2_RpWId                         
                         )
             REFERENCES CDN.RptWydruki2
                         (
                          RpW2_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_RpP2Primary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_RpP2Primary */</I><BR>
ALTER TABLE CDN.RptParametry2 ADD CONSTRAINT FK_RpP2Primary
 FOREIGN KEY
   (
                          RpP2_RpWId                         ,
                          RpP2_RpFId                         
                         )
             REFERENCES CDN.RptFormaty2
                         (
                          RpF2_RpWId                         ,
                          RpF2_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SZSC"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SZSC */</I><BR>
ALTER TABLE CDN.SCZasoby ADD CONSTRAINT FK_SZSC
 FOREIGN KEY
   (
                          SZ_SCNumer                       
                         )
             REFERENCES CDN.SkladyCelne
                         (
                          SC_GIDNumer                      
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SFPSFNId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SFPSFNId */</I><BR>
ALTER TABLE CDN.SFPodpisy ADD CONSTRAINT FK_SFPSFNId
 FOREIGN KEY
   (
                          SFP_SFNId                         
                         )
             REFERENCES CDN.SFNag
                         (
                          SFN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SFSESFNID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SFSESFNID */</I><BR>
ALTER TABLE CDN.SFSlownikiElem ADD CONSTRAINT FK_SFSESFNID
 FOREIGN KEY
   (
                          SFSE_SFSNID                        
                         )
             REFERENCES CDN.SFSlownikiNag
                         (
                          SFSN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SFZWSFNId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SFZWSFNId */</I><BR>
ALTER TABLE CDN.SFZalWlasne ADD CONSTRAINT FK_SFZWSFNId
 FOREIGN KEY
   (
                          SFZW_SFNId                         
                         )
             REFERENCES CDN.SFNag
                         (
                          SFN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SFZSFNId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SFZSFNId */</I><BR>
ALTER TABLE CDN.SFZalaczniki ADD CONSTRAINT FK_SFZSFNId
 FOREIGN KEY
   (
                          SFZ_SFNId                         
                         )
             REFERENCES CDN.SFNag
                         (
                          SFN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SISDefinicje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SISDefinicje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SISDefinicje_DeleteHandler
  ON CDN.SISDefinicje
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KsoElem
    IF EXISTS
       ( SELECT * FROM CDN.KsoElem JOIN deleted
          ON
                deleted.SID_GIDNumer = CDN.KsoElem.KSE_SIDNumer
       AND (CDN.KsoElem.KSE_SIDTyp=2392)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KsoElem) [SISDefinicje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZestKSDef
    IF EXISTS
       ( SELECT * FROM CDN.ZestKSDef JOIN deleted
          ON
                deleted.SID_GIDNumer = CDN.ZestKSDef.ZKD_SIDNumer
       AND (CDN.ZestKSDef.ZKD_SIDTyp=2392)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZestKSDef) [SISDefinicje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SISKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SISKPrimary */</I><BR>
ALTER TABLE CDN.SISDefinicjeKonta ADD CONSTRAINT FK_SISKPrimary
 FOREIGN KEY
   (
                          SISK_SISNumer                      
                         )
             REFERENCES CDN.SISDefinicje
                         (
                          SID_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SIWPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SIWPrimaryNoType */</I><BR>
ALTER TABLE CDN.SISWartosci ADD CONSTRAINT FK_SIWPrimaryNoType
 FOREIGN KEY
   (
                          SIW_GIDNumer                      
                         )
             REFERENCES CDN.SISDefinicje
                         (
                          SID_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SWKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SWKPrimary */</I><BR>
ALTER TABLE CDN.SWKolejka ADD CONSTRAINT FK_SWKPrimary
 FOREIGN KEY
   (
                          SWK_PolecenieID                   
                         )
             REFERENCES CDN.SWPolecenia
                         (
                          SWP_PolecenieID                   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SWZPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SWZPrimary */</I><BR>
ALTER TABLE CDN.SWZmienne ADD CONSTRAINT FK_SWZPrimary
 FOREIGN KEY
   (
                          SWZ_PolecenieID                   
                         )
             REFERENCES CDN.SWPolecenia
                         (
                          SWP_PolecenieID                   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SaEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SaEPrimary */</I><BR>
ALTER TABLE CDN.SadElem ADD CONSTRAINT FK_SaEPrimary
 FOREIGN KEY
   (
                          SaE_GIDNumer                      
                         )
             REFERENCES CDN.SadNag
                         (
                          SaN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SadElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SadElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SadElem_DeleteHandler
  ON CDN.SadElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SaE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SaE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.SaE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( (CDN.Atrybuty.Atr_OBITyp=3376 or CDN.Atrybuty.Atr_OBITyp=3377 or        CDN.Atrybuty.Atr_OBITyp=3378 or CDN.Atrybuty.Atr_OBITyp=3379) and    CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and     CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SaE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SaE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.SaE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( (CDN.Atrybuty.Atr_OBITyp=3376 or CDN.Atrybuty.Atr_OBITyp=3377 or        CDN.Atrybuty.Atr_OBITyp=3378 or CDN.Atrybuty.Atr_OBITyp=3379) and    CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and     CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SaE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SaE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.SaE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=3376 or CDN.AtrybutyHist.Ath_OBITyp=3377 or        CDN.AtrybutyHist.Ath_OBITyp=3378 or CDN.AtrybutyHist.Ath_OBITyp=3379) and    CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and     CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SaE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SaE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.SaE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=3376 or CDN.AtrybutyHist.Ath_OBITyp=3377 or        CDN.AtrybutyHist.Ath_OBITyp=3378 or CDN.AtrybutyHist.Ath_OBITyp=3379) and    CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and     CDN.AtrybutyHist.Ath_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SadElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SadElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SadElem_InsertUpdateHandler
  ON CDN.SadElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SaE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.SaE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [SadElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SaKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SaKPrimary */</I><BR>
ALTER TABLE CDN.SadKwoty ADD CONSTRAINT FK_SaKPrimary
 FOREIGN KEY
   (
                          SaK_GIDNumer                      
                         )
             REFERENCES CDN.SadNag
                         (
                          SaN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SadKwoty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SadKwoty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SadKwoty_InsertUpdateHandler
  ON CDN.SadKwoty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SaK_TrNNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaK_TrNTyp=3344)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.SaK_TrNNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.SaK_TrNTyp=3344)
                AND (
                          IsNull(inserted.SaK_TrNNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [SadKwoty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaK_TrNTyp )  OR UPDATE( SaK_TrNNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaK_TrNTyp&lt;&gt;3344)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.SaK_TrNTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.SaK_TrNNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.SaK_TrNTyp&lt;&gt;3344)
                AND (
                          IsNull(inserted.SaK_TrNTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SaK_TrNNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [SadKwoty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SadNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SadNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SadNag_DeleteHandler
  ON CDN.SadNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.SaN_GIDNumer = CDN.WydatkiPracownikow.WPR_DokNumer
       AND (  CDN.WydatkiPracownikow.WPR_DokTyp in ( 3376,3378,3379,3386,3387))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WydatkiPracownikow) [SadNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WysKoszty
    IF EXISTS
       ( SELECT * FROM CDN.WysKoszty JOIN deleted
          ON
                deleted.SaN_GIDTyp = CDN.WysKoszty.WyK_DokTyp
            AND deleted.SaN_GIDNumer = CDN.WysKoszty.WyK_DokNumer
       AND (CDN.WysKoszty.WyK_DokTyp in (3378,3379))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WysKoszty) [SadNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrtDokZakupu
    IF EXISTS(SELECT * FROM CDN.SrtDokZakupu JOIN deleted
            ON 
          deleted.SaN_GIDTyp = CDN.SrtDokZakupu.SDZ_DokTyp
      AND deleted.SaN_GIDNumer = CDN.SrtDokZakupu.SDZ_DokNumer
      AND (CDN.SrtDokZakupu.SDZ_DokTyp in (3376,3378,3379,3386,3387))
            )
        DELETE CDN.SrtDokZakupu
        FROM CDN.SrtDokZakupu JOIN deleted
        ON 
          deleted.SaN_GIDTyp = CDN.SrtDokZakupu.SDZ_DokTyp
      AND deleted.SaN_GIDNumer = CDN.SrtDokZakupu.SDZ_DokNumer
      AND (CDN.SrtDokZakupu.SDZ_DokTyp in (3376,3378,3379,3386,3387))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BstDokumenty
    IF EXISTS(SELECT * FROM CDN.BstDokumenty JOIN deleted
            ON 
          deleted.SaN_GIDNumer = CDN.BstDokumenty.BsD_DokNumer
      AND deleted.SaN_GIDTyp = CDN.BstDokumenty.BsD_DokTyp
      AND (CDN.BstDokumenty.BsD_DokTyp=3376)
            )
        DELETE CDN.BstDokumenty
        FROM CDN.BstDokumenty JOIN deleted
        ON 
          deleted.SaN_GIDNumer = CDN.BstDokumenty.BsD_DokNumer
      AND deleted.SaN_GIDTyp = CDN.BstDokumenty.BsD_DokTyp
      AND (CDN.BstDokumenty.BsD_DokTyp=3376)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.SaN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.SaN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (3376,3378,3379))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.SaN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.SaN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (3376,3378,3379))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SaN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SaN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( CDN.Atrybuty.Atr_OBITyp in (3376, 3377, 3378, 3379, 3387, 3386) and  CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SaN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SaN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( CDN.Atrybuty.Atr_OBITyp in (3376, 3377, 3378, 3379, 3387, 3386) and  CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.SaN_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.SaN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp in (3376,3378,3379,3386,3387))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.SaN_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.SaN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp in (3376,3378,3379,3386,3387))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraVat
    IF EXISTS(SELECT * FROM CDN.TraVat JOIN deleted
            ON 
          deleted.SaN_GIDTyp = CDN.TraVat.TRV_GIDTyp
      AND deleted.SaN_GIDNumer = CDN.TraVat.TRV_GIDNumer
      AND (CDN.TraVat.TrV_GIDTyp IN(3376,3378,3379,3387,3386))
            )
        DELETE CDN.TraVat
        FROM CDN.TraVat JOIN deleted
        ON 
          deleted.SaN_GIDTyp = CDN.TraVat.TRV_GIDTyp
      AND deleted.SaN_GIDNumer = CDN.TraVat.TRV_GIDNumer
      AND (CDN.TraVat.TrV_GIDTyp IN(3376,3378,3379,3387,3386))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.SaN_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.SaN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=3376 OR CDN.Predekrety.PDT_GIDTyp=3377)
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.SaN_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.SaN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=3376 OR CDN.Predekrety.PDT_GIDTyp=3377)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SaN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SaN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp in (3376, 3377, 3378, 3379, 3387, 3386) and    CDN.AtrybutyHist.Ath_OBILp = 0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SaN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SaN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp in (3376, 3377, 3378, 3379, 3387, 3386) and    CDN.AtrybutyHist.Ath_OBILp = 0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraJPK
    IF EXISTS(SELECT * FROM CDN.TraJPK JOIN deleted
            ON 
          deleted.SaN_GIDTyp = CDN.TraJPK.TrJ_TrNTyp
      AND deleted.SaN_GIDNumer = CDN.TraJPK.TrJ_TrNNumer
      AND (CDN.TraJPK.TrJ_TrNTyp in (3376,3378,3379,3386,3387))
            )
        DELETE CDN.TraJPK
        FROM CDN.TraJPK JOIN deleted
        ON 
          deleted.SaN_GIDTyp = CDN.TraJPK.TrJ_TrNTyp
      AND deleted.SaN_GIDNumer = CDN.TraJPK.TrJ_TrNNumer
      AND (CDN.TraJPK.TrJ_TrNTyp in (3376,3378,3379,3386,3387))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SadNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SadNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SadNag_InsertUpdateHandler
  ON CDN.SadNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SaN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaN_AkwTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SaN_AkwNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SaN_AkwTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaN_KnPTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SaN_KnPNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SaN_KnPTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaN_KnPTyp=48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.SaN_KnPNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.SaN_KnPTyp=48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaN_KnPTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.SaN_KnPNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.SaN_KnPTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaN_KnPTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SaN_KnPNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SaN_KnPTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaN_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SaN_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SaN_AkwTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_KntNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SaN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_URZGrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.SaN_URZGrNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaN_URZGrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_KnAZTyp )  OR UPDATE( SaN_KnAZNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.SaN_KnAZTyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.SaN_KnAZNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaN_KnAZTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SaN_KnAZNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_PrcNumerZ ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SaN_PrcNumerZ = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaN_PrcNumerZ,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_KntZNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SaN_KntZNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaN_KntZNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_PdmNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaN_PdmTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.SaN_PdmNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.SaN_PdmTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_PdmNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaN_PdmTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SaN_PdmNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SaN_PdmTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_KnATyp )  OR UPDATE( SaN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.SaN_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.SaN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaN_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SaN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_DstTyp )  OR UPDATE( SaN_DstNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SaN_DstTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.SaN_DstNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaN_DstTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SaN_DstNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaN_DstAdres ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.SaN_DstAdres = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaN_DstAdres,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [SadNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SaSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SaSPrimary */</I><BR>
ALTER TABLE CDN.SadSElem ADD CONSTRAINT FK_SaSPrimary
 FOREIGN KEY
   (
                          SaS_GIDNumer                      ,
                          SaS_GIDLp                         
                         )
             REFERENCES CDN.SadElem
                         (
                          SaE_GIDNumer   ,
                          SaE_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SadSElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SadSElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SadSElem_DeleteHandler
  ON CDN.SadSElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SaS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SaS_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.SaS_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.SaS_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND ( (CDN.Atrybuty.Atr_OBITyp=3376 or CDN.Atrybuty.Atr_OBITyp=3377 or        CDN.Atrybuty.Atr_OBITyp=3378 or CDN.Atrybuty.Atr_OBITyp=3379) and    CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and     CDN.Atrybuty.Atr_OBISubLp &gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SaS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SaS_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.SaS_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.SaS_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND ( (CDN.Atrybuty.Atr_OBITyp=3376 or CDN.Atrybuty.Atr_OBITyp=3377 or        CDN.Atrybuty.Atr_OBITyp=3378 or CDN.Atrybuty.Atr_OBITyp=3379) and    CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and     CDN.Atrybuty.Atr_OBISubLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SaS_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SaS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.SaS_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.SaS_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=3376 or CDN.AtrybutyHist.Ath_OBITyp=3377 or        CDN.AtrybutyHist.Ath_OBITyp=3378 or CDN.AtrybutyHist.Ath_OBITyp=3379) and    CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and     CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SaS_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SaS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.SaS_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.SaS_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=3376 or CDN.AtrybutyHist.Ath_OBITyp=3377 or        CDN.AtrybutyHist.Ath_OBITyp=3378 or CDN.AtrybutyHist.Ath_OBITyp=3379) and    CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and     CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SamPrzejazdy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SamPrzejazdy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SamPrzejazdy_DeleteHandler
  ON CDN.SamPrzejazdy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyElem
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyElem JOIN deleted
          ON
                deleted.SaP_ZrdNumer = CDN.CRMWizytyElem.CWE_GidNumer
            AND deleted.SaP_ZrdLp = CDN.CRMWizytyElem.CWE_GidLp
            AND deleted.SaP_ZrdTyp = CDN.CRMWizytyElem.CWE_GidTyp
            
       AND (deleted.SaP_ZrdTyp=4180)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć przejazdu. Przejazd jest wybrany na jednej z wizyt handlowych./# [SamPrzejazdy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WydatkiPracownikow
    IF EXISTS(SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
            ON 
          deleted.SaP_Id = CDN.WydatkiPracownikow.WPR_SaPId
            )
        DELETE CDN.WydatkiPracownikow
        FROM CDN.WydatkiPracownikow JOIN deleted
        ON 
          deleted.SaP_Id = CDN.WydatkiPracownikow.WPR_SaPId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SamPrzejazdy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SamPrzejazdy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SamPrzejazdy_InsertUpdateHandler
  ON CDN.SamPrzejazdy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SaP_RodzajPrzejazdu ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SaP_RodzajPrzejazdu = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SaP_RodzajPrzejazdu,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [SamPrzejazdy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaP_SamId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Samochody ON
                    inserted.SaP_SamId = CDN.Samochody.SaM_Id
              WHERE CDN.Samochody.SaM_Id IS NULL
                AND (
                          IsNull(inserted.SaP_SamId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Samochody) [SamPrzejazdy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaP_KierNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SaP_KierNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaP_KierNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SamPrzejazdy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaP_DGENumer )  OR UPDATE( SaP_DGELp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DelegacjeElem ON
                    inserted.SaP_DGENumer = CDN.DelegacjeElem.DGE_GIDNumer
                AND inserted.SaP_DGELp = CDN.DelegacjeElem.DGE_GIDLp
              WHERE CDN.DelegacjeElem.DGE_GIDLp IS NULL
                AND (
                          IsNull(inserted.SaP_DGENumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SaP_DGELp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DelegacjeElem) [SamPrzejazdy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Samochody_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Samochody_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Samochody_DeleteHandler
  ON CDN.Samochody
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtKarty
    IF EXISTS
       ( SELECT * FROM CDN.SrtKarty JOIN deleted
          ON
                deleted.SaM_Id = CDN.SrtKarty.Srt_SamId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć Samochodu. Samochód jest wybrany z karty środka trwałego./# [Samochody_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.SaM_Id = CDN.WydatkiPracownikow.WPR_SamId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WydatkiPracownikow) [Samochody_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.SaM_Id = CDN.SrwUrzadzenia.SrU_ObiNumer
       AND (CDN.SrwUrzadzenia.SrU_ObiTyp=342)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwUrzadzenia) [Samochody_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wysylki
    IF EXISTS
       ( SELECT * FROM CDN.Wysylki JOIN deleted
          ON
                deleted.SaM_Id = CDN.Wysylki.WYS_SamId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wysylki) [Samochody_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TrasyNag
    IF EXISTS
       ( SELECT * FROM CDN.TrasyNag JOIN deleted
          ON
                deleted.SaM_Id = CDN.TrasyNag.TsN_SamId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TrasyNag) [Samochody_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DelegacjeTransport
    IF EXISTS
       ( SELECT * FROM CDN.DelegacjeTransport JOIN deleted
          ON
                deleted.SaM_Id = CDN.DelegacjeTransport.DGT_SamID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą DelegacjeTransport) [Samochody_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SaM_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=342 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SaM_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=342 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SamPrzejazdy
    IF EXISTS(SELECT * FROM CDN.SamPrzejazdy JOIN deleted
            ON 
          deleted.SaM_Id = CDN.SamPrzejazdy.SaP_SamId
            )
        DELETE CDN.SamPrzejazdy
        FROM CDN.SamPrzejazdy JOIN deleted
        ON 
          deleted.SaM_Id = CDN.SamPrzejazdy.SaP_SamId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Samochody_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Samochody_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Samochody_InsertUpdateHandler
  ON CDN.Samochody
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SaM_Marka ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SaM_Marka = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SaM_Marka,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Samochody_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaM_KierNumer )  OR UPDATE( SaM_KierLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaM_KierTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.SaM_KierNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.SaM_KierLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.SaM_KierTyp=32)
                AND (
                          IsNull(inserted.SaM_KierNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SaM_KierLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [Samochody_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaM_KntNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SaM_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SaM_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Samochody_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SaM_KierNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SaM_KierTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SaM_KierNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SaM_KierTyp=944)
                AND (
                          IsNull(inserted.SaM_KierNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Samochody_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SCDPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SCDPrimary */</I><BR>
ALTER TABLE CDN.SchematDziennik ADD CONSTRAINT FK_SCDPrimary
 FOREIGN KEY
   (
                          SCD_GIDTyp                        ,
                          SCD_GIDNumer                      
                         )
             REFERENCES CDN.Schematy
                         (
                          SCH_GIDTyp                        ,
                          SCH_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SCRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SCRPrimary */</I><BR>
ALTER TABLE CDN.SchematRodzajDaty ADD CONSTRAINT FK_SCRPrimary
 FOREIGN KEY
   (
                          SCR_GIDTyp                        ,
                          SCR_GIDNumer                      
                         )
             REFERENCES CDN.Schematy
                         (
                          SCH_GIDTyp                        ,
                          SCH_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Schematy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Schematy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Schematy_DeleteHandler
  ON CDN.Schematy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Operacje
    IF EXISTS
       ( SELECT * FROM CDN.Operacje JOIN deleted
          ON
                deleted.SCH_GIDTyp = CDN.Operacje.KAO_SCHTyp
            AND deleted.SCH_GIDNumer = CDN.Operacje.KAO_SCHNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Operacje) [Schematy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SkwPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SkwPrimary */</I><BR>
ALTER TABLE CDN.SeSKwoty ADD CONSTRAINT FK_SkwPrimary
 FOREIGN KEY
   (
                          SKw_GIDNumer                      
                         )
             REFERENCES CDN.SadNag
                         (
                          SaN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SkOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SkOPrimary */</I><BR>
ALTER TABLE CDN.SeSKwotyDod ADD CONSTRAINT FK_SkOPrimary
 FOREIGN KEY
   (
                          SkO_SeSId                         
                         )
             REFERENCES CDN.SeSKwoty
                         (
                          SKw_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SekDokStatusy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SekDokStatusy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SekDokStatusy_DeleteHandler
  ON CDN.SekDokStatusy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekStatusyDok
    IF EXISTS
       ( SELECT * FROM CDN.SekStatusyDok JOIN deleted
          ON
                deleted.SDS_Id = CDN.SekStatusyDok.SOS_SdsId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć rekordu. Ten status dokumentu jest już użyty w obiegu dokumentów./# [SekDokStatusy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SekDokTypy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SekDokTypy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SekDokTypy_DeleteHandler
  ON CDN.SekDokTypy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SekDokumenty
    IF EXISTS
       ( SELECT * FROM CDN.SekDokumenty JOIN deleted
          ON
                deleted.SDT_Id = CDN.SekDokumenty.SDD_SdtId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć rekordu. Ten typ dokumentu jest już użyty w obiegu dokumentów./# [SekDokTypy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SekDokumenty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SekDokumenty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SekDokumenty_DeleteHandler
  ON CDN.SekDokumenty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.SDD_Id = CDN.DokZwiazane.DoZ_DOKNumer
      AND (  CDN.DokZwiazane.DoZ_DokTyp in (14451,14452,14453))
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.SDD_Id = CDN.DokZwiazane.DoZ_DOKNumer
      AND (  CDN.DokZwiazane.DoZ_DokTyp in (14451,14452,14453))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.SDD_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (14451,14452,14453))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.SDD_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (14451,14452,14453))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_Procesy
    IF EXISTS(SELECT * FROM CDN.WF_Procesy JOIN deleted
            ON 
          deleted.SDD_Id = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (14451,14452,14453))
            )
        DELETE CDN.WF_Procesy
        FROM CDN.WF_Procesy JOIN deleted
        ON 
          deleted.SDD_Id = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (14451,14452,14453))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.SDD_Id = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (  CDN.DokZwiazane.DoZ_ZRDTyp in (14451,14452,14453))
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.SDD_Id = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (  CDN.DokZwiazane.DoZ_ZRDTyp in (14451,14452,14453))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SDD_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (14451,14452,14453) and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SDD_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp in (14451,14452,14453) and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.SDD_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (14451,14452,14453) AND CDN.DaneObiekty.DAO_ObiLp = 0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.SDD_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (14451,14452,14453) AND CDN.DaneObiekty.DAO_ObiLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SekDokumenty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SekDokumenty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SekDokumenty_InsertUpdateHandler
  ON CDN.SekDokumenty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SDD_NadawcaAdrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SDD_NadawcaAdrTyp in (864,896))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.SDD_NadawcaAdrNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL AND (inserted.SDD_NadawcaAdrTyp in (864,896))
                AND (
                          IsNull(inserted.SDD_NadawcaAdrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [SekDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SDD_NadawcaAdrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SDD_NadawcaAdrTyp in (897,898,899))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OsoAdresy ON
                    inserted.SDD_NadawcaAdrNumer = CDN.OsoAdresy.OsA_Id
              WHERE CDN.OsoAdresy.OsA_Id IS NULL AND (inserted.SDD_NadawcaAdrTyp in (897,898,899))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OsoAdresy) [SekDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SDD_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.SDD_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.SDD_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [SekDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SDD_SdtId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SekDokTypy ON
                    inserted.SDD_SdtId = CDN.SekDokTypy.SDT_Id
              WHERE CDN.SekDokTypy.SDT_Id IS NULL
                AND (
                          IsNull(inserted.SDD_SdtId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SekDokTypy) [SekDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SODSdsId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SODSdsId */</I><BR>
ALTER TABLE CDN.SekOpiekunowieDok ADD CONSTRAINT FK_SODSdsId
 FOREIGN KEY
   (
                          SOD_SosId                         
                         )
             REFERENCES CDN.SekStatusyDok
                         (
                          SOS_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SekOpiekunowieDok_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SekOpiekunowieDok_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SekOpiekunowieDok_InsertUpdateHandler
  ON CDN.SekOpiekunowieDok
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SOD_OpiekunGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SOD_OpiekunGidTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SOD_OpiekunGidNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SOD_OpiekunGidTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SekOpiekunowieDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SOSSddId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SOSSddId */</I><BR>
ALTER TABLE CDN.SekStatusyDok ADD CONSTRAINT FK_SOSSddId
 FOREIGN KEY
   (
                          SOS_SddId                         
                         )
             REFERENCES CDN.SekDokumenty
                         (
                          SDD_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SekStatusyDok_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SekStatusyDok_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SekStatusyDok_InsertUpdateHandler
  ON CDN.SekStatusyDok
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SOS_WprowadzilNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SoS_WprowadzilTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.SOS_WprowadzilNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.SoS_WprowadzilTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [SekStatusyDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SOS_WprowadzilNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SoS_WprowadzilTyp=994)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SOS_WprowadzilNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SoS_WprowadzilTyp=994)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SekStatusyDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SOS_SdsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SekDokStatusy ON
                    inserted.SOS_SdsId = CDN.SekDokStatusy.SDS_Id
              WHERE CDN.SekDokStatusy.SDS_Id IS NULL
                AND (
                          IsNull(inserted.SOS_SdsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SekDokStatusy) [SekStatusyDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_STSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_STSPrimary */</I><BR>
ALTER TABLE CDN.SekTypySerie ADD CONSTRAINT FK_STSPrimary
 FOREIGN KEY
   (
                          STS_SDTId                         
                         )
             REFERENCES CDN.SekDokTypy
                         (
                          SDT_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SekTypySerie_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SekTypySerie_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SekTypySerie_InsertUpdateHandler
  ON CDN.SekTypySerie
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( STS_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.STS_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.STS_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [SekTypySerie_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SntFrsId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SntFrsId */</I><BR>
ALTER TABLE CDN.Sent ADD CONSTRAINT FK_SntFrsId
 FOREIGN KEY
   (
                          SnT_FrsId                         
                         )
             REFERENCES CDN.FrmStruktura
                         (
                          FRS_Id   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Sent_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Sent_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Sent_InsertUpdateHandler
  ON CDN.Sent
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SnT_KCNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KodyCN ON
                    inserted.SnT_KCNId = CDN.KodyCN.KCN_ID
              WHERE CDN.KodyCN.KCN_ID IS NULL
                AND (
                          IsNull(inserted.SnT_KCNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KodyCN) [Sent_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SnT_KntGidNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SnT_KntGidNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SnT_KntGidNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Sent_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SnT_KnaGidNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.SnT_KnaGidNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SnT_KnaGidNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [Sent_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SnESentNag"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SnESentNag */</I><BR>
ALTER TABLE CDN.SentElem ADD CONSTRAINT FK_SnESentNag
 FOREIGN KEY
   (
                          SnE_SnTId                         
                         )
             REFERENCES CDN.Sent
                         (
                          SnT_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Serie_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Serie_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Serie_DeleteHandler
  ON CDN.Serie
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.SER_GIDNumer = CDN.FrmStruktura.FRS_SERNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [Serie_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrmObiekty
    IF EXISTS(SELECT * FROM CDN.FrmObiekty JOIN deleted
            ON 
          deleted.SER_GIDNumer = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=272)
            )
        DELETE CDN.FrmObiekty
        FROM CDN.FrmObiekty JOIN deleted
        ON 
          deleted.SER_GIDNumer = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=272)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokRelacje
    IF EXISTS(SELECT * FROM CDN.DokRelacje JOIN deleted
            ON 
          deleted.SER_GIDNumer = CDN.DokRelacje.DoR_MSNumer
      AND (CDN.DokRelacje.DoR_MSTyp=272)
            )
        DELETE CDN.DokRelacje
        FROM CDN.DokRelacje JOIN deleted
        ON 
          deleted.SER_GIDNumer = CDN.DokRelacje.DoR_MSNumer
      AND (CDN.DokRelacje.DoR_MSTyp=272)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SLESLNNID"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SLESLNNID */</I><BR>
ALTER TABLE CDN.ShippingLogElem ADD CONSTRAINT FK_SLESLNNID
 FOREIGN KEY
   (
                          SLE_NID                           
                         )
             REFERENCES CDN.ShippingLogNag
                         (
                          SLN_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SCSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SCSPrimary */</I><BR>
ALTER TABLE CDN.Skladniki ADD CONSTRAINT FK_SCSPrimary
 FOREIGN KEY
   (
                          SCS_GIDTyp                        ,
                          SCS_GIDNumer                      
                         )
             REFERENCES CDN.Schematy
                         (
                          SCH_GIDTyp                        ,
                          SCH_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SkCTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SkCTowar */</I><BR>
ALTER TABLE CDN.SkladnikiCelne ADD CONSTRAINT FK_SkCTowar
 FOREIGN KEY
   (
                          Skc_KCID                          
                         )
             REFERENCES CDN.KategorieCelne
                         (
                          KC_ID                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SkcPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SkcPrimaryNoType */</I><BR>
ALTER TABLE CDN.SkladnikiCelne ADD CONSTRAINT FK_SkcPrimaryNoType
 FOREIGN KEY
   (
                          Skc_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SkladyCelne_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SkladyCelne_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SkladyCelne_DeleteHandler
  ON CDN.SkladyCelne
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmStruktura
    IF EXISTS
       ( SELECT * FROM CDN.FrmStruktura JOIN deleted
          ON
                deleted.SC_GIDNumer = CDN.FrmStruktura.FRS_SCNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmStruktura) [SkladyCelne_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Slowniki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Slowniki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Slowniki_DeleteHandler
  ON CDN.Slowniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Samochody
    IF EXISTS
       ( SELECT * FROM CDN.Samochody JOIN deleted
          ON
                deleted.SLW_ID = CDN.Samochody.SaM_Marka
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Samochody) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SamPrzejazdy
    IF EXISTS
       ( SELECT * FROM CDN.SamPrzejazdy JOIN deleted
          ON
                deleted.SLW_ID = CDN.SamPrzejazdy.SaP_RodzajPrzejazdu
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SamPrzejazdy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraVat
    IF EXISTS
       ( SELECT * FROM CDN.TraVat JOIN deleted
          ON
                deleted.SLW_ID = CDN.TraVat.TrV_OgraniczenieOdl
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraVat) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaKoszty
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaKoszty JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdTechnologiaKoszty.PTK_SLWId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć słownika, ponieważ występuje on na konfiguratorze produktu/# [Slowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ParamRozKonf
    IF EXISTS
       ( SELECT * FROM CDN.ParamRozKonf JOIN deleted
          ON
                deleted.SLW_ID = CDN.ParamRozKonf.PRK_DefPytId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć tego rekordu ponieważ, jest on ustawiony jako definicja pytania dla parametów różnicujących konfiguratory./# [Slowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcCzynnosci JOIN deleted
          ON
                deleted.SLW_ID = CDN.SrwZlcCzynnosci.SZC_SlwStatus
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcCzynnosci) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.UmwNag.UmN_RodzajUmowyId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKoncesje
    IF EXISTS
       ( SELECT * FROM CDN.KntKoncesje JOIN deleted
          ON
                deleted.SLW_ID = CDN.KntKoncesje.KKo_Koncesja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKoncesje) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrWzOpisy
    IF EXISTS
       ( SELECT * FROM CDN.TwrWzOpisy JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrWzOpisy.WTO_Jezyk
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrWzOpisy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyRptTwr
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyRptTwr JOIN deleted
          ON
                deleted.SLW_ID = CDN.CRMWizytyRptTwr.CWT_Ekspozycja
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyRptTwr) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrAplikacjeOpisy
    IF EXISTS
       ( SELECT * FROM CDN.TwrAplikacjeOpisy JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrAplikacjeOpisy.TPO_JezykId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrAplikacjeOpisy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrParMag
    IF EXISTS
       ( SELECT * FROM CDN.TwrParMag JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrParMag.TPM_RodzajId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrParMag) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.SLW_ID = CDN.SrwUrzadzenia.SrU_JednostkaPrzebiegu
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwUrzadzenia) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.SrwZlcNag.SZN_FiaskoID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.SLW_ID = CDN.CRMKntEtapy.CEK_FiaskoID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMKntEtapy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrWzorce
    IF EXISTS
       ( SELECT * FROM CDN.TwrWzorce JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrWzorce.TwW_StawkaKGO
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Wartość została wykorzystana w jednym z wzorców towaru./# [Slowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Ankiety
    IF EXISTS
       ( SELECT * FROM CDN.Ankiety JOIN deleted
          ON
                deleted.SLW_ID = CDN.Ankiety.ANT_Rodzaj
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Ankiety) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Zapisy
    IF EXISTS
       ( SELECT * FROM CDN.Zapisy JOIN deleted
          ON
                deleted.SLW_ID = CDN.Zapisy.KAZ_LokataTypId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Zapisy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyElem
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyElem JOIN deleted
          ON
                deleted.SLW_ID = CDN.CRMWizytyElem.CWE_RodzajId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyElem) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWzorceWizyt
    IF EXISTS
       ( SELECT * FROM CDN.CRMWzorceWizyt JOIN deleted
          ON
                deleted.SLW_ID = CDN.CRMWzorceWizyt.CWW_TypId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWzorceWizyt) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Tlumaczenia
    IF EXISTS
       ( SELECT * FROM CDN.Tlumaczenia JOIN deleted
          ON
                deleted.SLW_ID = CDN.Tlumaczenia.TLM_Jezyk
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Tlumaczenia) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.CRMWizytyNag.CWN_TypId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrOpisy
    IF EXISTS
       ( SELECT * FROM CDN.TwrOpisy JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrOpisy.TwO_Jezyk
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrOpisy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoStaleRoczne
    IF EXISTS
       ( SELECT * FROM CDN.OsoStaleRoczne JOIN deleted
          ON
                deleted.SLW_ID = CDN.OsoStaleRoczne.ORo_KosztUzyskaniaZTytulu
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoStaleRoczne) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUbezpieczenia
    IF EXISTS
       ( SELECT * FROM CDN.OsoUbezpieczenia JOIN deleted
          ON
                deleted.SLW_ID = CDN.OsoUbezpieczenia.OUb_TytulUbezpieczenia
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Tytuł ubezpieczenia został wykorzystany w danych pracownika./# [Slowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DefNieobecnosci
    IF EXISTS
       ( SELECT * FROM CDN.DefNieobecnosci JOIN deleted
          ON
                deleted.SLW_ID = CDN.DefNieobecnosci.DNB_KodRSA
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Kod ZUS świadczenia przerwy jest ustawiony na definicji nieobecności./# [Slowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklElem
    IF EXISTS
       ( SELECT * FROM CDN.ReklElem JOIN deleted
          ON
                deleted.SLW_ID = CDN.ReklElem.RLE_Zadanie
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Wartość została wykorzystana na reklamacji./# [Slowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoKarty
    IF EXISTS
       ( SELECT * FROM CDN.OsoKarty JOIN deleted
          ON
                deleted.SLW_ID = CDN.OsoKarty.Oso_Rodzaj
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoKarty) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStanowiska
    IF EXISTS
       ( SELECT * FROM CDN.KadrStanowiska JOIN deleted
          ON
                deleted.SLW_ID = CDN.KadrStanowiska.KSt_RodzajUmowy
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStanowiska) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStaSlowniki
    IF EXISTS
       ( SELECT * FROM CDN.KadrStaSlowniki JOIN deleted
          ON
                deleted.SLW_ID = CDN.KadrStaSlowniki.KSS_SlwId
       AND (CDN.KadrStaSlowniki.KSS_SlwTyp in (8225))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStaSlowniki) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoRodzina
    IF EXISTS
       ( SELECT * FROM CDN.OsoRodzina JOIN deleted
          ON
                deleted.SLW_ID = CDN.OsoRodzina.OsR_KodPokrewienstwa
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoRodzina) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzRodzaje
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzRodzaje JOIN deleted
          ON
                deleted.SLW_ID = CDN.SrwUrzRodzaje.SUR_JednostkaPrzebiegu
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwUrzRodzaje) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntOsobyKomunikatory
    IF EXISTS
       ( SELECT * FROM CDN.KntOsobyKomunikatory JOIN deleted
          ON
                deleted.SLW_ID = CDN.KntOsobyKomunikatory.KoK_RodzajId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntOsobyKomunikatory) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsElem
    IF EXISTS
       ( SELECT * FROM CDN.SrsElem JOIN deleted
          ON
                deleted.SLW_ID = CDN.SrsElem.SsE_TypId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsElem) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMDefZadania
    IF EXISTS
       ( SELECT * FROM CDN.CRMDefZadania JOIN deleted
          ON
                deleted.SLW_ID = CDN.CRMDefZadania.CDZ_TypId
       AND (CDN.CRMDefZadania.CDZ_TypID&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMDefZadania) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdKoszty
    IF EXISTS
       ( SELECT * FROM CDN.ProdKoszty JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdKoszty.PKO_Kategoria
       AND (CDN.ProdKoszty.PKO_Kategoria&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdKoszty) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DaneBinarne
    IF EXISTS
       ( SELECT * FROM CDN.DaneBinarne JOIN deleted
          ON
                deleted.SLW_ID = CDN.DaneBinarne.DAB_TypId
       AND ( CDN.DaneBinarne.DAB_TypId&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą DaneBinarne) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RecElem
    IF EXISTS
       ( SELECT * FROM CDN.RecElem JOIN deleted
          ON
                deleted.SLW_ID = CDN.RecElem.ReE_MagProdId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą RecElem) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.FrmObiekty
    IF EXISTS
       ( SELECT * FROM CDN.FrmObiekty JOIN deleted
          ON
                deleted.SLW_ID = CDN.FrmObiekty.FRO_MagProdId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą FrmObiekty) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RecNag
    IF EXISTS
       ( SELECT * FROM CDN.RecNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.RecNag.ReN_MagProdId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą RecNag) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrKarty
    IF EXISTS
       ( SELECT * FROM CDN.TwrKarty JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrKarty.Twr_Notowania
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrKarty) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KmStawki
    IF EXISTS
       ( SELECT * FROM CDN.KmStawki JOIN deleted
          ON
                deleted.SLW_ID = CDN.KmStawki.KmS_SlwId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KmStawki) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsWyposazenia
    IF EXISTS
       ( SELECT * FROM CDN.SrsWyposazenia JOIN deleted
          ON
                deleted.SLW_ID = CDN.SrsWyposazenia.SsW_RodzajPaliwaId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsWyposazenia) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdZasoby JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdZasoby.PZA_RodzajUbocznego
       AND (CDN.ProdZasoby.PZA_RodzajUbocznego&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZasoby) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DelegacjeTransport
    IF EXISTS
       ( SELECT * FROM CDN.DelegacjeTransport JOIN deleted
          ON
                deleted.SLW_ID = CDN.DelegacjeTransport.DGT_SrodekTransID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą DelegacjeTransport) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdOkresy
    IF EXISTS
       ( SELECT * FROM CDN.ProdOkresy JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdOkresy.POK_PrzyczynaPrzestoju
       AND (CDN.ProdOkresy.POK_PrzyczynaPrzestoju&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdOkresy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RetroKarty
    IF EXISTS
       ( SELECT * FROM CDN.RetroKarty JOIN deleted
          ON
                deleted.SLW_ID = CDN.RetroKarty.RtK_TypID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą RetroKarty) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdWzorceKosztow
    IF EXISTS
       ( SELECT * FROM CDN.ProdWzorceKosztow JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdWzorceKosztow.PWK_Kategoria
       AND (CDN.ProdWzorceKosztow.PWK_Kategoria&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdWzorceKosztow) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjNag
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.BudzetPrjNag.BPN_StatusId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BudzetPrjNag) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjElem
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjElem JOIN deleted
          ON
                deleted.SLW_ID = CDN.BudzetPrjElem.BPE_RezygnacjaId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BudzetPrjElem) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrGrupy
    IF EXISTS
       ( SELECT * FROM CDN.TwrGrupy JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrGrupy.TwG_KategoriaBIId
       AND (CDN.TwrGrupy.TwG_KategoriaBIId &gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrGrupy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOUpowaznienia
    IF EXISTS
       ( SELECT * FROM CDN.PDOUpowaznienia JOIN deleted
          ON
                deleted.SLW_ID = CDN.PDOUpowaznienia.PDOU_RodzajUpowaznieniaId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PDOUpowaznienia) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOCzynnosciKraje
    IF EXISTS
       ( SELECT * FROM CDN.PDOCzynnosciKraje JOIN deleted
          ON
                deleted.SLW_ID = CDN.PDOCzynnosciKraje.PDOCK_UzasadnienieId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Wartość została wykorzystana w jednym z upoważnien PDO./# [Slowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OpeKarty
    IF EXISTS
       ( SELECT * FROM CDN.OpeKarty JOIN deleted
          ON
                deleted.SLW_ID = CDN.OpeKarty.Ope_Jezyk
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OpeKarty) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.StaKarty
    IF EXISTS
       ( SELECT * FROM CDN.StaKarty JOIN deleted
          ON
                deleted.SLW_ID = CDN.StaKarty.Sta_Jezyk
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą StaKarty) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PDOCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.PDOCzynnosci JOIN deleted
          ON
                deleted.SLW_ID = CDN.PDOCzynnosci.PDOC_Kategoria
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Wartość została wykorzystana na czynności przetwarzania danych osobowych./# [Slowniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdNadzlecenia
    IF EXISTS
       ( SELECT * FROM CDN.ProdNadzlecenia JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdNadzlecenia.PNZ_Status
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdNadzlecenia) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdPKJNag.PKJN_Status
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wysylki
    IF EXISTS
       ( SELECT * FROM CDN.Wysylki JOIN deleted
          ON
                deleted.SLW_ID = CDN.Wysylki.WYS_Kurier
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wysylki) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdWzorceNumerowPartii
    IF EXISTS
       ( SELECT * FROM CDN.ProdWzorceNumerowPartii JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdWzorceNumerowPartii.WNP_Separator
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdWzorceNumerowPartii) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdOperacjePominiete
    IF EXISTS
       ( SELECT * FROM CDN.ProdOperacjePominiete JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdOperacjePominiete.POPP_PrzyczynaPominiecia
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdOperacjePominiete) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Bony
    IF EXISTS
       ( SELECT * FROM CDN.Bony JOIN deleted
          ON
                deleted.SLW_ID = CDN.Bony.Bbon_PrzyczynaBlokady
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Bony) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.ProdCzynnosci JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdCzynnosci.PCZ_Stan
       AND (CDN.ProdCzynnosci.PCZ_Stan&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdCzynnosci) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.ZamNag.ZaN_ZrodloPochodzeniaESklep
       AND (CDN.ZamNag.ZaN_ZrodloPochodzeniaESklep&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrPodm
    IF EXISTS
       ( SELECT * FROM CDN.TwrPodm JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrPodm.TwP_RodzajPowiazania
       AND (CDN.TwrPodm.TwP_RodzajPowiazania &gt; 2)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrPodm) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdOperacjePauzy
    IF EXISTS
       ( SELECT * FROM CDN.ProdOperacjePauzy JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdOperacjePauzy.PPY_PrzyczynaPauzy
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdOperacjePauzy) [Slowniki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MagParJednostki
    IF EXISTS(SELECT * FROM CDN.MagParJednostki JOIN deleted
            ON 
          deleted.SLW_ID = CDN.MagParJednostki.MPJ_JednostkaLog
      AND (CDN.MagParJednostki.MPJ_JednostkaLog&gt;0)
            )
        DELETE CDN.MagParJednostki
        FROM CDN.MagParJednostki JOIN deleted
        ON 
          deleted.SLW_ID = CDN.MagParJednostki.MPJ_JednostkaLog
      AND (CDN.MagParJednostki.MPJ_JednostkaLog&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SLW_ID = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=8225  and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SLW_ID = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=8225  and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WymPowiazania
    IF EXISTS(SELECT * FROM CDN.WymPowiazania JOIN deleted
            ON 
          deleted.SLW_ID = CDN.WymPowiazania.WMP_PowiazanieID
      AND (CDN.WymPowiazania.WMP_TypPowiazania=2)
            )
        DELETE CDN.WymPowiazania
        FROM CDN.WymPowiazania JOIN deleted
        ON 
          deleted.SLW_ID = CDN.WymPowiazania.WMP_PowiazanieID
      AND (CDN.WymPowiazania.WMP_TypPowiazania=2)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SLW_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=8225  and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SLW_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=8225  and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PicoRelacje
    IF EXISTS(SELECT * FROM CDN.PicoRelacje JOIN deleted
            ON 
          deleted.SLW_ID = CDN.PicoRelacje.PcR_OBINumer
      AND (CDN.PicoRelacje.PcR_OBITyp=-6560)
            )
        DELETE CDN.PicoRelacje
        FROM CDN.PicoRelacje JOIN deleted
        ON 
          deleted.SLW_ID = CDN.PicoRelacje.PcR_OBINumer
      AND (CDN.PicoRelacje.PcR_OBITyp=-6560)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PicoLog
    IF EXISTS(SELECT * FROM CDN.PicoLog JOIN deleted
            ON 
          deleted.SLW_ID = CDN.PicoLog.PcL_ObiNumer
      AND (CDN.PicoLog.PCL_ObiTyp = -6560)
            )
        DELETE CDN.PicoLog
        FROM CDN.PicoLog JOIN deleted
        ON 
          deleted.SLW_ID = CDN.PicoLog.PcL_ObiNumer
      AND (CDN.PicoLog.PCL_ObiTyp = -6560)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Slowniki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Slowniki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Slowniki_InsertUpdateHandler
  ON CDN.Slowniki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SLW_SLSId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SlownikiStruktura ON
                    inserted.SLW_SLSId = CDN.SlownikiStruktura.SLS_Id
              WHERE CDN.SlownikiStruktura.SLS_Id IS NULL
                AND (
                          IsNull(inserted.SLW_SLSId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SlownikiStruktura) [Slowniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SlownikiAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SlownikiAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SlownikiAlias1_DeleteHandler
  ON CDN.Slowniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.SrwZlcNag.SZN_SlwStatus
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.UmwNag.UmN_OpisStanuId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.SLW_ID = CDN.CRMKntEtapy.CEK_TypKnt
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMKntEtapy) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrWzorce
    IF EXISTS
       ( SELECT * FROM CDN.TwrWzorce JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrWzorce.TwW_RodzajId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrWzorce) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DaneBinarne
    IF EXISTS
       ( SELECT * FROM CDN.DaneBinarne JOIN deleted
          ON
                deleted.SLW_ID = CDN.DaneBinarne.DAB_Jezyk
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie mozna usunąć. Istnieją załączniki w tym języku./# [SlownikiAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KadrStanowiska
    IF EXISTS
       ( SELECT * FROM CDN.KadrStanowiska JOIN deleted
          ON
                deleted.SLW_ID = CDN.KadrStanowiska.KSt_SzczegolneWarunki
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KadrStanowiska) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrKarty
    IF EXISTS
       ( SELECT * FROM CDN.TwrKarty JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrKarty.Twr_StawkaKGO
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrKarty) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUbezpieczenia
    IF EXISTS
       ( SELECT * FROM CDN.OsoUbezpieczenia JOIN deleted
          ON
                deleted.SLW_ID = CDN.OsoUbezpieczenia.OUb_KodNiepelnosprawnosci
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Tytuł ubezpieczenia (niepełnosprawności) został wykorzystany w danych pracownika./# [SlownikiAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.DefNieobecnosci
    IF EXISTS
       ( SELECT * FROM CDN.DefNieobecnosci JOIN deleted
          ON
                deleted.SLW_ID = CDN.DefNieobecnosci.DNB_KodRCA
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Kod tytułu ubezpieczenia jest ustawiony na definicji nieobecności./# [SlownikiAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoRodzina
    IF EXISTS
       ( SELECT * FROM CDN.OsoRodzina JOIN deleted
          ON
                deleted.SLW_ID = CDN.OsoRodzina.OsR_KodNiepelnosprawnosci
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoRodzina) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdZasoby JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdZasoby.PZA_KodNiezgodnosci
       AND (CDN.ProdZasoby.PZA_KodNiezgodnosci&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZasoby) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjNag
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.BudzetPrjNag.BPN_ZmianaStanuId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BudzetPrjNag) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdPKJNag.PKJN_PrzyczynaOdrzucenia
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wysylki
    IF EXISTS
       ( SELECT * FROM CDN.Wysylki JOIN deleted
          ON
                deleted.SLW_ID = CDN.Wysylki.WYS_StanPrzesylki
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wysylki) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdOkresy
    IF EXISTS
       ( SELECT * FROM CDN.ProdOkresy JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdOkresy.POK_Status
       AND (CDN.ProdOkresy.POK_Status&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdOkresy) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.ZamNag.ZaN_StatusPlatnosciPOS
       AND (CDN.ZamNag.ZaN_StatusPlatnosciPOS&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [SlownikiAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.FrmObiekty
    IF EXISTS(SELECT * FROM CDN.FrmObiekty JOIN deleted
            ON 
          deleted.SLW_ID = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=4598)
            )
        DELETE CDN.FrmObiekty
        FROM CDN.FrmObiekty JOIN deleted
        ON 
          deleted.SLW_ID = CDN.FrmObiekty.FRO_GIDNumer
      AND (CDN.FrmObiekty.Fro_GIDTyp=4598)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Tlumaczenia
    IF EXISTS(SELECT * FROM CDN.Tlumaczenia JOIN deleted
            ON 
          deleted.SLW_ID = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ = 8225)
            )
        DELETE CDN.Tlumaczenia
        FROM CDN.Tlumaczenia JOIN deleted
        ON 
          deleted.SLW_ID = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ = 8225)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SlownikiAlias2_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SlownikiAlias2_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SlownikiAlias2_DeleteHandler
  ON CDN.Slowniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.UmwNag.UmN_PowodAneksuId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [SlownikiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrKarty
    IF EXISTS
       ( SELECT * FROM CDN.TwrKarty JOIN deleted
          ON
                deleted.SLW_ID = CDN.TwrKarty.Twr_RodzajId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrKarty) [SlownikiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoUbezpieczenia
    IF EXISTS
       ( SELECT * FROM CDN.OsoUbezpieczenia JOIN deleted
          ON
                deleted.SLW_ID = CDN.OsoUbezpieczenia.OUb_FEP
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć pozycji. Kod ZUS – szczeg. warunki/charakter (FEP) został wykorzystany w danych pracownika./# [SlownikiAlias2_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.ProdPKJNag.PKJN_WynikKJ
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [SlownikiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamNag
    IF EXISTS
       ( SELECT * FROM CDN.ZamNag JOIN deleted
          ON
                deleted.SLW_ID = CDN.ZamNag.ZaN_StatusRealizacji
       AND (CDN.ZamNag.ZaN_StatusRealizacji&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamNag) [SlownikiAlias2_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SlownikiStruktura_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SlownikiStruktura_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SlownikiStruktura_DeleteHandler
  ON CDN.SlownikiStruktura
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Slowniki
    IF EXISTS
       ( SELECT * FROM CDN.Slowniki JOIN deleted
          ON
                deleted.SLS_Id = CDN.Slowniki.SLW_SLSId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Slowniki) [SlownikiStruktura_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SDPKSlownik"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SDPKSlownik */</I><BR>
ALTER TABLE CDN.SlwDefPowiazaniaKont ADD CONSTRAINT FK_SDPKSlownik
 FOREIGN KEY
   (
                          SDPK_SlwId                         
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SFKPowiazania"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SFKPowiazania */</I><BR>
ALTER TABLE CDN.SlwFunkcjeKonta ADD CONSTRAINT FK_SFKPowiazania
 FOREIGN KEY
   (
                          SFK_SDPKId                        
                         )
             REFERENCES CDN.SlwDefPowiazaniaKont
                         (
                          SDPK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SLPSlownik"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SLPSlownik */</I><BR>
ALTER TABLE CDN.SlwKosztyParametry ADD CONSTRAINT FK_SLPSlownik
 FOREIGN KEY
   (
                          SLP_SlwId                         
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SlwKosztyParametry_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SlwKosztyParametry_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SlwKosztyParametry_DeleteHandler
  ON CDN.SlwKosztyParametry
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyParametry
    IF EXISTS(SELECT * FROM CDN.ProdKosztyParametry JOIN deleted
            ON 
          deleted.SLP_Id = CDN.ProdKosztyParametry.KOP_SlpId
      AND (CDN.ProdKosztyParametry.KOP_SlpId&gt;0)
            )
        DELETE CDN.ProdKosztyParametry
        FROM CDN.ProdKosztyParametry JOIN deleted
        ON 
          deleted.SLP_Id = CDN.ProdKosztyParametry.KOP_SlpId
      AND (CDN.ProdKosztyParametry.KOP_SlpId&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SLRPSlownik"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SLRPSlownik */</I><BR>
ALTER TABLE CDN.SlwRodzajePrzesylek ADD CONSTRAINT FK_SLRPSlownik
 FOREIGN KEY
   (
                          SLRP_SlwId                         
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SLDPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SLDPrimary */</I><BR>
ALTER TABLE CDN.SlwTraDokumenty ADD CONSTRAINT FK_SLDPrimary
 FOREIGN KEY
   (
                          SLD_SLTId                         
                         )
             REFERENCES CDN.SlwTransakcje
                         (
                          SLT_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SLTSlowniki"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SLTSlowniki */</I><BR>
ALTER TABLE CDN.SlwTransakcje ADD CONSTRAINT FK_SLTSlowniki
 FOREIGN KEY
   (
                          SLT_SlwId                         
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SLTISlowniki"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SLTISlowniki */</I><BR>
ALTER TABLE CDN.SlwTypyInwentaryzacjiPOS ADD CONSTRAINT FK_SLTISlowniki
 FOREIGN KEY
   (
                          SLTI_SlwId                         
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SpDPrmId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SpDPrmId */</I><BR>
ALTER TABLE CDN.SpDPromocje ADD CONSTRAINT FK_SpDPrmId
 FOREIGN KEY
   (
                          SPD_PrmId                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SpDPromocje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SpDPromocje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SpDPromocje_InsertUpdateHandler
  ON CDN.SpDPromocje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SpD_SpDTyp )  OR UPDATE( SpD_SpDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SpD_SpDTyp = 976 AND inserted.SpD_SpDLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Nazwy ON
                    inserted.SpD_SpDTyp = CDN.Nazwy.Naz_GIDTyp
                AND inserted.SpD_SpDLp = CDN.Nazwy.Naz_GIDLp
              WHERE CDN.Nazwy.Naz_GIDLp IS NULL AND (inserted.SpD_SpDTyp = 976 AND inserted.SpD_SpDLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Nazwy) [SpDPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SqlRaporty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SqlRaporty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SqlRaporty_InsertUpdateHandler
  ON CDN.SqlRaporty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SqR_StaNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.StaKarty ON
                    inserted.SqR_StaNumer = CDN.StaKarty.Sta_GIDNumer
              WHERE CDN.StaKarty.Sta_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SqR_StaNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  StaKarty) [SqlRaporty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SCCCzynnosc"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SCCCzynnosc */</I><BR>
ALTER TABLE CDN.SrsCennikCzynnosci ADD CONSTRAINT FK_SCCCzynnosc
 FOREIGN KEY
   (
                          SCC_SsCId                         
                         )
             REFERENCES CDN.SrsCzynnosci
                         (
                          SsC_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsCennikCzynnosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsCennikCzynnosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrsCennikCzynnosci_DeleteHandler
  ON CDN.SrsCennikCzynnosci
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNKartyPracyUsl
    IF EXISTS
       ( SELECT * FROM CDN.ZRNKartyPracyUsl JOIN deleted
          ON
                deleted.SCC_Id = CDN.ZRNKartyPracyUsl.ZRU_SsCId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNKartyPracyUsl) [SrsCennikCzynnosci_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsCzynnosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsCzynnosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrsCzynnosci_InsertUpdateHandler
  ON CDN.SrsCzynnosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SsC_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.SsC_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SsC_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [SrsCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SSEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SSEPrimary */</I><BR>
ALTER TABLE CDN.SrsElem ADD CONSTRAINT FK_SSEPrimary
 FOREIGN KEY
   (
                          SsE_GIDNumer                      
                         )
             REFERENCES CDN.SrsNag
                         (
                          SsN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrsElem_DeleteHandler
  ON CDN.SrsElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.SsE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND deleted.SsE_GIDLp = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=339 and  CDN.CRMDokumentyPozycje.CDP_CRMLp &lt;&gt; 0 and  CDN.CRMDokumentyPozycje.CDP_CRMLp &lt;&gt; -1)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.SsE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND deleted.SsE_GIDLp = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=339 and  CDN.CRMDokumentyPozycje.CDP_CRMLp &lt;&gt; 0 and  CDN.CRMDokumentyPozycje.CDP_CRMLp &lt;&gt; -1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyElemObiekty
    IF EXISTS(SELECT * FROM CDN.CRMWizytyElemObiekty JOIN deleted
            ON 
          deleted.SsE_GIDNumer = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND deleted.SsE_GIDLp = CDN.CRMWizytyElemObiekty.CWO_ObiLp
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=339 and  CDN.CRMWizytyElemObiekty.CWO_ObiLp &lt;&gt; 0)
            )
        DELETE CDN.CRMWizytyElemObiekty
        FROM CDN.CRMWizytyElemObiekty JOIN deleted
        ON 
          deleted.SsE_GIDNumer = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND deleted.SsE_GIDLp = CDN.CRMWizytyElemObiekty.CWO_ObiLp
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=339 and  CDN.CRMWizytyElemObiekty.CWO_ObiLp &lt;&gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.SsE_GIDNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND deleted.SsE_GIDLp = CDN.CRMDokumentyLinki.CDL_CRMLp
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=339 and  CDN.CRMDokumentyLinki.CDL_CRMLp &lt;&gt; 0 and  CDN.CRMDokumentyLinki.CDL_CRMLp &lt;&gt; -1)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.SsE_GIDNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND deleted.SsE_GIDLp = CDN.CRMDokumentyLinki.CDL_CRMLp
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=339 and  CDN.CRMDokumentyLinki.CDL_CRMLp &lt;&gt; 0 and  CDN.CRMDokumentyLinki.CDL_CRMLp &lt;&gt; -1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMZadaniaObiekty
    IF EXISTS(SELECT * FROM CDN.CRMZadaniaObiekty JOIN deleted
            ON 
          deleted.SsE_GIDNumer = CDN.CRMZadaniaObiekty.CZO_SseNumer
      AND deleted.SsE_GIDLp = CDN.CRMZadaniaObiekty.CZO_SseLP
      AND (CDN.CRMZadaniaObiekty.Czo_SseNumer&gt;0)
            )
        DELETE CDN.CRMZadaniaObiekty
        FROM CDN.CRMZadaniaObiekty JOIN deleted
        ON 
          deleted.SsE_GIDNumer = CDN.CRMZadaniaObiekty.CZO_SseNumer
      AND deleted.SsE_GIDLp = CDN.CRMZadaniaObiekty.CZO_SseLP
      AND (CDN.CRMZadaniaObiekty.Czo_SseNumer&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.SsE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.SsE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp=339 AND CDN.DaneObiekty.DAO_ObiLp &gt; 0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.SsE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.SsE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp=339 AND CDN.DaneObiekty.DAO_ObiLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zadania
    IF EXISTS(SELECT * FROM CDN.Zadania JOIN deleted
            ON 
          deleted.SsE_GIDNumer = CDN.Zadania.Zad_ZrdNumer
      AND deleted.SsE_GIDLp = CDN.Zadania.Zad_ZrdLp
      AND (CDN.Zadania.ZAD_ZrdTyp=339)
            )
        DELETE CDN.Zadania
        FROM CDN.Zadania JOIN deleted
        ON 
          deleted.SsE_GIDNumer = CDN.Zadania.Zad_ZrdNumer
      AND deleted.SsE_GIDLp = CDN.Zadania.Zad_ZrdLp
      AND (CDN.Zadania.ZAD_ZrdTyp=339)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SsE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SsE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=339 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SsE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SsE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=339 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SsE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.SsE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=339 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SsE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.SsE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=339 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrsElem_InsertUpdateHandler
  ON CDN.SrsElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SsE_OpePNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SSE_OpePTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.SsE_OpePNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.SSE_OpePTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [SrsElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsE_OpePNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SSE_OpePTyp=4272)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.SsE_OpePNumer = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL AND (inserted.SSE_OpePTyp=4272)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [SrsElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsE_TypId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SsE_TypId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SsE_TypId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [SrsElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsE_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SsE_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SsE_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SsE_AkwTyp=32)
                AND (
                          IsNull(inserted.SsE_AkwNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrsElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrsNag_DeleteHandler
  ON CDN.SrsNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.SsN_GIDNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=339 and  CDN.CRMDokumentyPozycje.CDP_CRMLp=0)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.SsN_GIDNumer = CDN.CRMDokumentyPozycje.CDP_CRMNumer
      AND (CDN.CRMDokumentyPozycje.CDP_CRMTyp=339 and  CDN.CRMDokumentyPozycje.CDP_CRMLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyElemObiekty
    IF EXISTS(SELECT * FROM CDN.CRMWizytyElemObiekty JOIN deleted
            ON 
          deleted.SsN_GIDNumer = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=339 and  CDN.CRMWizytyElemObiekty.CWO_ObiLp=0)
            )
        DELETE CDN.CRMWizytyElemObiekty
        FROM CDN.CRMWizytyElemObiekty JOIN deleted
        ON 
          deleted.SsN_GIDNumer = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=339 and  CDN.CRMWizytyElemObiekty.CWO_ObiLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.SsN_GIDNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=339 and  CDN.CRMDokumentyLinki.CDL_CRMLp=0)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.SsN_GIDNumer = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=339 and  CDN.CRMDokumentyLinki.CDL_CRMLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.SsN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=339 AND CDN.DaneObiekty.DAO_ObiLp=0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.SsN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=339 AND CDN.DaneObiekty.DAO_ObiLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SsN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=339 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SsN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=339 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SsN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=339 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SsN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=339 and CDN.AtrybutyHist.Ath_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrsNag_InsertUpdateHandler
  ON CDN.SrsNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SsN_KntNumer )  OR UPDATE( SsN_OsobaLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SsN_OsobaLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.SsN_KntNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.SsN_OsobaLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.SsN_OsobaLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [SrsNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SsN_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SsN_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SsN_AkwTyp=32)
                AND (
                          IsNull(inserted.SsN_AkwNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrsNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsN_OpeNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SsN_OpeTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.SsN_OpeNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.SsN_OpeTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [SrsNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SsN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SsN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SsN_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrsNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsObiekty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsObiekty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrsObiekty_DeleteHandler
  ON CDN.SrsObiekty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNPlanyNag
    IF EXISTS
       ( SELECT * FROM CDN.ZRNPlanyNag JOIN deleted
          ON
                deleted.SOb_GIDTyp = CDN.ZRNPlanyNag.ZPN_SObTyp
            AND deleted.SOb_GIDNumer = CDN.ZRNPlanyNag.ZPN_SObNumer
       AND (CDN.ZRNPlanyNag.ZpN_SObTyp=6656)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNPlanyNag) [SrsObiekty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemNag
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemNag JOIN deleted
          ON
                deleted.SOb_GIDTyp = CDN.ZlcRemNag.ZRN_SOBTyp
            AND deleted.SOb_GIDNumer = CDN.ZlcRemNag.ZRN_SOBNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemNag) [SrsObiekty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Odleglosci
    IF EXISTS(SELECT * FROM CDN.Odleglosci JOIN deleted
            ON 
          deleted.SOb_GIDTyp = CDN.Odleglosci.Odl_OdTyp
      AND deleted.SOb_GIDNumer = CDN.Odleglosci.Odl_OdNumer
            )
        DELETE CDN.Odleglosci
        FROM CDN.Odleglosci JOIN deleted
        ON 
          deleted.SOb_GIDTyp = CDN.Odleglosci.Odl_OdTyp
      AND deleted.SOb_GIDNumer = CDN.Odleglosci.Odl_OdNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrsWyposazenia
    IF EXISTS(SELECT * FROM CDN.SrsWyposazenia JOIN deleted
            ON 
          deleted.SOb_GIDTyp = CDN.SrsWyposazenia.SsW_SobTyp
      AND deleted.SOb_GIDNumer = CDN.SrsWyposazenia.SsW_SObNumer
            )
        DELETE CDN.SrsWyposazenia
        FROM CDN.SrsWyposazenia JOIN deleted
        ON 
          deleted.SOb_GIDTyp = CDN.SrsWyposazenia.SsW_SobTyp
      AND deleted.SOb_GIDNumer = CDN.SrsWyposazenia.SsW_SObNumer
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrsObiekty_InsertUpdateHandler
  ON CDN.SrsObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SOb_PrcNumerS ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SOb_PrcNumerS = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SOb_PrcNumerS,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrsObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SOb_PrcNumerO ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SOb_PrcNumerO = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SOb_PrcNumerO,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrsObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SOb_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Sob_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SOb_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Sob_KntTyp=32)
                AND (
                          IsNull(inserted.SOb_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrsObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SOb_KntNumerW ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SOb_KntNumerW = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SOb_KntNumerW,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrsObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsObiektyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsObiektyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrsObiektyAlias_DeleteHandler
  ON CDN.SrsObiekty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Odleglosci
    IF EXISTS(SELECT * FROM CDN.Odleglosci JOIN deleted
            ON 
          deleted.SOb_GIDTyp = CDN.Odleglosci.Odl_DoTyp
      AND deleted.SOb_GIDNumer = CDN.Odleglosci.Odl_DoNumer
            )
        DELETE CDN.Odleglosci
        FROM CDN.Odleglosci JOIN deleted
        ON 
          deleted.SOb_GIDTyp = CDN.Odleglosci.Odl_DoTyp
      AND deleted.SOb_GIDNumer = CDN.Odleglosci.Odl_DoNumer
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsWypDefinicje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsWypDefinicje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrsWypDefinicje_DeleteHandler
  ON CDN.SrsWypDefinicje
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsWypRodzaje
    IF EXISTS
       ( SELECT * FROM CDN.SrsWypRodzaje JOIN deleted
          ON
                deleted.SsD_Id = CDN.SrsWypRodzaje.RWp_SsDId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsWypRodzaje) [SrsWypDefinicje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsWyposazenia
    IF EXISTS
       ( SELECT * FROM CDN.SrsWyposazenia JOIN deleted
          ON
                deleted.SsD_Id = CDN.SrsWyposazenia.SsW_DefId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsWyposazenia) [SrsWypDefinicje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsWypRodzaje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsWypRodzaje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrsWypRodzaje_DeleteHandler
  ON CDN.SrsWypRodzaje
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsWyposazenia
    IF EXISTS
       ( SELECT * FROM CDN.SrsWyposazenia JOIN deleted
          ON
                deleted.RWp_Id = CDN.SrsWyposazenia.SsW_RodzajId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsWyposazenia) [SrsWypRodzaje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsWypRodzaje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsWypRodzaje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrsWypRodzaje_InsertUpdateHandler
  ON CDN.SrsWypRodzaje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( RWp_SsDId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsWypDefinicje ON
                    inserted.RWp_SsDId = CDN.SrsWypDefinicje.SsD_Id
              WHERE CDN.SrsWypDefinicje.SsD_Id IS NULL
                AND (
                          IsNull(inserted.RWp_SsDId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsWypDefinicje) [SrsWypRodzaje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SSWKontrahent"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SSWKontrahent */</I><BR>
ALTER TABLE CDN.SrsWyposazenia ADD CONSTRAINT FK_SSWKontrahent
 FOREIGN KEY
   (
                          SsW_KntNumer                      
                         )
             REFERENCES CDN.KntKarty
                         (
                          Knt_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsWyposazenia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsWyposazenia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrsWyposazenia_DeleteHandler
  ON CDN.SrsWyposazenia
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsWyposazenia
    IF EXISTS
       ( SELECT * FROM CDN.SrsWyposazenia JOIN deleted
          ON
                deleted.SsW_Id = CDN.SrsWyposazenia.SsW_ParId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsWyposazenia) [SrsWyposazenia_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNPlanyElem
    IF EXISTS
       ( SELECT * FROM CDN.ZRNPlanyElem JOIN deleted
          ON
                deleted.SsW_Id = CDN.ZRNPlanyElem.ZPE_SsWId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNPlanyElem) [SrsWyposazenia_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemElem
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemElem JOIN deleted
          ON
                deleted.SsW_Id = CDN.ZlcRemElem.ZRE_SsWId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemElem) [SrsWyposazenia_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SsW_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=7040 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SsW_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=7040 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SsW_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=7040 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SsW_Id = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=7040 and CDN.AtrybutyHist.Ath_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsWyposazenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsWyposazenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrsWyposazenia_InsertUpdateHandler
  ON CDN.SrsWyposazenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SsW_RodzajId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsWypRodzaje ON
                    inserted.SsW_RodzajId = CDN.SrsWypRodzaje.RWp_Id
              WHERE CDN.SrsWypRodzaje.RWp_Id IS NULL
                AND (
                          IsNull(inserted.SsW_RodzajId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsWypRodzaje) [SrsWyposazenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsW_RodzajPaliwaId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SsW_RodzajPaliwaId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SsW_RodzajPaliwaId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [SrsWyposazenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsW_DefId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsWypDefinicje ON
                    inserted.SsW_DefId = CDN.SrsWypDefinicje.SsD_Id
              WHERE CDN.SrsWypDefinicje.SsD_Id IS NULL
                AND (
                          IsNull(inserted.SsW_DefId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsWypDefinicje) [SrsWyposazenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsW_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.SsW_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SsW_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [SrsWyposazenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SsW_SobTyp )  OR UPDATE( SsW_SObNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsObiekty ON
                    inserted.SsW_SobTyp = CDN.SrsObiekty.SOb_GIDTyp
                AND inserted.SsW_SObNumer = CDN.SrsObiekty.SOb_GIDNumer
              WHERE CDN.SrsObiekty.SOb_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SsW_SobTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SsW_SObNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsObiekty) [SrsWyposazenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrsWyposazeniaAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrsWyposazeniaAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrsWyposazeniaAlias_InsertUpdateHandler
  ON CDN.SrsWyposazenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SsW_ParId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsWyposazenia ON
                    inserted.SsW_ParId = CDN.SrsWyposazenia.SsW_Id
              WHERE CDN.SrsWyposazenia.SsW_Id IS NULL
                AND (
                          IsNull(inserted.SsW_ParId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsWyposazenia) [SrsWyposazeniaAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SDZSrtNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SDZSrtNumer */</I><BR>
ALTER TABLE CDN.SrtDokZakupu ADD CONSTRAINT FK_SDZSrtNumer
 FOREIGN KEY
   (
                          SDZ_SrtNumer                      
                         )
             REFERENCES CDN.SrtKarty
                         (
                          Srt_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtDokZakupu_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtDokZakupu_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrtDokZakupu_InsertUpdateHandler
  ON CDN.SrtDokZakupu
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SDZ_DokTyp )  OR UPDATE( SDZ_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SDZ_DokTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.SDZ_DokTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.SDZ_DokNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.SDZ_DokTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [SrtDokZakupu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SDZ_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SDZ_DokTyp in (4144,4145,4146))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.SDZ_DokNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.SDZ_DokTyp in (4144,4145,4146))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [SrtDokZakupu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SDZ_DokTyp )  OR UPDATE( SDZ_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SDZ_DokTyp in (3376,3378,3379,3386,3387))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.SDZ_DokTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.SDZ_DokNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (inserted.SDZ_DokTyp in (3376,3378,3379,3386,3387))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [SrtDokZakupu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SDZ_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SDZ_DokTyp in (3344,3352))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.SDZ_DokNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.SDZ_DokTyp in (3344,3352))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [SrtDokZakupu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtGrupy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtGrupy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrtGrupy_DeleteHandler
  ON CDN.SrtGrupy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiekty JOIN deleted
          ON
                deleted.SrG_GIDNumer = CDN.ProdObiekty.POB_ObiNumer
            AND deleted.SrG_GIDTyp = CDN.ProdObiekty.POB_ObiTyp
       AND (CDN.ProdObiekty.POB_ObiTyp=-368)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiekty) [SrtGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SHEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SHEPrimary */</I><BR>
ALTER TABLE CDN.SrtHistElem ADD CONSTRAINT FK_SHEPrimary
 FOREIGN KEY
   (
                          SHE_GIDTyp                        ,
                          SHE_GIDNumer                      
                         )
             REFERENCES CDN.SrtHistNag
                         (
                          SHN_GIDTyp                        ,
                          SHN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtHistElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtHistElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrtHistElem_DeleteHandler
  ON CDN.SrtHistElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SHE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SHE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.SHE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (  CDN.Atrybuty.Atr_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532  ) AND CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SHE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SHE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.SHE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (  CDN.Atrybuty.Atr_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532  ) AND CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SHE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SHE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.SHE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (  CDN.AtrybutyHist.Ath_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532  ) AND CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SHE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SHE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.SHE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (  CDN.AtrybutyHist.Ath_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532  ) AND CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtHistElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtHistElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrtHistElem_InsertUpdateHandler
  ON CDN.SrtHistElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SHE_SZEId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtZestElem ON
                    inserted.SHE_SZEId = CDN.SrtZestElem.SZE_ID
              WHERE CDN.SrtZestElem.SZE_ID IS NULL
                AND (
                          IsNull(inserted.SHE_SZEId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtZestElem) [SrtHistElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SHE_ITAId )  OR UPDATE( SHE_IAELp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImtArkuszeElem ON
                    inserted.SHE_ITAId = CDN.ImtArkuszeElem.IAE_ITAId
                AND inserted.SHE_IAELp = CDN.ImtArkuszeElem.IAE_Lp
              WHERE CDN.ImtArkuszeElem.IAE_Lp IS NULL
                AND (
                          IsNull(inserted.SHE_ITAId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SHE_IAELp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImtArkuszeElem) [SrtHistElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SHE_KnDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SHE_KnDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SHE_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SHE_KnDTyp=32)
                AND (
                          IsNull(inserted.SHE_KnDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrtHistElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SHE_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SHE_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SHE_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrtHistElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SHE_SrtNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.SHE_SrtNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SHE_SrtNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [SrtHistElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtHistNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtHistNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrtHistNag_DeleteHandler
  ON CDN.SrtHistNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.SHN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.SHN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (2304, 2064, 2162, 6208, 2096, 2224, 2432, 2496, 2048, 2176, 2080, 2128, 2532, 2112, 2552, 2160, 2548, 2144, 2556, 2288, 2192))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.SHN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.SHN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (2304, 2064, 2162, 6208, 2096, 2224, 2432, 2496, 2048, 2176, 2080, 2128, 2532, 2112, 2552, 2160, 2548, 2144, 2556, 2288, 2192))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SHN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SHN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (  CDN.Atrybuty.Atr_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532 ) AND CDN.Atrybuty.Atr_OBILp=0 and          CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SHN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SHN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (  CDN.Atrybuty.Atr_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532 ) AND CDN.Atrybuty.Atr_OBILp=0 and          CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.SHN_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.SHN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=2048 OR CDN.Predekrety.PDT_GIDTyp=2064  OR           CDN.Predekrety.PDT_GIDTyp=2080 OR CDN.Predekrety.PDT_GIDTyp=2096 OR CDN.Predekrety.PDT_GIDTyp=2112 OR          CDN.Predekrety.PDT_GIDTyp=2128 OR CDN.Predekrety.PDT_GIDTyp=2144)
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.SHN_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.SHN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=2048 OR CDN.Predekrety.PDT_GIDTyp=2064  OR           CDN.Predekrety.PDT_GIDTyp=2080 OR CDN.Predekrety.PDT_GIDTyp=2096 OR CDN.Predekrety.PDT_GIDTyp=2112 OR          CDN.Predekrety.PDT_GIDTyp=2128 OR CDN.Predekrety.PDT_GIDTyp=2144)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SHN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SHN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (  CDN.AtrybutyHist.Ath_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532 ) AND CDN.AtrybutyHist.Ath_OBILp=0 and          CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SHN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SHN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (  CDN.AtrybutyHist.Ath_OBITyp in ( 2048, 2064, 2096, 2112, 2128, 2144,   2160, 2176, 2192, 2224, 2288, 2304, 6208, 2432, 2496, 2552, 2556, 2548,  2532, 2548, 2532 ) AND CDN.AtrybutyHist.Ath_OBILp=0 and          CDN.AtrybutyHist.Ath_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtHistNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtHistNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrtHistNag_InsertUpdateHandler
  ON CDN.SrtHistNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SHN_ITNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImtNag ON
                    inserted.SHN_ITNId = CDN.ImtNag.ITN_ID
              WHERE CDN.ImtNag.ITN_ID IS NULL
                AND (
                          IsNull(inserted.SHN_ITNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImtNag) [SrtHistNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtKST_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtKST_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrtKST_DeleteHandler
  ON CDN.SrtKST
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtKarty
    IF EXISTS
       ( SELECT * FROM CDN.SrtKarty JOIN deleted
          ON
                deleted.SKT_ID = CDN.SrtKarty.Srt_SKTId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtKarty) [SrtKST_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtKarty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtKarty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrtKarty_DeleteHandler
  ON CDN.SrtKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImtOdczytyElem
    IF EXISTS
       ( SELECT * FROM CDN.ImtOdczytyElem JOIN deleted
          ON
                deleted.Srt_GIDNumer = CDN.ImtOdczytyElem.IOE_SrtNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImtOdczytyElem) [SrtKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraVat
    IF EXISTS
       ( SELECT * FROM CDN.TraVat JOIN deleted
          ON
                deleted.Srt_GIDNumer = CDN.TraVat.TRV_SrtNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraVat) [SrtKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmlPrzedmioty
    IF EXISTS
       ( SELECT * FROM CDN.UmlPrzedmioty JOIN deleted
          ON
                deleted.Srt_GIDNumer = CDN.UmlPrzedmioty.ULP_SRTNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmlPrzedmioty) [SrtKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.Srt_GIDNumer = CDN.SrwUrzadzenia.SrU_ObiNumer
       AND (CDN.SrwUrzadzenia.SrU_ObiTyp=368)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwUrzadzenia) [SrtKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiekty JOIN deleted
          ON
                deleted.Srt_GIDNumer = CDN.ProdObiekty.POB_ObiNumer
       AND (CDN.ProdObiekty.POB_ObiTyp=368)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiekty) [SrtKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtHistElem
    IF EXISTS
       ( SELECT * FROM CDN.SrtHistElem JOIN deleted
          ON
                deleted.Srt_GIDNumer = CDN.SrtHistElem.SHE_SrtNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtHistElem) [SrtKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklElem
    IF EXISTS
       ( SELECT * FROM CDN.ReklElem JOIN deleted
          ON
                deleted.Srt_GIDNumer = CDN.ReklElem.RLE_SrtId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ReklElem) [SrtKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.Srt_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=368)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.Srt_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=368)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.Srt_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=368)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.Srt_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=368)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.Srt_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=368)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.Srt_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=368)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtKarty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtKarty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrtKarty_InsertUpdateHandler
  ON CDN.SrtKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Srt_SamId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Samochody ON
                    inserted.Srt_SamId = CDN.Samochody.SaM_Id
              WHERE CDN.Samochody.SaM_Id IS NULL
                AND (
                          IsNull(inserted.Srt_SamId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Samochody) [SrtKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Srt_KnDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Srt_KnDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Srt_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Srt_KnDTyp=32)
                AND (
                          IsNull(inserted.Srt_KnDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrtKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Srt_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.Srt_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Srt_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrtKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Srt_SKTId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKST ON
                    inserted.Srt_SKTId = CDN.SrtKST.SKT_ID
              WHERE CDN.SrtKST.SKT_ID IS NULL
                AND (
                          IsNull(inserted.Srt_SKTId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKST) [SrtKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SrOSrt"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SrOSrt */</I><BR>
ALTER TABLE CDN.SrtOpisy ADD CONSTRAINT FK_SrOSrt
 FOREIGN KEY
   (
                          SrO_SrtNumer                      
                         )
             REFERENCES CDN.SrtKarty
                         (
                          Srt_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SEZPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SEZPrimary */</I><BR>
ALTER TABLE CDN.SrtSezon ADD CONSTRAINT FK_SEZPrimary
 FOREIGN KEY
   (
                          SEZ_GIDNumer                      
                         )
             REFERENCES CDN.SrtKarty
                         (
                          Srt_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtWzorce_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtWzorce_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrtWzorce_DeleteHandler
  ON CDN.SrtWzorce
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SrW_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SrW_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp=-368 and  CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SrW_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.SrW_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp=-368 and  CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.SrW_GrpTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SrW_GrpNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=-368 and  CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.SrW_GrpTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.SrW_GrpNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=-368 and  CDN.AtrybutyHist.Ath_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrtZestElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrtZestElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrtZestElem_DeleteHandler
  ON CDN.SrtZestElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrtHistElem
    IF EXISTS
       ( SELECT * FROM CDN.SrtHistElem JOIN deleted
          ON
                deleted.SZE_ID = CDN.SrtHistElem.SHE_SZEId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrtHistElem) [SrtZestElem_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SCZUrzadzenie"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SCZUrzadzenie */</I><BR>
ALTER TABLE CDN.SrwCzesciZamienne ADD CONSTRAINT FK_SCZUrzadzenie
 FOREIGN KEY
   (
                          SCZ_SruId                         
                         )
             REFERENCES CDN.SrwUrzadzenia
                         (
                          SrU_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SCZTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SCZTowar */</I><BR>
ALTER TABLE CDN.SrwCzesciZamienne ADD CONSTRAINT FK_SCZTowar
 FOREIGN KEY
   (
                          SCZ_TwrId                         
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwObiektyReceptury_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwObiektyReceptury_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwObiektyReceptury_InsertUpdateHandler
  ON CDN.SrwObiektyReceptury
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SOR_SrcId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SOR_SRCId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwRecepturyCzynnosci ON
                    inserted.SOR_SrcId = CDN.SrwRecepturyCzynnosci.SRC_Id
              WHERE CDN.SrwRecepturyCzynnosci.SRC_Id IS NULL AND (inserted.SOR_SRCId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwRecepturyCzynnosci) [SrwObiektyReceptury_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SOR_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SOR_ObiTyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.SOR_ObiNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.SOR_ObiTyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [SrwObiektyReceptury_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SOR_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SOR_ObiTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SOR_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SOR_ObiTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrwObiektyReceptury_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SOR_SreId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwReceptury ON
                    inserted.SOR_SreId = CDN.SrwReceptury.SRE_Id
              WHERE CDN.SrwReceptury.SRE_Id IS NULL
                AND (
                          IsNull(inserted.SOR_SreId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwReceptury) [SrwObiektyReceptury_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SEPPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SEPPrimary */</I><BR>
ALTER TABLE CDN.SrwPlanDokumenty ADD CONSTRAINT FK_SEPPrimary
 FOREIGN KEY
   (
                          SED_SPPId                         ,
                          SED_SrUId                         
                         )
             REFERENCES CDN.SrwPlanElem
                         (
                          SPE_SPPId                         ,
                          SPE_SrUId                         
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwPlanDokumenty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwPlanDokumenty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwPlanDokumenty_InsertUpdateHandler
  ON CDN.SrwPlanDokumenty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SED_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SED_DokTyp=4700)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.SED_DokNumer = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL AND (inserted.SED_DokTyp=4700)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [SrwPlanDokumenty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SPESPP"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SPESPP */</I><BR>
ALTER TABLE CDN.SrwPlanElem ADD CONSTRAINT FK_SPESPP
 FOREIGN KEY
   (
                          SPE_SPPId                         
                         )
             REFERENCES CDN.SrwPlanPrzegladu
                         (
                          SPP_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwPlanElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwPlanElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwPlanElem_DeleteHandler
  ON CDN.SrwPlanElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwSruHistoriaDok
    IF EXISTS(SELECT * FROM CDN.SrwSruHistoriaDok JOIN deleted
            ON 
          deleted.SPE_SrUId = CDN.SrwSruHistoriaDok.SSHD_SruId
      AND deleted.SPE_SPPId = CDN.SrwSruHistoriaDok.SSHD_DokNumer
      AND (CDN.SrwSruHistoriaDok.SSHD_DokTyp=4710)
            )
        DELETE CDN.SrwSruHistoriaDok
        FROM CDN.SrwSruHistoriaDok JOIN deleted
        ON 
          deleted.SPE_SrUId = CDN.SrwSruHistoriaDok.SSHD_SruId
      AND deleted.SPE_SPPId = CDN.SrwSruHistoriaDok.SSHD_DokNumer
      AND (CDN.SrwSruHistoriaDok.SSHD_DokTyp=4710)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwPlanElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwPlanElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwPlanElem_InsertUpdateHandler
  ON CDN.SrwPlanElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SPE_SrUId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SPE_SrUId = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL
                AND (
                          IsNull(inserted.SPE_SrUId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwPlanElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwPlanPrzegladu_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwPlanPrzegladu_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwPlanPrzegladu_DeleteHandler
  ON CDN.SrwPlanPrzegladu
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.SPP_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4710)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.SPP_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4710)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SPP_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4710 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SPP_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4710 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.SPP_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=4710)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.SPP_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=4710)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwSruHistoriaDok
    IF EXISTS(SELECT * FROM CDN.SrwSruHistoriaDok JOIN deleted
            ON 
          deleted.SPP_Id = CDN.SrwSruHistoriaDok.SSHD_DokNumer
      AND (CDN.SrwSruHistoriaDok.SSHD_DokTyp=4710)
            )
        DELETE CDN.SrwSruHistoriaDok
        FROM CDN.SrwSruHistoriaDok JOIN deleted
        ON 
          deleted.SPP_Id = CDN.SrwSruHistoriaDok.SSHD_DokNumer
      AND (CDN.SrwSruHistoriaDok.SSHD_DokTyp=4710)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwPlanPrzegladu_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwPlanPrzegladu_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwPlanPrzegladu_InsertUpdateHandler
  ON CDN.SrwPlanPrzegladu
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SPP_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.SPP_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.SPP_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [SrwPlanPrzegladu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SPP_KntTyp )  OR UPDATE( SPP_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SPP_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SPP_KntTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.SPP_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SPP_KntTyp=32)
                AND (
                          IsNull(inserted.SPP_KntTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SPP_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrwPlanPrzegladu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SPP_SURId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzRodzaje ON
                    inserted.SPP_SURId = CDN.SrwUrzRodzaje.SUR_Id
              WHERE CDN.SrwUrzRodzaje.SUR_Id IS NULL
                AND (
                          IsNull(inserted.SPP_SURId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzRodzaje) [SrwPlanPrzegladu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SPP_STPId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwTypyPrzegladu ON
                    inserted.SPP_STPId = CDN.SrwTypyPrzegladu.STP_Id
              WHERE CDN.SrwTypyPrzegladu.STP_Id IS NULL
                AND (
                          IsNull(inserted.SPP_STPId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwTypyPrzegladu) [SrwPlanPrzegladu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SPP_PrjId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.SPP_PrjId = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.SPP_PrjId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [SrwPlanPrzegladu_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwReceptury_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwReceptury_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwReceptury_DeleteHandler
  ON CDN.SrwReceptury
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwRecepturyCzynnosci
    IF EXISTS(SELECT * FROM CDN.SrwRecepturyCzynnosci JOIN deleted
            ON 
          deleted.SRE_Id = CDN.SrwRecepturyCzynnosci.SRC_SREId
            )
        DELETE CDN.SrwRecepturyCzynnosci
        FROM CDN.SrwRecepturyCzynnosci JOIN deleted
        ON 
          deleted.SRE_Id = CDN.SrwRecepturyCzynnosci.SRC_SREId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwRecepturySkladniki
    IF EXISTS(SELECT * FROM CDN.SrwRecepturySkladniki JOIN deleted
            ON 
          deleted.SRE_Id = CDN.SrwRecepturySkladniki.SRS_SreId
            )
        DELETE CDN.SrwRecepturySkladniki
        FROM CDN.SrwRecepturySkladniki JOIN deleted
        ON 
          deleted.SRE_Id = CDN.SrwRecepturySkladniki.SRS_SreId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwObiektyReceptury
    IF EXISTS(SELECT * FROM CDN.SrwObiektyReceptury JOIN deleted
            ON 
          deleted.SRE_Id = CDN.SrwObiektyReceptury.SOR_SreId
            )
        DELETE CDN.SrwObiektyReceptury
        FROM CDN.SrwObiektyReceptury JOIN deleted
        ON 
          deleted.SRE_Id = CDN.SrwObiektyReceptury.SOR_SreId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcUrz
    IF EXISTS(SELECT * FROM CDN.SrwZlcUrz JOIN deleted
            ON 
          deleted.SRE_Id = CDN.SrwZlcUrz.SZU_SREId
            )
        DELETE CDN.SrwZlcUrz
        FROM CDN.SrwZlcUrz JOIN deleted
        ON 
          deleted.SRE_Id = CDN.SrwZlcUrz.SZU_SREId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcCzynnosci
    IF EXISTS(SELECT * FROM CDN.SrwZlcCzynnosci JOIN deleted
            ON 
          deleted.SRE_Id = CDN.SrwZlcCzynnosci.SZC_SREId
            )
        DELETE CDN.SrwZlcCzynnosci
        FROM CDN.SrwZlcCzynnosci JOIN deleted
        ON 
          deleted.SRE_Id = CDN.SrwZlcCzynnosci.SZC_SREId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcObiekty
    IF EXISTS(SELECT * FROM CDN.SrwZlcObiekty JOIN deleted
            ON 
          deleted.SRE_Id = CDN.SrwZlcObiekty.SZO_SREId
            )
        DELETE CDN.SrwZlcObiekty
        FROM CDN.SrwZlcObiekty JOIN deleted
        ON 
          deleted.SRE_Id = CDN.SrwZlcObiekty.SZO_SREId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcSkladniki
    IF EXISTS(SELECT * FROM CDN.SrwZlcSkladniki JOIN deleted
            ON 
          deleted.SRE_Id = CDN.SrwZlcSkladniki.SZS_SREId
            )
        DELETE CDN.SrwZlcSkladniki
        FROM CDN.SrwZlcSkladniki JOIN deleted
        ON 
          deleted.SRE_Id = CDN.SrwZlcSkladniki.SZS_SREId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwReceptury_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwReceptury_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwReceptury_InsertUpdateHandler
  ON CDN.SrwReceptury
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SRE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SRE_ObiTyp=4701)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SRE_ObiNumer = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL AND (inserted.SRE_ObiTyp=4701)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwReceptury_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SRE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SRE_ObiTyp=4706)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzRodzaje ON
                    inserted.SRE_ObiNumer = CDN.SrwUrzRodzaje.SUR_Id
              WHERE CDN.SrwUrzRodzaje.SUR_Id IS NULL AND (inserted.SRE_ObiTyp=4706)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzRodzaje) [SrwReceptury_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SRE_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SRE_ObiTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.SRE_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.SRE_ObiTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [SrwReceptury_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SRCTowary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SRCTowary */</I><BR>
ALTER TABLE CDN.SrwRecepturyCzynnosci ADD CONSTRAINT FK_SRCTowary
 FOREIGN KEY
   (
                          SRC_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwRecepturyCzynnosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwRecepturyCzynnosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwRecepturyCzynnosci_DeleteHandler
  ON CDN.SrwRecepturyCzynnosci
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwRecepturySkladniki
    IF EXISTS(SELECT * FROM CDN.SrwRecepturySkladniki JOIN deleted
            ON 
          deleted.SRC_Id = CDN.SrwRecepturySkladniki.SRS_SrcId
            )
        DELETE CDN.SrwRecepturySkladniki
        FROM CDN.SrwRecepturySkladniki JOIN deleted
        ON 
          deleted.SRC_Id = CDN.SrwRecepturySkladniki.SRS_SrcId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwObiektyReceptury
    IF EXISTS(SELECT * FROM CDN.SrwObiektyReceptury JOIN deleted
            ON 
          deleted.SRC_Id = CDN.SrwObiektyReceptury.SOR_SrcId
      AND (CDN.SrwObiektyReceptury.SOR_SRCId&gt;0)
            )
        DELETE CDN.SrwObiektyReceptury
        FROM CDN.SrwObiektyReceptury JOIN deleted
        ON 
          deleted.SRC_Id = CDN.SrwObiektyReceptury.SOR_SrcId
      AND (CDN.SrwObiektyReceptury.SOR_SRCId&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwRecepturyCzynnosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwRecepturyCzynnosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwRecepturyCzynnosci_InsertUpdateHandler
  ON CDN.SrwRecepturyCzynnosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SRC_SREId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwReceptury ON
                    inserted.SRC_SREId = CDN.SrwReceptury.SRE_Id
              WHERE CDN.SrwReceptury.SRE_Id IS NULL
                AND (
                          IsNull(inserted.SRC_SREId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwReceptury) [SrwRecepturyCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SRSTowary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SRSTowary */</I><BR>
ALTER TABLE CDN.SrwRecepturySkladniki ADD CONSTRAINT FK_SRSTowary
 FOREIGN KEY
   (
                          SRS_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwRecepturySkladniki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwRecepturySkladniki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwRecepturySkladniki_InsertUpdateHandler
  ON CDN.SrwRecepturySkladniki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SRS_SrcId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwRecepturyCzynnosci ON
                    inserted.SRS_SrcId = CDN.SrwRecepturyCzynnosci.SRC_Id
              WHERE CDN.SrwRecepturyCzynnosci.SRC_Id IS NULL
                AND (
                          IsNull(inserted.SRS_SrcId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwRecepturyCzynnosci) [SrwRecepturySkladniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SRS_SreId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwReceptury ON
                    inserted.SRS_SreId = CDN.SrwReceptury.SRE_Id
              WHERE CDN.SrwReceptury.SRE_Id IS NULL
                AND (
                          IsNull(inserted.SRS_SreId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwReceptury) [SrwRecepturySkladniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwSruHistoriaDok_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwSruHistoriaDok_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwSruHistoriaDok_InsertUpdateHandler
  ON CDN.SrwSruHistoriaDok
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SSHD_SruId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SSHD_SruId = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL
                AND (
                          IsNull(inserted.SSHD_SruId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwSruHistoriaDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SSHD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SSHD_DokTyp=4710)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwPlanPrzegladu ON
                    inserted.SSHD_DokNumer = CDN.SrwPlanPrzegladu.SPP_Id
              WHERE CDN.SrwPlanPrzegladu.SPP_Id IS NULL AND (inserted.SSHD_DokTyp=4710)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwPlanPrzegladu) [SrwSruHistoriaDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SSHD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SSHD_DokTyp=4700)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.SSHD_DokNumer = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL AND (inserted.SSHD_DokTyp=4700)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [SrwSruHistoriaDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SSHD_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SSHD_DokTyp=4700)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.SSHD_DokNumer = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL AND (inserted.SSHD_DokTyp=4700)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [SrwSruHistoriaDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SSHD_DokNumer )  OR UPDATE( SSHD_SruId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SSHD_DokTyp=4710)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwPlanElem ON
                    inserted.SSHD_DokNumer = CDN.SrwPlanElem.SPE_SPPId
                AND inserted.SSHD_SruId = CDN.SrwPlanElem.SPE_SrUId
              WHERE CDN.SrwPlanElem.SPE_SrUId IS NULL AND (inserted.SSHD_DokTyp=4710)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwPlanElem) [SrwSruHistoriaDok_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SSHDLSSHD"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SSHDLSSHD */</I><BR>
ALTER TABLE CDN.SrwSruHistoriaDokLinki ADD CONSTRAINT FK_SSHDLSSHD
 FOREIGN KEY
   (
                          SSHDL_SSHDId                        
                         )
             REFERENCES CDN.SrwSruHistoriaDok
                         (
                          SSHD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwSruHistoriaDokLinki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwSruHistoriaDokLinki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwSruHistoriaDokLinki_InsertUpdateHandler
  ON CDN.SrwSruHistoriaDokLinki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SSHDL_SruIdWyswietl ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SSHDL_SruIdWyswietl = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL
                AND (
                          IsNull(inserted.SSHDL_SruIdWyswietl,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwSruHistoriaDokLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwSruHistoriaZmian_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwSruHistoriaZmian_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwSruHistoriaZmian_InsertUpdateHandler
  ON CDN.SrwSruHistoriaZmian
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SSHZ_SruId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SSHZ_SruId = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL
                AND (
                          IsNull(inserted.SSHZ_SruId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwSruHistoriaZmian_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SSHZLSSHZ"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SSHZLSSHZ */</I><BR>
ALTER TABLE CDN.SrwSruHistoriaZmianLinki ADD CONSTRAINT FK_SSHZLSSHZ
 FOREIGN KEY
   (
                          SSHZL_SSHZId                        
                         )
             REFERENCES CDN.SrwSruHistoriaZmian
                         (
                          SSHZ_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwSruHistoriaZmianLinki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwSruHistoriaZmianLinki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwSruHistoriaZmianLinki_InsertUpdateHandler
  ON CDN.SrwSruHistoriaZmianLinki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SSHZL_SruIdWyswietl ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SSHZL_SruIdWyswietl = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL
                AND (
                          IsNull(inserted.SSHZL_SruIdWyswietl,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwSruHistoriaZmianLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwTypyPrzegladu_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwTypyPrzegladu_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwTypyPrzegladu_DeleteHandler
  ON CDN.SrwTypyPrzegladu
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzRodzTypyP
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzRodzTypyP JOIN deleted
          ON
                deleted.STP_Id = CDN.SrwUrzRodzTypyP.SRX_STPId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie typu przeglądu nie jest możliwe. Typ jest wykorzystany przynajmniej na jednym rodzaju urządzeń serwisowych./# [SrwTypyPrzegladu_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzTypyP
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzTypyP JOIN deleted
          ON
                deleted.STP_Id = CDN.SrwUrzTypyP.SUT_STPId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie typu przeglądu nie jest możliwe. Typ jest wykorzystany przynajmniej na jednym urządzeniu serwisowym./# [SrwTypyPrzegladu_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwPlanPrzegladu
    IF EXISTS
       ( SELECT * FROM CDN.SrwPlanPrzegladu JOIN deleted
          ON
                deleted.STP_Id = CDN.SrwPlanPrzegladu.SPP_STPId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć typu przeglądu, ponieważ występuje on na planie przeglądu technicznego./# [SrwTypyPrzegladu_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SUPParDefinicja"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SUPParDefinicja */</I><BR>
ALTER TABLE CDN.SrwUrzParam ADD CONSTRAINT FK_SUPParDefinicja
 FOREIGN KEY
   (
                          SUP_SUDId                         
                         )
             REFERENCES CDN.SrwUrzParDef
                         (
                          SUD_Id                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzParam_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzParam_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzParam_InsertUpdateHandler
  ON CDN.SrwUrzParam
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SUP_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SUP_ObiTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.SUP_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.SUP_ObiTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [SrwUrzParam_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SUP_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SUP_ObiTyp=4701)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SUP_ObiNumer = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL AND (inserted.SUP_ObiTyp=4701)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwUrzParam_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SRPRodzUrz"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SRPRodzUrz */</I><BR>
ALTER TABLE CDN.SrwUrzRodzPar ADD CONSTRAINT FK_SRPRodzUrz
 FOREIGN KEY
   (
                          SRP_SURId                         
                         )
             REFERENCES CDN.SrwUrzRodzaje
                         (
                          SUR_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SRPParDef"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SRPParDef */</I><BR>
ALTER TABLE CDN.SrwUrzRodzPar ADD CONSTRAINT FK_SRPParDef
 FOREIGN KEY
   (
                          SRP_SUDId                         
                         )
             REFERENCES CDN.SrwUrzParDef
                         (
                          SUD_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SRXSUR"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SRXSUR */</I><BR>
ALTER TABLE CDN.SrwUrzRodzTypyP ADD CONSTRAINT FK_SRXSUR
 FOREIGN KEY
   (
                          SRX_SURId                         
                         )
             REFERENCES CDN.SrwUrzRodzaje
                         (
                          SUR_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzRodzTypyP_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzRodzTypyP_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzRodzTypyP_InsertUpdateHandler
  ON CDN.SrwUrzRodzTypyP
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SRX_STPId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwTypyPrzegladu ON
                    inserted.SRX_STPId = CDN.SrwTypyPrzegladu.STP_Id
              WHERE CDN.SrwTypyPrzegladu.STP_Id IS NULL
                AND (
                          IsNull(inserted.SRX_STPId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwTypyPrzegladu) [SrwUrzRodzTypyP_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzRodzaje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzRodzaje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzRodzaje_DeleteHandler
  ON CDN.SrwUrzRodzaje
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwPlanPrzegladu
    IF EXISTS
       ( SELECT * FROM CDN.SrwPlanPrzegladu JOIN deleted
          ON
                deleted.SUR_Id = CDN.SrwPlanPrzegladu.SPP_SURId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć rodzaju serwisowanych urządzeń, ponieważ występuje on na planie przeglądu technicznego./# [SrwUrzRodzaje_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrKarty
    IF EXISTS
       ( SELECT * FROM CDN.TwrKarty JOIN deleted
          ON
                deleted.SUR_Id = CDN.TwrKarty.Twr_RodzajUrzadzenia
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrKarty) [SrwUrzRodzaje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwReceptury
    IF EXISTS
       ( SELECT * FROM CDN.SrwReceptury JOIN deleted
          ON
                deleted.SUR_Id = CDN.SrwReceptury.SRE_ObiNumer
       AND (CDN.SrwReceptury.SRE_ObiTyp=4706)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwReceptury) [SrwUrzRodzaje_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwUrzadzenia
    IF EXISTS(SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
            ON 
          deleted.SUR_Id = CDN.SrwUrzadzenia.SrU_SURId
            )
        DELETE CDN.SrwUrzadzenia
        FROM CDN.SrwUrzadzenia JOIN deleted
        ON 
          deleted.SUR_Id = CDN.SrwUrzadzenia.SrU_SURId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzRodzaje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzRodzaje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzRodzaje_InsertUpdateHandler
  ON CDN.SrwUrzRodzaje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SUR_JednostkaPrzebiegu ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SUR_JednostkaPrzebiegu = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SUR_JednostkaPrzebiegu,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [SrwUrzRodzaje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SUTSrUSTP"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SUTSrUSTP */</I><BR>
ALTER TABLE CDN.SrwUrzTypyP ADD CONSTRAINT FK_SUTSrUSTP
 FOREIGN KEY
   (
                          SUT_SrUId                         
                         )
             REFERENCES CDN.SrwUrzadzenia
                         (
                          SrU_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzTypyP_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzTypyP_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzTypyP_InsertUpdateHandler
  ON CDN.SrwUrzTypyP
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SUT_STPId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwTypyPrzegladu ON
                    inserted.SUT_STPId = CDN.SrwTypyPrzegladu.STP_Id
              WHERE CDN.SrwTypyPrzegladu.STP_Id IS NULL
                AND (
                          IsNull(inserted.SUT_STPId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwTypyPrzegladu) [SrwUrzTypyP_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SUWPriamry"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SUWPriamry */</I><BR>
ALTER TABLE CDN.SrwUrzWlasc ADD CONSTRAINT FK_SUWPriamry
 FOREIGN KEY
   (
                          SUW_SrUId                         
                         )
             REFERENCES CDN.SrwUrzadzenia
                         (
                          SrU_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzWlasc_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzWlasc_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzWlasc_InsertUpdateHandler
  ON CDN.SrwUrzWlasc
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SUW_WlaNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SUW_WlaTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SUW_WlaNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SUW_WlaTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrwUrzWlasc_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SUW_WlaNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SUW_WlaTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SUW_WlaNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SUW_WlaTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrwUrzWlasc_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzadzenia_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzadzenia_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzadzenia_DeleteHandler
  ON CDN.SrwUrzadzenia
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwPlanElem
    IF EXISTS
       ( SELECT * FROM CDN.SrwPlanElem JOIN deleted
          ON
                deleted.SrU_Id = CDN.SrwPlanElem.SPE_SrUId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć urządzenia, ponieważ występuje ono na planie przeglądu technicznego./# [SrwUrzadzenia_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.SrU_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4701)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.SrU_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4701)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SrU_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4701 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SrU_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4701 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwUrzParam
    IF EXISTS(SELECT * FROM CDN.SrwUrzParam JOIN deleted
            ON 
          deleted.SrU_Id = CDN.SrwUrzParam.SUP_ObiNumer
      AND (CDN.SrwUrzParam.SUP_ObiTyp=4701)
            )
        DELETE CDN.SrwUrzParam
        FROM CDN.SrwUrzParam JOIN deleted
        ON 
          deleted.SrU_Id = CDN.SrwUrzParam.SUP_ObiNumer
      AND (CDN.SrwUrzParam.SUP_ObiTyp=4701)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcUrz
    IF EXISTS(SELECT * FROM CDN.SrwZlcUrz JOIN deleted
            ON 
          deleted.SrU_Id = CDN.SrwZlcUrz.SZU_SrUId
            )
        DELETE CDN.SrwZlcUrz
        FROM CDN.SrwZlcUrz JOIN deleted
        ON 
          deleted.SrU_Id = CDN.SrwZlcUrz.SZU_SrUId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwReceptury
    IF EXISTS(SELECT * FROM CDN.SrwReceptury JOIN deleted
            ON 
          deleted.SrU_Id = CDN.SrwReceptury.SRE_ObiNumer
      AND (CDN.SrwReceptury.SRE_ObiTyp=4701)
            )
        DELETE CDN.SrwReceptury
        FROM CDN.SrwReceptury JOIN deleted
        ON 
          deleted.SrU_Id = CDN.SrwReceptury.SRE_ObiNumer
      AND (CDN.SrwReceptury.SRE_ObiTyp=4701)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwSruHistoriaDok
    IF EXISTS(SELECT * FROM CDN.SrwSruHistoriaDok JOIN deleted
            ON 
          deleted.SrU_Id = CDN.SrwSruHistoriaDok.SSHD_SruId
            )
        DELETE CDN.SrwSruHistoriaDok
        FROM CDN.SrwSruHistoriaDok JOIN deleted
        ON 
          deleted.SrU_Id = CDN.SrwSruHistoriaDok.SSHD_SruId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwSruHistoriaZmian
    IF EXISTS(SELECT * FROM CDN.SrwSruHistoriaZmian JOIN deleted
            ON 
          deleted.SrU_Id = CDN.SrwSruHistoriaZmian.SSHZ_SruId
            )
        DELETE CDN.SrwSruHistoriaZmian
        FROM CDN.SrwSruHistoriaZmian JOIN deleted
        ON 
          deleted.SrU_Id = CDN.SrwSruHistoriaZmian.SSHZ_SruId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwSruHistoriaDokLinki
    IF EXISTS(SELECT * FROM CDN.SrwSruHistoriaDokLinki JOIN deleted
            ON 
          deleted.SrU_Id = CDN.SrwSruHistoriaDokLinki.SSHDL_SruIdWyswietl
            )
        DELETE CDN.SrwSruHistoriaDokLinki
        FROM CDN.SrwSruHistoriaDokLinki JOIN deleted
        ON 
          deleted.SrU_Id = CDN.SrwSruHistoriaDokLinki.SSHDL_SruIdWyswietl
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwSruHistoriaZmianLinki
    IF EXISTS(SELECT * FROM CDN.SrwSruHistoriaZmianLinki JOIN deleted
            ON 
          deleted.SrU_Id = CDN.SrwSruHistoriaZmianLinki.SSHZL_SruIdWyswietl
            )
        DELETE CDN.SrwSruHistoriaZmianLinki
        FROM CDN.SrwSruHistoriaZmianLinki JOIN deleted
        ON 
          deleted.SrU_Id = CDN.SrwSruHistoriaZmianLinki.SSHZL_SruIdWyswietl
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzadzenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzadzenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzadzenia_InsertUpdateHandler
  ON CDN.SrwUrzadzenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SrU_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SrU_DokTyp=4700)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.SrU_DokNumer = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL AND (inserted.SrU_DokTyp=4700)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_JednostkaPrzebiegu ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SrU_JednostkaPrzebiegu = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SrU_JednostkaPrzebiegu,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SrU_ObiTyp=342)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Samochody ON
                    inserted.SrU_ObiNumer = CDN.Samochody.SaM_Id
              WHERE CDN.Samochody.SaM_Id IS NULL AND (inserted.SrU_ObiTyp=342)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Samochody) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SrU_ObiTyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.SrU_ObiNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.SrU_ObiTyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SrU_ObiTyp=368)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.SrU_ObiNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL AND (inserted.SrU_ObiTyp=368)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_SURId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzRodzaje ON
                    inserted.SrU_SURId = CDN.SrwUrzRodzaje.SUR_Id
              WHERE CDN.SrwUrzRodzaje.SUR_Id IS NULL
                AND (
                          IsNull(inserted.SrU_SURId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzRodzaje) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SrU_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.SrU_DokNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.SrU_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SrU_ObiTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.SrU_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.SrU_ObiTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_Nadrzedny ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SrU_Nadrzedny = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL
                AND (
                          IsNull(inserted.SrU_Nadrzedny,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SrU_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SrU_DokTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.SrU_DokNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.SrU_DokTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [SrwUrzadzenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwUrzadzeniaAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwUrzadzeniaAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwUrzadzeniaAlias_DeleteHandler
  ON CDN.SrwUrzadzenia
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.SrU_Id = CDN.SrwUrzadzenia.SrU_Nadrzedny
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć urządzenia, ponieważ występuje jako nadrzędne na karcie innego urządzenia serwisowego./# [SrwUrzadzeniaAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SZCZlecenie"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SZCZlecenie */</I><BR>
ALTER TABLE CDN.SrwZlcCzynnosci ADD CONSTRAINT FK_SZCZlecenie
 FOREIGN KEY
   (
                          SZC_SZNId                         
                         )
             REFERENCES CDN.SrwZlcNag
                         (
                          SZN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcCzynnosci_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcCzynnosci_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcCzynnosci_DeleteHandler
  ON CDN.SrwZlcCzynnosci
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraElem
    IF EXISTS
       ( SELECT * FROM CDN.TraElem JOIN deleted
          ON
                deleted.SZC_Id = CDN.TraElem.TrE_ZlcNumer
            
       AND (CDN.TraElem.TrE_ZlcTyp=4702)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie czynności nie jest możliwe, ponieważ wygenerowano do niej dokumenty handlowe./# [SrwZlcCzynnosci_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.SZC_Id = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=4702)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.SZC_Id = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=4702)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrmHistoria
    IF EXISTS(SELECT * FROM CDN.PrmHistoria JOIN deleted
            ON 
          deleted.SZC_Id = CDN.PrmHistoria.PrH_GIDNumer
      AND (CDN.PrmHistoria.PRH_GIDTyp = 4702 and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
            )
        DELETE CDN.PrmHistoria
        FROM CDN.PrmHistoria JOIN deleted
        ON 
          deleted.SZC_Id = CDN.PrmHistoria.PrH_GIDNumer
      AND (CDN.PrmHistoria.PRH_GIDTyp = 4702 and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SZC_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4702 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SZC_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4702 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcObiekty
    IF EXISTS(SELECT * FROM CDN.SrwZlcObiekty JOIN deleted
            ON 
          deleted.SZC_Id = CDN.SrwZlcObiekty.SZO_SZCId
      AND (CDN.SrwZlcObiekty.SZO_SZCId&gt;0)
            )
        DELETE CDN.SrwZlcObiekty
        FROM CDN.SrwZlcObiekty JOIN deleted
        ON 
          deleted.SZC_Id = CDN.SrwZlcObiekty.SZO_SZCId
      AND (CDN.SrwZlcObiekty.SZO_SZCId&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcSkladniki
    IF EXISTS(SELECT * FROM CDN.SrwZlcSkladniki JOIN deleted
            ON 
          deleted.SZC_Id = CDN.SrwZlcSkladniki.SZS_SZCId
            )
        DELETE CDN.SrwZlcSkladniki
        FROM CDN.SrwZlcSkladniki JOIN deleted
        ON 
          deleted.SZC_Id = CDN.SrwZlcSkladniki.SZS_SZCId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMWizytyElemObiekty
    IF EXISTS(SELECT * FROM CDN.CRMWizytyElemObiekty JOIN deleted
            ON 
          deleted.SZC_Id = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=4702)
            )
        DELETE CDN.CRMWizytyElemObiekty
        FROM CDN.CRMWizytyElemObiekty JOIN deleted
        ON 
          deleted.SZC_Id = CDN.CRMWizytyElemObiekty.CWO_ObiNumer
      AND (CDN.CRMWizytyElemObiekty.CWO_ObiTyp=4702)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Rezerwacje
    IF EXISTS(SELECT * FROM CDN.Rezerwacje JOIN deleted
            ON 
          deleted.SZC_Id = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=4702)
            )
        DELETE CDN.Rezerwacje
        FROM CDN.Rezerwacje JOIN deleted
        ON 
          deleted.SZC_Id = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=4702)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwSruHistoriaDok
    IF EXISTS(SELECT * FROM CDN.SrwSruHistoriaDok JOIN deleted
            ON 
          deleted.SZC_Id = CDN.SrwSruHistoriaDok.SSHD_DokNumer
      AND (CDN.SrwSruHistoriaDok.SSHD_DokTyp=4700)
            )
        DELETE CDN.SrwSruHistoriaDok
        FROM CDN.SrwSruHistoriaDok JOIN deleted
        ON 
          deleted.SZC_Id = CDN.SrwSruHistoriaDok.SSHD_DokNumer
      AND (CDN.SrwSruHistoriaDok.SSHD_DokTyp=4700)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcCzynnosci_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcCzynnosci_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcCzynnosci_InsertUpdateHandler
  ON CDN.SrwZlcCzynnosci
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SZC_SlwStatus ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SZC_SlwStatus = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SZC_SlwStatus,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [SrwZlcCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZC_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.SZC_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SZC_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [SrwZlcCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZC_SZUId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZC_SZUId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcUrz ON
                    inserted.SZC_SZUId = CDN.SrwZlcUrz.SZU_Id
              WHERE CDN.SrwZlcUrz.SZU_Id IS NULL AND (inserted.SZC_SZUId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcUrz) [SrwZlcCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZC_SREId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwReceptury ON
                    inserted.SZC_SREId = CDN.SrwReceptury.SRE_Id
              WHERE CDN.SrwReceptury.SRE_Id IS NULL
                AND (
                          IsNull(inserted.SZC_SREId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwReceptury) [SrwZlcCzynnosci_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SZTTerminy"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SZTTerminy */</I><BR>
ALTER TABLE CDN.SrwZlcCzynnosciTerminy ADD CONSTRAINT FK_SZTTerminy
 FOREIGN KEY
   (
                          SZT_SZCId                         
                         )
             REFERENCES CDN.SrwZlcCzynnosci
                         (
                          SZC_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcCzynnosciTerminy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcCzynnosciTerminy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcCzynnosciTerminy_DeleteHandler
  ON CDN.SrwZlcCzynnosciTerminy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zadania
    IF EXISTS(SELECT * FROM CDN.Zadania JOIN deleted
            ON 
          deleted.SZT_ID = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=4702)
            )
        DELETE CDN.Zadania
        FROM CDN.Zadania JOIN deleted
        ON 
          deleted.SZT_ID = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=4702)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SZKZlecenie"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SZKZlecenie */</I><BR>
ALTER TABLE CDN.SrwZlcKoszty ADD CONSTRAINT FK_SZKZlecenie
 FOREIGN KEY
   (
                          SZK_SZNId                         
                         )
             REFERENCES CDN.SrwZlcNag
                         (
                          SZN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcNag_DeleteHandler
  ON CDN.SrwZlcNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.SZN_Id = CDN.SrwUrzadzenia.SrU_DokNumer
            
       AND (CDN.SrwUrzadzenia.SrU_DokTyp=4700)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć dokumentu bądź pozycji, ponieważ występuje powiązanie z urządzeniem serwisowym./# [SrwZlcNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwPlanDokumenty
    IF EXISTS(SELECT * FROM CDN.SrwPlanDokumenty JOIN deleted
            ON 
          deleted.SZN_Id = CDN.SrwPlanDokumenty.SED_DokNumer
      AND (CDN.SrwPlanDokumenty.SED_DokTyp=4700)
            )
        DELETE CDN.SrwPlanDokumenty
        FROM CDN.SrwPlanDokumenty JOIN deleted
        ON 
          deleted.SZN_Id = CDN.SrwPlanDokumenty.SED_DokNumer
      AND (CDN.SrwPlanDokumenty.SED_DokTyp=4700)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.SZN_Id = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp =4700 and  CDN.WysRelacje.WyR_DokLp=0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.SZN_Id = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp =4700 and  CDN.WysRelacje.WyR_DokLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.SZN_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4700)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.SZN_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4700)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SZN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4700 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SZN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4700 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcObiekty
    IF EXISTS(SELECT * FROM CDN.SrwZlcObiekty JOIN deleted
            ON 
          deleted.SZN_Id = CDN.SrwZlcObiekty.SZO_SZNId
            )
        DELETE CDN.SrwZlcObiekty
        FROM CDN.SrwZlcObiekty JOIN deleted
        ON 
          deleted.SZN_Id = CDN.SrwZlcObiekty.SZO_SZNId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.SZN_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=4700)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.SZN_Id = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=4700)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcUrz
    IF EXISTS(SELECT * FROM CDN.SrwZlcUrz JOIN deleted
            ON 
          deleted.SZN_Id = CDN.SrwZlcUrz.SZU_SZNId
            )
        DELETE CDN.SrwZlcUrz
        FROM CDN.SrwZlcUrz JOIN deleted
        ON 
          deleted.SZN_Id = CDN.SrwZlcUrz.SZU_SZNId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcSkladniki
    IF EXISTS(SELECT * FROM CDN.SrwZlcSkladniki JOIN deleted
            ON 
          deleted.SZN_Id = CDN.SrwZlcSkladniki.SZS_SZNId
            )
        DELETE CDN.SrwZlcSkladniki
        FROM CDN.SrwZlcSkladniki JOIN deleted
        ON 
          deleted.SZN_Id = CDN.SrwZlcSkladniki.SZS_SZNId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdZwiazane
    IF EXISTS(SELECT * FROM CDN.ProdZwiazane JOIN deleted
            ON 
          deleted.SZN_Id = CDN.ProdZwiazane.PZW_DokNumer
      AND (CDN.ProdZwiazane.PZW_DokTyp=4700)
            )
        DELETE CDN.ProdZwiazane
        FROM CDN.ProdZwiazane JOIN deleted
        ON 
          deleted.SZN_Id = CDN.ProdZwiazane.PZW_DokNumer
      AND (CDN.ProdZwiazane.PZW_DokTyp=4700)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwSruHistoriaDok
    IF EXISTS(SELECT * FROM CDN.SrwSruHistoriaDok JOIN deleted
            ON 
          deleted.SZN_Id = CDN.SrwSruHistoriaDok.SSHD_DokNumer
      AND (CDN.SrwSruHistoriaDok.SSHD_DokTyp=4700)
            )
        DELETE CDN.SrwSruHistoriaDok
        FROM CDN.SrwSruHistoriaDok JOIN deleted
        ON 
          deleted.SZN_Id = CDN.SrwSruHistoriaDok.SSHD_DokNumer
      AND (CDN.SrwSruHistoriaDok.SSHD_DokTyp=4700)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcNag_InsertUpdateHandler
  ON CDN.SrwZlcNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SZN_SlwStatus ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SZN_SlwStatus = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SZN_SlwStatus,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_FiaskoID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.SZN_FiaskoID = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.SZN_FiaskoID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KnDTyp )  OR UPDATE( SZN_KnDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZN_KnDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SZN_KnDTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.SZN_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SZN_KnDTyp=32)
                AND (
                          IsNull(inserted.SZN_KnDTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SZN_KnDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KnATyp )  OR UPDATE( SZN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.SZN_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.SZN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SZN_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SZN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_AdWTyp )  OR UPDATE( SZN_AdWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.SZN_AdWTyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.SZN_AdWNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SZN_AdWTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SZN_AdWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZN_KnPTyp=48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.SZN_KnPNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.SZN_KnPTyp=48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZN_KnPTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.SZN_KnPNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.SZN_KnPTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZN_KnPTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SZN_KnPNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SZN_KnPTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KnSTyp )  OR UPDATE( SZN_KnSNumer )  OR UPDATE( SZN_KnSLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZN_KnSTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.SZN_KnSTyp = CDN.KntOsoby.KnS_KntTyp
                AND inserted.SZN_KnSNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.SZN_KnSLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.SZN_KnSTyp=32)
                AND (
                          IsNull(inserted.SZN_KnSTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SZN_KnSNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SZN_KnSLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KnSTypD )  OR UPDATE( SZN_KnSNumerD )  OR UPDATE( SZN_KnSLpD ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZN_KnSTypD=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.SZN_KnSTypD = CDN.KntOsoby.KnS_KntTyp
                AND inserted.SZN_KnSNumerD = CDN.KntOsoby.KnS_KntNumer
                AND inserted.SZN_KnSLpD = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.SZN_KnSTypD=32)
                AND (
                          IsNull(inserted.SZN_KnSTypD,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SZN_KnSNumerD,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SZN_KnSLpD,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_OpiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SZN_OpiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SZN_OpiNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_FrsId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.SZN_FrsId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.SZN_FrsId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZN_KnPTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SZN_KnPNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SZN_KnPTyp=32)
                AND (
                          IsNull(inserted.SZN_KnPNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_KntTyp )  OR UPDATE( SZN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.SZN_KntTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.SZN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.SZN_KntTyp=32)
                AND (
                          IsNull(inserted.SZN_KntTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.SZN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZN_PrjId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.SZN_PrjId = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.SZN_PrjId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [SrwZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcObiekty_InsertUpdateHandler
  ON CDN.SrwZlcObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SZO_SZNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.SZO_SZNId = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL
                AND (
                          IsNull(inserted.SZO_SZNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [SrwZlcObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZO_SZCId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZO_SZCId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.SZO_SZCId = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL AND (inserted.SZO_SZCId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [SrwZlcObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZO_OBITyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.SZO_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.SZO_OBITyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [SrwZlcObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.SZO_OBITyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.SZO_ObiNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.SZO_OBITyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [SrwZlcObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZO_SREId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwReceptury ON
                    inserted.SZO_SREId = CDN.SrwReceptury.SRE_Id
              WHERE CDN.SrwReceptury.SRE_Id IS NULL
                AND (
                          IsNull(inserted.SZO_SREId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwReceptury) [SrwZlcObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcSkladniki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcSkladniki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcSkladniki_DeleteHandler
  ON CDN.SrwZlcSkladniki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraElem
    IF EXISTS
       ( SELECT * FROM CDN.TraElem JOIN deleted
          ON
                deleted.SZS_Id = CDN.TraElem.TrE_ZlcNumer
            
       AND (CDN.TraElem.TrE_ZlcTyp=4703)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie składnika nie jest możliwe, ponieważ wygenerowano do niego dokumenty handlowe./# [SrwZlcSkladniki_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrmHistoria
    IF EXISTS(SELECT * FROM CDN.PrmHistoria JOIN deleted
            ON 
          deleted.SZS_Id = CDN.PrmHistoria.PrH_GIDNumer
      AND (CDN.PrmHistoria.PRH_GIDTyp = 4703 and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
            )
        DELETE CDN.PrmHistoria
        FROM CDN.PrmHistoria JOIN deleted
        ON 
          deleted.SZS_Id = CDN.PrmHistoria.PrH_GIDNumer
      AND (CDN.PrmHistoria.PRH_GIDTyp = 4703 and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.SZS_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4703 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.SZS_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4703 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.SZS_Id = CDN.ZamZamLinki.ZZL_ZSGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZSGIDTyp=4703)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.SZS_Id = CDN.ZamZamLinki.ZZL_ZSGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZSGIDTyp=4703)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Rezerwacje
    IF EXISTS(SELECT * FROM CDN.Rezerwacje JOIN deleted
            ON 
          deleted.SZS_Id = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=4703)
            )
        DELETE CDN.Rezerwacje
        FROM CDN.Rezerwacje JOIN deleted
        ON 
          deleted.SZS_Id = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=4703)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcSkladniki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcSkladniki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcSkladniki_InsertUpdateHandler
  ON CDN.SrwZlcSkladniki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SZS_SZCId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.SZS_SZCId = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL
                AND (
                          IsNull(inserted.SZS_SZCId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [SrwZlcSkladniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZS_SZNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.SZS_SZNId = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL
                AND (
                          IsNull(inserted.SZS_SZNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [SrwZlcSkladniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZS_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.SZS_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.SZS_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [SrwZlcSkladniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZS_SREId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwReceptury ON
                    inserted.SZS_SREId = CDN.SrwReceptury.SRE_Id
              WHERE CDN.SrwReceptury.SRE_Id IS NULL
                AND (
                          IsNull(inserted.SZS_SREId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwReceptury) [SrwZlcSkladniki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcUrz_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcUrz_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcUrz_DeleteHandler
  ON CDN.SrwZlcUrz
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.SZU_Id = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=4704)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.SZU_Id = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=4704)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwZlcCzynnosci
    IF EXISTS(SELECT * FROM CDN.SrwZlcCzynnosci JOIN deleted
            ON 
          deleted.SZU_Id = CDN.SrwZlcCzynnosci.SZC_SZUId
      AND (CDN.SrwZlcCzynnosci.SZC_SZUId&gt;0)
            )
        DELETE CDN.SrwZlcCzynnosci
        FROM CDN.SrwZlcCzynnosci JOIN deleted
        ON 
          deleted.SZU_Id = CDN.SrwZlcCzynnosci.SZC_SZUId
      AND (CDN.SrwZlcCzynnosci.SZC_SZUId&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.SZU_Id = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp=4704 and  CDN.WysRelacje.WyR_DokLp=0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.SZU_Id = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp=4704 and  CDN.WysRelacje.WyR_DokLp=0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="SrwZlcUrz_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* SrwZlcUrz_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.SrwZlcUrz_InsertUpdateHandler
  ON CDN.SrwZlcUrz
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( SZU_SZNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.SZU_SZNId = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL
                AND (
                          IsNull(inserted.SZU_SZNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [SrwZlcUrz_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZU_SrUId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzadzenia ON
                    inserted.SZU_SrUId = CDN.SrwUrzadzenia.SrU_Id
              WHERE CDN.SrwUrzadzenia.SrU_Id IS NULL
                AND (
                          IsNull(inserted.SZU_SrUId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzadzenia) [SrwZlcUrz_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( SZU_SREId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwReceptury ON
                    inserted.SZU_SREId = CDN.SrwReceptury.SRE_Id
              WHERE CDN.SrwReceptury.SRE_Id IS NULL
                AND (
                          IsNull(inserted.SZU_SREId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwReceptury) [SrwZlcUrz_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="StaKarty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* StaKarty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.StaKarty_DeleteHandler
  ON CDN.StaKarty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SqlRaporty
    IF EXISTS(SELECT * FROM CDN.SqlRaporty JOIN deleted
            ON 
          deleted.Sta_GIDNumer = CDN.SqlRaporty.SqR_StaNumer
            )
        DELETE CDN.SqlRaporty
        FROM CDN.SqlRaporty JOIN deleted
        ON 
          deleted.Sta_GIDNumer = CDN.SqlRaporty.SqR_StaNumer
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="StaKarty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* StaKarty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.StaKarty_InsertUpdateHandler
  ON CDN.StaKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Sta_Jezyk ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.Sta_Jezyk = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.Sta_Jezyk,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [StaKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_StKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_StKPrimary */</I><BR>
ALTER TABLE CDN.StaKonfig ADD CONSTRAINT FK_StKPrimary
 FOREIGN KEY
   (
                          StK_StaNumer                      
                         )
             REFERENCES CDN.StaKarty
                         (
                          Sta_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_StOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_StOPrimary */</I><BR>
ALTER TABLE CDN.StaOpisy ADD CONSTRAINT FK_StOPrimary
 FOREIGN KEY
   (
                          StO_StaNumer                      
                         )
             REFERENCES CDN.StaKarty
                         (
                          Sta_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_StZPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_StZPrimary */</I><BR>
ALTER TABLE CDN.StaZakazy ADD CONSTRAINT FK_StZPrimary
 FOREIGN KEY
   (
                          StZ_StaNumer                      
                         )
             REFERENCES CDN.StaKarty
                         (
                          Sta_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TKEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TKEPrimary */</I><BR>
ALTER TABLE CDN.TKElem ADD CONSTRAINT FK_TKEPrimary
 FOREIGN KEY
   (
                          TKE_GIDNumer                      
                         )
             REFERENCES CDN.TKNag
                         (
                          TKN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TKElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TKElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TKElem_InsertUpdateHandler
  ON CDN.TKElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TKE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TKE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TKE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TKElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TKNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TKNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TKNag_InsertUpdateHandler
  ON CDN.TKNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TKN_MagZNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TKN_MagZNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TKN_MagZNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TKNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TKN_MagDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TKN_MagDNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TKN_MagDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TKNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TKN_KnATyp )  OR UPDATE( TKN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.TKN_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.TKN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TKN_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.TKN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [TKNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TKN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TKN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.TKN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.TKN_KntTyp=32)
                AND (
                          IsNull(inserted.TKN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TKNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TKSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TKSPrimary */</I><BR>
ALTER TABLE CDN.TKSElem ADD CONSTRAINT FK_TKSPrimary
 FOREIGN KEY
   (
                          TKS_GIDTyp                        ,
                          TKS_GIDNumer                      ,
                          TKS_GIDLp                         
                         )
             REFERENCES CDN.TKElem
                         (
                          TKE_GIDTyp                        ,
                          TKE_GIDNumer                      ,
                          TKE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TKSElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TKSElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TKSElem_InsertUpdateHandler
  ON CDN.TKSElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TKS_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TKS_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TKS_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TKSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Tlumaczenia_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Tlumaczenia_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Tlumaczenia_InsertUpdateHandler
  ON CDN.Tlumaczenia
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TLM_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TLM_Typ=5057)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProgiIloscAp ON
                    inserted.TLM_Numer = CDN.ProgiIloscAp.PIA_Id
              WHERE CDN.ProgiIloscAp.PIA_Id IS NULL AND (inserted.TLM_Typ=5057)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProgiIloscAp) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TLM_Typ )  OR UPDATE( TLM_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TLM_Typ = 736)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Konfig ON
                    inserted.TLM_Typ = CDN.Konfig.KON_Numer
                AND inserted.TLM_Numer = CDN.Konfig.KON_Lp
              WHERE CDN.Konfig.KON_Lp IS NULL AND (inserted.TLM_Typ = 736)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Konfig) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TLM_Typ )  OR UPDATE( TLM_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TLM_Typ IN (144,64))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Nazwy ON
                    inserted.TLM_Typ = CDN.Nazwy.Naz_GIDTyp
                AND inserted.TLM_Numer = CDN.Nazwy.Naz_GIDLp
              WHERE CDN.Nazwy.Naz_GIDLp IS NULL AND (inserted.TLM_Typ IN (144,64))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Nazwy) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TLM_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TLM_Typ=14417)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AtrybutyWartosci ON
                    inserted.TLM_Numer = CDN.AtrybutyWartosci.AtW_ID
              WHERE CDN.AtrybutyWartosci.AtW_ID IS NULL AND (inserted.TLM_Typ=14417)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AtrybutyWartosci) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TLM_Jezyk ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TLM_Jezyk = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.TLM_Jezyk,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TLM_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TLM_Typ=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TLM_Numer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.TLM_Typ=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TLM_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TLM_Typ=14416)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.AtrybutyKlasy ON
                    inserted.TLM_Numer = CDN.AtrybutyKlasy.AtK_ID
              WHERE CDN.AtrybutyKlasy.AtK_ID IS NULL AND (inserted.TLM_Typ=14416)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  AtrybutyKlasy) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TLM_Typ )  OR UPDATE( TLM_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TLM_Typ=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzorce ON
                    inserted.TLM_Typ = CDN.TwrWzorce.TwW_GrpTyp
                AND inserted.TLM_Numer = CDN.TwrWzorce.TwW_GrpNumer
              WHERE CDN.TwrWzorce.TwW_GrpNumer IS NULL AND (inserted.TLM_Typ=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzorce) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TLM_Numer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TLM_Typ = 8225)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TLM_Numer = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.TLM_Typ = 8225)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Tlumaczenia_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TnOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TnOPrimary */</I><BR>
ALTER TABLE CDN.TrNOpisy ADD CONSTRAINT FK_TnOPrimary
 FOREIGN KEY
   (
                          TnO_TrnNumer                      
                         )
             REFERENCES CDN.TraNag
                         (
                          TrN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TrEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TrEPrimary */</I><BR>
ALTER TABLE CDN.TraElem ADD CONSTRAINT FK_TrEPrimary
 FOREIGN KEY
   (
                          TrE_GIDNumer                      
                         )
             REFERENCES CDN.TraNag
                         (
                          TrN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraElem_DeleteHandler
  ON CDN.TraElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.TrE_GIDNumer = CDN.WydatkiPracownikow.WPR_DokNumer
            AND deleted.TrE_GIDLp = CDN.WydatkiPracownikow.WPR_DokLp
       AND (CDN.WydatkiPracownikow.WPR_DokTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968) And CDN.WydatkiPracownikow.Wpr_DokLp&lt;&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WydatkiPracownikow) [TraElem_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KBNElem
    IF EXISTS
       ( SELECT * FROM CDN.KBNElem JOIN deleted
          ON
                deleted.TrE_GIDTyp = CDN.KBNElem.KBNE_RWTyp
            AND deleted.TrE_GIDNumer = CDN.KBNElem.KBNE_RWNumer
            AND deleted.TrE_GIDLp = CDN.KBNElem.KBNE_RWLp
       AND (CDN.KBNElem.KBNE_RWTyp in (1616,1624))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KBNElem) [TraElem_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.TrE_GIDTyp = CDN.ProdPKJNag.PKJN_ObiTyp
            AND deleted.TrE_GIDNumer = CDN.ProdPKJNag.PKJN_ObiNumer
            AND deleted.TrE_GIDLp = CDN.ProdPKJNag.PKJN_ObiLp
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie dokumentu nie jest możliwe, zarejestrowano do niego protokół kontroli jakości PKJ/# [TraElem_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.TrE_GIDTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.TrE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND deleted.TrE_GIDLp = CDN.CRMDokumentyPozycje.CDP_DokLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.TrE_GIDTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.TrE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND deleted.TrE_GIDLp = CDN.CRMDokumentyPozycje.CDP_DokLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.TrE_GIDNumer = CDN.DokZwiazane.DoZ_ZRDNumer
      AND deleted.TrE_GIDLp = CDN.DokZwiazane.DoZ_ZRDLp
      AND deleted.TrE_GIDTyp = CDN.DokZwiazane.DoZ_ZRDTyp
      AND (CDN.DokZwiazane.DoZ_ZRDTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND CDN.DokZwiazane.DoZ_ZrdLp&gt;0)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.TrE_GIDNumer = CDN.DokZwiazane.DoZ_ZRDNumer
      AND deleted.TrE_GIDLp = CDN.DokZwiazane.DoZ_ZRDLp
      AND deleted.TrE_GIDTyp = CDN.DokZwiazane.DoZ_ZRDTyp
      AND (CDN.DokZwiazane.DoZ_ZRDTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND CDN.DokZwiazane.DoZ_ZrdLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrmHistoria
    IF EXISTS(SELECT * FROM CDN.PrmHistoria JOIN deleted
            ON 
          deleted.TrE_GIDNumer = CDN.PrmHistoria.PrH_GIDNumer
      AND deleted.TrE_GIDTyp = CDN.PrmHistoria.PrH_GIDTyp
      AND deleted.TrE_GIDLp = CDN.PrmHistoria.PrH_GIDLp
      AND (CDN.PrmHistoria.PRH_GIDTyp not in (960,4702,4703,4803) and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
            )
        DELETE CDN.PrmHistoria
        FROM CDN.PrmHistoria JOIN deleted
        ON 
          deleted.TrE_GIDNumer = CDN.PrmHistoria.PrH_GIDNumer
      AND deleted.TrE_GIDTyp = CDN.PrmHistoria.PrH_GIDTyp
      AND deleted.TrE_GIDLp = CDN.PrmHistoria.PrH_GIDLp
      AND (CDN.PrmHistoria.PRH_GIDTyp not in (960,4702,4703,4803) and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TrE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TrE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TrE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,    2005 ,2013 ,2034 ,2042, 2035, 2043 , 2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TrE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TrE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TrE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,    2005 ,2013 ,2034 ,2042, 2035, 2043 , 2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.TrE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TrE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TrE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,    2005 ,2013 ,2034 ,2042, 2035, 2043 , 2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.TrE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TrE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TrE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,    2005 ,2013 ,2034 ,2042, 2035, 2043 , 2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrmTransakcje
    IF EXISTS(SELECT * FROM CDN.PrmTransakcje JOIN deleted
            ON 
          deleted.TrE_GIDTyp = CDN.PrmTransakcje.PrT_DokTyp
      AND deleted.TrE_GIDNumer = CDN.PrmTransakcje.PrT_DokNumer
      AND deleted.TrE_GIDLp = CDN.PrmTransakcje.PrT_DokLp
      AND (CDN.PrmTransakcje.PrT_DokTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2000,2008,1521,1529,1489,1497,1520,1528,2002,2010,1490,1498))
            )
        DELETE CDN.PrmTransakcje
        FROM CDN.PrmTransakcje JOIN deleted
        ON 
          deleted.TrE_GIDTyp = CDN.PrmTransakcje.PrT_DokTyp
      AND deleted.TrE_GIDNumer = CDN.PrmTransakcje.PrT_DokNumer
      AND deleted.TrE_GIDLp = CDN.PrmTransakcje.PrT_DokLp
      AND (CDN.PrmTransakcje.PrT_DokTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2000,2008,1521,1529,1489,1497,1520,1528,2002,2010,1490,1498))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.TrE_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND deleted.TrE_GIDLp = CDN.WysRelacje.WYR_DokLp
      AND (CDN.WysRelacje.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  CDN.WysRelacje.WyR_DokLp&lt;&gt;0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.TrE_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND deleted.TrE_GIDLp = CDN.WysRelacje.WYR_DokLp
      AND (CDN.WysRelacje.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  CDN.WysRelacje.WyR_DokLp&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RelTraImp
    IF EXISTS(SELECT * FROM CDN.RelTraImp JOIN deleted
            ON 
          deleted.TrE_GIDNumer = CDN.RelTraImp.RTI_DocNumer
      AND deleted.TrE_GIDLp = CDN.RelTraImp.RTI_DocLp
      AND deleted.TrE_GIDTyp = CDN.RelTraImp.RTI_DocTyp
      AND (CDN.RelTraImp.RTI_DocTyp in (1490, 1498))
            )
        DELETE CDN.RelTraImp
        FROM CDN.RelTraImp JOIN deleted
        ON 
          deleted.TrE_GIDNumer = CDN.RelTraImp.RTI_DocNumer
      AND deleted.TrE_GIDLp = CDN.RelTraImp.RTI_DocLp
      AND deleted.TrE_GIDTyp = CDN.RelTraImp.RTI_DocTyp
      AND (CDN.RelTraImp.RTI_DocTyp in (1490, 1498))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TraElem_InsertUpdateHandler
  ON CDN.TraElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TrE_PakietId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrmKarty ON
                    inserted.TrE_PakietId = CDN.PrmKarty.PRM_Id
              WHERE CDN.PrmKarty.PRM_Id IS NULL
                AND (
                          IsNull(inserted.TrE_PakietId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrmKarty) [TraElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TrE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TrE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TraElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrE_ZlcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrE_ZlcTyp=4703)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcSkladniki ON
                    inserted.TrE_ZlcNumer = CDN.SrwZlcSkladniki.SZS_Id
              WHERE CDN.SrwZlcSkladniki.SZS_Id IS NULL AND (inserted.TrE_ZlcTyp=4703)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcSkladniki) [TraElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrE_ZlcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrE_ZlcTyp=4702)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.TrE_ZlcNumer = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL AND (inserted.TrE_ZlcTyp=4702)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [TraElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraElemAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraElemAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraElemAlias_DeleteHandler
  ON CDN.TraElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KBNElem
    IF EXISTS
       ( SELECT * FROM CDN.KBNElem JOIN deleted
          ON
                deleted.TrE_GIDTyp = CDN.KBNElem.KBNE_PWTyp
            AND deleted.TrE_GIDNumer = CDN.KBNElem.KBNE_PWNumer
            AND deleted.TrE_GIDLp = CDN.KBNElem.KBNE_PWLp
       AND (CDN.KBNElem.KBNE_PWTyp in (1617,1625))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KBNElem) [TraElemAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RelTraImp
    IF EXISTS
       ( SELECT * FROM CDN.RelTraImp JOIN deleted
          ON
                deleted.TrE_GIDNumer = CDN.RelTraImp.RTI_ZrdNumer
            AND deleted.TrE_GIDLp = CDN.RelTraImp.RTI_ZrdLp
            AND deleted.TrE_GIDTyp = CDN.RelTraImp.RTI_ZrdTyp
            
       AND (CDN.RelTraImp.RTI_ZrdTyp in (1490, 1498))
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć elementów z których wygenerowano jakiś dokument./# [TraElemAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraJPK_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraJPK_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TraJPK_InsertUpdateHandler
  ON CDN.TraJPK
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TrJ_TrNTyp )  OR UPDATE( TrJ_TrNNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrJ_TrNTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,1520,1528,1521,1529,1489,1497,2036,2044,1490,1498,1312,1824,1320,1832,2000,2002,2008,2010,1828,1836,1968))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.TrJ_TrNTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.TrJ_TrNNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.TrJ_TrNTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,1520,1528,1521,1529,1489,1497,2036,2044,1490,1498,1312,1824,1320,1832,2000,2002,2008,2010,1828,1836,1968))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [TraJPK_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrJ_TrNNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrJ_TrNTyp in (3344,3352))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.TrJ_TrNNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.TrJ_TrNTyp in (3344,3352))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [TraJPK_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrJ_TrNTyp )  OR UPDATE( TrJ_TrNNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrJ_TrNTyp in (3376,3378,3379,3386,3387))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.TrJ_TrNTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.TrJ_TrNNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (inserted.TrJ_TrNTyp in (3376,3378,3379,3386,3387))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [TraJPK_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TrKPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TrKPrimaryNoType */</I><BR>
ALTER TABLE CDN.TraKElem ADD CONSTRAINT FK_TrKPrimaryNoType
 FOREIGN KEY
   (
                          TRK_GIDNumer                      
                         )
             REFERENCES CDN.TraNag
                         (
                          TrN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraNag_DeleteHandler
  ON CDN.TraNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwMag
    IF EXISTS
       ( SELECT * FROM CDN.InwMag JOIN deleted
          ON
                deleted.TrN_GIDTyp = CDN.InwMag.InM_RWTyp
            AND deleted.TrN_GIDNumer = CDN.InwMag.InM_RWNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Dokument RW został wygenerowany z inwentaryzacji, nie może zostać usunięty./# [TraNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WydatkiPracownikow
    IF EXISTS
       ( SELECT * FROM CDN.WydatkiPracownikow JOIN deleted
          ON
                deleted.TrN_GIDNumer = CDN.WydatkiPracownikow.WPR_DokNumer
       AND (CDN.WydatkiPracownikow.WPR_DokTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WydatkiPracownikow) [TraNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.TrN_GIDNumer = CDN.SrwUrzadzenia.SrU_DokNumer
            
       AND (CDN.SrwUrzadzenia.SrU_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć dokumentu bądź pozycji, ponieważ występuje powiązanie z urządzeniem serwisowym./# [TraNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamPlat
    IF EXISTS
       ( SELECT * FROM CDN.ZamPlat JOIN deleted
          ON
                deleted.TrN_GIDTyp = CDN.ZamPlat.ZaP_TrNTyp
            AND deleted.TrN_GIDNumer = CDN.ZamPlat.ZaP_TrNNumer
       AND (CDN.ZamPlat.ZaP_TrNTyp &lt;&gt; 0 and CDN.ZamPlat.ZaP_TrNNumer &lt;&gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamPlat) [TraNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WysKoszty
    IF EXISTS
       ( SELECT * FROM CDN.WysKoszty JOIN deleted
          ON
                deleted.TrN_GIDTyp = CDN.WysKoszty.WyK_DokTyp
            AND deleted.TrN_GIDNumer = CDN.WysKoszty.WyK_DokNumer
       AND (CDN.WysKoszty.WyK_DokTyp not in (4144,4145,4146,4336,3378,3379,3344))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WysKoszty) [TraNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadKwoty
    IF EXISTS
       ( SELECT * FROM CDN.SadKwoty JOIN deleted
          ON
                deleted.TrN_GIDNumer = CDN.SadKwoty.SaK_TrNNumer
            AND deleted.TrN_GIDTyp = CDN.SadKwoty.SaK_TrNTyp
       AND (CDN.SadKwoty.SaK_TrNTyp&lt;&gt;3344)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadKwoty) [TraNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwPlat
    IF EXISTS
       ( SELECT * FROM CDN.UmwPlat JOIN deleted
          ON
                deleted.TrN_GIDTyp = CDN.UmwPlat.UPl_TrNTyp
            AND deleted.TrN_GIDNumer = CDN.UmwPlat.UPl_TrNNumer
       AND (CDN.UmwPlat.UPl_TrNTyp &lt;&gt; 0 and CDN.UmwPlat.UPl_TrNNumer &lt;&gt; 0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwPlat) [TraNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.TrN_GIDTyp = CDN.ProdPKJNag.PKJN_ObiTyp
            AND deleted.TrN_GIDNumer = CDN.ProdPKJNag.PKJN_ObiNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie elementu nie jest możliwe, zarejestrowano do niego protokół kontroli jakości PKJ/# [TraNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DoZ_DOKTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968)  AND CDN.DokZwiazane.DoZ_DokLp=0)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DoZ_DOKTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968)  AND CDN.DokZwiazane.DoZ_DokLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (CDN.DokZwiazane.DoZ_ZRDTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968)  AND CDN.DokZwiazane.DoZ_ZrdLp=0)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (CDN.DokZwiazane.DoZ_ZRDTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968)  AND CDN.DokZwiazane.DoZ_ZrdLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrtDokZakupu
    IF EXISTS(SELECT * FROM CDN.SrtDokZakupu JOIN deleted
            ON 
          deleted.TrN_GIDTyp = CDN.SrtDokZakupu.SDZ_DokTyp
      AND deleted.TrN_GIDNumer = CDN.SrtDokZakupu.SDZ_DokNumer
      AND (CDN.SrtDokZakupu.SDZ_DokTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968))
            )
        DELETE CDN.SrtDokZakupu
        FROM CDN.SrtDokZakupu JOIN deleted
        ON 
          deleted.TrN_GIDTyp = CDN.SrtDokZakupu.SDZ_DokTyp
      AND deleted.TrN_GIDNumer = CDN.SrtDokZakupu.SDZ_DokNumer
      AND (CDN.SrtDokZakupu.SDZ_DokTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (1312,1320,1489,1490,1497,1498,1520,1521,1528,1529,1603,1604,1616,1617,1624,1625,1824,1828,1832,1836,1968,2000,2001,2002,2003,2005,2008,2009,2010,2013,2033,2034,2035,2036,2037,2039,2041,2042,2043,2044,2045,2047))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKosztyElem
    IF EXISTS(SELECT * FROM CDN.ProdKosztyElem JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.ProdKosztyElem.PKE_ObiNumer
      AND deleted.TrN_GIDTyp = CDN.ProdKosztyElem.PKE_ObiTyp
      AND (  CDN.ProdKosztyElem.PKE_OBITyp in ( 1521,1529,1497,1489,1520,1528,1490,1498,1616,1624))
            )
        DELETE CDN.ProdKosztyElem
        FROM CDN.ProdKosztyElem JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.ProdKosztyElem.PKE_ObiNumer
      AND deleted.TrN_GIDTyp = CDN.ProdKosztyElem.PKE_ObiTyp
      AND (  CDN.ProdKosztyElem.PKE_OBITyp in ( 1521,1529,1497,1489,1520,1528,1490,1498,1616,1624))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_Procesy
    IF EXISTS(SELECT * FROM CDN.WF_Procesy JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036 ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968))
            )
        DELETE CDN.WF_Procesy
        FROM CDN.WF_Procesy JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036 ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BstDokumenty
    IF EXISTS(SELECT * FROM CDN.BstDokumenty JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.BstDokumenty.BsD_DokNumer
      AND deleted.TrN_GIDTyp = CDN.BstDokumenty.BsD_DokTyp
      AND (CDN.BstDokumenty.BsD_DokTyp IN(1600,1603))
            )
        DELETE CDN.BstDokumenty
        FROM CDN.BstDokumenty JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.BstDokumenty.BsD_DokNumer
      AND deleted.TrN_GIDTyp = CDN.BstDokumenty.BsD_DokTyp
      AND (CDN.BstDokumenty.BsD_DokTyp IN(1600,1603))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.TrN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.TrN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (1520,1489,2034,1497,2042,1528,1828,2033,2041,  2005,2036,2044,2002,2010,1832,2035,2003,1616,2000,2008,1824,2037,1625,2001,2009, 1617,1836,2039,1490,2047,1600,1603,1604,1529,1521,1232))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.TrN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.TrN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (1520,1489,2034,1497,2042,1528,1828,2033,2041,  2005,2036,2044,2002,2010,1832,2035,2003,1616,2000,2008,1824,2037,1625,2001,2009, 1617,1836,2039,1490,2047,1600,1603,1604,1529,1521,1232))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TrN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND  CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TrN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND  CDN.Atrybuty.Atr_OBILp=0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  CDN.WysRelacje.WyR_DokLp=0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  CDN.WysRelacje.WyR_DokLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.TrN_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.TrN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp  IN(1489,1497,2001,2009,1520,1528,1521,1529,2033,2041,2034,2042,2035,2043,2039,2047,1616,1617,1936,1937,2008,2010))
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.TrN_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.TrN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp  IN(1489,1497,2001,2009,1520,1528,1521,1529,2033,2041,2034,2042,2035,2043,2039,2047,1616,1617,1936,1937,2008,2010))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraVat
    IF EXISTS(SELECT * FROM CDN.TraVat JOIN deleted
            ON 
          deleted.TrN_GIDTyp = CDN.TraVat.TRV_GIDTyp
      AND deleted.TrN_GIDNumer = CDN.TraVat.TRV_GIDNumer
      AND (CDN.TraVat.TrV_GIDTyp NOT IN(3376,3378,3379,3387,3386,2600))
            )
        DELETE CDN.TraVat
        FROM CDN.TraVat JOIN deleted
        ON 
          deleted.TrN_GIDTyp = CDN.TraVat.TRV_GIDTyp
      AND deleted.TrN_GIDNumer = CDN.TraVat.TRV_GIDNumer
      AND (CDN.TraVat.TrV_GIDTyp NOT IN(3376,3378,3379,3387,3386,2600))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.TrN_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.TrN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.TrN_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.TrN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.TrN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TrN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600 ,1603,1604,2036,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND  CDN.AtrybutyHist.Ath_OBILp=0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.TrN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TrN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600 ,1603,1604,2036,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968)  AND  CDN.AtrybutyHist.Ath_OBILp=0 and CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraJPK
    IF EXISTS(SELECT * FROM CDN.TraJPK JOIN deleted
            ON 
          deleted.TrN_GIDTyp = CDN.TraJPK.TrJ_TrNTyp
      AND deleted.TrN_GIDNumer = CDN.TraJPK.TrJ_TrNNumer
      AND (CDN.TraJPK.TrJ_TrNTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,1520,1528,1521,1529,1489,1497,2036,2044,1490,1498,1312,1824,1320,1832,2000,2002,2008,2010,1828,1836,1968))
            )
        DELETE CDN.TraJPK
        FROM CDN.TraJPK JOIN deleted
        ON 
          deleted.TrN_GIDTyp = CDN.TraJPK.TrJ_TrNTyp
      AND deleted.TrN_GIDNumer = CDN.TraJPK.TrJ_TrNNumer
      AND (CDN.TraJPK.TrJ_TrNTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,1520,1528,1521,1529,1489,1497,2036,2044,1490,1498,1312,1824,1320,1832,2000,2002,2008,2010,1828,1836,1968))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdZwiazane
    IF EXISTS(SELECT * FROM CDN.ProdZwiazane JOIN deleted
            ON 
          deleted.TrN_GIDNumer = CDN.ProdZwiazane.PZW_DokNumer
      AND (CDN.ProdZwiazane.PZW_DokTyp IN(1616,1624))
            )
        DELETE CDN.ProdZwiazane
        FROM CDN.ProdZwiazane JOIN deleted
        ON 
          deleted.TrN_GIDNumer = CDN.ProdZwiazane.PZW_DokNumer
      AND (CDN.ProdZwiazane.PZW_DokTyp IN(1616,1624))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TraNag_InsertUpdateHandler
  ON CDN.TraNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TrN_MagZNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_MagZTyp=208)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TrN_MagZNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.TrN_MagZTyp=208)
                AND (
                          IsNull(inserted.TrN_MagZNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_MagDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_MagDTyp=208)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TrN_MagDNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.TrN_MagDTyp=208)
                AND (
                          IsNull(inserted.TrN_MagDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KnDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.TrN_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TrN_KnDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KnSNumerD )  OR UPDATE( TrN_KnSLpD ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.TrN_KnSNumerD = CDN.KntOsoby.KnS_KntNumer
                AND inserted.TrN_KnSLpD = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.TrN_KnSNumerD,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.TrN_KnSLpD,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KnSNumerP )  OR UPDATE( TrN_KnSLpP ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.TrN_KnSNumerP = CDN.KntOsoby.KnS_KntNumer
                AND inserted.TrN_KnSLpP = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.TrN_KnSNumerP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.TrN_KnSLpP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_PrjId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.TrN_PrjId = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.TrN_PrjId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_OdoNumer )  OR UPDATE( TrN_OdoLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_OdoTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.TrN_OdoNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.TrN_OdoLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.TrN_OdoTyp=32)
                AND (
                          IsNull(inserted.TrN_OdoNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.TrN_OdoLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_KntTyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.TrN_KntNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.TrN_KntTyp=14337)
                AND (
                          IsNull(inserted.TrN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_KnPTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.TrN_KnPNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.TrN_KnPTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_KnPTyp=48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.TrN_KnPNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.TrN_KnPTyp=48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_KnPTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.TrN_KnPNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.TrN_KnPTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KnPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_KnPTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.TrN_KnPNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.TrN_KnPTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRN_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.TrN_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.TRN_AkwTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_OpiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.TrN_OpiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TrN_OpiNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_FrsID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.TrN_FrsID = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.TrN_FrsID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRN_AkwTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.TrN_AkwNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.TRN_AkwTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_AdWTyp )  OR UPDATE( TrN_AdWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.TrN_AdWTyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.TrN_AdWNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL AND (exists (select * from CDN.KntKarty where Knt_GIDNumer = CDN.KntAdresy.KnA_KntNumer and Knt_GIDNumer = inserted.TrN_KnDNumer))
                AND (
                          IsNull(inserted.TrN_AdWTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.TrN_AdWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.TrN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.TrN_KntTyp=32)
                AND (
                          IsNull(inserted.TrN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrN_KnATyp )  OR UPDATE( TrN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.TrN_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.TrN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL AND (exists (select * from CDN.KntKarty where Knt_GIDNumer = CDN.KntAdresy.KnA_KntNumer and Knt_GIDNumer = inserted.TrN_KntNumer))
                AND (
                          IsNull(inserted.TrN_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.TrN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [TraNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraNagAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraNagAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraNagAlias_DeleteHandler
  ON CDN.TraNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwMag
    IF EXISTS
       ( SELECT * FROM CDN.InwMag JOIN deleted
          ON
                deleted.TrN_GIDTyp = CDN.InwMag.InM_PWTyp
            AND deleted.TrN_GIDNumer = CDN.InwMag.InM_PWNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Dokument PW został wygenerowany z inwentaryzacji, nie może zostać usunięty./# [TraNagAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraPlat_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraPlat_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraPlat_DeleteHandler
  ON CDN.TraPlat
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rozliczenia
    IF EXISTS
       ( SELECT * FROM CDN.Rozliczenia JOIN deleted
          ON
                deleted.TrP_GIDTyp = CDN.Rozliczenia.R2_Dok1Typ
            AND deleted.TrP_GIDNumer = CDN.Rozliczenia.R2_Dok1Numer
            AND deleted.TrP_GIDLp = CDN.Rozliczenia.R2_Dok1Lp
       AND (CDN.Rozliczenia.R2_Dok1Typ&lt;&gt;784 AND CDN.Rozliczenia.R2_Dok1Typ&lt;&gt;0 AND  CDN.Rozliczenia.R2_Dok1Typ&lt;&gt;435)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rozliczenia) [TraPlat_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TrP_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TrP_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TrP_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp &lt;&gt; 960 and CDN.Atrybuty.Atr_OBISubLp = -8209)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TrP_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TrP_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TrP_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp &lt;&gt; 960 and CDN.Atrybuty.Atr_OBISubLp = -8209)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.TrP_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TrP_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TrP_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp &lt;&gt; 960 and CDN.AtrybutyHist.Ath_OBISubLp = -8209)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.TrP_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TrP_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TrP_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp &lt;&gt; 960 and CDN.AtrybutyHist.Ath_OBISubLp = -8209)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraPlat_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraPlat_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TraPlat_InsertUpdateHandler
  ON CDN.TraPlat
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TrP_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_KntTyp=48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.TrP_KntNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.TRP_KntTyp=48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDTyp )  OR UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrP_GIDTyp IN(6272,6400,2768,7691,7696,7712,6402))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PodNag ON
                    inserted.TrP_GIDTyp = CDN.PodNag.PON_GIDTyp
                AND inserted.TrP_GIDNumer = CDN.PodNag.PON_GIDNumer
              WHERE CDN.PodNag.PON_GIDNumer IS NULL AND (inserted.TrP_GIDTyp IN(6272,6400,2768,7691,7696,7712,6402))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PodNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDTyp )  OR UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp IN(7680,7681,7682,7683))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.BilansOtwarciaNag ON
                    inserted.TrP_GIDTyp = CDN.BilansOtwarciaNag.BON_GIDTyp
                AND inserted.TrP_GIDNumer = CDN.BilansOtwarciaNag.BON_GIDNumer
              WHERE CDN.BilansOtwarciaNag.BON_GIDNumer IS NULL AND (inserted.TRP_GIDTyp IN(7680,7681,7682,7683))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  BilansOtwarciaNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_KntTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.TrP_KntNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.TRP_KntTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDTyp )  OR UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp in (3376,3378,3379,3386,3387))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.TrP_GIDTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.TrP_GIDNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (inserted.TRP_GIDTyp in (3376,3378,3379,3386,3387))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_KntTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.TrP_KntNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.TRP_KntTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDTyp )  OR UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp in (2832,2833))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UpoNag ON
                    inserted.TrP_GIDTyp = CDN.UpoNag.UPN_GIDTyp
                AND inserted.TrP_GIDNumer = CDN.UpoNag.UPN_GIDNumer
              WHERE CDN.UpoNag.UPN_GIDNumer IS NULL AND (inserted.TRP_GIDTyp in (2832,2833))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UpoNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_KARNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.TrP_KARNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TrP_KARNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.TrP_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.TRP_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDTyp )  OR UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrP_GIDTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.TrP_GIDTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.TrP_GIDNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.TrP_GIDTyp in (2033,2041,2037,2045,2001,2009,2005,2013,2034,2042,2035,2043,2039,2047,1520,1528,1521,1529,1489,1497,1600,1603,1604,2036,2044,1617,1616,2003,2004,1490,1498,1312,1824,1320,1832,1624,1625,2000,2002,2008,2010,1828,1836,1968))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_RachBank ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RachunkiBankowe ON
                    inserted.TrP_RachBank = CDN.RachunkiBankowe.RkB_Id
              WHERE CDN.RachunkiBankowe.RkB_Id IS NULL
                AND (
                          IsNull(inserted.TrP_RachBank,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RachunkiBankowe) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp IN (2976,2977))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PIKNag ON
                    inserted.TrP_GIDNumer = CDN.PIKNag.PIN_GIDNumer
              WHERE CDN.PIKNag.PIN_GIDNumer IS NULL AND (inserted.TRP_GIDTyp IN (2976,2977))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PIKNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp in (800))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Raporty ON
                    inserted.TrP_GIDNumer = CDN.Raporty.KRP_GIDNumer
              WHERE CDN.Raporty.KRP_GIDNumer IS NULL AND (inserted.TRP_GIDTyp in (800))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Raporty) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp IN(7684,7690))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Preliminarz ON
                    inserted.TrP_GIDNumer = CDN.Preliminarz.PRL_GIDNumer
              WHERE CDN.Preliminarz.PRL_GIDNumer IS NULL AND (inserted.TRP_GIDTyp IN(7684,7690))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Preliminarz) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrP_GIDTyp=4608)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KBNNag ON
                    inserted.TrP_GIDNumer = CDN.KBNNag.KBNN_Id
              WHERE CDN.KBNNag.KBNN_Id IS NULL AND (inserted.TrP_GIDTyp=4608)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KBNNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer )  OR UPDATE( TrP_GIDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp=434 AND inserted.TRP_Typ=1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KompElemPlatnosci ON
                    inserted.TrP_GIDNumer = CDN.KompElemPlatnosci.KMP_KMEID
                AND inserted.TrP_GIDLp = CDN.KompElemPlatnosci.KMP_ZobTRPLp
              WHERE CDN.KompElemPlatnosci.KMP_ZobTRPLp IS NULL AND (inserted.TRP_GIDTyp=434 AND inserted.TRP_Typ=1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KompElemPlatnosci) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer )  OR UPDATE( TrP_GIDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp=434 AND inserted.TRP_Typ=2)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KompElemPlatnosci ON
                    inserted.TrP_GIDNumer = CDN.KompElemPlatnosci.KMP_KMEID
                AND inserted.TrP_GIDLp = CDN.KompElemPlatnosci.KMP_NalTRPLp
              WHERE CDN.KompElemPlatnosci.KMP_NalTRPLp IS NULL AND (inserted.TRP_GIDTyp=434 AND inserted.TRP_Typ=2)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KompElemPlatnosci) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRP_GIDTyp=2984)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Delegacje ON
                    inserted.TrP_GIDNumer = CDN.Delegacje.DLG_GIDNumer
              WHERE CDN.Delegacje.DLG_GIDNumer IS NULL AND (inserted.TRP_GIDTyp=2984)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Delegacje) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrP_GIDTyp in (7942,7943))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProlongNag ON
                    inserted.TrP_GIDNumer = CDN.ProlongNag.PRLN_ID
              WHERE CDN.ProlongNag.PRLN_ID IS NULL AND (inserted.TrP_GIDTyp in (7942,7943))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProlongNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrP_GIDTyp in (4144,4145,4146))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.TrP_GIDNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.TrP_GIDTyp in (4144,4145,4146))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrP_GIDTyp in (2978,2979,2980))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wyplaty ON
                    inserted.TrP_GIDNumer = CDN.Wyplaty.WPL_Id
              WHERE CDN.Wyplaty.WPL_Id IS NULL AND (inserted.TrP_GIDTyp in (2978,2979,2980))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wyplaty) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrP_GIDTyp in (3344,3352))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.TrP_GIDNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.TrP_GIDTyp in (3344,3352))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrP_BbonId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Bony ON
                    inserted.TrP_BbonId = CDN.Bony.Bbon_Id
              WHERE CDN.Bony.Bbon_Id IS NULL
                AND (
                          IsNull(inserted.TrP_BbonId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Bony) [TraPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraPlatAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraPlatAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraPlatAlias_DeleteHandler
  ON CDN.TraPlat
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rozliczenia
    IF EXISTS
       ( SELECT * FROM CDN.Rozliczenia JOIN deleted
          ON
                deleted.TrP_GIDTyp = CDN.Rozliczenia.R2_Dok2Typ
            AND deleted.TrP_GIDNumer = CDN.Rozliczenia.R2_Dok2Numer
            AND deleted.TrP_GIDLp = CDN.Rozliczenia.R2_Dok2Lp
       AND (CDN.Rozliczenia.R2_Dok2Typ&lt;&gt;784 AND CDN.Rozliczenia.R2_Dok2Typ&lt;&gt;0 AND  CDN.Rozliczenia.R2_Dok2Typ&lt;&gt;435)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rozliczenia) [TraPlatAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TRZRozliczajacy"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TRZRozliczajacy */</I><BR>
ALTER TABLE CDN.TraRozliczZal ADD CONSTRAINT FK_TRZRozliczajacy
 FOREIGN KEY
   (
                          TRZ_KonNumer                      
                         )
             REFERENCES CDN.TraNag
                         (
                          TrN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TrSPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TrSPrimary */</I><BR>
ALTER TABLE CDN.TraSElem ADD CONSTRAINT FK_TrSPrimary
 FOREIGN KEY
   (
                          TrS_GIDNumer                      ,
                          TrS_GIDLp                         
                         )
             REFERENCES CDN.TraElem
                         (
                          TrE_GIDNumer   ,
                          TrE_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraSElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraSElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraSElem_DeleteHandler
  ON CDN.TraSElem
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJSubelem
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJSubelem JOIN deleted
          ON
                deleted.TrS_GIDTyp = CDN.ProdPKJSubelem.PKJS_GIDTyp
            AND deleted.TrS_GIDNumer = CDN.ProdPKJSubelem.PKJS_GIDNumer
            AND deleted.TrS_GIDLp = CDN.ProdPKJSubelem.PKJS_GIDLp
            AND deleted.TrS_SubGIDLp = CDN.ProdPKJSubelem.PKJS_SubGIDLp
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie elementu nie jest możliwe, zarejestrowano do niego protokół kontroli jakości PKJ/# [TraSElem_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagSElem
    IF EXISTS
       ( SELECT * FROM CDN.MagSElem JOIN deleted
          ON
                deleted.TrS_GIDTyp = CDN.MagSElem.MaS_ZrdTyp
            AND deleted.TrS_GIDNumer = CDN.MagSElem.MaS_ZrdNumer
            AND deleted.TrS_GIDLp = CDN.MagSElem.MaS_ZrdLp
            AND deleted.TrS_SubGIDLp = CDN.MagSElem.MaS_SubZrdLp
            
       AND (CDN.MagSElem.Mas_ZrdTyp NOT IN (0, 2576, 2592))
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Usunięcie elementu nie jest możliwe, zarejestrowano do niego dokument magazynowy/# [TraSElem_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TrS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TrS_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TrS_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.TrS_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND (CDN.Atrybuty.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,     2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528,1521 ,1529 ,1489 ,1497 ,1600 ,1603,1604,2036      ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TrS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TrS_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TrS_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND deleted.TrS_SubGIDLp = CDN.Atrybuty.Atr_ObiSubLp
      AND (CDN.Atrybuty.Atr_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,     2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528,1521 ,1529 ,1489 ,1497 ,1600 ,1603,1604,2036      ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   CDN.Atrybuty.Atr_OBILp&lt;&gt;0 and CDN.Atrybuty.Atr_OBISubLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZlcTrsLinki
    IF EXISTS(SELECT * FROM CDN.ZlcTrsLinki JOIN deleted
            ON 
          deleted.TrS_GIDTyp = CDN.ZlcTrsLinki.ZTL_PWTRSTyp
      AND deleted.TrS_GIDNumer = CDN.ZlcTrsLinki.ZTL_PWTRSNumer
      AND deleted.TrS_GIDLp = CDN.ZlcTrsLinki.ZTL_PWTRSLp
      AND deleted.TrS_SubGIDLp = CDN.ZlcTrsLinki.ZTL_PWSubTRSLp
      AND (CDN.ZlcTrsLinki.ZTL_PWTRSTyp=1617)
            )
        DELETE CDN.ZlcTrsLinki
        FROM CDN.ZlcTrsLinki JOIN deleted
        ON 
          deleted.TrS_GIDTyp = CDN.ZlcTrsLinki.ZTL_PWTRSTyp
      AND deleted.TrS_GIDNumer = CDN.ZlcTrsLinki.ZTL_PWTRSNumer
      AND deleted.TrS_GIDLp = CDN.ZlcTrsLinki.ZTL_PWTRSLp
      AND deleted.TrS_SubGIDLp = CDN.ZlcTrsLinki.ZTL_PWSubTRSLp
      AND (CDN.ZlcTrsLinki.ZTL_PWTRSTyp=1617)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.TrS_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TrS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TrS_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.TrS_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,     2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528,1521 ,1529 ,1489 ,1497 ,1600,1603,1604 ,2036      ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.TrS_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TrS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TrS_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND deleted.TrS_SubGIDLp = CDN.AtrybutyHist.AtH_ObiSubLp
      AND (CDN.AtrybutyHist.Ath_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,     2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528,1521 ,1529 ,1489 ,1497 ,1600,1603,1604 ,2036      ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498 ,1312  ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010 ) AND   CDN.AtrybutyHist.Ath_OBILp&lt;&gt;0 and CDN.AtrybutyHist.Ath_OBISubLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.TrS_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND deleted.TrS_GIDLp = CDN.WysRelacje.WYR_DokLp
      AND deleted.TrS_SubGIDLp = CDN.WysRelacje.WYR_DokSubLp
      AND (CDN.WysRelacje.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  CDN.WysRelacje.WyR_DokLp&lt;&gt;0  and  CDN.WysRelacje.WyR_DokSubLp&lt;&gt;0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.TrS_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND deleted.TrS_GIDLp = CDN.WysRelacje.WYR_DokLp
      AND deleted.TrS_SubGIDLp = CDN.WysRelacje.WYR_DokSubLp
      AND (CDN.WysRelacje.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  CDN.WysRelacje.WyR_DokLp&lt;&gt;0  and  CDN.WysRelacje.WyR_DokSubLp&lt;&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraSElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraSElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TraSElem_InsertUpdateHandler
  ON CDN.TraSElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TrS_MagNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Trs_MagTyp=208)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TrS_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (inserted.Trs_MagTyp=208)
                AND (
                          IsNull(inserted.TrS_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TraSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrS_ZlcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TRS_ZLCTYP = 14345)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.TrS_ZlcNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.TRS_ZLCTYP = 14345)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [TraSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TrS_ZlcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Trs_ZlcTyp=14346)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZasoby ON
                    inserted.TrS_ZlcNumer = CDN.ProdZasoby.PZA_ID
              WHERE CDN.ProdZasoby.PZA_ID IS NULL AND (inserted.Trs_ZlcTyp=14346)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZasoby) [TraSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraSElemAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraSElemAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraSElemAlias_DeleteHandler
  ON CDN.TraSElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZlcTrsLinki
    IF EXISTS(SELECT * FROM CDN.ZlcTrsLinki JOIN deleted
            ON 
          deleted.TrS_GIDTyp = CDN.ZlcTrsLinki.ZTL_RWTRSTyp
      AND deleted.TrS_GIDNumer = CDN.ZlcTrsLinki.ZTL_RWTRSNumer
      AND deleted.TrS_GIDLp = CDN.ZlcTrsLinki.ZTL_RWTRSLp
      AND deleted.TrS_SubGIDLp = CDN.ZlcTrsLinki.ZTL_RWSubTRSLp
      AND (CDN.ZlcTrsLinki.ZTL_RWTRSTyp=1616)
            )
        DELETE CDN.ZlcTrsLinki
        FROM CDN.ZlcTrsLinki JOIN deleted
        ON 
          deleted.TrS_GIDTyp = CDN.ZlcTrsLinki.ZTL_RWTRSTyp
      AND deleted.TrS_GIDNumer = CDN.ZlcTrsLinki.ZTL_RWTRSNumer
      AND deleted.TrS_GIDLp = CDN.ZlcTrsLinki.ZTL_RWTRSLp
      AND deleted.TrS_SubGIDLp = CDN.ZlcTrsLinki.ZTL_RWSubTRSLp
      AND (CDN.ZlcTrsLinki.ZTL_RWTRSTyp=1616)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraSElemAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraSElemAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TraSElemAlias_InsertUpdateHandler
  ON CDN.TraSElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TrS_DsFNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrS_DsFTyp=160)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Dostawy ON
                    inserted.TrS_DsFNumer = CDN.Dostawy.Dst_GIDNumer
              WHERE CDN.Dostawy.Dst_GIDNumer IS NULL AND (inserted.TrS_DsFTyp=160)
                AND (
                          IsNull(inserted.TrS_DsFNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Dostawy) [TraSElemAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TSVPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TSVPrimary */</I><BR>
ALTER TABLE CDN.TraSVat ADD CONSTRAINT FK_TSVPrimary
 FOREIGN KEY
   (
                          TSV_GIDTyp                        ,
                          TSV_GIDNumer                      ,
                          TSV_GIDLp                         
                         )
             REFERENCES CDN.TraVat
                         (
                          TRV_GIDTyp   ,
                          TRV_GIDNumer   ,
                          TRV_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraSVat_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraSVat_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TraSVat_InsertUpdateHandler
  ON CDN.TraSVat
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TSV_R2ID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rozliczenia ON
                    inserted.TSV_R2ID = CDN.Rozliczenia.R2_ID
              WHERE CDN.Rozliczenia.R2_ID IS NULL
                AND (
                          IsNull(inserted.TSV_R2ID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rozliczenia) [TraSVat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraVat_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraVat_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TraVat_DeleteHandler
  ON CDN.TraVat
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TRV_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TRV_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TRV_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBISubLp = -8210)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TRV_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TRV_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TRV_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBISubLp = -8210)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.TRV_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TRV_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TRV_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBISubLp = -8210)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.TRV_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TRV_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TRV_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBISubLp = -8210)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TraVat_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TraVat_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TraVat_InsertUpdateHandler
  ON CDN.TraVat
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TrV_OgraniczenieOdl ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TrV_OgraniczenieOdl = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.TrV_OgraniczenieOdl,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TraVat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TRV_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrV_GIDTyp=2600)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmlRaty ON
                    inserted.TRV_GIDNumer = CDN.UmlRaty.ULR_ID
              WHERE CDN.UmlRaty.ULR_ID IS NULL AND (inserted.TrV_GIDTyp=2600)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmlRaty) [TraVat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TRV_SrtNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.TRV_SrtNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TRV_SrtNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [TraVat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TRV_GIDTyp )  OR UPDATE( TRV_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrV_GIDTyp IN(3376,3378,3379,3387,3386))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.TRV_GIDTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.TRV_GIDNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (inserted.TrV_GIDTyp IN(3376,3378,3379,3387,3386))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [TraVat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TRV_GIDTyp )  OR UPDATE( TRV_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TrV_GIDTyp NOT IN(3376,3378,3379,3387,3386,2600))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.TRV_GIDTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.TRV_GIDNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.TrV_GIDTyp NOT IN(3376,3378,3379,3387,3386,2600))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [TraVat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TsETrasa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TsETrasa */</I><BR>
ALTER TABLE CDN.TrasyElem ADD CONSTRAINT FK_TsETrasa
 FOREIGN KEY
   (
                          TsE_TsNId                         
                         )
             REFERENCES CDN.TrasyNag
                         (
                          TsN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TrasyElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TrasyElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TrasyElem_InsertUpdateHandler
  ON CDN.TrasyElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TsE_KntATyp )  OR UPDATE( TsE_KntANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.TsE_KntATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.TsE_KntANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TsE_KntATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.TsE_KntANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [TrasyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TrasyNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TrasyNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TrasyNag_DeleteHandler
  ON CDN.TrasyNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagNag
    IF EXISTS
       ( SELECT * FROM CDN.MagNag JOIN deleted
          ON
                deleted.TsN_Id = CDN.MagNag.MaN_TrasaId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagNag) [TrasyNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WysPaczki
    IF EXISTS
       ( SELECT * FROM CDN.WysPaczki JOIN deleted
          ON
                deleted.TsN_Id = CDN.WysPaczki.WyP_TrasaID
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WysPaczki) [TrasyNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Wysylki
    IF EXISTS
       ( SELECT * FROM CDN.Wysylki JOIN deleted
          ON
                deleted.TsN_Id = CDN.Wysylki.WYS_TrasaId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Wysylki) [TrasyNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyNag
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyNag JOIN deleted
          ON
                deleted.TsN_Id = CDN.CRMWizytyNag.CWN_TsNId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyNag) [TrasyNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TrasyNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TrasyNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TrasyNag_InsertUpdateHandler
  ON CDN.TrasyNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TsN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TsN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.TsN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.TsN_KntTyp=32)
                AND (
                          IsNull(inserted.TsN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TrasyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TsN_KierNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TsN_KierTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.TsN_KierNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.TsN_KierTyp=944)
                AND (
                          IsNull(inserted.TsN_KierNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [TrasyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TsN_KierNumer )  OR UPDATE( TsN_KierLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TsN_KierTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.TsN_KierNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.TsN_KierLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.TsN_KierTyp=32)
                AND (
                          IsNull(inserted.TsN_KierNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.TsN_KierLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [TrasyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TsN_SamId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Samochody ON
                    inserted.TsN_SamId = CDN.Samochody.SaM_Id
              WHERE CDN.Samochody.SaM_Id IS NULL
                AND (
                          IsNull(inserted.TsN_SamId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Samochody) [TrasyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TeOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TeOPrimary */</I><BR>
ALTER TABLE CDN.TreOpisy ADD CONSTRAINT FK_TeOPrimary
 FOREIGN KEY
   (
                          TeO_TreNumer                      ,
                          TeO_TreLp                         
                         )
             REFERENCES CDN.TraElem
                         (
                          TrE_GIDNumer   ,
                          TrE_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TWAPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TWAPrimary */</I><BR>
ALTER TABLE CDN.TwrAnaliza ADD CONSTRAINT FK_TWAPrimary
 FOREIGN KEY
   (
                          TwA_OkresId                       
                         )
             REFERENCES CDN.TwrAnalizaOkres
                         (
                          TAO_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TAEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TAEPrimary */</I><BR>
ALTER TABLE CDN.TwrAnalizaElem ADD CONSTRAINT FK_TAEPrimary
 FOREIGN KEY
   (
                          TAE_TANId                         
                         )
             REFERENCES CDN.TwrAnalizaNag
                         (
                          TAN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TAETwr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TAETwr */</I><BR>
ALTER TABLE CDN.TwrAnalizaElem ADD CONSTRAINT FK_TAETwr
 FOREIGN KEY
   (
                          TAE_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrAnalizaElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrAnalizaElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrAnalizaElem_InsertUpdateHandler
  ON CDN.TwrAnalizaElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TAE_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TAE_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TAE_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TwrAnalizaElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TAMPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TAMPrimary */</I><BR>
ALTER TABLE CDN.TwrAnalizaMag ADD CONSTRAINT FK_TAMPrimary
 FOREIGN KEY
   (
                          TAM_TANId                         
                         )
             REFERENCES CDN.TwrAnalizaNag
                         (
                          TAN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrAnalizaNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrAnalizaNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrAnalizaNag_InsertUpdateHandler
  ON CDN.TwrAnalizaNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TAN_OkresId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrAnalizaOkres ON
                    inserted.TAN_OkresId = CDN.TwrAnalizaOkres.TAO_Id
              WHERE CDN.TwrAnalizaOkres.TAO_Id IS NULL
                AND (
                          IsNull(inserted.TAN_OkresId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrAnalizaOkres) [TwrAnalizaNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrAnalizaOkres_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrAnalizaOkres_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrAnalizaOkres_DeleteHandler
  ON CDN.TwrAnalizaOkres
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrAnalizaNag
    IF EXISTS
       ( SELECT * FROM CDN.TwrAnalizaNag JOIN deleted
          ON
                deleted.TAO_Id = CDN.TwrAnalizaNag.TAN_OkresId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrAnalizaNag) [TwrAnalizaOkres_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrAplikacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrAplikacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrAplikacje_InsertUpdateHandler
  ON CDN.TwrAplikacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TAP_ObiTyp )  OR UPDATE( TAP_ObiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TAP_ObiTyp = CDN.TwrKarty.Twr_GIDTyp
                AND inserted.TAP_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (CDN.TwrKarty.Twr_GIDTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TAP_ObiTyp )  OR UPDATE( TAP_ObiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzorce ON
                    inserted.TAP_ObiTyp = CDN.TwrWzorce.TwW_GrpTyp
                AND inserted.TAP_ObiNumer = CDN.TwrWzorce.TwW_GrpNumer
              WHERE CDN.TwrWzorce.TwW_GrpNumer IS NULL AND (CDN.TwrWzorce.TwW_GrpTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzorce) [TwrAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TAp_WszystkoPlKategoria ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KatGrupyTwr ON
                    inserted.TAp_WszystkoPlKategoria = CDN.KatGrupyTwr.KGT_Id
              WHERE CDN.KatGrupyTwr.KGT_Id IS NULL
                AND (
                          IsNull(inserted.TAp_WszystkoPlKategoria,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KatGrupyTwr) [TwrAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TAP_ObiTyp )  OR UPDATE( TAP_ObiNumer )  OR UPDATE( TAp_GrupaeSklep ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TAP_GrupaeSklep&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupy ON
                    inserted.TAP_ObiTyp = CDN.TwrGrupy.TwG_GIDTyp
                AND inserted.TAP_ObiNumer = CDN.TwrGrupy.TwG_GIDNumer
                AND inserted.TAp_GrupaeSklep = CDN.TwrGrupy.TwG_GrONumer
              WHERE CDN.TwrGrupy.TwG_GrONumer IS NULL AND (inserted.TAP_GrupaeSklep&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupy) [TwrAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TAp_TwrNadrzedny ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TAp_TwrNadrzedny = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TAp_TwrNadrzedny,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrAplikacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrAplikacjeOpisy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrAplikacjeOpisy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrAplikacjeOpisy_InsertUpdateHandler
  ON CDN.TwrAplikacjeOpisy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TPO_ObiTyp )  OR UPDATE( TPO_ObiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TPO_ObiTyp = CDN.TwrKarty.Twr_GIDTyp
                AND inserted.TPO_ObiNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (CDN.TwrKarty.Twr_GIDTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrAplikacjeOpisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TPO_ObiTyp )  OR UPDATE( TPO_ObiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzorce ON
                    inserted.TPO_ObiTyp = CDN.TwrWzorce.TwW_GrpTyp
                AND inserted.TPO_ObiNumer = CDN.TwrWzorce.TwW_GrpNumer
              WHERE CDN.TwrWzorce.TwW_GrpNumer IS NULL AND (CDN.TwrWzorce.TwW_GrpTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzorce) [TwrAplikacjeOpisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TPO_JezykId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TPO_JezykId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.TPO_JezykId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrAplikacjeOpisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TwCTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TwCTowar */</I><BR>
ALTER TABLE CDN.TwrCeny ADD CONSTRAINT FK_TwCTowar
 FOREIGN KEY
   (
                          TwC_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrCeny_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrCeny_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrCeny_DeleteHandler
  ON CDN.TwrCeny
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PicoCenniki
    IF EXISTS(SELECT * FROM CDN.PicoCenniki JOIN deleted
            ON 
          deleted.TwC_ID = CDN.PicoCenniki.PcC_TwCTwrNumer
      AND (CDN.PicoCenniki.PcC_TwCTwrTyp = 64 and CDN.PicoCenniki.PcC_TwCTwrLp = 0)
            )
        DELETE CDN.PicoCenniki
        FROM CDN.PicoCenniki JOIN deleted
        ON 
          deleted.TwC_ID = CDN.PicoCenniki.PcC_TwCTwrNumer
      AND (CDN.PicoCenniki.PcC_TwCTwrTyp = 64 and CDN.PicoCenniki.PcC_TwCTwrLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TwC_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp = 64 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and  CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TwC_ID = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp = 64 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and  CDN.Atrybuty.Atr_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrCenyAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrCenyAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrCenyAlias_InsertUpdateHandler
  ON CDN.TwrCeny
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TwC_TcnId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrCenyNag ON
                    inserted.TwC_TcnId = CDN.TwrCenyNag.TCN_Id
              WHERE CDN.TwrCenyNag.TCN_Id IS NULL
                AND (
                          IsNull(inserted.TwC_TcnId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrCenyNag) [TwrCenyAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrCenyNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrCenyNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrCenyNag_DeleteHandler
  ON CDN.TwrCenyNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrCeny
    IF EXISTS(SELECT * FROM CDN.TwrCeny JOIN deleted
            ON 
          deleted.TCN_Id = CDN.TwrCeny.TwC_TcnId
            )
        DELETE CDN.TwrCeny
        FROM CDN.TwrCeny JOIN deleted
        ON 
          deleted.TCN_Id = CDN.TwrCeny.TwC_TcnId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TCN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp = 64 and CDN.Atrybuty.Atr_OBILp = 0 and  CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TCN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp = 64 and CDN.Atrybuty.Atr_OBILp = 0 and  CDN.Atrybuty.Atr_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TwDTwrNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TwDTwrNoType */</I><BR>
ALTER TABLE CDN.TwrDost ADD CONSTRAINT FK_TwDTwrNoType
 FOREIGN KEY
   (
                          TWD_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrDost_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrDost_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrDost_DeleteHandler
  ON CDN.TwrDost
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrDostHist
    IF EXISTS(SELECT * FROM CDN.TwrDostHist JOIN deleted
            ON 
          deleted.TWD_TwrTyp = CDN.TwrDostHist.TDH_TwrTyp
      AND deleted.TWD_TwrNumer = CDN.TwrDostHist.TDH_TwrNumer
      AND deleted.TWD_KlasaKnt = CDN.TwrDostHist.TDH_KlasaKnt
      AND deleted.TWD_TwrLp = CDN.TwrDostHist.TDH_TwrLp
      AND ( CDN.TwrDostHist.TDH_TwrTyp =16)
            )
        DELETE CDN.TwrDostHist
        FROM CDN.TwrDostHist JOIN deleted
        ON 
          deleted.TWD_TwrTyp = CDN.TwrDostHist.TDH_TwrTyp
      AND deleted.TWD_TwrNumer = CDN.TwrDostHist.TDH_TwrNumer
      AND deleted.TWD_KlasaKnt = CDN.TwrDostHist.TDH_KlasaKnt
      AND deleted.TWD_TwrLp = CDN.TwrDostHist.TDH_TwrLp
      AND ( CDN.TwrDostHist.TDH_TwrTyp =16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TWD_TwrNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TWD_TwrTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TWD_TwrLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp =16 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and           CDN.Atrybuty.Atr_OBISubLp = 32)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TWD_TwrNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TWD_TwrTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.TWD_TwrLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp =16 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and           CDN.Atrybuty.Atr_OBISubLp = 32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.TWD_TwrTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TWD_TwrNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TWD_TwrLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp =16 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and           CDN.AtrybutyHist.Ath_OBISubLp = 32)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.TWD_TwrTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TWD_TwrNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.TWD_TwrLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp =16 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and           CDN.AtrybutyHist.Ath_OBISubLp = 32)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrDost_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrDost_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrDost_InsertUpdateHandler
  ON CDN.TwrDost
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TWD_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TWD_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.TWD_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.TWD_KntTyp=32)
                AND (
                          IsNull(inserted.TWD_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TwrDost_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TDCTwd"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TDCTwd */</I><BR>
ALTER TABLE CDN.TwrDostCeny ADD CONSTRAINT FK_TDCTwd
 FOREIGN KEY
   (
                          TDC_TwdId                         
                         )
             REFERENCES CDN.TwrDost
                         (
                          TwD_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrDostHist_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrDostHist_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrDostHist_InsertUpdateHandler
  ON CDN.TwrDostHist
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TDH_TwrTyp )  OR UPDATE( TDH_TwrNumer )  OR UPDATE( TDH_KlasaKnt )  OR UPDATE( TDH_TwrLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE  inserted.TDH_TwrTyp =16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrDost ON
                    inserted.TDH_TwrTyp = CDN.TwrDost.TWD_TwrTyp
                AND inserted.TDH_TwrNumer = CDN.TwrDost.TWD_TwrNumer
                AND inserted.TDH_KlasaKnt = CDN.TwrDost.TWD_KlasaKnt
                AND inserted.TDH_TwrLp = CDN.TwrDost.TWD_TwrLp
              WHERE CDN.TwrDost.TWD_TwrLp IS NULL AND ( inserted.TDH_TwrTyp =16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrDost) [TwrDostHist_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrGrupy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrGrupy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrGrupy_DeleteHandler
  ON CDN.TwrGrupy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdGrupyElem
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdGrupyElem JOIN deleted
          ON
                deleted.TwG_GIDNumer = CDN.KonfProdGrupyElem.KEG_TwGNumer
            AND deleted.TwG_GIDTyp = CDN.KonfProdGrupyElem.KEG_TwGTyp
       AND (CDN.KonfProdGrupyElem.KEG_TwGTyp=-16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KonfProdGrupyElem) [TwrGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologia
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologia JOIN deleted
          ON
                deleted.TwG_GIDNumer = CDN.ProdTechnologia.PTE_TwrNumer
            AND deleted.TwG_GIDTyp = CDN.ProdTechnologia.PTE_TwrTyp
       AND (EXISTS(SELECT * FROM CDN.TwrGrupyDom where TGD_GIDTyp=deleted.TwG_GIDTyp AND TGD_GIDNumer = deleted.TwG_GIDNumer AND TGD_GrOTyp = deleted.TwG_GrOTyp AND TGD_GrONumer = deleted.TwG_GrONumer))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologia) [TwrGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaZasobyTwX
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaZasobyTwX JOIN deleted
          ON
                deleted.TwG_GIDTyp = CDN.ProdTechnologiaZasobyTwX.PTT_TwXTyp
            AND deleted.TwG_GIDNumer = CDN.ProdTechnologiaZasobyTwX.PTT_TwXNumer
       AND (EXISTS(SELECT * FROM CDN.TwrGrupyDom where TGD_GIDTyp=deleted.TwG_GIDTyp AND TGD_GIDNumer = deleted.TwG_GIDNumer AND TGD_GrOTyp = deleted.TwG_GrOTyp AND TGD_GrONumer = deleted.TwG_GrONumer))
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologiaZasobyTwX) [TwrGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdNag
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdNag JOIN deleted
          ON
                deleted.TwG_GIDNumer = CDN.KonfProdNag.KPN_TwGNumer
            AND deleted.TwG_GIDTyp = CDN.KonfProdNag.KPN_TwGTyp
            
       AND (CDN.KonfProdNag.KPN_TwGTyp=-16)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć grupy towarowej, ponieważ występuje ona na konfiguracji produktu elementu dokumentu./# [TwrGrupy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPlanyTwG
    IF EXISTS
       ( SELECT * FROM CDN.ProdPlanyTwG JOIN deleted
          ON
                deleted.TwG_GIDNumer = CDN.ProdPlanyTwG.PPG_TwGNumer
            AND deleted.TwG_GIDTyp = CDN.ProdPlanyTwG.PPG_TwGTyp
       AND (CDN.ProdPlanyTwG.PPG_TwGTyp=-16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPlanyTwG) [TwrGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKampTwr
    IF EXISTS
       ( SELECT * FROM CDN.CRMKampTwr JOIN deleted
          ON
                deleted.TwG_GIDNumer = CDN.CRMKampTwr.CKT_TwrNumer
            AND deleted.TwG_GIDTyp = CDN.CRMKampTwr.CKT_TwrTyp
            
       AND (CDN.CRMKampTwr.CKT_TwrTyp=-16)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć grupy, ponieważ występuje ona na kampanii CRM./# [TwrGrupy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.TwrAplikacje JOIN deleted
          ON
                deleted.TwG_GIDTyp = CDN.TwrAplikacje.TAP_ObiTyp
            AND deleted.TwG_GIDNumer = CDN.TwrAplikacje.TAP_ObiNumer
            AND deleted.TwG_GrONumer = CDN.TwrAplikacje.TAp_GrupaeSklep
            
       AND (CDN.TwrAplikacje.TAP_GrupaeSklep&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć elementu z grupy domyślnej dla aplikacji zewnętrznej./# [TwrGrupy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProgiIloscAp
    IF EXISTS(SELECT * FROM CDN.ProgiIloscAp JOIN deleted
            ON 
          deleted.TwG_GIDNumer = CDN.ProgiIloscAp.PIA_ObiNumer
      AND deleted.TwG_GIDTyp = CDN.ProgiIloscAp.PIA_ObiTyp
      AND (EXISTS(SELECT * FROM CDN.TwrGrupyDom where TGD_GIDTyp=deleted.TwG_GIDTyp AND TGD_GIDNumer = deleted.TwG_GIDNumer AND TGD_GrOTyp = deleted.TwG_GrOTyp AND TGD_GrONumer = deleted.TwG_GrONumer))
            )
        DELETE CDN.ProgiIloscAp
        FROM CDN.ProgiIloscAp JOIN deleted
        ON 
          deleted.TwG_GIDNumer = CDN.ProgiIloscAp.PIA_ObiNumer
      AND deleted.TwG_GIDTyp = CDN.ProgiIloscAp.PIA_ObiTyp
      AND (EXISTS(SELECT * FROM CDN.TwrGrupyDom where TGD_GIDTyp=deleted.TwG_GIDTyp AND TGD_GIDNumer = deleted.TwG_GIDNumer AND TGD_GrOTyp = deleted.TwG_GrOTyp AND TGD_GrONumer = deleted.TwG_GrONumer))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ParamRozKonf
    IF EXISTS(SELECT * FROM CDN.ParamRozKonf JOIN deleted
            ON 
          deleted.TwG_GIDNumer = CDN.ParamRozKonf.PRK_ObiNumer
      AND deleted.TwG_GIDTyp = CDN.ParamRozKonf.PRK_ObiTyp
      AND (CDN.ParamRozKonf.PRK_ObiTyp = -16)
            )
        DELETE CDN.ParamRozKonf
        FROM CDN.ParamRozKonf JOIN deleted
        ON 
          deleted.TwG_GIDNumer = CDN.ParamRozKonf.PRK_ObiNumer
      AND deleted.TwG_GIDTyp = CDN.ParamRozKonf.PRK_ObiTyp
      AND (CDN.ParamRozKonf.PRK_ObiTyp = -16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TwG_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TwG_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp = -16 and CDN.Atrybuty.Atr_OBILp = 1)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TwG_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TwG_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp = -16 and CDN.Atrybuty.Atr_OBILp = 1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanSprzedazyTwr
    IF EXISTS(SELECT * FROM CDN.PlanSprzedazyTwr JOIN deleted
            ON 
          deleted.TwG_GIDTyp = CDN.PlanSprzedazyTwr.PST_TwrTyp
      AND deleted.TwG_GIDNumer = CDN.PlanSprzedazyTwr.PST_TwrNumer
      AND (CDN.PlanSprzedazyTwr.PST_TwrTyp&lt;0)
            )
        DELETE CDN.PlanSprzedazyTwr
        FROM CDN.PlanSprzedazyTwr JOIN deleted
        ON 
          deleted.TwG_GIDTyp = CDN.PlanSprzedazyTwr.PST_TwrTyp
      AND deleted.TwG_GIDNumer = CDN.PlanSprzedazyTwr.PST_TwrNumer
      AND (CDN.PlanSprzedazyTwr.PST_TwrTyp&lt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroTowary
    IF EXISTS(SELECT * FROM CDN.RetroTowary JOIN deleted
            ON 
          deleted.TwG_GIDNumer = CDN.RetroTowary.RtT_TwrNumer
      AND deleted.TwG_GIDTyp = CDN.RetroTowary.RtT_TwrTyp
      AND (CDN.RetroTowary.RtT_TwrTyp=-16)
            )
        DELETE CDN.RetroTowary
        FROM CDN.RetroTowary JOIN deleted
        ON 
          deleted.TwG_GIDNumer = CDN.RetroTowary.RtT_TwrNumer
      AND deleted.TwG_GIDTyp = CDN.RetroTowary.RtT_TwrTyp
      AND (CDN.RetroTowary.RtT_TwrTyp=-16)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrGrupy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrGrupy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrGrupy_InsertUpdateHandler
  ON CDN.TwrGrupy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TwG_GIDTyp )  OR UPDATE( TwG_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TwG_GIDTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TwG_GIDTyp = CDN.TwrKarty.Twr_GIDTyp
                AND inserted.TwG_GIDNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.TwG_GIDTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrGrupy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TwG_KategoriaBIId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TwG_KategoriaBIId &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TwG_KategoriaBIId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.TwG_KategoriaBIId &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrGrupy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrGrupyDom_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrGrupyDom_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrGrupyDom_DeleteHandler
  ON CDN.TwrGrupyDom
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntAplikacjeObiekty
    IF EXISTS
       ( SELECT * FROM CDN.KntAplikacjeObiekty JOIN deleted
          ON
                deleted.TGD_GIDNumer = CDN.KntAplikacjeObiekty.KOb_ObiNumer
            AND deleted.TGD_GIDTyp = CDN.KntAplikacjeObiekty.KOb_ObiTyp
            
       AND (CDN.KntAplikacjeObiekty.KOb_ObiTyp=-16)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunać grupy, ponieważ jest ona użyta w aplikacjach zewnętrznych kontrahenta./# [TwrGrupyDom_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrPromocje
    IF EXISTS(SELECT * FROM CDN.TwrPromocje JOIN deleted
            ON 
          deleted.TGD_GIDTyp = CDN.TwrPromocje.TPR_TwrTyp
      AND deleted.TGD_GIDNumer = CDN.TwrPromocje.TPR_TwrNumer
      AND (CDN.TwrPromocje.TPR_TwrTyp&lt;0 AND CDN.TwrPromocje.TPR_TwrNumer&lt;&gt;0)
            )
        DELETE CDN.TwrPromocje
        FROM CDN.TwrPromocje JOIN deleted
        ON 
          deleted.TGD_GIDTyp = CDN.TwrPromocje.TPR_TwrTyp
      AND deleted.TGD_GIDNumer = CDN.TwrPromocje.TPR_TwrNumer
      AND (CDN.TwrPromocje.TPR_TwrTyp&lt;0 AND CDN.TwrPromocje.TPR_TwrNumer&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdWzorceKJTowary
    IF EXISTS(SELECT * FROM CDN.ProdWzorceKJTowary JOIN deleted
            ON 
          deleted.TGD_GIDNumer = CDN.ProdWzorceKJTowary.PWT_TwrGIDNumer
      AND (CDN.ProdWzorceKJTowary.PWT_TwrGIDTyp = -16 AND CDN.ProdWzorceKJTowary.PWT_TwrGIDNumer &lt;&gt; 0)
            )
        DELETE CDN.ProdWzorceKJTowary
        FROM CDN.ProdWzorceKJTowary JOIN deleted
        ON 
          deleted.TGD_GIDNumer = CDN.ProdWzorceKJTowary.PWT_TwrGIDNumer
      AND (CDN.ProdWzorceKJTowary.PWT_TwrGIDTyp = -16 AND CDN.ProdWzorceKJTowary.PWT_TwrGIDNumer &lt;&gt; 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TwJTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TwJTowar */</I><BR>
ALTER TABLE CDN.TwrJm ADD CONSTRAINT FK_TwJTowar
 FOREIGN KEY
   (
                          TwJ_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrJm_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrJm_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrJm_InsertUpdateHandler
  ON CDN.TwrJm
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TwJ_KcaNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TwJ_KcaNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TwJ_KcaNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrJm_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrKarty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrKarty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrKarty_DeleteHandler
  ON CDN.TwrKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdGrupyStruktura
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdGrupyStruktura JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.KonfProdGrupyStruktura.KGS_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KonfProdGrupyStruktura) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanyObciazeniaPozycje
    IF EXISTS
       ( SELECT * FROM CDN.PlanyObciazeniaPozycje JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.PlanyObciazeniaPozycje.PPO_TwrNumer
            
       AND (CDN.PlanyObciazeniaPozycje.PPO_TwrTyp=16)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru, ponieważ występuje on na planie obciążenia gniazd roboczych./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPlanyMaterialy
    IF EXISTS
       ( SELECT * FROM CDN.ProdPlanyMaterialy JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ProdPlanyMaterialy.PPT_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPlanyMaterialy) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KonfProdNag
    IF EXISTS
       ( SELECT * FROM CDN.KonfProdNag JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.KonfProdNag.KPN_PrdNumer
            
       AND (CDN.KonfProdNag.KPN_PrdTyp=16)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru, ponieważ występuje on na konfiguracji produktu elementu dokumentu./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKampTwr
    IF EXISTS
       ( SELECT * FROM CDN.CRMKampTwr JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.CRMKampTwr.CKT_TwrNumer
            
       AND (CDN.CRMKampTwr.CKT_TwrTyp=16)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru, ponieważ występuje on na kampanii CRM./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMWizytyAnkiety
    IF EXISTS
       ( SELECT * FROM CDN.CRMWizytyAnkiety JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.CRMWizytyAnkiety.CWA_TWRNumer
       AND (CDN.CRMWizytyAnkiety.CWA_TwrTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMWizytyAnkiety) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ReklElem
    IF EXISTS
       ( SELECT * FROM CDN.ReklElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ReklElem.RLE_TwrNumer
       AND (CDN.ReklElem.RLE_TwrTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ReklElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.SrwUrzadzenia.SrU_ObiNumer
       AND (CDN.SrwUrzadzenia.SrU_ObiTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwUrzadzenia) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcCzynnosci JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.SrwZlcCzynnosci.SZC_TwrNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru ponieważ występuje on na czynności zlecenia ZSR./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcSkladniki
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcSkladniki JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.SrwZlcSkladniki.SZS_TwrNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru ponieważ występuje on na składniku zlecenia ZSR./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagElem
    IF EXISTS
       ( SELECT * FROM CDN.MagElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.MagElem.MaE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrPartie
    IF EXISTS
       ( SELECT * FROM CDN.TwrPartie JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.TwrPartie.TpA_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrPartie) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdZasoby JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ProdZasoby.PZA_TwrNumer
       AND (CDN.ProdZasoby.PZA_TwrTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZasoby) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.PlanElem
    IF EXISTS
       ( SELECT * FROM CDN.PlanElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.PlanElem.PLE_TwrNumer
       AND (CDN.PlanElem.PLE_TwrTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą PlanElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdZlecElem
    IF EXISTS
       ( SELECT * FROM CDN.ProdZlecElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ProdZlecElem.PZE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdZlecElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaZasoby
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaZasoby JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ProdTechnologiaZasoby.PTZ_TwrNumer
       AND (CDN.ProdTechnologiaZasoby.PTZ_TwrTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologiaZasoby) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologiaCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologiaCzynnosci JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ProdTechnologiaCzynnosci.PTC_TwrNumer
       AND (CDN.ProdTechnologiaCzynnosci.PTC_TwrTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologiaCzynnosci) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdObiekty
    IF EXISTS
       ( SELECT * FROM CDN.ProdObiekty JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ProdObiekty.POB_ObiNumer
       AND (CDN.ProdObiekty.POB_ObiTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdObiekty) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsCzynnosci
    IF EXISTS
       ( SELECT * FROM CDN.SrsCzynnosci JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.SrsCzynnosci.SsC_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsCzynnosci) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNMaterialy
    IF EXISTS
       ( SELECT * FROM CDN.ZRNMaterialy JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ZRNMaterialy.ZRM_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNMaterialy) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZRNKartyPracyUsl
    IF EXISTS
       ( SELECT * FROM CDN.ZRNKartyPracyUsl JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ZRNKartyPracyUsl.ZRU_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZRNKartyPracyUsl) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcRemElem
    IF EXISTS
       ( SELECT * FROM CDN.ZlcRemElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ZlcRemElem.ZRE_TwrNumer
       AND (CDN.ZlcRemElem.ZrE_TwrTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcRemElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrsWyposazenia
    IF EXISTS
       ( SELECT * FROM CDN.SrsWyposazenia JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.SrsWyposazenia.SsW_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrsWyposazenia) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwTwr
    IF EXISTS
       ( SELECT * FROM CDN.InwTwr JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.InwTwr.InT_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą InwTwr) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwOdcTwr
    IF EXISTS
       ( SELECT * FROM CDN.InwOdcTwr JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.InwOdcTwr.IOT_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą InwOdcTwr) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZlcElem
    IF EXISTS
       ( SELECT * FROM CDN.ZlcElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ZlcElem.ZcE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZlcElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadElem
    IF EXISTS
       ( SELECT * FROM CDN.SadElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.SadElem.SaE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpElem
    IF EXISTS
       ( SELECT * FROM CDN.ImpElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ImpElem.ImE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TKElem
    IF EXISTS
       ( SELECT * FROM CDN.TKElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.TKElem.TKE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TKElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rezerwacje
    IF EXISTS
       ( SELECT * FROM CDN.Rezerwacje JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.Rezerwacje.Rez_TwrNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru, ponieważ występuje on na rezerwacji./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrWzJm
    IF EXISTS
       ( SELECT * FROM CDN.TwrWzJm JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.TwrWzJm.WTJ_KcaNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrWzJm) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ZamElem
    IF EXISTS
       ( SELECT * FROM CDN.ZamElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ZamElem.ZaE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ZamElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.NtsElem
    IF EXISTS
       ( SELECT * FROM CDN.NtsElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.NtsElem.NtE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą NtsElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.MagSElem
    IF EXISTS
       ( SELECT * FROM CDN.MagSElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.MagSElem.MaS_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą MagSElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraElem
    IF EXISTS
       ( SELECT * FROM CDN.TraElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.TraElem.TrE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraElem) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwPozycje
    IF EXISTS
       ( SELECT * FROM CDN.UmwPozycje JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.UmwPozycje.UmP_TwrNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru ponieważ występuje on na pozycji umowy./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdRekomendacjeWzorceWarunkiTwr
    IF EXISTS
       ( SELECT * FROM CDN.ProdRekomendacjeWzorceWarunkiTwr JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ProdRekomendacjeWzorceWarunkiTwr.PREWT_TWRNumer
       AND (CDN.ProdRekomendacjeWzorceWarunkiTwr.PREWT_TwRTyp=16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdRekomendacjeWzorceWarunkiTwr) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPKJNag
    IF EXISTS
       ( SELECT * FROM CDN.ProdPKJNag JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.ProdPKJNag.PKJN_TwrNumer
       AND (CDN.ProdPKJNag.PKJN_TwrTyp = 16)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPKJNag) [TwrKarty_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RezerwacjeWPrzyszlosc
    IF EXISTS
       ( SELECT * FROM CDN.RezerwacjeWPrzyszlosc JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.RezerwacjeWPrzyszlosc.RezP_TwrNumer
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru, ponieważ występuje on na rezerwacji w przyszłość./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RodzajeBonow
    IF EXISTS
       ( SELECT * FROM CDN.RodzajeBonow JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.RodzajeBonow.RBo_TwrNumer
            
       AND (CDN.RodzajeBonow.RBo_TwrTyp=16)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru, ponieważ występuje on na rodzaju bonów./# [TwrKarty_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.GratisyPromocje
    IF EXISTS(SELECT * FROM CDN.GratisyPromocje JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.GratisyPromocje.GPR_TwrNumer
      AND (CDN.GratisyPromocje.GPR_TwrTyp&gt;0)
            )
        DELETE CDN.GratisyPromocje
        FROM CDN.GratisyPromocje JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.GratisyPromocje.GPR_TwrNumer
      AND (CDN.GratisyPromocje.GPR_TwrTyp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrAplikacjeOpisy
    IF EXISTS(SELECT * FROM CDN.TwrAplikacjeOpisy JOIN deleted
            ON 
          deleted.Twr_GIDTyp = CDN.TwrAplikacjeOpisy.TPO_ObiTyp
      AND deleted.Twr_GIDNumer = CDN.TwrAplikacjeOpisy.TPO_ObiNumer
      AND (deleted.Twr_GIDTyp=16)
            )
        DELETE CDN.TwrAplikacjeOpisy
        FROM CDN.TwrAplikacjeOpisy JOIN deleted
        ON 
          deleted.Twr_GIDTyp = CDN.TwrAplikacjeOpisy.TPO_ObiTyp
      AND deleted.Twr_GIDNumer = CDN.TwrAplikacjeOpisy.TPO_ObiNumer
      AND (deleted.Twr_GIDTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrAplikacje
    IF EXISTS(SELECT * FROM CDN.TwrAplikacje JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.TwrAplikacje.TAP_ObiNumer
      AND deleted.Twr_GIDTyp = CDN.TwrAplikacje.TAP_ObiTyp
      AND (deleted.Twr_GIDTyp=16)
            )
        DELETE CDN.TwrAplikacje
        FROM CDN.TwrAplikacje JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.TwrAplikacje.TAP_ObiNumer
      AND deleted.Twr_GIDTyp = CDN.TwrAplikacje.TAP_ObiTyp
      AND (deleted.Twr_GIDTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwUrzParam
    IF EXISTS(SELECT * FROM CDN.SrwUrzParam JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.SrwUrzParam.SUP_ObiNumer
      AND (CDN.SrwUrzParam.SUP_ObiTyp=16)
            )
        DELETE CDN.SrwUrzParam
        FROM CDN.SrwUrzParam JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.SrwUrzParam.SUP_ObiNumer
      AND (CDN.SrwUrzParam.SUP_ObiTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanSprzedazyTwr
    IF EXISTS(SELECT * FROM CDN.PlanSprzedazyTwr JOIN deleted
            ON 
          deleted.Twr_GIDTyp = CDN.PlanSprzedazyTwr.PST_TwrTyp
      AND deleted.Twr_GIDNumer = CDN.PlanSprzedazyTwr.PST_TwrNumer
      AND (CDN.PlanSprzedazyTwr.PST_TwrTyp&gt;0)
            )
        DELETE CDN.PlanSprzedazyTwr
        FROM CDN.PlanSprzedazyTwr JOIN deleted
        ON 
          deleted.Twr_GIDTyp = CDN.PlanSprzedazyTwr.PST_TwrTyp
      AND deleted.Twr_GIDNumer = CDN.PlanSprzedazyTwr.PST_TwrNumer
      AND (CDN.PlanSprzedazyTwr.PST_TwrTyp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Tlumaczenia
    IF EXISTS(SELECT * FROM CDN.Tlumaczenia JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ=16)
            )
        DELETE CDN.Tlumaczenia
        FROM CDN.Tlumaczenia JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.Tlumaczenia.TLM_Numer
      AND (CDN.Tlumaczenia.TLM_Typ=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=16)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.MagTwrObszary
    IF EXISTS(SELECT * FROM CDN.MagTwrObszary JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.MagTwrObszary.MTO_TwrNumer
      AND (CDN.MagTwrObszary.MTO_TwrTyp=16)
            )
        DELETE CDN.MagTwrObszary
        FROM CDN.MagTwrObszary JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.MagTwrObszary.MTO_TwrNumer
      AND (CDN.MagTwrObszary.MTO_TwrTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrPromocje
    IF EXISTS(SELECT * FROM CDN.TwrPromocje JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.TwrPromocje.TPR_TwrNumer
      AND (CDN.TwrPromocje.TPR_TwrTyp&gt;0)
            )
        DELETE CDN.TwrPromocje
        FROM CDN.TwrPromocje JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.TwrPromocje.TPR_TwrNumer
      AND (CDN.TwrPromocje.TPR_TwrTyp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=16 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=16 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KntWzUpusty
    IF EXISTS(SELECT * FROM CDN.KntWzUpusty JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.KntWzUpusty.WKU_TwGNumer
      AND (CDN.KntWzUpusty.WKU_TwGTyp=16)
            )
        DELETE CDN.KntWzUpusty
        FROM CDN.KntWzUpusty JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.KntWzUpusty.WKU_TwGNumer
      AND (CDN.KntWzUpusty.WKU_TwGTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrPodm
    IF EXISTS(SELECT * FROM CDN.TwrPodm JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.TwrPodm.TwP_TwrNumer
      AND (CDN.TwrPodm.TwP_Warstwa in (0,1))
            )
        DELETE CDN.TwrPodm
        FROM CDN.TwrPodm JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.TwrPodm.TwP_TwrNumer
      AND (CDN.TwrPodm.TwP_Warstwa in (0,1))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrGrupy
    IF EXISTS(SELECT * FROM CDN.TwrGrupy JOIN deleted
            ON 
          deleted.Twr_GIDTyp = CDN.TwrGrupy.TwG_GIDTyp
      AND deleted.Twr_GIDNumer = CDN.TwrGrupy.TwG_GIDNumer
      AND (CDN.TwrGrupy.TwG_GIDTyp=16)
            )
        DELETE CDN.TwrGrupy
        FROM CDN.TwrGrupy JOIN deleted
        ON 
          deleted.Twr_GIDTyp = CDN.TwrGrupy.TwG_GIDTyp
      AND deleted.Twr_GIDNumer = CDN.TwrGrupy.TwG_GIDNumer
      AND (CDN.TwrGrupy.TwG_GIDTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RetroTowary
    IF EXISTS(SELECT * FROM CDN.RetroTowary JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.RetroTowary.RtT_TwrNumer
      AND (CDN.RetroTowary.RtT_TwrTyp=16)
            )
        DELETE CDN.RetroTowary
        FROM CDN.RetroTowary JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.RetroTowary.RtT_TwrNumer
      AND (CDN.RetroTowary.RtT_TwrTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdOkresy
    IF EXISTS(SELECT * FROM CDN.ProdOkresy JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.ProdOkresy.POK_ObiNumer
      AND (CDN.ProdOkresy.POK_ObiTyp=16)
            )
        DELETE CDN.ProdOkresy
        FROM CDN.ProdOkresy JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.ProdOkresy.POK_ObiNumer
      AND (CDN.ProdOkresy.POK_ObiTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PunktyKonfig
    IF EXISTS(SELECT * FROM CDN.PunktyKonfig JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.PunktyKonfig.PuK_ObiNumer
      AND (CDN.PunktyKonfig.PuK_ObiTyp=16)
            )
        DELETE CDN.PunktyKonfig
        FROM CDN.PunktyKonfig JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.PunktyKonfig.PuK_ObiNumer
      AND (CDN.PunktyKonfig.PuK_ObiTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrmTransakcje
    IF EXISTS(SELECT * FROM CDN.PrmTransakcje JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.PrmTransakcje.PrT_TwrNumer
            )
        DELETE CDN.PrmTransakcje
        FROM CDN.PrmTransakcje JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.PrmTransakcje.PrT_TwrNumer
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.SrwReceptury
    IF EXISTS(SELECT * FROM CDN.SrwReceptury JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.SrwReceptury.SRE_ObiNumer
      AND (CDN.SrwReceptury.SRE_ObiTyp=16)
            )
        DELETE CDN.SrwReceptury
        FROM CDN.SrwReceptury JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.SrwReceptury.SRE_ObiNumer
      AND (CDN.SrwReceptury.SRE_ObiTyp=16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdWzorceKJTowary
    IF EXISTS(SELECT * FROM CDN.ProdWzorceKJTowary JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.ProdWzorceKJTowary.PWT_TwrGIDNumer
      AND (CDN.ProdWzorceKJTowary.PWT_TwrGIDTyp = 16)
            )
        DELETE CDN.ProdWzorceKJTowary
        FROM CDN.ProdWzorceKJTowary JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.ProdWzorceKJTowary.PWT_TwrGIDNumer
      AND (CDN.ProdWzorceKJTowary.PWT_TwrGIDTyp = 16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrStawkiVAT
    IF EXISTS(SELECT * FROM CDN.TwrStawkiVAT JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.TwrStawkiVAT.TwV_TwrNumer
      AND (CDN.TwrStawkiVAT.TwV_TwrTyp=16)
            )
        DELETE CDN.TwrStawkiVAT
        FROM CDN.TwrStawkiVAT JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.TwrStawkiVAT.TwV_TwrNumer
      AND (CDN.TwrStawkiVAT.TwV_TwrTyp=16)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrKarty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrKarty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrKarty_InsertUpdateHandler
  ON CDN.TwrKarty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Twr_RodzajId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.Twr_RodzajId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.Twr_RodzajId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Twr_RodzajUrzadzenia ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwUrzRodzaje ON
                    inserted.Twr_RodzajUrzadzenia = CDN.SrwUrzRodzaje.SUR_Id
              WHERE CDN.SrwUrzRodzaje.SUR_Id IS NULL
                AND (
                          IsNull(inserted.Twr_RodzajUrzadzenia,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwUrzRodzaje) [TwrKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Twr_StawkaKGO ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.Twr_StawkaKGO = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.Twr_StawkaKGO,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Twr_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.Twr_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Twr_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TwrKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Twr_SkNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrSchematyKaucjiNag ON
                    inserted.Twr_SkNId = CDN.TwrSchematyKaucjiNag.SKN_Id
              WHERE CDN.TwrSchematyKaucjiNag.SKN_Id IS NULL
                AND (
                          IsNull(inserted.Twr_SkNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrSchematyKaucjiNag) [TwrKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Twr_Notowania ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.Twr_Notowania = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.Twr_Notowania,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Twr_CCKNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CechyKlasy ON
                    inserted.Twr_CCKNumer = CDN.CechyKlasy.CCK_GIDNumer
              WHERE CDN.CechyKlasy.CCK_GIDNumer IS NULL
                AND (
                          IsNull(inserted.Twr_CCKNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CechyKlasy) [TwrKarty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrKartyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrKartyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrKartyAlias_DeleteHandler
  ON CDN.TwrKarty
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrJm
    IF EXISTS
       ( SELECT * FROM CDN.TwrJm JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.TwrJm.TwJ_KcaNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrJm) [TwrKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.RecElem
    IF EXISTS
       ( SELECT * FROM CDN.RecElem JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.RecElem.ReE_TwrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą RecElem) [TwrKartyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrAplikacje
    IF EXISTS
       ( SELECT * FROM CDN.TwrAplikacje JOIN deleted
          ON
                deleted.Twr_GIDNumer = CDN.TwrAplikacje.TAp_TwrNadrzedny
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć towaru, ponieważ jest ustawiony jako nadrzędny./# [TwrKartyAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrPodm
    IF EXISTS(SELECT * FROM CDN.TwrPodm JOIN deleted
            ON 
          deleted.Twr_GIDNumer = CDN.TwrPodm.TwP_ZamNumer
            )
        DELETE CDN.TwrPodm
        FROM CDN.TwrPodm JOIN deleted
        ON 
          deleted.Twr_GIDNumer = CDN.TwrPodm.TwP_ZamNumer
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TwKRodzajTwr"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TwKRodzajTwr */</I><BR>
ALTER TABLE CDN.TwrKody ADD CONSTRAINT FK_TwKRodzajTwr
 FOREIGN KEY
   (
                          TwK_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TKKKntNumer"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TKKKntNumer */</I><BR>
ALTER TABLE CDN.TwrKodyKnt ADD CONSTRAINT FK_TKKKntNumer
 FOREIGN KEY
   (
                          TKK_KntNumer                      
                         )
             REFERENCES CDN.KntKarty
                         (
                          Knt_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TKKTwKId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TKKTwKId */</I><BR>
ALTER TABLE CDN.TwrKodyKnt ADD CONSTRAINT FK_TKKTwKId
 FOREIGN KEY
   (
                          TKK_TwKId                         
                         )
             REFERENCES CDN.TwrKody
                         (
                          TwK_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TwOTowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TwOTowar */</I><BR>
ALTER TABLE CDN.TwrOpisy ADD CONSTRAINT FK_TwOTowar
 FOREIGN KEY
   (
                          TwO_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrOpisy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrOpisy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrOpisy_InsertUpdateHandler
  ON CDN.TwrOpisy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TwO_Jezyk ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TwO_Jezyk = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.TwO_Jezyk,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrOpisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TpmTowarMag"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TpmTowarMag */</I><BR>
ALTER TABLE CDN.TwrParMag ADD CONSTRAINT FK_TpmTowarMag
 FOREIGN KEY
   (
                          Tpm_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrParMag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrParMag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrParMag_InsertUpdateHandler
  ON CDN.TwrParMag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TPM_RodzajId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TPM_RodzajId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.TPM_RodzajId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrParMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TPM_MgAId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagAdresy ON
                    inserted.TPM_MgAId = CDN.MagAdresy.MgA_Id
              WHERE CDN.MagAdresy.MgA_Id IS NULL
                AND (
                          IsNull(inserted.TPM_MgAId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagAdresy) [TwrParMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TPM_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TPM_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TPM_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TwrParMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TPMHTPMChron"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TPMHTPMChron */</I><BR>
ALTER TABLE CDN.TwrParMagHist ADD CONSTRAINT FK_TPMHTPMChron
 FOREIGN KEY
   (
                          TPMH_TPMId                         
                         )
             REFERENCES CDN.TwrParMag
                         (
                          TPM_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrPartie_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrPartie_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrPartie_DeleteHandler
  ON CDN.TwrPartie
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwMagTwr
    IF EXISTS
       ( SELECT * FROM CDN.InwMagTwr JOIN deleted
          ON
                deleted.TpA_Id = CDN.InwMagTwr.IMT_TPaIdMag
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą InwMagTwr) [TwrPartie_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.InwTwr
    IF EXISTS
       ( SELECT * FROM CDN.InwTwr JOIN deleted
          ON
                deleted.TpA_Id = CDN.InwTwr.InT_TpaId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą InwTwr) [TwrPartie_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrPartie_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrPartie_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrPartie_InsertUpdateHandler
  ON CDN.TwrPartie
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TpA_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TpA_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TpA_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrPartie_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrPartieAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrPartieAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrPartieAlias_DeleteHandler
  ON CDN.TwrPartie
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Dostawy
    IF EXISTS
       ( SELECT * FROM CDN.Dostawy JOIN deleted
          ON
                deleted.TpA_Id = CDN.Dostawy.Dst_TpAId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Dostawy) [TwrPartieAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrPodm_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrPodm_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrPodm_InsertUpdateHandler
  ON CDN.TwrPodm
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TwP_ZamNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TwP_ZamNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TwP_ZamNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrPodm_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TwP_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TwP_Warstwa in (0,1))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TwP_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.TwP_Warstwa in (0,1))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrPodm_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TwP_RodzajPowiazania ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TwP_RodzajPowiazania &gt; 2)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TwP_RodzajPowiazania = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.TwP_RodzajPowiazania &gt; 2)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrPodm_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TprPrm"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TprPrm */</I><BR>
ALTER TABLE CDN.TwrPromocje ADD CONSTRAINT FK_TprPrm
 FOREIGN KEY
   (
                          TPR_PrmId                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrPromocje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrPromocje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrPromocje_DeleteHandler
  ON CDN.TwrPromocje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProgiTwrPromocje
    IF EXISTS(SELECT * FROM CDN.ProgiTwrPromocje JOIN deleted
            ON 
          deleted.TPR_Id = CDN.ProgiTwrPromocje.PTP_TPRId
      AND (CDN.ProgiTwrPromocje.PTP_TprId&gt;0)
            )
        DELETE CDN.ProgiTwrPromocje
        FROM CDN.ProgiTwrPromocje JOIN deleted
        ON 
          deleted.TPR_Id = CDN.ProgiTwrPromocje.PTP_TPRId
      AND (CDN.ProgiTwrPromocje.PTP_TprId&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrPromocje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrPromocje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrPromocje_InsertUpdateHandler
  ON CDN.TwrPromocje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TPR_TwrTyp )  OR UPDATE( TPR_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TPR_TwrTyp&lt;0 AND inserted.TPR_TwrNumer&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrGrupyDom ON
                    inserted.TPR_TwrTyp = CDN.TwrGrupyDom.TGD_GIDTyp
                AND inserted.TPR_TwrNumer = CDN.TwrGrupyDom.TGD_GIDNumer
              WHERE CDN.TwrGrupyDom.TGD_GIDNumer IS NULL AND (inserted.TPR_TwrTyp&lt;0 AND inserted.TPR_TwrNumer&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrGrupyDom) [TwrPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TPR_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TPR_TwrTyp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TPR_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.TPR_TwrTyp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrPromocje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SkEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SkEPrimary */</I><BR>
ALTER TABLE CDN.TwrSchematyKaucjiElem ADD CONSTRAINT FK_SkEPrimary
 FOREIGN KEY
   (
                          SKE_SKNId                         
                         )
             REFERENCES CDN.TwrSchematyKaucjiNag
                         (
                          SKN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SkETowar"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SkETowar */</I><BR>
ALTER TABLE CDN.TwrSchematyKaucjiElem ADD CONSTRAINT FK_SkETowar
 FOREIGN KEY
   (
                          SKE_TwrNumer                      
                         )
             REFERENCES CDN.TwrKarty
                         (
                          Twr_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrSchematyKaucjiNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrSchematyKaucjiNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrSchematyKaucjiNag_DeleteHandler
  ON CDN.TwrSchematyKaucjiNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrKarty
    IF EXISTS
       ( SELECT * FROM CDN.TwrKarty JOIN deleted
          ON
                deleted.SKN_Id = CDN.TwrKarty.Twr_SkNId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrKarty) [TwrSchematyKaucjiNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TwrWzorce
    IF EXISTS
       ( SELECT * FROM CDN.TwrWzorce JOIN deleted
          ON
                deleted.SKN_Id = CDN.TwrWzorce.TwW_SKNId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TwrWzorce) [TwrSchematyKaucjiNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrStany_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrStany_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrStany_InsertUpdateHandler
  ON CDN.TwrStany
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TWS_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TWS_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TWS_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TwrStany_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrStanyBufor_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrStanyBufor_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrStanyBufor_InsertUpdateHandler
  ON CDN.TwrStanyBufor
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TSB_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TSB_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TSB_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TwrStanyBufor_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrStawkiVAT_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrStawkiVAT_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrStawkiVAT_InsertUpdateHandler
  ON CDN.TwrStawkiVAT
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TwV_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TwV_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.TwV_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.TwV_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrStawkiVAT_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TwV_TwrTyp )  OR UPDATE( TwV_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.TwV_TwrTyp=-16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrWzorce ON
                    inserted.TwV_TwrTyp = CDN.TwrWzorce.TwW_GrpTyp
                AND inserted.TwV_TwrNumer = CDN.TwrWzorce.TwW_GrpNumer
              WHERE CDN.TwrWzorce.TwW_GrpNumer IS NULL AND (inserted.TwV_TwrTyp=-16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrWzorce) [TwrStawkiVAT_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WTCGrupa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WTCGrupa */</I><BR>
ALTER TABLE CDN.TwrWzCeny ADD CONSTRAINT FK_WTCGrupa
 FOREIGN KEY
   (
                          WTC_GrpTyp                        ,
                          WTC_GrpNumer                      
                         )
             REFERENCES CDN.TwrWzorce
                         (
                          TwW_GrpTyp                        ,
                          TwW_GrpNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrWzCeny_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrWzCeny_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrWzCeny_DeleteHandler
  ON CDN.TwrWzCeny
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.WTC_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.WTC_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.WTC_GrpLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp =-16 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and  CDN.Atrybuty.Atr_OBISubLp = 64)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.WTC_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.WTC_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.WTC_GrpLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp =-16 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and  CDN.Atrybuty.Atr_OBISubLp = 64)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WTDGrupa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WTDGrupa */</I><BR>
ALTER TABLE CDN.TwrWzDst ADD CONSTRAINT FK_WTDGrupa
 FOREIGN KEY
   (
                          WTD_GrpTyp                        ,
                          WTD_GrpNumer                      
                         )
             REFERENCES CDN.TwrWzorce
                         (
                          TwW_GrpTyp                        ,
                          TwW_GrpNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrWzDst_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrWzDst_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrWzDst_DeleteHandler
  ON CDN.TwrWzDst
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.WTD_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.WTD_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.WTD_GrpLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp =-16 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and           CDN.Atrybuty.Atr_OBISubLp = -32)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.WTD_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.WTD_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.WTD_GrpLp = CDN.Atrybuty.Atr_ObiLp
      AND ( CDN.Atrybuty.Atr_OBITyp =-16 and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and           CDN.Atrybuty.Atr_OBISubLp = -32)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.WTD_GrpTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.WTD_GrpNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.WTD_GrpLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp =-16 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and           CDN.AtrybutyHist.Ath_OBISubLp = -32)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.WTD_GrpTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.WTD_GrpNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.WTD_GrpLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( CDN.AtrybutyHist.Ath_OBITyp =-16 and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and           CDN.AtrybutyHist.Ath_OBISubLp = -32)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrWzDst_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrWzDst_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrWzDst_InsertUpdateHandler
  ON CDN.TwrWzDst
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WTD_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WTD_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.WTD_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.WTD_KntTyp=32)
                AND (
                          IsNull(inserted.WTD_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [TwrWzDst_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WTJGrupa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WTJGrupa */</I><BR>
ALTER TABLE CDN.TwrWzJm ADD CONSTRAINT FK_WTJGrupa
 FOREIGN KEY
   (
                          WTJ_GrpTyp                        ,
                          WTJ_GrpNumer                      
                         )
             REFERENCES CDN.TwrWzorce
                         (
                          TwW_GrpTyp                        ,
                          TwW_GrpNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrWzJm_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrWzJm_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrWzJm_InsertUpdateHandler
  ON CDN.TwrWzJm
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WTJ_KcaNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.WTJ_KcaNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.WTJ_KcaNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [TwrWzJm_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WTOGrupa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WTOGrupa */</I><BR>
ALTER TABLE CDN.TwrWzOpisy ADD CONSTRAINT FK_WTOGrupa
 FOREIGN KEY
   (
                          WTO_GrpTyp                        ,
                          WTO_GrpNumer                      
                         )
             REFERENCES CDN.TwrWzorce
                         (
                          TwW_GrpTyp                        ,
                          TwW_GrpNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrWzOpisy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrWzOpisy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrWzOpisy_InsertUpdateHandler
  ON CDN.TwrWzOpisy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WTO_Jezyk ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.WTO_Jezyk = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.WTO_Jezyk,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrWzOpisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WTUGrupa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WTUGrupa */</I><BR>
ALTER TABLE CDN.TwrWzUpusty ADD CONSTRAINT FK_WTUGrupa
 FOREIGN KEY
   (
                          WTU_GrpTyp                        ,
                          WTU_GrpNumer                      
                         )
             REFERENCES CDN.TwrWzorce
                         (
                          TwW_GrpTyp                        ,
                          TwW_GrpNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrWzorce_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrWzorce_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.TwrWzorce_DeleteHandler
  ON CDN.TwrWzorce
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrAplikacjeOpisy
    IF EXISTS(SELECT * FROM CDN.TwrAplikacjeOpisy JOIN deleted
            ON 
          deleted.TwW_GrpTyp = CDN.TwrAplikacjeOpisy.TPO_ObiTyp
      AND deleted.TwW_GrpNumer = CDN.TwrAplikacjeOpisy.TPO_ObiNumer
      AND (deleted.TwW_GrpTyp=-16)
            )
        DELETE CDN.TwrAplikacjeOpisy
        FROM CDN.TwrAplikacjeOpisy JOIN deleted
        ON 
          deleted.TwW_GrpTyp = CDN.TwrAplikacjeOpisy.TPO_ObiTyp
      AND deleted.TwW_GrpNumer = CDN.TwrAplikacjeOpisy.TPO_ObiNumer
      AND (deleted.TwW_GrpTyp=-16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrAplikacje
    IF EXISTS(SELECT * FROM CDN.TwrAplikacje JOIN deleted
            ON 
          deleted.TwW_GrpNumer = CDN.TwrAplikacje.TAP_ObiNumer
      AND deleted.TwW_GrpTyp = CDN.TwrAplikacje.TAP_ObiTyp
      AND (deleted.TwW_GrpTyp=-16)
            )
        DELETE CDN.TwrAplikacje
        FROM CDN.TwrAplikacje JOIN deleted
        ON 
          deleted.TwW_GrpNumer = CDN.TwrAplikacje.TAP_ObiNumer
      AND deleted.TwW_GrpTyp = CDN.TwrAplikacje.TAP_ObiTyp
      AND (deleted.TwW_GrpTyp=-16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Tlumaczenia
    IF EXISTS(SELECT * FROM CDN.Tlumaczenia JOIN deleted
            ON 
          deleted.TwW_GrpNumer = CDN.Tlumaczenia.TLM_Numer
      AND deleted.TwW_GrpTyp = CDN.Tlumaczenia.TLM_Typ
      AND (CDN.Tlumaczenia.TLM_Typ=-16)
            )
        DELETE CDN.Tlumaczenia
        FROM CDN.Tlumaczenia JOIN deleted
        ON 
          deleted.TwW_GrpNumer = CDN.Tlumaczenia.TLM_Numer
      AND deleted.TwW_GrpTyp = CDN.Tlumaczenia.TLM_Typ
      AND (CDN.Tlumaczenia.TLM_Typ=-16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.TwW_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TwW_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp=-16 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.TwW_GrpNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.TwW_GrpTyp = CDN.Atrybuty.Atr_ObiTyp
      AND (CDN.Atrybuty.Atr_OBITyp=-16 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.TwW_GrpTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TwW_GrpNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=-16 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.TwW_GrpTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.TwW_GrpNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=-16 and CDN.AtrybutyHist.Ath_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PunktyKonfig
    IF EXISTS(SELECT * FROM CDN.PunktyKonfig JOIN deleted
            ON 
          deleted.TwW_GrpNumer = CDN.PunktyKonfig.PuK_ObiNumer
      AND deleted.TwW_GrpTyp = CDN.PunktyKonfig.PuK_ObiTyp
      AND (CDN.PunktyKonfig.PuK_ObiTyp=-16)
            )
        DELETE CDN.PunktyKonfig
        FROM CDN.PunktyKonfig JOIN deleted
        ON 
          deleted.TwW_GrpNumer = CDN.PunktyKonfig.PuK_ObiNumer
      AND deleted.TwW_GrpTyp = CDN.PunktyKonfig.PuK_ObiTyp
      AND (CDN.PunktyKonfig.PuK_ObiTyp=-16)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TwrStawkiVAT
    IF EXISTS(SELECT * FROM CDN.TwrStawkiVAT JOIN deleted
            ON 
          deleted.TwW_GrpNumer = CDN.TwrStawkiVAT.TwV_TwrNumer
      AND deleted.TwW_GrpTyp = CDN.TwrStawkiVAT.TwV_TwrTyp
      AND (CDN.TwrStawkiVAT.TwV_TwrTyp=-16)
            )
        DELETE CDN.TwrStawkiVAT
        FROM CDN.TwrStawkiVAT JOIN deleted
        ON 
          deleted.TwW_GrpNumer = CDN.TwrStawkiVAT.TwV_TwrNumer
      AND deleted.TwW_GrpTyp = CDN.TwrStawkiVAT.TwV_TwrTyp
      AND (CDN.TwrStawkiVAT.TwV_TwrTyp=-16)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrWzorce_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrWzorce_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrWzorce_InsertUpdateHandler
  ON CDN.TwrWzorce
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TwW_RodzajId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TwW_RodzajId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.TwW_RodzajId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TwW_StawkaKGO ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.TwW_StawkaKGO = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.TwW_StawkaKGO,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [TwrWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TwW_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TwW_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TwW_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TwrWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TwW_SKNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrSchematyKaucjiNag ON
                    inserted.TwW_SKNId = CDN.TwrSchematyKaucjiNag.SKN_Id
              WHERE CDN.TwrSchematyKaucjiNag.SKN_Id IS NULL
                AND (
                          IsNull(inserted.TwW_SKNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrSchematyKaucjiNag) [TwrWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( TwW_KreatorId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KreatorKodowNag ON
                    inserted.TwW_KreatorId = CDN.KreatorKodowNag.KrN_Id
              WHERE CDN.KreatorKodowNag.KrN_Id IS NULL
                AND (
                          IsNull(inserted.TwW_KreatorId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KreatorKodowNag) [TwrWzorce_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_TwzMagazyn"></A><PRE>
          <FONT SIZE="2"><I>/* FK_TwzMagazyn */</I><BR>
ALTER TABLE CDN.TwrZasoby ADD CONSTRAINT FK_TwzMagazyn
 FOREIGN KEY
   (
                          TwZ_MagNumer                      
                         )
             REFERENCES CDN.Magazyny
                         (
                          Mag_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="TwrZasobyMag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* TwrZasobyMag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.TwrZasobyMag_InsertUpdateHandler
  ON CDN.TwrZasobyMag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( TZM_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.TZM_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.TZM_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [TwrZasobyMag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_SCTSchemat"></A><PRE>
          <FONT SIZE="2"><I>/* FK_SCTSchemat */</I><BR>
ALTER TABLE CDN.TypSchemat ADD CONSTRAINT FK_SCTSchemat
 FOREIGN KEY
   (
                          SCT_SCHTyp                        ,
                          SCT_SCHNumer                      
                         )
             REFERENCES CDN.Schematy
                         (
                          SCH_GIDTyp                        ,
                          SCH_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UczestnicyKonwersacji_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UczestnicyKonwersacji_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UczestnicyKonwersacji_DeleteHandler
  ON CDN.UczestnicyKonwersacji
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Konwersacje
    IF EXISTS(SELECT * FROM CDN.Konwersacje JOIN deleted
            ON 
          deleted.UKN_IDKonwersacji = CDN.Konwersacje.KXL_ID
            )
        DELETE CDN.Konwersacje
        FROM CDN.Konwersacje JOIN deleted
        ON 
          deleted.UKN_IDKonwersacji = CDN.Konwersacje.KXL_ID
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UczestnicyKonwersacji_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UczestnicyKonwersacji_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UczestnicyKonwersacji_InsertUpdateHandler
  ON CDN.UczestnicyKonwersacji
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UKN_IDOperatora ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UKN_IDOperatora &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.UKN_IDOperatora = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.UKN_IDOperatora &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [UczestnicyKonwersacji_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmlNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmlNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UmlNag_DeleteHandler
  ON CDN.UmlNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.ULN_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (2600))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.ULN_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (2600))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmlNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmlNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmlNag_InsertUpdateHandler
  ON CDN.UmlNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ULN_PodmFinansNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ULN_PodmFinansTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ULN_PodmFinansNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ULN_PodmFinansTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [UmlNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ULN_PodmFinansNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ULN_PodmFinansTyp=48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.ULN_PodmFinansNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.ULN_PodmFinansTyp=48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [UmlNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ULPPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ULPPrimary */</I><BR>
ALTER TABLE CDN.UmlPrzedmioty ADD CONSTRAINT FK_ULPPrimary
 FOREIGN KEY
   (
                          ULP_ULNId                         
                         )
             REFERENCES CDN.UmlNag
                         (
                          ULN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmlPrzedmioty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmlPrzedmioty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmlPrzedmioty_InsertUpdateHandler
  ON CDN.UmlPrzedmioty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ULP_SRTNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrtKarty ON
                    inserted.ULP_SRTNumer = CDN.SrtKarty.Srt_GIDNumer
              WHERE CDN.SrtKarty.Srt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ULP_SRTNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrtKarty) [UmlPrzedmioty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ULRUmowa"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ULRUmowa */</I><BR>
ALTER TABLE CDN.UmlRaty ADD CONSTRAINT FK_ULRUmowa
 FOREIGN KEY
   (
                          ULR_ULNID                         
                         )
             REFERENCES CDN.UmlNag
                         (
                          ULN_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmlRaty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmlRaty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UmlRaty_DeleteHandler
  ON CDN.UmlRaty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraVat
    IF EXISTS(SELECT * FROM CDN.TraVat JOIN deleted
            ON 
          deleted.ULR_ID = CDN.TraVat.TRV_GIDNumer
      AND (CDN.TraVat.TrV_GIDTyp=2600)
            )
        DELETE CDN.TraVat
        FROM CDN.TraVat JOIN deleted
        ON 
          deleted.ULR_ID = CDN.TraVat.TRV_GIDNumer
      AND (CDN.TraVat.TrV_GIDTyp=2600)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UmwElem_DeleteHandler
  ON CDN.UmwElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.UmE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.UmE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.UmE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBISubLp = 4807 AND CDN.Atrybuty.Atr_OBITyp in (4800,4801,4802) and CDN.Atrybuty.Atr_OBILp&gt;0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.UmE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.UmE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.UmE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBISubLp = 4807 AND CDN.Atrybuty.Atr_OBITyp in (4800,4801,4802) and CDN.Atrybuty.Atr_OBILp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.UmE_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.UmE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.UmE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4800,4801,4802) AND CDN.DaneObiekty.DAO_ObiLp&gt;0)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.UmE_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.UmE_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND deleted.UmE_GIDLp = CDN.DaneObiekty.DAO_ObiLp
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4800,4801,4802) AND CDN.DaneObiekty.DAO_ObiLp&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmwElem_InsertUpdateHandler
  ON CDN.UmwElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UmE_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UmE_GidTyp=4800)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwNag ON
                    inserted.UmE_GIDNumer = CDN.UmwNag.UmN_Id
              WHERE CDN.UmwNag.UmN_Id IS NULL AND (inserted.UmE_GidTyp=4800)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwNag) [UmwElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmE_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UmE_DokTyp=4800)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwNag ON
                    inserted.UmE_DokNumer = CDN.UmwNag.UmN_Id
              WHERE CDN.UmwNag.UmN_Id IS NULL AND (inserted.UmE_DokTyp=4800)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwNag) [UmwElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmE_GIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UmE_GidTyp=4801)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwTypy ON
                    inserted.UmE_GIDNumer = CDN.UmwTypy.UmT_Id
              WHERE CDN.UmwTypy.UmT_Id IS NULL AND (inserted.UmE_GidTyp=4801)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwTypy) [UmwElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UmwNag_DeleteHandler
  ON CDN.UmwNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.UmN_Id = CDN.UmwNag.UmN_AneksId
            
       AND (CDN.UmwNag.UmN_UmowaId&lt;&gt;0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć umowy/aneksu do którego wygenerowny jest inny aneks./# [UmwNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjElem
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjElem JOIN deleted
          ON
                deleted.UmN_Id = CDN.BudzetPrjElem.BPE_UmNId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BudzetPrjElem) [UmwNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.BudzetPrjNag
    IF EXISTS
       ( SELECT * FROM CDN.BudzetPrjNag JOIN deleted
          ON
                deleted.UmN_Id = CDN.BudzetPrjNag.BPN_UmNId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą BudzetPrjNag) [UmwNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.UmN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4800 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.UmN_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4800 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.UmwElem
    IF EXISTS(SELECT * FROM CDN.UmwElem JOIN deleted
            ON 
          deleted.UmN_Id = CDN.UmwElem.UmE_GIDNumer
      AND (CDN.UmwElem.UmE_GidTyp=4800)
            )
        DELETE CDN.UmwElem
        FROM CDN.UmwElem JOIN deleted
        ON 
          deleted.UmN_Id = CDN.UmwElem.UmE_GIDNumer
      AND (CDN.UmwElem.UmE_GidTyp=4800)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.UmN_Id = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4800)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.UmN_Id = CDN.CRMDokumentyLinki.CDL_CRMNumer
      AND (CDN.CRMDokumentyLinki.CDL_CRMTyp=4800)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmwNag_InsertUpdateHandler
  ON CDN.UmwNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UmN_PowodAneksuId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.UmN_PowodAneksuId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.UmN_PowodAneksuId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_FrSID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.UmN_FrSID = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.UmN_FrSID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_PrjId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.UmN_PrjId = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.UmN_PrjId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.UmN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.UmN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_OpisStanuId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.UmN_OpisStanuId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.UmN_OpisStanuId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_AdWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.UmN_AdWNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.UmN_AdWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_KnDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UmN_KnDTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.UmN_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.UmN_KnDTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_KnSTypOdb )  OR UPDATE( UmN_KnSNumerOdb )  OR UPDATE( UmN_KnSLpOdb ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.UmN_KnSTypOdb = CDN.KntOsoby.KnS_KntTyp
                AND inserted.UmN_KnSNumerOdb = CDN.KntOsoby.KnS_KntNumer
                AND inserted.UmN_KnSLpOdb = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.UmN_KnSTypOdb,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.UmN_KnSNumerOdb,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.UmN_KnSLpOdb,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_OpiekunNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.UmN_OpiekunNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.UmN_OpiekunNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_RodzajUmowyId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.UmN_RodzajUmowyId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.UmN_RodzajUmowyId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_KnSTyp )  OR UPDATE( UmN_KnSNumer )  OR UPDATE( UmN_KnSLp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.UmN_KnSTyp = CDN.KntOsoby.KnS_KntTyp
                AND inserted.UmN_KnSNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.UmN_KnSLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.UmN_KnSTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.UmN_KnSNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.UmN_KnSLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_UmTId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwTypy ON
                    inserted.UmN_UmTId = CDN.UmwTypy.UmT_Id
              WHERE CDN.UmwTypy.UmT_Id IS NULL
                AND (
                          IsNull(inserted.UmN_UmTId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwTypy) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_KnSTypPlt )  OR UPDATE( UmN_KnSNumerPlt )  OR UPDATE( UmN_KnSLpPlt ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.UmN_KnSTypPlt = CDN.KntOsoby.KnS_KntTyp
                AND inserted.UmN_KnSNumerPlt = CDN.KntOsoby.KnS_KntNumer
                AND inserted.UmN_KnSLpPlt = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.UmN_KnSTypPlt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.UmN_KnSNumerPlt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.UmN_KnSLpPlt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [UmwNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwNagAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwNagAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UmwNagAlias_DeleteHandler
  ON CDN.UmwNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwElem
    IF EXISTS
       ( SELECT * FROM CDN.UmwElem JOIN deleted
          ON
                deleted.UmN_Id = CDN.UmwElem.UmE_DokNumer
       AND (CDN.UmwElem.UmE_DokTyp=4800)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwElem) [UmwNagAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwNagAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwNagAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmwNagAlias_InsertUpdateHandler
  ON CDN.UmwNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UmN_PodNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UmN_PodTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.UmN_PodNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.UmN_PodTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [UmwNagAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_PodNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UmN_PodTyp=48)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.UmN_PodNumer = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL AND (inserted.UmN_PodTyp=48)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [UmwNagAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UmN_AneksId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UmN_UmowaId&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwNag ON
                    inserted.UmN_AneksId = CDN.UmwNag.UmN_Id
              WHERE CDN.UmwNag.UmN_Id IS NULL AND (inserted.UmN_UmowaId&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwNag) [UmwNagAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_UPlPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_UPlPrimaryNoType */</I><BR>
ALTER TABLE CDN.UmwPlat ADD CONSTRAINT FK_UPlPrimaryNoType
 FOREIGN KEY
   (
                          UPl_GIDNumer                      
                         )
             REFERENCES CDN.UmwNag
                         (
                          UmN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwPlat_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwPlat_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UmwPlat_DeleteHandler
  ON CDN.UmwPlat
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.UmwPlatPozycje
    IF EXISTS(SELECT * FROM CDN.UmwPlatPozycje JOIN deleted
            ON 
          deleted.UPl_GIDNumer = CDN.UmwPlatPozycje.UPP_UPlNumer
      AND deleted.UPl_GIDLp = CDN.UmwPlatPozycje.UPP_UPlLp
            )
        DELETE CDN.UmwPlatPozycje
        FROM CDN.UmwPlatPozycje JOIN deleted
        ON 
          deleted.UPl_GIDNumer = CDN.UmwPlatPozycje.UPP_UPlNumer
      AND deleted.UPl_GIDLp = CDN.UmwPlatPozycje.UPP_UPlLp
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwPlat_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwPlat_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmwPlat_InsertUpdateHandler
  ON CDN.UmwPlat
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UPl_TrNTyp )  OR UPDATE( UPl_TrNNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UPl_TrNTyp &lt;&gt; 0 and inserted.UPl_TrNNumer &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.UPl_TrNTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.UPl_TrNNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.UPl_TrNTyp &lt;&gt; 0 and inserted.UPl_TrNNumer &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [UmwPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UPl_ImpNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UPl_ImpNumer &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.UPl_ImpNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.UPl_ImpNumer &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [UmwPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwPlatPozycje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwPlatPozycje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmwPlatPozycje_InsertUpdateHandler
  ON CDN.UmwPlatPozycje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UPP_UPlNumer )  OR UPDATE( UPP_UPlLp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwPlat ON
                    inserted.UPP_UPlNumer = CDN.UmwPlat.UPl_GIDNumer
                AND inserted.UPP_UPlLp = CDN.UmwPlat.UPl_GIDLp
              WHERE CDN.UmwPlat.UPl_GIDLp IS NULL
                AND (
                          IsNull(inserted.UPP_UPlNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.UPP_UPlLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwPlat) [UmwPlatPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UPP_UmPId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwPozycje ON
                    inserted.UPP_UmPId = CDN.UmwPozycje.UmP_Id
              WHERE CDN.UmwPozycje.UmP_Id IS NULL
                AND (
                          IsNull(inserted.UPP_UmPId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwPozycje) [UmwPlatPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_UmPPozycja"></A><PRE>
          <FONT SIZE="2"><I>/* FK_UmPPozycja */</I><BR>
ALTER TABLE CDN.UmwPozycje ADD CONSTRAINT FK_UmPPozycja
 FOREIGN KEY
   (
                          UmP_UmNId                         
                         )
             REFERENCES CDN.UmwNag
                         (
                          UmN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwPozycje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwPozycje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UmwPozycje_DeleteHandler
  ON CDN.UmwPozycje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.UmP_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4800 AND CDN.Atrybuty.Atr_OBILp=0 AND CDN.Atrybuty.Atr_OBISubLp=4803)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.UmP_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4800 AND CDN.Atrybuty.Atr_OBILp=0 AND CDN.Atrybuty.Atr_OBISubLp=4803)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.UmP_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4803)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.UmP_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 4803)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrmHistoria
    IF EXISTS(SELECT * FROM CDN.PrmHistoria JOIN deleted
            ON 
          deleted.UmP_Id = CDN.PrmHistoria.PrH_GIDNumer
      AND (CDN.PrmHistoria.PRH_GIDTyp = 4803 and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
            )
        DELETE CDN.PrmHistoria
        FROM CDN.PrmHistoria JOIN deleted
        ON 
          deleted.UmP_Id = CDN.PrmHistoria.PrH_GIDNumer
      AND (CDN.PrmHistoria.PRH_GIDTyp = 4803 and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.UmP_Id = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp =4800)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.UmP_Id = CDN.CRMDokumentyPozycje.CDP_CRMLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp =4800)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.UmwPlatPozycje
    IF EXISTS(SELECT * FROM CDN.UmwPlatPozycje JOIN deleted
            ON 
          deleted.UmP_Id = CDN.UmwPlatPozycje.UPP_UmPId
            )
        DELETE CDN.UmwPlatPozycje
        FROM CDN.UmwPlatPozycje JOIN deleted
        ON 
          deleted.UmP_Id = CDN.UmwPlatPozycje.UPP_UmPId
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwPozycje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwPozycje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmwPozycje_InsertUpdateHandler
  ON CDN.UmwPozycje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UmP_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.UmP_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.UmP_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [UmwPozycje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwTypy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwTypy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UmwTypy_DeleteHandler
  ON CDN.UmwTypy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwTypy
    IF EXISTS
       ( SELECT * FROM CDN.UmwTypy JOIN deleted
          ON
                deleted.UmT_Id = CDN.UmwTypy.UmT_OjciecId
            
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć typu umowy, który jest nadrzędny dla innych typów umowy./# [UmwTypy_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UmwNag
    IF EXISTS
       ( SELECT * FROM CDN.UmwNag JOIN deleted
          ON
                deleted.UmT_Id = CDN.UmwNag.UmN_UmTId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UmwNag) [UmwTypy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.UmwElem
    IF EXISTS(SELECT * FROM CDN.UmwElem JOIN deleted
            ON 
          deleted.UmT_Id = CDN.UmwElem.UmE_GIDNumer
      AND (CDN.UmwElem.UmE_GidTyp=4801)
            )
        DELETE CDN.UmwElem
        FROM CDN.UmwElem JOIN deleted
        ON 
          deleted.UmT_Id = CDN.UmwElem.UmE_GIDNumer
      AND (CDN.UmwElem.UmE_GidTyp=4801)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UmwTypyAlias_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UmwTypyAlias_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UmwTypyAlias_InsertUpdateHandler
  ON CDN.UmwTypy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UmT_OjciecId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UmwTypy ON
                    inserted.UmT_OjciecId = CDN.UmwTypy.UmT_Id
              WHERE CDN.UmwTypy.UmT_Id IS NULL
                AND (
                          IsNull(inserted.UmT_OjciecId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UmwTypy) [UmwTypyAlias_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_UmVPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_UmVPrimary */</I><BR>
ALTER TABLE CDN.UmwVat ADD CONSTRAINT FK_UmVPrimary
 FOREIGN KEY
   (
                          UmV_GIDNumer                      
                         )
             REFERENCES CDN.UmwNag
                         (
                          UmN_Id   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_UPEPlatnosc"></A><PRE>
          <FONT SIZE="2"><I>/* FK_UPEPlatnosc */</I><BR>
ALTER TABLE CDN.UpoElem ADD CONSTRAINT FK_UPEPlatnosc
 FOREIGN KEY
   (
                          UPE_TrPTyp                        ,
                          UPE_TrPNumer                      ,
                          UPE_TrPLp                         
                         )
             REFERENCES CDN.TraPlat
                         (
                          TrP_GIDTyp   ,
                          TrP_GIDNumer   ,
                          TrP_GIDLp   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_UPEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_UPEPrimary */</I><BR>
ALTER TABLE CDN.UpoElem ADD CONSTRAINT FK_UPEPrimary
 FOREIGN KEY
   (
                          UPE_GIDNumer                      
                         )
             REFERENCES CDN.UpoNag
                         (
                          UPN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UpoNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UpoNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UpoNag_DeleteHandler
  ON CDN.UpoNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.UPN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (2832,2833))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.UPN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (2832,2833))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.UPN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (2832,2833))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.UPN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (2832,2833))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Predekrety
    IF EXISTS(SELECT * FROM CDN.Predekrety JOIN deleted
            ON 
          deleted.UPN_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.UPN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=2832)
            )
        DELETE CDN.Predekrety
        FROM CDN.Predekrety JOIN deleted
        ON 
          deleted.UPN_GIDTyp = CDN.Predekrety.PDT_GIDTyp
      AND deleted.UPN_GIDNumer = CDN.Predekrety.PDT_GIDNumer
      AND (CDN.Predekrety.PDT_GIDTyp=2832)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.UPN_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.UPN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp in (2832,2833))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.UPN_GIDTyp = CDN.TraPlat.TrP_GIDTyp
      AND deleted.UPN_GIDNumer = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TRP_GIDTyp in (2832,2833))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_Procesy
    IF EXISTS(SELECT * FROM CDN.WF_Procesy JOIN deleted
            ON 
          deleted.UPN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (2832, 2833))
            )
        DELETE CDN.WF_Procesy
        FROM CDN.WF_Procesy JOIN deleted
        ON 
          deleted.UPN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (CDN.WF_Procesy.WFP_OBITyp in (2832, 2833))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UpoNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UpoNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UpoNag_InsertUpdateHandler
  ON CDN.UpoNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UPN_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UPN_KntTyp=4304)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Urzedy ON
                    inserted.UPN_KNTNumer = CDN.Urzedy.URZ_GIDNumer
              WHERE CDN.Urzedy.URZ_GIDNumer IS NULL AND (inserted.UPN_KntTyp=4304)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Urzedy) [UpoNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UPN_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UPN_KntTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.UPN_KNTNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.UPN_KntTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [UpoNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( UPN_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UPN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.UPN_KNTNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.UPN_KntTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [UpoNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_UPOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_UPOPrimary */</I><BR>
ALTER TABLE CDN.UpoOpisy ADD CONSTRAINT FK_UPOPrimary
 FOREIGN KEY
   (
                          UPO_GIDNumer                      
                         )
             REFERENCES CDN.UpoNag
                         (
                          UPN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UrzadzeniaZewnetrzne_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UrzadzeniaZewnetrzne_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UrzadzeniaZewnetrzne_DeleteHandler
  ON CDN.UrzadzeniaZewnetrzne
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.PicoKonfig
    IF EXISTS
       ( SELECT * FROM CDN.PicoKonfig JOIN deleted
          ON
                deleted.UZ_Id = CDN.PicoKonfig.PcK_CentrumID
            
       AND (CDN.PicoKonfig.Pck_Typ = 6 AND CDN.PicoKonfig.Pck_CentrumId &gt; 0)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć. Z urządzeniem jest powiązana baza odległa./# [UrzadzeniaZewnetrzne_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_UZOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_UZOPrimary */</I><BR>
ALTER TABLE CDN.UrzadzeniaZewnetrzneObiekty ADD CONSTRAINT FK_UZOPrimary
 FOREIGN KEY
   (
                          UZO_UzID                          
                         )
             REFERENCES CDN.UrzadzeniaZewnetrzne
                         (
                          UZ_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UrzadzeniaZewnetrzneObiekty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UrzadzeniaZewnetrzneObiekty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.UrzadzeniaZewnetrzneObiekty_InsertUpdateHandler
  ON CDN.UrzadzeniaZewnetrzneObiekty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( UZO_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.UZO_ObiTyp=128)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.UZO_ObiNumer = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL AND (inserted.UZO_ObiTyp=128)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [UrzadzeniaZewnetrzneObiekty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Urzedy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Urzedy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Urzedy_DeleteHandler
  ON CDN.Urzedy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.OsoStaleRoczne
    IF EXISTS
       ( SELECT * FROM CDN.OsoStaleRoczne JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.OsoStaleRoczne.ORo_Urzad
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą OsoStaleRoczne) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwZlcNag
    IF EXISTS
       ( SELECT * FROM CDN.SrwZlcNag JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.SrwZlcNag.SZN_KnPNumer
       AND (CDN.SrwZlcNag.SZN_KnPTyp=4304)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SrwZlcNag) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraNag
    IF EXISTS
       ( SELECT * FROM CDN.TraNag JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.TraNag.TrN_KnPNumer
       AND (CDN.TraNag.TrN_KnPTyp=4304)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraNag) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.KntKarty
    IF EXISTS
       ( SELECT * FROM CDN.KntKarty JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.KntKarty.Knt_KnPNumer
       AND (CDN.KntKarty.Knt_KnPTyp=4304)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą KntKarty) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ImpNag
    IF EXISTS
       ( SELECT * FROM CDN.ImpNag JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.ImpNag.ImN_KnPNumer
       AND (CDN.ImpNag.ImN_KnPTyp=4304)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ImpNag) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.IstNag
    IF EXISTS
       ( SELECT * FROM CDN.IstNag JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.IstNag.IsN_UrzNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą IstNag) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.UpoNag
    IF EXISTS
       ( SELECT * FROM CDN.UpoNag JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.UpoNag.UPN_KNTNumer
       AND (CDN.UpoNag.UPN_KntTyp=4304)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą UpoNag) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.SadNag.SaN_PdmNumer
       AND (CDN.SadNag.SaN_PdmTyp=4304)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.TraPlat
    IF EXISTS
       ( SELECT * FROM CDN.TraPlat JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.TraPlat.TrP_KntNumer
       AND (CDN.TraPlat.TRP_KntTyp=4304)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą TraPlat) [Urzedy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.NumeryRachunkow
    IF EXISTS(SELECT * FROM CDN.NumeryRachunkow JOIN deleted
            ON 
          deleted.URZ_GIDNumer = CDN.NumeryRachunkow.NRB_ObNumer
      AND (CDN.NumeryRachunkow.NrB_ObTyp=4304)
            )
        DELETE CDN.NumeryRachunkow
        FROM CDN.NumeryRachunkow JOIN deleted
        ON 
          deleted.URZ_GIDNumer = CDN.NumeryRachunkow.NRB_ObNumer
      AND (CDN.NumeryRachunkow.NrB_ObTyp=4304)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.RachunkiBankowe
    IF EXISTS(SELECT * FROM CDN.RachunkiBankowe JOIN deleted
            ON 
          deleted.URZ_GIDNumer = CDN.RachunkiBankowe.RkB_ObiNumer
      AND (CDN.RachunkiBankowe.RkB_ObiTyp = 4304)
            )
        DELETE CDN.RachunkiBankowe
        FROM CDN.RachunkiBankowe JOIN deleted
        ON 
          deleted.URZ_GIDNumer = CDN.RachunkiBankowe.RkB_ObiNumer
      AND (CDN.RachunkiBankowe.RkB_ObiTyp = 4304)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Urzedy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Urzedy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Urzedy_InsertUpdateHandler
  ON CDN.Urzedy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( URZ_BnkNumer2 ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.URZ_BnkNumer2 = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.URZ_BnkNumer2,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [Urzedy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( URZ_BnkNumer3 ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.URZ_BnkNumer3 = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.URZ_BnkNumer3,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [Urzedy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( URZ_BnkNumer4 ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.URZ_BnkNumer4 = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.URZ_BnkNumer4,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [Urzedy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( URZ_BnkNumer1 ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Banki ON
                    inserted.URZ_BnkNumer1 = CDN.Banki.Bnk_GIDNumer
              WHERE CDN.Banki.Bnk_GIDNumer IS NULL
                AND (
                          IsNull(inserted.URZ_BnkNumer1,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Banki) [Urzedy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UrzedyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UrzedyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UrzedyAlias_DeleteHandler
  ON CDN.Urzedy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.SadNag.SaN_URZGrNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [UrzedyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="UrzedyAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* UrzedyAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.UrzedyAlias1_DeleteHandler
  ON CDN.Urzedy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.SadNag
    IF EXISTS
       ( SELECT * FROM CDN.SadNag JOIN deleted
          ON
                deleted.URZ_GIDNumer = CDN.SadNag.SaN_KnPNumer
       AND (CDN.SadNag.SaN_KnPTyp=4304)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą SadNag) [UrzedyAlias1_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_UroPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_UroPrimary */</I><BR>
ALTER TABLE CDN.UrzedyOpisy ADD CONSTRAINT FK_UroPrimary
 FOREIGN KEY
   (
                          URO_GIDNumer                      
                         )
             REFERENCES CDN.Urzedy
                         (
                          URZ_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ULTPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ULTPrimary */</I><BR>
ALTER TABLE CDN.UstawieniaList ADD CONSTRAINT FK_ULTPrimary
 FOREIGN KEY
   (
                          ULT_IDOperatora                   
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefAkcje_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefAkcje_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefAkcje_DeleteHandler
  ON CDN.WF_DefAkcje
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_DefZadania
    IF EXISTS(SELECT * FROM CDN.WF_DefZadania JOIN deleted
            ON 
          deleted.WDA_ID = CDN.WF_DefZadania.WDZ_WDAID
      AND (CDN.WF_DefZadania.WDZ_WDAID&gt;0)
            )
        DELETE CDN.WF_DefZadania
        FROM CDN.WF_DefZadania JOIN deleted
        ON 
          deleted.WDA_ID = CDN.WF_DefZadania.WDZ_WDAID
      AND (CDN.WF_DefZadania.WDZ_WDAID&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefAkcje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefAkcje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefAkcje_InsertUpdateHandler
  ON CDN.WF_DefAkcje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WDA_WDPUruchomId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefProcesy ON
                    inserted.WDA_WDPUruchomId = CDN.WF_DefProcesy.WDP_ID
              WHERE CDN.WF_DefProcesy.WDP_ID IS NULL
                AND (
                          IsNull(inserted.WDA_WDPUruchomId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefProcesy) [WF_DefAkcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WDA_WDPID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WDA_WDPID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefProcesy ON
                    inserted.WDA_WDPID = CDN.WF_DefProcesy.WDP_ID
              WHERE CDN.WF_DefProcesy.WDP_ID IS NULL AND (inserted.WDA_WDPID&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefProcesy) [WF_DefAkcje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefOpiekun_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefOpiekun_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefOpiekun_InsertUpdateHandler
  ON CDN.WF_DefOpiekun
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WDO_WDZID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WDO_WDZID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefZadania ON
                    inserted.WDO_WDZID = CDN.WF_DefZadania.WDZ_ID
              WHERE CDN.WF_DefZadania.WDZ_ID IS NULL AND (inserted.WDO_WDZID&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefZadania) [WF_DefOpiekun_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefProcesy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefProcesy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefProcesy_DeleteHandler
  ON CDN.WF_DefProcesy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_Procesy
    IF EXISTS
       ( SELECT * FROM CDN.WF_Procesy JOIN deleted
          ON
                deleted.WDP_ID = CDN.WF_Procesy.WFP_WDPID
       AND (CDN.WF_Procesy.WFP_DataZamkniecia=0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WF_Procesy) [WF_DefProcesy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_DefAkcje
    IF EXISTS(SELECT * FROM CDN.WF_DefAkcje JOIN deleted
            ON 
          deleted.WDP_ID = CDN.WF_DefAkcje.WDA_WDPID
      AND (CDN.WF_DefAkcje.WDA_WDPID&gt;0)
            )
        DELETE CDN.WF_DefAkcje
        FROM CDN.WF_DefAkcje JOIN deleted
        ON 
          deleted.WDP_ID = CDN.WF_DefAkcje.WDA_WDPID
      AND (CDN.WF_DefAkcje.WDA_WDPID&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdIoTAkcjeZdarzenia
    IF EXISTS(SELECT * FROM CDN.ProdIoTAkcjeZdarzenia JOIN deleted
            ON 
          deleted.WDP_ID = CDN.ProdIoTAkcjeZdarzenia.PIAZ_AkcjaNumer
      AND (CDN.ProdIoTAkcjeZdarzenia.PIAZ_AkcjaTyp=12288)
            )
        DELETE CDN.ProdIoTAkcjeZdarzenia
        FROM CDN.ProdIoTAkcjeZdarzenia JOIN deleted
        ON 
          deleted.WDP_ID = CDN.ProdIoTAkcjeZdarzenia.PIAZ_AkcjaNumer
      AND (CDN.ProdIoTAkcjeZdarzenia.PIAZ_AkcjaTyp=12288)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefProcesy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefProcesy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefProcesy_InsertUpdateHandler
  ON CDN.WF_DefProcesy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WDP_WDGId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefProcesyGrupy ON
                    inserted.WDP_WDGId = CDN.WF_DefProcesyGrupy.WDG_Id
              WHERE CDN.WF_DefProcesyGrupy.WDG_Id IS NULL
                AND (
                          IsNull(inserted.WDP_WDGId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefProcesyGrupy) [WF_DefProcesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefProcesyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefProcesyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefProcesyAlias_DeleteHandler
  ON CDN.WF_DefProcesy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_DefAkcje
    IF EXISTS
       ( SELECT * FROM CDN.WF_DefAkcje JOIN deleted
          ON
                deleted.WDP_ID = CDN.WF_DefAkcje.WDA_WDPUruchomId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WF_DefAkcje) [WF_DefProcesyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefProcesyGrupy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefProcesyGrupy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefProcesyGrupy_DeleteHandler
  ON CDN.WF_DefProcesyGrupy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_DefProcesy
    IF EXISTS
       ( SELECT * FROM CDN.WF_DefProcesy JOIN deleted
          ON
                deleted.WDG_Id = CDN.WF_DefProcesy.WDP_WDGId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WF_DefProcesy) [WF_DefProcesyGrupy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WDKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WDKPrimary */</I><BR>
ALTER TABLE CDN.WF_DefStatKonc ADD CONSTRAINT FK_WDKPrimary
 FOREIGN KEY
   (
                          WDK_WDZID                         
                         )
             REFERENCES CDN.WF_DefZadania
                         (
                          WDZ_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefStatKonc_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefStatKonc_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefStatKonc_InsertUpdateHandler
  ON CDN.WF_DefStatKonc
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WDK_WDSID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WDK_WDSID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefStatusy ON
                    inserted.WDK_WDSID = CDN.WF_DefStatusy.WDS_ID
              WHERE CDN.WF_DefStatusy.WDS_ID IS NULL AND (inserted.WDK_WDSID&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefStatusy) [WF_DefStatKonc_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WDSKodStatusu"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WDSKodStatusu */</I><BR>
ALTER TABLE CDN.WF_DefStatusy ADD CONSTRAINT FK_WDSKodStatusu
 FOREIGN KEY
   (
                          WDS_WDPID                         
                         )
             REFERENCES CDN.WF_DefProcesy
                         (
                          WDP_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefStatusy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefStatusy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefStatusy_DeleteHandler
  ON CDN.WF_DefStatusy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_Zadania
    IF EXISTS
       ( SELECT * FROM CDN.WF_Zadania JOIN deleted
          ON
                deleted.WDS_ID = CDN.WF_Zadania.WFZ_WDSID
       AND (CDN.WF_Zadania.WFZ_WDSID&gt;0 and CDN.WF_Zadania.WFZ_DataZamkniecia =0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WF_Zadania) [WF_DefStatusy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_DefStatKonc
    IF EXISTS
       ( SELECT * FROM CDN.WF_DefStatKonc JOIN deleted
          ON
                deleted.WDS_ID = CDN.WF_DefStatKonc.WDK_WDSID
       AND (CDN.WF_DefStatKonc.WDK_WDSID&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WF_DefStatKonc) [WF_DefStatusy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_DefZadania
    IF EXISTS(SELECT * FROM CDN.WF_DefZadania JOIN deleted
            ON 
          deleted.WDS_ID = CDN.WF_DefZadania.WDZ_WDSID
      AND (CDN.WF_DefZadania.WDZ_WDSID&gt;0)
            )
        DELETE CDN.WF_DefZadania
        FROM CDN.WF_DefZadania JOIN deleted
        ON 
          deleted.WDS_ID = CDN.WF_DefZadania.WDZ_WDSID
      AND (CDN.WF_DefZadania.WDZ_WDSID&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefStatusyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefStatusyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefStatusyAlias_DeleteHandler
  ON CDN.WF_DefStatusy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_DefZadania
    IF EXISTS
       ( SELECT * FROM CDN.WF_DefZadania JOIN deleted
          ON
                deleted.WDS_ID = CDN.WF_DefZadania.WDZ_Wynik
       AND (CDN.WF_DefZadania.WDZ_WYNIK&gt;0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WF_DefZadania) [WF_DefStatusyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefStatusyAlias1_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefStatusyAlias1_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefStatusyAlias1_DeleteHandler
  ON CDN.WF_DefStatusy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_DefZadania
    IF EXISTS
       ( SELECT * FROM CDN.WF_DefZadania JOIN deleted
          ON
                deleted.WDS_ID = CDN.WF_DefZadania.WDZ_OpiekunId
            
       AND (CDN.WF_DefZadania.WDZ_OpiekunTyp=3 AND CDN.WF_DefZadania.WDZ_OpiekunId&lt;&gt;-1)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Zadania nie można usunąć gdyż pobierany jest z niego opiekun dynamiczny w czynności definicji procesu./# [WF_DefStatusyAlias1_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WDZProces"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WDZProces */</I><BR>
ALTER TABLE CDN.WF_DefZadania ADD CONSTRAINT FK_WDZProces
 FOREIGN KEY
   (
                          WDZ_WDPID                         
                         )
             REFERENCES CDN.WF_DefProcesy
                         (
                          WDP_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefZadania_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefZadania_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefZadania_DeleteHandler
  ON CDN.WF_DefZadania
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_Zadania
    IF EXISTS
       ( SELECT * FROM CDN.WF_Zadania JOIN deleted
          ON
                deleted.WDZ_ID = CDN.WF_Zadania.WFZ_WDZID
       AND (CDN.WF_Zadania.WFZ_WDZID&gt;0  AND CDN.WF_Zadania.WFZ_DataZamkniecia=0)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WF_Zadania) [WF_DefZadania_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_DefOpiekun
    IF EXISTS(SELECT * FROM CDN.WF_DefOpiekun JOIN deleted
            ON 
          deleted.WDZ_ID = CDN.WF_DefOpiekun.WDO_WDZID
      AND (CDN.WF_DefOpiekun.WDO_WDZID&gt;0)
            )
        DELETE CDN.WF_DefOpiekun
        FROM CDN.WF_DefOpiekun JOIN deleted
        ON 
          deleted.WDZ_ID = CDN.WF_DefOpiekun.WDO_WDZID
      AND (CDN.WF_DefOpiekun.WDO_WDZID&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefZadania_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefZadania_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefZadania_InsertUpdateHandler
  ON CDN.WF_DefZadania
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WDZ_OpiekunId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WDZ_OpiekunTyp=3 AND inserted.WDZ_OpiekunId&lt;&gt;-1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefStatusy ON
                    inserted.WDZ_OpiekunId = CDN.WF_DefStatusy.WDS_ID
              WHERE CDN.WF_DefStatusy.WDS_ID IS NULL AND (inserted.WDZ_OpiekunTyp=3 AND inserted.WDZ_OpiekunId&lt;&gt;-1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefStatusy) [WF_DefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WDZ_OpiekunId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WDZ_OpiekunTyp=2)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefZadania ON
                    inserted.WDZ_OpiekunId = CDN.WF_DefZadania.WDZ_ID
              WHERE CDN.WF_DefZadania.WDZ_ID IS NULL AND (inserted.WDZ_OpiekunTyp=2)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefZadania) [WF_DefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WDZ_Wynik ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WDZ_WYNIK&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefStatusy ON
                    inserted.WDZ_Wynik = CDN.WF_DefStatusy.WDS_ID
              WHERE CDN.WF_DefStatusy.WDS_ID IS NULL AND (inserted.WDZ_WYNIK&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefStatusy) [WF_DefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WDZ_WDSID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WDZ_WDSID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefStatusy ON
                    inserted.WDZ_WDSID = CDN.WF_DefStatusy.WDS_ID
              WHERE CDN.WF_DefStatusy.WDS_ID IS NULL AND (inserted.WDZ_WDSID&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefStatusy) [WF_DefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WDZ_WDAID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WDZ_WDAID&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefAkcje ON
                    inserted.WDZ_WDAID = CDN.WF_DefAkcje.WDA_ID
              WHERE CDN.WF_DefAkcje.WDA_ID IS NULL AND (inserted.WDZ_WDAID&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefAkcje) [WF_DefZadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_DefZadaniaAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_DefZadaniaAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_DefZadaniaAlias_DeleteHandler
  ON CDN.WF_DefZadania
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WF_DefZadania
    IF EXISTS
       ( SELECT * FROM CDN.WF_DefZadania JOIN deleted
          ON
                deleted.WDZ_ID = CDN.WF_DefZadania.WDZ_OpiekunId
            
       AND (CDN.WF_DefZadania.WDZ_OpiekunTyp=2)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Czynności nie można usunąć gdyż pobierany jest z niej opiekun dynamiczny w innej czynności definicji procesu./# [WF_DefZadaniaAlias_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WFHSlwId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WFHSlwId */</I><BR>
ALTER TABLE CDN.WF_HarmonogramAutomatu ADD CONSTRAINT FK_WFHSlwId
 FOREIGN KEY
   (
                          WFH_SlwId                         
                         )
             REFERENCES CDN.Slowniki
                         (
                          SLW_ID   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_Procesy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_Procesy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_Procesy_DeleteHandler
  ON CDN.WF_Procesy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.WFP_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=12289)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.WFP_ID = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp=12289)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_Procesy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_Procesy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WF_Procesy_InsertUpdateHandler
  ON CDN.WF_Procesy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WFP_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFP_OBITyp in (4144, 4145, 4146))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.WFP_OBINumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.WFP_OBITyp in (4144, 4145, 4146))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFP_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFP_OBITyp in (14451,14452,14453))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SekDokumenty ON
                    inserted.WFP_OBINumer = CDN.SekDokumenty.SDD_Id
              WHERE CDN.SekDokumenty.SDD_Id IS NULL AND (inserted.WFP_OBITyp in (14451,14452,14453))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SekDokumenty) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFP_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFP_OBITyp in (1089, 1601, 1602))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.WFP_OBINumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL AND (inserted.WFP_OBITyp in (1089, 1601, 1602))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFP_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFP_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036 ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.WFP_OBINumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.WFP_OBITyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036 ,2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFP_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.WFP_OBITyp = 960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.WFP_OBINumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (  inserted.WFP_OBITyp = 960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFP_WDPID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFP_DataZamkniecia=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefProcesy ON
                    inserted.WFP_WDPID = CDN.WF_DefProcesy.WDP_ID
              WHERE CDN.WF_DefProcesy.WDP_ID IS NULL AND (inserted.WFP_DataZamkniecia=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefProcesy) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFP_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFP_OBITyp in (14343,14350))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecenia ON
                    inserted.WFP_OBINumer = CDN.ProdZlecenia.PZL_Id
              WHERE CDN.ProdZlecenia.PZL_Id IS NULL AND (inserted.WFP_OBITyp in (14343,14350))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecenia) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFP_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFP_OBITyp = 880)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrzelewyNag ON
                    inserted.WFP_OBINumer = CDN.PrzelewyNag.PPN_ID
              WHERE CDN.PrzelewyNag.PPN_ID IS NULL AND (inserted.WFP_OBITyp = 880)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrzelewyNag) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFP_OBINumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFP_OBITyp in (2832, 2833))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.UpoNag ON
                    inserted.WFP_OBINumer = CDN.UpoNag.UPN_GIDNumer
              WHERE CDN.UpoNag.UPN_GIDNumer IS NULL AND (inserted.WFP_OBITyp in (2832, 2833))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  UpoNag) [WF_Procesy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WFZProces"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WFZProces */</I><BR>
ALTER TABLE CDN.WF_Zadania ADD CONSTRAINT FK_WFZProces
 FOREIGN KEY
   (
                          WFZ_WFPID                         
                         )
             REFERENCES CDN.WF_Procesy
                         (
                          WFP_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_Zadania_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_Zadania_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WF_Zadania_DeleteHandler
  ON CDN.WF_Zadania
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zadania
    IF EXISTS(SELECT * FROM CDN.Zadania JOIN deleted
            ON 
          deleted.WFZ_ID = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=12293)
            )
        DELETE CDN.Zadania
        FROM CDN.Zadania JOIN deleted
        ON 
          deleted.WFZ_ID = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=12293)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WF_Zadania_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WF_Zadania_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WF_Zadania_InsertUpdateHandler
  ON CDN.WF_Zadania
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WFZ_WDSID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFZ_WDSID&gt;0 and inserted.WFZ_DataZamkniecia =0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefStatusy ON
                    inserted.WFZ_WDSID = CDN.WF_DefStatusy.WDS_ID
              WHERE CDN.WF_DefStatusy.WDS_ID IS NULL AND (inserted.WFZ_WDSID&gt;0 and inserted.WFZ_DataZamkniecia =0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefStatusy) [WF_Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WFZ_WDZID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WFZ_WDZID&gt;0  AND inserted.WFZ_DataZamkniecia=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_DefZadania ON
                    inserted.WFZ_WDZID = CDN.WF_DefZadania.WDZ_ID
              WHERE CDN.WF_DefZadania.WDZ_ID IS NULL AND (inserted.WFZ_WDZID&gt;0  AND inserted.WFZ_DataZamkniecia=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_DefZadania) [WF_Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WaEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WaEPrimary */</I><BR>
ALTER TABLE CDN.WalElem ADD CONSTRAINT FK_WaEPrimary
 FOREIGN KEY
   (
                          WaE_Symbol                        
                         )
             REFERENCES CDN.WalNag
                         (
                          WaN_Symbol                        
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Wnioski_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Wnioski_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Wnioski_InsertUpdateHandler
  ON CDN.Wnioski
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WNO_PRCNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.WNO_PRCNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.WNO_PRCNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Wnioski_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Wolne_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Wolne_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Wolne_InsertUpdateHandler
  ON CDN.Wolne
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WOL_MagNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.Wol_Typ in ( 8, 9 ,27))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.WOL_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL AND (  inserted.Wol_Typ in ( 8, 9 ,27))
                AND (
                          IsNull(inserted.WOL_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [Wolne_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WSTUstawienie"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WSTUstawienie */</I><BR>
ALTER TABLE CDN.WstegaUstawienia ADD CONSTRAINT FK_WSTUstawienie
 FOREIGN KEY
   (
                          WST_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WydatkiPracownikow_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WydatkiPracownikow_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WydatkiPracownikow_InsertUpdateHandler
  ON CDN.WydatkiPracownikow
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WPR_PrcNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.WPR_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.WPR_PrcNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.WPR_DokTyp in ( 3376,3378,3379,3386,3387))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.WPR_DokNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (  inserted.WPR_DokTyp in ( 3376,3378,3379,3386,3387))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.WPR_DokTyp in ( 4144,4145,4146))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.WPR_DokNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (  inserted.WPR_DokTyp in ( 4144,4145,4146))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_CWNId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyNag ON
                    inserted.WPR_CWNId = CDN.CRMWizytyNag.CWN_ID
              WHERE CDN.CRMWizytyNag.CWN_ID IS NULL
                AND (
                          IsNull(inserted.WPR_CWNId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyNag) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WPR_DokTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.WPR_DokNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.WPR_DokTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_DokNumer )  OR UPDATE( WPR_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WPR_DokTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968) And inserted.Wpr_DokLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.WPR_DokNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.WPR_DokLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.WPR_DokTyp in ( 2033, 2041 ,2037 ,2045 ,2001 ,2009,   2005 ,2013 ,2034 ,2042 ,2035,2043 ,2039, 2047, 1520, 1528, 1521 ,1529  ,1489 ,1497 ,1600,1603,1604 ,2036, 2044 ,1617 ,1616  ,2003  ,2004 ,1490 ,1498  ,1312 ,1824 ,1320 ,1832, 1624, 1625, 2000, 2002, 2008, 2010, 1828, 1836, 1968) And inserted.Wpr_DokLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_KntTyp )  OR UPDATE( WPR_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE   inserted.WPR_KntTyp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.WPR_KntTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.WPR_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (  inserted.WPR_KntTyp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_SamId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Samochody ON
                    inserted.WPR_SamId = CDN.Samochody.SaM_Id
              WHERE CDN.Samochody.SaM_Id IS NULL
                AND (
                          IsNull(inserted.WPR_SamId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Samochody) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_DGENumer )  OR UPDATE( WPR_DGELp ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DelegacjeElem ON
                    inserted.WPR_DGENumer = CDN.DelegacjeElem.DGE_GIDNumer
                AND inserted.WPR_DGELp = CDN.DelegacjeElem.DGE_GIDLp
              WHERE CDN.DelegacjeElem.DGE_GIDLp IS NULL
                AND (
                          IsNull(inserted.WPR_DGENumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.WPR_DGELp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DelegacjeElem) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPR_SaPId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SamPrzejazdy ON
                    inserted.WPR_SaPId = CDN.SamPrzejazdy.SaP_Id
              WHERE CDN.SamPrzejazdy.SaP_Id IS NULL
                AND (
                          IsNull(inserted.WPR_SaPId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SamPrzejazdy) [WydatkiPracownikow_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WPPDLGTrp"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WPPDLGTrp */</I><BR>
ALTER TABLE CDN.WydatkiPrcPlatnosci ADD CONSTRAINT FK_WPPDLGTrp
 FOREIGN KEY
   (
                          WPP_DLGTRPTyp                     ,
                          WPP_DLGTRPNumer                   ,
                          WPP_DLGTRPLp                      
                         )
             REFERENCES CDN.TraPlat
                         (
                          TrP_GIDTyp   ,
                          TrP_GIDNumer   ,
                          TrP_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ */</I><BR>
ALTER TABLE CDN.WydatkiPrcPlatnosci ADD CONSTRAINT FK_
 FOREIGN KEY
   (
                          WPP_WPRID                         
                         )
             REFERENCES CDN.WydatkiPracownikow
                         (
                          WPR_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WmpPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WmpPrimary */</I><BR>
ALTER TABLE CDN.WymPowiazania ADD CONSTRAINT FK_WmpPrimary
 FOREIGN KEY
   (
                          WMP_WmrID                         
                         )
             REFERENCES CDN.Wymiary
                         (
                          WMR_ID                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WymPowiazania_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WymPowiazania_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WymPowiazania_InsertUpdateHandler
  ON CDN.WymPowiazania
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WMP_PowiazanieID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WMP_TypPowiazania=1)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.WMP_PowiazanieID = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL AND (inserted.WMP_TypPowiazania=1)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [WymPowiazania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WMP_PowiazanieID ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WMP_TypPowiazania=2)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.WMP_PowiazanieID = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.WMP_TypPowiazania=2)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [WymPowiazania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Wymiary_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Wymiary_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Wymiary_DeleteHandler
  ON CDN.Wymiary
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.WMR_ID = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=7685)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.WMR_ID = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=7685)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.WMR_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=7685)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.WMR_ID = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=7685)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WPEWyplata"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WPEWyplata */</I><BR>
ALTER TABLE CDN.WypElem ADD CONSTRAINT FK_WPEWyplata
 FOREIGN KEY
   (
                          WPE_WPLId                         
                         )
             REFERENCES CDN.Wyplaty
                         (
                          WPL_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WypElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WypElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WypElem_DeleteHandler
  ON CDN.WypElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WypSElem
    IF EXISTS(SELECT * FROM CDN.WypSElem JOIN deleted
            ON 
          deleted.WPE_WPLId = CDN.WypSElem.WPS_WPLId
      AND deleted.WPE_Id = CDN.WypSElem.WPS_WPEId
      AND (CDN.WypSElem.WPS_WPEId&gt;0)
            )
        DELETE CDN.WypSElem
        FROM CDN.WypSElem JOIN deleted
        ON 
          deleted.WPE_WPLId = CDN.WypSElem.WPS_WPLId
      AND deleted.WPE_Id = CDN.WypSElem.WPS_WPEId
      AND (CDN.WypSElem.WPS_WPEId&gt;0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WypElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WypElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WypElem_InsertUpdateHandler
  ON CDN.WypElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WPE_PEWId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceElementyWyplat ON
                    inserted.WPE_PEWId = CDN.PlaceElementyWyplat.PEW_Id
              WHERE CDN.PlaceElementyWyplat.PEW_Id IS NULL
                AND (
                          IsNull(inserted.WPE_PEWId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceElementyWyplat) [WypElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WypSElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WypSElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WypSElem_InsertUpdateHandler
  ON CDN.WypSElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WPS_WPLId )  OR UPDATE( WPS_WPEId ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WPS_WPEId&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WypElem ON
                    inserted.WPS_WPLId = CDN.WypElem.WPE_WPLId
                AND inserted.WPS_WPEId = CDN.WypElem.WPE_Id
              WHERE CDN.WypElem.WPE_Id IS NULL AND (inserted.WPS_WPEId&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WypElem) [WypSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPS_PESId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PlaceElementySkladniki ON
                    inserted.WPS_PESId = CDN.PlaceElementySkladniki.PES_Id
              WHERE CDN.PlaceElementySkladniki.PES_Id IS NULL
                AND (
                          IsNull(inserted.WPS_PESId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PlaceElementySkladniki) [WypSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WPS_WPLId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wyplaty ON
                    inserted.WPS_WPLId = CDN.Wyplaty.WPL_Id
              WHERE CDN.Wyplaty.WPL_Id IS NULL
                AND (
                          IsNull(inserted.WPS_WPLId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wyplaty) [WypSElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WPLLista"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WPLLista */</I><BR>
ALTER TABLE CDN.Wyplaty ADD CONSTRAINT FK_WPLLista
 FOREIGN KEY
   (
                          WPL_LPLId                         
                         )
             REFERENCES CDN.ListyPlac
                         (
                          LPL_Id                            
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Wyplaty_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Wyplaty_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Wyplaty_DeleteHandler
  ON CDN.Wyplaty
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WypSElem
    IF EXISTS(SELECT * FROM CDN.WypSElem JOIN deleted
            ON 
          deleted.WPL_Id = CDN.WypSElem.WPS_WPLId
            )
        DELETE CDN.WypSElem
        FROM CDN.WypSElem JOIN deleted
        ON 
          deleted.WPL_Id = CDN.WypSElem.WPS_WPLId
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.TraPlat
    IF EXISTS(SELECT * FROM CDN.TraPlat JOIN deleted
            ON 
          deleted.WPL_Id = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (2978,2979,2980))
            )
        DELETE CDN.TraPlat
        FROM CDN.TraPlat JOIN deleted
        ON 
          deleted.WPL_Id = CDN.TraPlat.TrP_GIDNumer
      AND (CDN.TraPlat.TrP_GIDTyp in (2978,2979,2980))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Wyplaty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Wyplaty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Wyplaty_InsertUpdateHandler
  ON CDN.Wyplaty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WPL_OsoNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.WPL_OsoNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (CDN.PrcKarty.Prc_GIDTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Wyplaty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WyKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WyKPrimary */</I><BR>
ALTER TABLE CDN.WysKoszty ADD CONSTRAINT FK_WyKPrimary
 FOREIGN KEY
   (
                          WyK_WysNumer                      
                         )
             REFERENCES CDN.Wysylki
                         (
                          WYS_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WysKoszty_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WysKoszty_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WysKoszty_InsertUpdateHandler
  ON CDN.WysKoszty
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WyK_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyK_DokTyp in (4144,4145,4146))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MemNag ON
                    inserted.WyK_DokNumer = CDN.MemNag.MEN_GIDNumer
              WHERE CDN.MemNag.MEN_GIDNumer IS NULL AND (inserted.WyK_DokTyp in (4144,4145,4146))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MemNag) [WysKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WyK_DokTyp )  OR UPDATE( WyK_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyK_DokTyp=4336)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlecWewNag ON
                    inserted.WyK_DokTyp = CDN.ZlecWewNag.ZWN_GIDTyp
                AND inserted.WyK_DokNumer = CDN.ZlecWewNag.ZWN_GIDNumer
              WHERE CDN.ZlecWewNag.ZWN_GIDNumer IS NULL AND (inserted.WyK_DokTyp=4336)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlecWewNag) [WysKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WyK_DokTyp )  OR UPDATE( WyK_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyK_DokTyp not in (4144,4145,4146,4336,3378,3379,3344))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.WyK_DokTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.WyK_DokNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.WyK_DokTyp not in (4144,4145,4146,4336,3378,3379,3344))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [WysKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WyK_DokTyp )  OR UPDATE( WyK_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyK_DokTyp in (3378,3379))
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SadNag ON
                    inserted.WyK_DokTyp = CDN.SadNag.SaN_GIDTyp
                AND inserted.WyK_DokNumer = CDN.SadNag.SaN_GIDNumer
              WHERE CDN.SadNag.SaN_GIDNumer IS NULL AND (inserted.WyK_DokTyp in (3378,3379))
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SadNag) [WysKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WyK_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyK_DokTyp = 3344)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ImpNag ON
                    inserted.WyK_DokNumer = CDN.ImpNag.ImN_GIDNumer
              WHERE CDN.ImpNag.ImN_GIDNumer IS NULL AND (inserted.WyK_DokTyp = 3344)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ImpNag) [WysKoszty_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WysPaczki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WysPaczki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.WysPaczki_DeleteHandler
  ON CDN.WysPaczki
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.WyP_IdPaczki = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DOZ_DOKTyp=340)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.WyP_IdPaczki = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DOZ_DOKTyp=340)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.WyP_IdPaczki = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=340)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.WyP_IdPaczki = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=340)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.WyP_IdPaczki = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 340)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.WyP_IdPaczki = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 340)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.WyP_IdPaczki = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=340 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.WyP_IdPaczki = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=340 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.WyP_IdPaczki = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=340 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.WyP_IdPaczki = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=340 and CDN.AtrybutyHist.Ath_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WysPaczki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WysPaczki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WysPaczki_InsertUpdateHandler
  ON CDN.WysPaczki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WyP_TrasaID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TrasyNag ON
                    inserted.WyP_TrasaID = CDN.TrasyNag.TsN_Id
              WHERE CDN.TrasyNag.TsN_Id IS NULL
                AND (
                          IsNull(inserted.WyP_TrasaID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TrasyNag) [WysPaczki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WyP_KnATyp )  OR UPDATE( WyP_KnANumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Wyp_KnATyp=864 or inserted.Wyp_KnATyp=896)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.WyP_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.WyP_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL AND (inserted.Wyp_KnATyp=864 or inserted.Wyp_KnATyp=896)
                AND (
                          IsNull(inserted.WyP_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.WyP_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [WysPaczki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WyP_WysNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Wysylki ON
                    inserted.WyP_WysNumer = CDN.Wysylki.WYS_GIDNumer
              WHERE CDN.Wysylki.WYS_GIDNumer IS NULL
                AND (
                          IsNull(inserted.WyP_WysNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Wysylki) [WysPaczki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_WyRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_WyRPrimary */</I><BR>
ALTER TABLE CDN.WysRelacje ADD CONSTRAINT FK_WyRPrimary
 FOREIGN KEY
   (
                          WYR_IdPaczki                      
                         )
             REFERENCES CDN.WysPaczki
                         (
                          WyP_IdPaczki                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="WysRelacje_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* WysRelacje_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.WysRelacje_InsertUpdateHandler
  ON CDN.WysRelacje
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WYR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp =4700 and  inserted.WyR_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcNag ON
                    inserted.WYR_DokNumer = CDN.SrwZlcNag.SZN_Id
              WHERE CDN.SrwZlcNag.SZN_Id IS NULL AND (inserted.WyR_DokTyp =4700 and  inserted.WyR_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcNag) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp in (3584,3585) and  inserted.WyR_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklNag ON
                    inserted.WYR_DokNumer = CDN.ReklNag.RLN_Id
              WHERE CDN.ReklNag.RLN_Id IS NULL AND (inserted.WyR_DokTyp in (3584,3585) and  inserted.WyR_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklNag) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp in (1601,1089,1605,1093) and  inserted.WyR_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagNag ON
                    inserted.WYR_DokNumer = CDN.MagNag.MaN_GIDNumer
              WHERE CDN.MagNag.MaN_GIDNumer IS NULL AND (inserted.WyR_DokTyp in (1601,1089,1605,1093) and  inserted.WyR_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagNag) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp=960 and  inserted.WyR_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamNag ON
                    inserted.WYR_DokNumer = CDN.ZamNag.ZaN_GIDNumer
              WHERE CDN.ZamNag.ZaN_GIDNumer IS NULL AND (inserted.WyR_DokTyp=960 and  inserted.WyR_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamNag) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  inserted.WyR_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.WYR_DokNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  inserted.WyR_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer )  OR UPDATE( WYR_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  inserted.WyR_DokLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraElem ON
                    inserted.WYR_DokNumer = CDN.TraElem.TrE_GIDNumer
                AND inserted.WYR_DokLp = CDN.TraElem.TrE_GIDLp
              WHERE CDN.TraElem.TrE_GIDLp IS NULL AND (inserted.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  inserted.WyR_DokLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraElem) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer )  OR UPDATE( WYR_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp in (1601,1089,1605,1093) and  inserted.WyR_DokLp&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.MagElem ON
                    inserted.WYR_DokNumer = CDN.MagElem.MaE_GIDNumer
                AND inserted.WYR_DokLp = CDN.MagElem.MaE_GIDLp
              WHERE CDN.MagElem.MaE_GIDLp IS NULL AND (inserted.WyR_DokTyp in (1601,1089,1605,1093) and  inserted.WyR_DokLp&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  MagElem) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer )  OR UPDATE( WYR_DokLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp=960 and  inserted.WyR_DokLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.WYR_DokNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.WYR_DokLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.WyR_DokTyp=960 and  inserted.WyR_DokLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp=4704 and  inserted.WyR_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcUrz ON
                    inserted.WYR_DokNumer = CDN.SrwZlcUrz.SZU_Id
              WHERE CDN.SrwZlcUrz.SZU_Id IS NULL AND (inserted.WyR_DokTyp=4704 and  inserted.WyR_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcUrz) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp=3586 and  inserted.WyR_DokLp=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ReklElem ON
                    inserted.WYR_DokNumer = CDN.ReklElem.RLE_Id
              WHERE CDN.ReklElem.RLE_Id IS NULL AND (inserted.WyR_DokTyp=3586 and  inserted.WyR_DokLp=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ReklElem) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYR_DokNumer )  OR UPDATE( WYR_DokLp )  OR UPDATE( WYR_DokSubLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  inserted.WyR_DokLp&lt;&gt;0  and  inserted.WyR_DokSubLp&lt;&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraSElem ON
                    inserted.WYR_DokNumer = CDN.TraSElem.TrS_GIDNumer
                AND inserted.WYR_DokLp = CDN.TraSElem.TrS_GIDLp
                AND inserted.WYR_DokSubLp = CDN.TraSElem.TrS_SubGIDLp
              WHERE CDN.TraSElem.TrS_SubGIDLp IS NULL AND (inserted.WyR_DokTyp not in (2003,2004,1312,1824,960,1601,1089,1605,1093,3584,3585,4700,4704,3586) and  inserted.WyR_DokLp&lt;&gt;0  and  inserted.WyR_DokSubLp&lt;&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraSElem) [WysRelacje_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Wysylki_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Wysylki_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Wysylki_DeleteHandler
  ON CDN.Wysylki
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WysPaczki
    IF EXISTS
       ( SELECT * FROM CDN.WysPaczki JOIN deleted
          ON
                deleted.WYS_GIDNumer = CDN.WysPaczki.WyP_WysNumer
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WysPaczki) [Wysylki_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.WYS_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DOZ_DOKTyp=337)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.WYS_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DOZ_DOKTyp=337)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.WYS_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=337)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.WYS_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=337)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.WYS_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 337)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.WYS_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 337)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.WYS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=337 and CDN.Atrybuty.Atr_OBILp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.WYS_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=337 and CDN.Atrybuty.Atr_OBILp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.WYS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=337 and CDN.AtrybutyHist.Ath_OBILp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.WYS_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND (CDN.AtrybutyHist.Ath_OBITyp=337 and CDN.AtrybutyHist.Ath_OBILp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Wysylki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Wysylki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Wysylki_InsertUpdateHandler
  ON CDN.Wysylki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( WYS_SamId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Samochody ON
                    inserted.WYS_SamId = CDN.Samochody.SaM_Id
              WHERE CDN.Samochody.SaM_Id IS NULL
                AND (
                          IsNull(inserted.WYS_SamId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Samochody) [Wysylki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYS_KierNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyS_KierTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.WYS_KierNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.WyS_KierTyp=944)
                AND (
                          IsNull(inserted.WYS_KierNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Wysylki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYS_KierNumer )  OR UPDATE( WYS_KierLP ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.WyS_KierTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.WYS_KierNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.WYS_KierLP = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.WyS_KierTyp=32)
                AND (
                          IsNull(inserted.WYS_KierNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.WYS_KierLP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [Wysylki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYS_TrasaId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TrasyNag ON
                    inserted.WYS_TrasaId = CDN.TrasyNag.TsN_Id
              WHERE CDN.TrasyNag.TsN_Id IS NULL
                AND (
                          IsNull(inserted.WYS_TrasaId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TrasyNag) [Wysylki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYS_SpeNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Wys_SpeTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.WYS_SpeNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Wys_SpeTyp=32)
                AND (
                          IsNull(inserted.WYS_SpeNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Wysylki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYS_Kurier ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.WYS_Kurier = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.WYS_Kurier,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Wysylki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( WYS_StanPrzesylki ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.WYS_StanPrzesylki = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.WYS_StanPrzesylki,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Wysylki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZRKZRN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZRKZRN */</I><BR>
ALTER TABLE CDN.ZRNKartyPracy ADD CONSTRAINT FK_ZRKZRN
 FOREIGN KEY
   (
                          ZRK_ZrNNumer                      
                         )
             REFERENCES CDN.ZlcRemNag
                         (
                          ZRN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNKartyPracy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNKartyPracy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZRNKartyPracy_DeleteHandler
  ON CDN.ZRNKartyPracy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Zadania
    IF EXISTS(SELECT * FROM CDN.Zadania JOIN deleted
            ON 
          deleted.ZRK_GIDNumer = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=4347 AND CDN.Zadania.ZAD_ZrdLP=0)
            )
        DELETE CDN.Zadania
        FROM CDN.Zadania JOIN deleted
        ON 
          deleted.ZRK_GIDNumer = CDN.Zadania.Zad_ZrdNumer
      AND (CDN.Zadania.ZAD_ZrdTyp=4347 AND CDN.Zadania.ZAD_ZrdLP=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZRK_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4347)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZRK_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4347)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZRK_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4347)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZRK_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4347)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZRPZRN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZRPZRN */</I><BR>
ALTER TABLE CDN.ZRNKartyPracyPrc ADD CONSTRAINT FK_ZRPZRN
 FOREIGN KEY
   (
                          ZRP_ZRNNumer                      
                         )
             REFERENCES CDN.ZRNKartyPracy
                         (
                          ZRK_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNKartyPracyPrc_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNKartyPracyPrc_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZRNKartyPracyPrc_DeleteHandler
  ON CDN.ZRNKartyPracyPrc
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZRP_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4348)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZRP_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4348)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZRP_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4348)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZRP_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4348)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNKartyPracyPrc_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNKartyPracyPrc_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZRNKartyPracyPrc_InsertUpdateHandler
  ON CDN.ZRNKartyPracyPrc
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZRP_PRCNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZrP_PrcTyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.ZRP_PRCNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.ZrP_PrcTyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [ZRNKartyPracyPrc_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRP_PRCNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZrP_PrcTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZRP_PRCNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.ZrP_PrcTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZRNKartyPracyPrc_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZRUZRN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZRUZRN */</I><BR>
ALTER TABLE CDN.ZRNKartyPracyUsl ADD CONSTRAINT FK_ZRUZRN
 FOREIGN KEY
   (
                          ZRU_ZRNNumer                      
                         )
             REFERENCES CDN.ZRNKartyPracy
                         (
                          ZRK_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNKartyPracyUsl_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNKartyPracyUsl_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZRNKartyPracyUsl_DeleteHandler
  ON CDN.ZRNKartyPracyUsl
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZRU_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4349)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZRU_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=4349)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZRU_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4349)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZRU_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4349)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNKartyPracyUsl_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNKartyPracyUsl_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZRNKartyPracyUsl_InsertUpdateHandler
  ON CDN.ZRNKartyPracyUsl
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZRU_SsCId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsCennikCzynnosci ON
                    inserted.ZRU_SsCId = CDN.SrsCennikCzynnosci.SCC_Id
              WHERE CDN.SrsCennikCzynnosci.SCC_Id IS NULL
                AND (
                          IsNull(inserted.ZRU_SsCId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsCennikCzynnosci) [ZRNKartyPracyUsl_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRU_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.ZRU_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRU_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ZRNKartyPracyUsl_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZRMZRN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZRMZRN */</I><BR>
ALTER TABLE CDN.ZRNMaterialy ADD CONSTRAINT FK_ZRMZRN
 FOREIGN KEY
   (
                          ZRM_ZRNNumer                      
                         )
             REFERENCES CDN.ZlcRemNag
                         (
                          ZRN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNMaterialy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNMaterialy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZRNMaterialy_DeleteHandler
  ON CDN.ZRNMaterialy
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZRM_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4350)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZRM_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4350)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZRM_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4350)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZRM_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4350)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNMaterialy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNMaterialy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZRNMaterialy_InsertUpdateHandler
  ON CDN.ZRNMaterialy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZRM_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ZRM_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRM_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ZRNMaterialy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRM_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.ZRM_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRM_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ZRNMaterialy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRM_KntNumerO ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZRM_KntNumerO = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRM_KntNumerO,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZRNMaterialy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZPEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZPEPrimary */</I><BR>
ALTER TABLE CDN.ZRNPlanyElem ADD CONSTRAINT FK_ZPEPrimary
 FOREIGN KEY
   (
                          ZPE_GIDNumer                      
                         )
             REFERENCES CDN.ZRNPlanyNag
                         (
                          ZPN_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNPlanyElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNPlanyElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZRNPlanyElem_InsertUpdateHandler
  ON CDN.ZRNPlanyElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZPE_SsWId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsWyposazenia ON
                    inserted.ZPE_SsWId = CDN.SrsWyposazenia.SsW_Id
              WHERE CDN.SrsWyposazenia.SsW_Id IS NULL
                AND (
                          IsNull(inserted.ZPE_SsWId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsWyposazenia) [ZRNPlanyElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZRNPlanyNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZRNPlanyNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZRNPlanyNag_InsertUpdateHandler
  ON CDN.ZRNPlanyNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZPN_SObTyp )  OR UPDATE( ZPN_SObNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZpN_SObTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZPN_SObTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.ZPN_SObNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZpN_SObTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZRNPlanyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZPN_OpeNumerW ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.ZPN_OpeNumerW = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZPN_OpeNumerW,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ZRNPlanyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZPN_OpeNumerZ ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.OpeKarty ON
                    inserted.ZPN_OpeNumerZ = CDN.OpeKarty.Ope_GIDNumer
              WHERE CDN.OpeKarty.Ope_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZPN_OpeNumerZ,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  OpeKarty) [ZRNPlanyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZPN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZPN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZPN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZPN_KntTyp=32)
                AND (
                          IsNull(inserted.ZPN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZRNPlanyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZPN_SObTyp )  OR UPDATE( ZPN_SObNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZpN_SObTyp=6656)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsObiekty ON
                    inserted.ZPN_SObTyp = CDN.SrsObiekty.SOb_GIDTyp
                AND inserted.ZPN_SObNumer = CDN.SrsObiekty.SOb_GIDNumer
              WHERE CDN.SrsObiekty.SOb_GIDNumer IS NULL AND (inserted.ZpN_SObTyp=6656)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsObiekty) [ZRNPlanyNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZeOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZeOPrimary */</I><BR>
ALTER TABLE CDN.ZaEOpisy ADD CONSTRAINT FK_ZeOPrimary
 FOREIGN KEY
   (
                          ZeO_ZamNumer                      ,
                          ZeO_ZamLp                         
                         )
             REFERENCES CDN.ZamElem
                         (
                          ZaE_GIDNumer   ,
                          ZaE_GIDLp   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZnOPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZnOPrimaryNoType */</I><BR>
ALTER TABLE CDN.ZaNOpisy ADD CONSTRAINT FK_ZnOPrimaryNoType
 FOREIGN KEY
   (
                          ZnO_ZamNumer                      
                         )
             REFERENCES CDN.ZamNag
                         (
                          ZaN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Zadania_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Zadania_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Zadania_DeleteHandler
  ON CDN.Zadania
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.CRMKntEtapy
    IF EXISTS
       ( SELECT * FROM CDN.CRMKntEtapy JOIN deleted
          ON
                deleted.Zad_Id = CDN.CRMKntEtapy.CEK_AntZadId
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą CRMKntEtapy) [Zadania_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Zadania_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Zadania_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Zadania_InsertUpdateHandler
  ON CDN.Zadania
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Zad_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZAD_ZrdTyp=4180)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.CRMWizytyNag ON
                    inserted.Zad_ZrdNumer = CDN.CRMWizytyNag.CWN_ID
              WHERE CDN.CRMWizytyNag.CWN_ID IS NULL AND (inserted.ZAD_ZrdTyp=4180)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  CRMWizytyNag) [Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zad_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZAD_ZrdTyp=4702)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosciTerminy ON
                    inserted.Zad_ZrdNumer = CDN.SrwZlcCzynnosciTerminy.SZT_ID
              WHERE CDN.SrwZlcCzynnosciTerminy.SZT_ID IS NULL AND (inserted.ZAD_ZrdTyp=4702)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosciTerminy) [Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zad_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZAD_ZrdTyp=14460 AND inserted.ZAD_ZrdLP=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Ankiety ON
                    inserted.Zad_ZrdNumer = CDN.Ankiety.ANT_Id
              WHERE CDN.Ankiety.ANT_Id IS NULL AND (inserted.ZAD_ZrdTyp=14460 AND inserted.ZAD_ZrdLP=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Ankiety) [Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zad_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZAD_ZrdTyp=12293)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.WF_Zadania ON
                    inserted.Zad_ZrdNumer = CDN.WF_Zadania.WFZ_ID
              WHERE CDN.WF_Zadania.WFZ_ID IS NULL AND (inserted.ZAD_ZrdTyp=12293)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  WF_Zadania) [Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zad_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZAD_ZrdTyp=14345 AND inserted.ZAD_ZrdLP=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosciTerminy ON
                    inserted.Zad_ZrdNumer = CDN.ProdCzynnosciTerminy.PCT_Id
              WHERE CDN.ProdCzynnosciTerminy.PCT_Id IS NULL AND (inserted.ZAD_ZrdTyp=14345 AND inserted.ZAD_ZrdLP=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosciTerminy) [Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zad_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZAD_ZrdTyp=4347 AND inserted.ZAD_ZrdLP=0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZRNKartyPracy ON
                    inserted.Zad_ZrdNumer = CDN.ZRNKartyPracy.ZRK_GIDNumer
              WHERE CDN.ZRNKartyPracy.ZRK_GIDNumer IS NULL AND (inserted.ZAD_ZrdTyp=4347 AND inserted.ZAD_ZrdLP=0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZRNKartyPracy) [Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zad_ZrdNumer )  OR UPDATE( Zad_ZrdLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZAD_ZrdTyp=339)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsElem ON
                    inserted.Zad_ZrdNumer = CDN.SrsElem.SsE_GIDNumer
                AND inserted.Zad_ZrdLp = CDN.SrsElem.SsE_GIDLp
              WHERE CDN.SrsElem.SsE_GIDLp IS NULL AND (inserted.ZAD_ZrdTyp=339)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsElem) [Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zad_ZrdNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZAD_ZrdTyp=2984)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Delegacje ON
                    inserted.Zad_ZrdNumer = CDN.Delegacje.DLG_GIDNumer
              WHERE CDN.Delegacje.DLG_GIDNumer IS NULL AND (inserted.ZAD_ZrdTyp=2984)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Delegacje) [Zadania_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZaOPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZaOPrimary */</I><BR>
ALTER TABLE CDN.ZadaniaObiekty ADD CONSTRAINT FK_ZaOPrimary
 FOREIGN KEY
   (
                          ZaO_ZadId                         
                         )
             REFERENCES CDN.Zadania
                         (
                          Zad_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZadaniaPrcPodl_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZadaniaPrcPodl_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZadaniaPrcPodl_InsertUpdateHandler
  ON CDN.ZadaniaPrcPodl
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZPP_PrcNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZPP_PrcTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZPP_PrcNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.ZPP_PrcTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZadaniaPrcPodl_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZPP_PrcPodlNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZPP_PrcPodlTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZPP_PrcPodlNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.ZPP_PrcPodlTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZadaniaPrcPodl_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZaEPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZaEPrimaryNoType */</I><BR>
ALTER TABLE CDN.ZamElem ADD CONSTRAINT FK_ZaEPrimaryNoType
 FOREIGN KEY
   (
                          ZaE_GIDNumer                      
                         )
             REFERENCES CDN.ZamNag
                         (
                          ZaN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZamElem_DeleteHandler
  ON CDN.ZamElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PlanyObciazeniaPozycje
    IF EXISTS(SELECT * FROM CDN.PlanyObciazeniaPozycje JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.PlanyObciazeniaPozycje.PPO_DokZrdNumer
      AND deleted.ZaE_GIDLp = CDN.PlanyObciazeniaPozycje.PPO_DokZrdLp
      AND deleted.ZaE_GIDTyp = CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp
      AND (CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp=960)
            )
        DELETE CDN.PlanyObciazeniaPozycje
        FROM CDN.PlanyObciazeniaPozycje JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.PlanyObciazeniaPozycje.PPO_DokZrdNumer
      AND deleted.ZaE_GIDLp = CDN.PlanyObciazeniaPozycje.PPO_DokZrdLp
      AND deleted.ZaE_GIDTyp = CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp
      AND (CDN.PlanyObciazeniaPozycje.PPO_DokZrdTyp=960)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.KonfProdNag
    IF EXISTS(SELECT * FROM CDN.KonfProdNag JOIN deleted
            ON 
          deleted.ZaE_GIDTyp = CDN.KonfProdNag.KPN_DokTyp
      AND deleted.ZaE_GIDNumer = CDN.KonfProdNag.KPN_DokNumer
      AND deleted.ZaE_GIDLp = CDN.KonfProdNag.KPN_DokLp
      AND (CDN.KonfProdNag.KPN_DokTyp=960 and CDN.KonfProdNag.KPN_DokLp&gt;0)
            )
        DELETE CDN.KonfProdNag
        FROM CDN.KonfProdNag JOIN deleted
        ON 
          deleted.ZaE_GIDTyp = CDN.KonfProdNag.KPN_DokTyp
      AND deleted.ZaE_GIDNumer = CDN.KonfProdNag.KPN_DokNumer
      AND deleted.ZaE_GIDLp = CDN.KonfProdNag.KPN_DokLp
      AND (CDN.KonfProdNag.KPN_DokTyp=960 and CDN.KonfProdNag.KPN_DokLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyPozycje
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyPozycje JOIN deleted
            ON 
          deleted.ZaE_GIDTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.ZaE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND deleted.ZaE_GIDLp = CDN.CRMDokumentyPozycje.CDP_DokLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp=960)
            )
        DELETE CDN.CRMDokumentyPozycje
        FROM CDN.CRMDokumentyPozycje JOIN deleted
        ON 
          deleted.ZaE_GIDTyp = CDN.CRMDokumentyPozycje.CDP_DokTyp
      AND deleted.ZaE_GIDNumer = CDN.CRMDokumentyPozycje.CDP_DokNumer
      AND deleted.ZaE_GIDLp = CDN.CRMDokumentyPozycje.CDP_DokLp
      AND (CDN.CRMDokumentyPozycje.CDP_DokTyp=960)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamHistoriaZmian
    IF EXISTS(SELECT * FROM CDN.ZamHistoriaZmian JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.ZamHistoriaZmian.ZaH_GIDNumer
      AND deleted.ZaE_GIDLp = CDN.ZamHistoriaZmian.ZaH_GIDLp
      AND (CDN.ZamHistoriaZmian.ZaH_GIDLp &gt; 0)
            )
        DELETE CDN.ZamHistoriaZmian
        FROM CDN.ZamHistoriaZmian JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.ZamHistoriaZmian.ZaH_GIDNumer
      AND deleted.ZaE_GIDLp = CDN.ZamHistoriaZmian.ZaH_GIDLp
      AND (CDN.ZamHistoriaZmian.ZaH_GIDLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.DokZwiazane.DoZ_ZRDNumer
      AND deleted.ZaE_GIDLp = CDN.DokZwiazane.DoZ_ZRDLp
      AND (CDN.DokZwiazane.DoZ_ZrdTyp=960 AND CDN.DokZwiazane.DoZ_ZrdLp &gt; 0)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.DokZwiazane.DoZ_ZRDNumer
      AND deleted.ZaE_GIDLp = CDN.DokZwiazane.DoZ_ZRDLp
      AND (CDN.DokZwiazane.DoZ_ZrdTyp=960 AND CDN.DokZwiazane.DoZ_ZrdLp &gt; 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND deleted.ZaE_GIDLp = CDN.DokZwiazane.DoZ_DOKLp
      AND (CDN.DokZwiazane.DoZ_DokTyp=960 AND CDN.DokZwiazane.DoZ_DokLp&gt;0)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND deleted.ZaE_GIDLp = CDN.DokZwiazane.DoZ_DOKLp
      AND (CDN.DokZwiazane.DoZ_DokTyp=960 AND CDN.DokZwiazane.DoZ_DokLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.PrmHistoria
    IF EXISTS(SELECT * FROM CDN.PrmHistoria JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.PrmHistoria.PrH_GIDNumer
      AND deleted.ZaE_GIDTyp = CDN.PrmHistoria.PrH_GIDTyp
      AND deleted.ZaE_GIDLp = CDN.PrmHistoria.PrH_GIDLp
      AND (CDN.PrmHistoria.PRH_GIDTyp=960 and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
            )
        DELETE CDN.PrmHistoria
        FROM CDN.PrmHistoria JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.PrmHistoria.PrH_GIDNumer
      AND deleted.ZaE_GIDTyp = CDN.PrmHistoria.PrH_GIDTyp
      AND deleted.ZaE_GIDLp = CDN.PrmHistoria.PrH_GIDLp
      AND (CDN.PrmHistoria.PRH_GIDTyp=960 and CDN.PrmHistoria.PRH_GIDLp&lt;&gt;-1)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZaE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.ZaE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=960 and  CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and        CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZaE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.ZaE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp=960 and  CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and        CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.ZaE_GIDTyp = CDN.ZamZamLinki.ZZL_ZZGidTyp
      AND deleted.ZaE_GIDNumer = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND deleted.ZaE_GIDLp = CDN.ZamZamLinki.ZZL_ZZGidLp
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=960)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.ZaE_GIDTyp = CDN.ZamZamLinki.ZZL_ZZGidTyp
      AND deleted.ZaE_GIDNumer = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND deleted.ZaE_GIDLp = CDN.ZamZamLinki.ZZL_ZZGidLp
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=960)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZaE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZaE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ZaE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=960 and  CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and        CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZaE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZaE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ZaE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp=960 and  CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and        CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdKalkulacjaKosztu
    IF EXISTS(SELECT * FROM CDN.ProdKalkulacjaKosztu JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.ProdKalkulacjaKosztu.PKK_ObiNumer
      AND deleted.ZaE_GIDLp = CDN.ProdKalkulacjaKosztu.PKK_ObiLp
      AND (CDN.ProdKalkulacjaKosztu.PKK_ObiTyp=960 AND CDN.ProdKalkulacjaKosztu.PKK_ObiLp&gt;0)
            )
        DELETE CDN.ProdKalkulacjaKosztu
        FROM CDN.ProdKalkulacjaKosztu JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.ProdKalkulacjaKosztu.PKK_ObiNumer
      AND deleted.ZaE_GIDLp = CDN.ProdKalkulacjaKosztu.PKK_ObiLp
      AND (CDN.ProdKalkulacjaKosztu.PKK_ObiTyp=960 AND CDN.ProdKalkulacjaKosztu.PKK_ObiLp&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND deleted.ZaE_GIDLp = CDN.WysRelacje.WYR_DokLp
      AND (CDN.WysRelacje.WyR_DokTyp=960 and  CDN.WysRelacje.WyR_DokLp&lt;&gt;0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND deleted.ZaE_GIDLp = CDN.WysRelacje.WYR_DokLp
      AND (CDN.WysRelacje.WyR_DokTyp=960 and  CDN.WysRelacje.WyR_DokLp&lt;&gt;0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdRekomendacjeDokumenty
    IF EXISTS(SELECT * FROM CDN.ProdRekomendacjeDokumenty JOIN deleted
            ON 
          deleted.ZaE_GIDNumer = CDN.ProdRekomendacjeDokumenty.PRED_DokNumer
      AND deleted.ZaE_GIDLp = CDN.ProdRekomendacjeDokumenty.PRED_DokLp
      AND (CDN.ProdRekomendacjeDokumenty.PRED_DokTyp=960)
            )
        DELETE CDN.ProdRekomendacjeDokumenty
        FROM CDN.ProdRekomendacjeDokumenty JOIN deleted
        ON 
          deleted.ZaE_GIDNumer = CDN.ProdRekomendacjeDokumenty.PRED_DokNumer
      AND deleted.ZaE_GIDLp = CDN.ProdRekomendacjeDokumenty.PRED_DokLp
      AND (CDN.ProdRekomendacjeDokumenty.PRED_DokTyp=960)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZamElem_InsertUpdateHandler
  ON CDN.ZamElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZaE_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ZaE_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaE_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ZamElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.ZaE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ZamElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaE_ReNNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.RecNag ON
                    inserted.ZaE_ReNNumer = CDN.RecNag.ReN_GIDNumer
              WHERE CDN.RecNag.ReN_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaE_ReNNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  RecNag) [ZamElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamElemAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamElemAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZamElemAlias_DeleteHandler
  ON CDN.ZamElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.ZaE_GIDTyp = CDN.ZamZamLinki.ZZL_ZSGidTyp
      AND deleted.ZaE_GIDNumer = CDN.ZamZamLinki.ZZL_ZSGidNumer
      AND deleted.ZaE_GIDLp = CDN.ZamZamLinki.ZZL_ZSGidLp
      AND (CDN.ZamZamLinki.ZZL_ZSGIDTyp=960)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.ZaE_GIDTyp = CDN.ZamZamLinki.ZZL_ZSGidTyp
      AND deleted.ZaE_GIDNumer = CDN.ZamZamLinki.ZZL_ZSGidNumer
      AND deleted.ZaE_GIDLp = CDN.ZamZamLinki.ZZL_ZSGidLp
      AND (CDN.ZamZamLinki.ZZL_ZSGIDTyp=960)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZaHZamElemNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZaHZamElemNoType */</I><BR>
ALTER TABLE CDN.ZamHistoriaZmian ADD CONSTRAINT FK_ZaHZamElemNoType
 FOREIGN KEY
   (
                          ZAH_GIDNumer                      
                         )
             REFERENCES CDN.ZamNag
                         (
                          ZaN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamHistoriaZmian_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamHistoriaZmian_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZamHistoriaZmian_InsertUpdateHandler
  ON CDN.ZamHistoriaZmian
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZaH_GIDNumer )  OR UPDATE( ZaH_GIDLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaH_GIDLp &gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.ZaH_GIDNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.ZaH_GIDLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.ZaH_GIDLp &gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [ZamHistoriaZmian_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZamNag_DeleteHandler
  ON CDN.ZamNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdPlanyProdukty
    IF EXISTS
       ( SELECT * FROM CDN.ProdPlanyProdukty JOIN deleted
          ON
                deleted.ZaN_GIDNumer = CDN.ProdPlanyProdukty.PPP_DokZrdNumer
       AND (CDN.ProdPlanyProdukty.PPP_DokZrdTyp = 960)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdPlanyProdukty) [ZamNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.ProdTechnologia
    IF EXISTS
       ( SELECT * FROM CDN.ProdTechnologia JOIN deleted
          ON
                deleted.ZaN_GIDNumer = CDN.ProdTechnologia.PTE_ZrdNumer
       AND (CDN.ProdTechnologia.PTE_ZrdTyp=960)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą ProdTechnologia) [ZamNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END
    -- obsługa sprawdzania relacji restrict do tabeli CDN.SrwUrzadzenia
    IF EXISTS
       ( SELECT * FROM CDN.SrwUrzadzenia JOIN deleted
          ON
                deleted.ZaN_GIDNumer = CDN.SrwUrzadzenia.SrU_DokNumer
            
       AND (CDN.SrwUrzadzenia.SrU_DokTyp=960)
       )
    BEGIN
      RAISERROR('#CDN_BLAD/##CDN_1=Nie można usunąć dokumentu bądź pozycji, ponieważ występuje powiązanie z urządzeniem serwisowym./# [ZamNag_DeleteHandler]', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdPlanyDokumenty
    IF EXISTS(SELECT * FROM CDN.ProdPlanyDokumenty JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.ProdPlanyDokumenty.PPD_DokNumer
      AND (CDN.ProdPlanyDokumenty.PPD_DokTyp=960)
            )
        DELETE CDN.ProdPlanyDokumenty
        FROM CDN.ProdPlanyDokumenty JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.ProdPlanyDokumenty.PPD_DokNumer
      AND (CDN.ProdPlanyDokumenty.PPD_DokTyp=960)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (CDN.DokZwiazane.DoZ_ZrdTyp=960 AND CDN.DokZwiazane.DoZ_ZrdLp=0)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.DokZwiazane.DoZ_ZRDNumer
      AND (CDN.DokZwiazane.DoZ_ZrdTyp=960 AND CDN.DokZwiazane.DoZ_ZrdLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DoZ_DokTyp=960 AND CDN.DokZwiazane.DoZ_DokLp=0)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND (CDN.DokZwiazane.DoZ_DokTyp=960 AND CDN.DokZwiazane.DoZ_DokLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=960)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=960)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WF_Procesy
    IF EXISTS(SELECT * FROM CDN.WF_Procesy JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (  CDN.WF_Procesy.WFP_OBITyp = 960)
            )
        DELETE CDN.WF_Procesy
        FROM CDN.WF_Procesy JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.WF_Procesy.WFP_OBINumer
      AND (  CDN.WF_Procesy.WFP_OBITyp = 960)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BstDokumenty
    IF EXISTS(SELECT * FROM CDN.BstDokumenty JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.BstDokumenty.BsD_DokNumer
      AND (CDN.BstDokumenty.BsD_DokTyp=960)
            )
        DELETE CDN.BstDokumenty
        FROM CDN.BstDokumenty JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.BstDokumenty.BsD_DokNumer
      AND (CDN.BstDokumenty.BsD_DokTyp=960)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (960,8832,8960,9344,9472,10880,11008,9473))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (960,8832,8960,9344,9472,10880,11008,9473))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.WysRelacje
    IF EXISTS(SELECT * FROM CDN.WysRelacje JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp=960 and  CDN.WysRelacje.WyR_DokLp=0)
            )
        DELETE CDN.WysRelacje
        FROM CDN.WysRelacje JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.WysRelacje.WYR_DokNumer
      AND (CDN.WysRelacje.WyR_DokTyp=960 and  CDN.WysRelacje.WyR_DokLp=0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=960 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_OBITyp=960 and CDN.Atrybuty.Atr_OBILp = 0 and CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Rezerwacje
    IF EXISTS(SELECT * FROM CDN.Rezerwacje JOIN deleted
            ON 
          deleted.ZaN_GIDNumer = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=960)
            )
        DELETE CDN.Rezerwacje
        FROM CDN.Rezerwacje JOIN deleted
        ON 
          deleted.ZaN_GIDNumer = CDN.Rezerwacje.Rez_ZrdNumer
      AND (CDN.Rezerwacje.Rez_ZrdTyp=960)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZamNag_InsertUpdateHandler
  ON CDN.ZamNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZaN_MagDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ZaN_MagDNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaN_MagDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ZaN_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaN_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_KnDTyp )  OR UPDATE( ZaN_KnDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZaN_KnDTyp = CDN.KntKarty.Knt_GIDTyp
                AND inserted.ZaN_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaN_KnDTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_KnSTypOdb )  OR UPDATE( ZaN_KnSNumerOdb )  OR UPDATE( ZaN_KnSLpOdb ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.ZaN_KnSTypOdb = CDN.KntOsoby.KnS_KntTyp
                AND inserted.ZaN_KnSNumerOdb = CDN.KntOsoby.KnS_KntNumer
                AND inserted.ZaN_KnSLpOdb = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.ZaN_KnSTypOdb,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnSNumerOdb,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnSLpOdb,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_KnSTypPlt )  OR UPDATE( ZaN_KnSNumerPlt )  OR UPDATE( ZaN_KnSLpPlt ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.ZaN_KnSTypPlt = CDN.KntOsoby.KnS_KntTyp
                AND inserted.ZaN_KnSNumerPlt = CDN.KntOsoby.KnS_KntNumer
                AND inserted.ZaN_KnSLpPlt = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.ZaN_KnSTypPlt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnSNumerPlt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnSLpPlt,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_PrjId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrjStruktura ON
                    inserted.ZaN_PrjId = CDN.PrjStruktura.PRJ_Id
              WHERE CDN.PrjStruktura.PRJ_Id IS NULL
                AND (
                          IsNull(inserted.ZaN_PrjId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrjStruktura) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaN_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZaN_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZaN_AkwTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_OpiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZaN_OpiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaN_OpiNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaN_AkwTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZaN_AkwNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.ZaN_AkwTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_FrSID ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.ZaN_FrSID = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.ZaN_FrSID,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_AdWTyp )  OR UPDATE( ZaN_AdWNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.ZaN_AdWTyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.ZaN_AdWNumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaN_AdWTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_AdWNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_KnSTypP )  OR UPDATE( ZaN_KnSNumerP )  OR UPDATE( ZaN_KnSLpP ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.ZaN_KnSTypP = CDN.KntOsoby.KnS_KntTyp
                AND inserted.ZaN_KnSNumerP = CDN.KntOsoby.KnS_KntNumer
                AND inserted.ZaN_KnSLpP = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL
                AND (
                          IsNull(inserted.ZaN_KnSTypP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnSNumerP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnSLpP,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_KnSTyp )  OR UPDATE( ZaN_KnSNumer )  OR UPDATE( ZaN_KnSLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaN_KnSTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.ZaN_KnSTyp = CDN.KntOsoby.KnS_KntTyp
                AND inserted.ZaN_KnSNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.ZaN_KnSLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.ZaN_KnSTyp=32)
                AND (
                          IsNull(inserted.ZaN_KnSTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnSNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnSLp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZaN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZaN_KntTyp=32)
                AND (
                          IsNull(inserted.ZaN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_KnATyp )  OR UPDATE( ZaN_KnANumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntAdresy ON
                    inserted.ZaN_KnATyp = CDN.KntAdresy.KnA_GIDTyp
                AND inserted.ZaN_KnANumer = CDN.KntAdresy.KnA_GIDNumer
              WHERE CDN.KntAdresy.KnA_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZaN_KnATyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZaN_KnANumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntAdresy) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_ZrodloPochodzeniaESklep ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaN_ZrodloPochodzeniaESklep&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.ZaN_ZrodloPochodzeniaESklep = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.ZaN_ZrodloPochodzeniaESklep&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_StatusPlatnosciPOS ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaN_StatusPlatnosciPOS&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.ZaN_StatusPlatnosciPOS = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.ZaN_StatusPlatnosciPOS&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZaN_StatusRealizacji ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaN_StatusRealizacji&gt;0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.ZaN_StatusRealizacji = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL AND (inserted.ZaN_StatusRealizacji&gt;0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [ZamNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZaPPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZaPPrimaryNoType */</I><BR>
ALTER TABLE CDN.ZamPlat ADD CONSTRAINT FK_ZaPPrimaryNoType
 FOREIGN KEY
   (
                          ZaP_GIDNumer                      
                         )
             REFERENCES CDN.ZamNag
                         (
                          ZaN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamPlat_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamPlat_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZamPlat_DeleteHandler
  ON CDN.ZamPlat
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZaP_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZaP_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.ZaP_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp = 960 and CDN.Atrybuty.Atr_OBISubLp = -8209)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZaP_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZaP_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.ZaP_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND (CDN.Atrybuty.Atr_OBITyp = 960 and CDN.Atrybuty.Atr_OBISubLp = -8209)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZaP_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZaP_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ZaP_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp = 960 and CDN.AtrybutyHist.Ath_OBISubLp = -8209)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZaP_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZaP_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ZaP_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND (CDN.AtrybutyHist.Ath_OBITyp = 960 and CDN.AtrybutyHist.Ath_OBISubLp = -8209)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamPlat_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamPlat_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZamPlat_InsertUpdateHandler
  ON CDN.ZamPlat
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZaP_TrNTyp )  OR UPDATE( ZaP_TrNNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZaP_TrNTyp &lt;&gt; 0 and inserted.ZaP_TrNNumer &lt;&gt; 0)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraNag ON
                    inserted.ZaP_TrNTyp = CDN.TraNag.TrN_GIDTyp
                AND inserted.ZaP_TrNNumer = CDN.TraNag.TrN_GIDNumer
              WHERE CDN.TraNag.TrN_GIDNumer IS NULL AND (inserted.ZaP_TrNTyp &lt;&gt; 0 and inserted.ZaP_TrNNumer &lt;&gt; 0)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraNag) [ZamPlat_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZaRPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZaRPrimary */</I><BR>
ALTER TABLE CDN.ZamRealizacja ADD CONSTRAINT FK_ZaRPrimary
 FOREIGN KEY
   (
                          ZaR_ZamGID                        
                         )
             REFERENCES CDN.ZamNag
                         (
                          ZaN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZaVPrimaryNoType"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZaVPrimaryNoType */</I><BR>
ALTER TABLE CDN.ZamVat ADD CONSTRAINT FK_ZaVPrimaryNoType
 FOREIGN KEY
   (
                          ZaV_GIDNumer                      
                         )
             REFERENCES CDN.ZamNag
                         (
                          ZaN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZamZamLinki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZamZamLinki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZamZamLinki_InsertUpdateHandler
  ON CDN.ZamZamLinki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZZL_ZZGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZZGIDTyp=4704)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcUrz ON
                    inserted.ZZL_ZZGidNumer = CDN.SrwZlcUrz.SZU_Id
              WHERE CDN.SrwZlcUrz.SZU_Id IS NULL AND (inserted.ZZL_ZZGIDTyp=4704)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcUrz) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZZL_ZZGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZZGIDTyp=4702)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcCzynnosci ON
                    inserted.ZZL_ZZGidNumer = CDN.SrwZlcCzynnosci.SZC_Id
              WHERE CDN.SrwZlcCzynnosci.SZC_Id IS NULL AND (inserted.ZZL_ZZGIDTyp=4702)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcCzynnosci) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZZL_ZSGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZSGIDTyp=4703)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrwZlcSkladniki ON
                    inserted.ZZL_ZSGidNumer = CDN.SrwZlcSkladniki.SZS_Id
              WHERE CDN.SrwZlcSkladniki.SZS_Id IS NULL AND (inserted.ZZL_ZSGIDTyp=4703)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrwZlcSkladniki) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZZL_ZSGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZSGIDTyp=14345)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdCzynnosci ON
                    inserted.ZZL_ZSGidNumer = CDN.ProdCzynnosci.PCZ_Id
              WHERE CDN.ProdCzynnosci.PCZ_Id IS NULL AND (inserted.ZZL_ZSGIDTyp=14345)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdCzynnosci) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZZL_ZZGidNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZZGIDTyp=14343)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdZlecElem ON
                    inserted.ZZL_ZZGidNumer = CDN.ProdZlecElem.PZE_Id
              WHERE CDN.ProdZlecElem.PZE_Id IS NULL AND (inserted.ZZL_ZZGIDTyp=14343)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdZlecElem) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZZL_ZZGidTyp )  OR UPDATE( ZZL_ZZGidNumer )  OR UPDATE( ZZL_ZZGidLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZZGIDTyp=4192 OR inserted.ZZL_ZZGIDTyp=4240)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcElem ON
                    inserted.ZZL_ZZGidTyp = CDN.ZlcElem.ZcE_GIDTyp
                AND inserted.ZZL_ZZGidNumer = CDN.ZlcElem.ZcE_GIDNumer
                AND inserted.ZZL_ZZGidLp = CDN.ZlcElem.ZcE_GIDLp
              WHERE CDN.ZlcElem.ZcE_GIDLp IS NULL AND (inserted.ZZL_ZZGIDTyp=4192 OR inserted.ZZL_ZZGIDTyp=4240)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcElem) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZZL_ZSGidTyp )  OR UPDATE( ZZL_ZSGidNumer )  OR UPDATE( ZZL_ZSGidLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZSGIDTyp=4192 OR inserted.ZZL_ZSGIDTyp=4240)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZlcElem ON
                    inserted.ZZL_ZSGidTyp = CDN.ZlcElem.ZcE_GIDTyp
                AND inserted.ZZL_ZSGidNumer = CDN.ZlcElem.ZcE_GIDNumer
                AND inserted.ZZL_ZSGidLp = CDN.ZlcElem.ZcE_GIDLp
              WHERE CDN.ZlcElem.ZcE_GIDLp IS NULL AND (inserted.ZZL_ZSGIDTyp=4192 OR inserted.ZZL_ZSGIDTyp=4240)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZlcElem) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZZL_ZZGidTyp )  OR UPDATE( ZZL_ZZGidNumer )  OR UPDATE( ZZL_ZZGidLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZZGIDTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.ZZL_ZZGidTyp = CDN.ZamElem.ZaE_GIDTyp
                AND inserted.ZZL_ZZGidNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.ZZL_ZZGidLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.ZZL_ZZGIDTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZZL_ZSGidTyp )  OR UPDATE( ZZL_ZSGidNumer )  OR UPDATE( ZZL_ZSGidLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZZL_ZSGIDTyp=960)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ZamElem ON
                    inserted.ZZL_ZSGidTyp = CDN.ZamElem.ZaE_GIDTyp
                AND inserted.ZZL_ZSGidNumer = CDN.ZamElem.ZaE_GIDNumer
                AND inserted.ZZL_ZSGidLp = CDN.ZamElem.ZaE_GIDLp
              WHERE CDN.ZamElem.ZaE_GIDLp IS NULL AND (inserted.ZZL_ZSGIDTyp=960)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ZamElem) [ZamZamLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_KAZOperacja"></A><PRE>
          <FONT SIZE="2"><I>/* FK_KAZOperacja */</I><BR>
ALTER TABLE CDN.Zapisy ADD CONSTRAINT FK_KAZOperacja
 FOREIGN KEY
   (
                          KAZ_KAONumer                      ,
                          KAZ_KAOLp                         
                         )
             REFERENCES CDN.Operacje
                         (
                          KAO_GIDNumer                      ,
                          KAO_GIDLp                         
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Zapisy_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Zapisy_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Zapisy_DeleteHandler
  ON CDN.Zapisy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rozliczenia
    IF EXISTS
       ( SELECT * FROM CDN.Rozliczenia JOIN deleted
          ON
                deleted.KAZ_GIDNumer = CDN.Rozliczenia.R2_Dok1Numer
       AND (CDN.Rozliczenia.R2_Dok1Typ=784)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rozliczenia) [Zapisy_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END

    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.KAZ_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 784)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.KAZ_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 784)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.KAZ_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=784)
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.KAZ_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp=784)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.KAZ_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=784)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.KAZ_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=784)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.KAZ_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=784)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.KAZ_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=784)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Zapisy_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Zapisy_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Zapisy_InsertUpdateHandler
  ON CDN.Zapisy
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( KAZ_LokataTypId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Slowniki ON
                    inserted.KAZ_LokataTypId = CDN.Slowniki.SLW_ID
              WHERE CDN.Slowniki.SLW_ID IS NULL
                AND (
                          IsNull(inserted.KAZ_LokataTypId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Slowniki) [Zapisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAZ_KNDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KAZ_KNDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.KAZ_KNDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Zapisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAZ_KRPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KAZ_KRPTyp=752)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Rejestry ON
                    inserted.KAZ_KRPNumer = CDN.Rejestry.KAR_GIDNumer
              WHERE CDN.Rejestry.KAR_GIDNumer IS NULL AND (inserted.KAZ_KRPTyp=752)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Rejestry) [Zapisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAZ_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KAZ_KNTTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.KAZ_KNTNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.KAZ_KNTTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Zapisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAZ_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KAZ_KNTTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.KAZ_KNTNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.KAZ_KNTTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Zapisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAZ_KRPNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.KAZ_KRPTyp=800)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Raporty ON
                    inserted.KAZ_KRPNumer = CDN.Raporty.KRP_GIDNumer
              WHERE CDN.Raporty.KRP_GIDNumer IS NULL AND (inserted.KAZ_KRPTyp=800)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Raporty) [Zapisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( KAZ_BbonId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Bony ON
                    inserted.KAZ_BbonId = CDN.Bony.Bbon_Id
              WHERE CDN.Bony.Bbon_Id IS NULL
                AND (
                          IsNull(inserted.KAZ_BbonId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Bony) [Zapisy_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZapisyAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZapisyAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZapisyAlias_DeleteHandler
  ON CDN.Zapisy
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.Rozliczenia
    IF EXISTS
       ( SELECT * FROM CDN.Rozliczenia JOIN deleted
          ON
                deleted.KAZ_GIDNumer = CDN.Rozliczenia.R2_Dok2Numer
       AND (CDN.Rozliczenia.R2_Dok2Typ=784)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą Rozliczenia) [ZapisyAlias_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZKDPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZKDPrimary */</I><BR>
ALTER TABLE CDN.ZestKSDef ADD CONSTRAINT FK_ZKDPrimary
 FOREIGN KEY
   (
                          ZKD_GIDNumer                      ,
                          ZKD_GIDLp                         
                         )
             REFERENCES CDN.ZestKSElem
                         (
                          ZKE_GIDNumer                      ,
                          ZKE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZestKSDef_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZestKSDef_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZestKSDef_InsertUpdateHandler
  ON CDN.ZestKSDef
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZKD_SIDNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZKD_SIDTyp=2392)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SISDefinicje ON
                    inserted.ZKD_SIDNumer = CDN.SISDefinicje.SID_GIDNumer
              WHERE CDN.SISDefinicje.SID_GIDNumer IS NULL AND (inserted.ZKD_SIDTyp=2392)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SISDefinicje) [ZestKSDef_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZKDKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZKDKPrimary */</I><BR>
ALTER TABLE CDN.ZestKSDefKonta ADD CONSTRAINT FK_ZKDKPrimary
 FOREIGN KEY
   (
                          ZKDK_GIDNumer                      ,
                          ZKDK_GIDLp                         ,
                          ZKDK_SubGIDLp                      
                         )
             REFERENCES CDN.ZestKSDef
                         (
                          ZKD_GIDNumer                      ,
                          ZKD_GIDLp                         ,
                          ZKD_SubGIDLp                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZKEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZKEPrimary */</I><BR>
ALTER TABLE CDN.ZestKSElem ADD CONSTRAINT FK_ZKEPrimary
 FOREIGN KEY
   (
                          ZKE_GIDNumer                      
                         )
             REFERENCES CDN.ZestKSNag
                         (
                          ZKN_GIDNumer                      
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZKKPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZKKPrimary */</I><BR>
ALTER TABLE CDN.ZestKSKolumny ADD CONSTRAINT FK_ZKKPrimary
 FOREIGN KEY
   (
                          ZKK_GIDNumer                      
                         )
             REFERENCES CDN.ZestKSWidok
                         (
                          ZKO_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZestKSNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZestKSNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZestKSNag_DeleteHandler
  ON CDN.ZestKSNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.ZKN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (2784))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.ZKN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in  (2784))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZKWPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZKWPrimary */</I><BR>
ALTER TABLE CDN.ZestKSWyniki ADD CONSTRAINT FK_ZKWPrimary
 FOREIGN KEY
   (
                          ZKW_ZKENumer                      ,
                          ZKW_ZKELp                         
                         )
             REFERENCES CDN.ZestKSElem
                         (
                          ZKE_GIDNumer                      ,
                          ZKE_GIDLp                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZWDPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZWDPrimary */</I><BR>
ALTER TABLE CDN.ZestKSWynikiDef ADD CONSTRAINT FK_ZWDPrimary
 FOREIGN KEY
   (
                          ZWD_ZKWNumer                      ,
                          ZWD_ZKWLp                         ,
                          ZWD_ZKWDataOd                     ,
                          ZWD_ZKWDataDo                     ,
                          ZWD_ZKWBufor                      
                         )
             REFERENCES CDN.ZestKSWyniki
                         (
                          ZKW_ZKENumer                      ,
                          ZKW_ZKELp                         ,
                          ZKW_DataOd                        ,
                          ZKW_DataDo                        ,
                          ZKW_Bufor                         
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZKZPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZKZPrimary */</I><BR>
ALTER TABLE CDN.ZestKSZmienne ADD CONSTRAINT FK_ZKZPrimary
 FOREIGN KEY
   (
                          ZKZ_GIDNumer                      
                         )
             REFERENCES CDN.ZestKSWidok
                         (
                          ZKO_GIDNumer                      
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Zgody_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Zgody_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.Zgody_DeleteHandler
  ON CDN.Zgody
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.Zgo_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_ObiTyp = 6560 and CDN.Atrybuty.Atr_ObiLp = 0 and  CDN.Atrybuty.Atr_ObiSubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.Zgo_Id = CDN.Atrybuty.Atr_ObiNumer
      AND (CDN.Atrybuty.Atr_ObiTyp = 6560 and CDN.Atrybuty.Atr_ObiLp = 0 and  CDN.Atrybuty.Atr_ObiSubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.Zgo_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 6560)
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.Zgo_Id = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp = 6560)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="Zgody_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* Zgody_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.Zgody_InsertUpdateHandler
  ON CDN.Zgody
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( Zgo_ObiNumer )  OR UPDATE( Zgo_ObiLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Zgo_ObiTyp = 8211)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.Zgo_ObiNumer = CDN.KntOsoby.KnS_KntNumer
                AND inserted.Zgo_ObiLp = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.Zgo_ObiTyp = 8211)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [Zgody_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zgo_Regulamin ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.DaneBinarne ON
                    inserted.Zgo_Regulamin = CDN.DaneBinarne.DAB_ID
              WHERE CDN.DaneBinarne.DAB_ID IS NULL
                AND (
                          IsNull(inserted.Zgo_Regulamin,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  DaneBinarne) [Zgody_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zgo_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Zgo_ObiTyp = 32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.Zgo_ObiNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.Zgo_ObiTyp = 32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [Zgody_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( Zgo_ObiNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.Zgo_ObiTyp = 944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.Zgo_ObiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.Zgo_ObiTyp = 944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [Zgody_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZcEPrimary"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZcEPrimary */</I><BR>
ALTER TABLE CDN.ZlcElem ADD CONSTRAINT FK_ZcEPrimary
 FOREIGN KEY
   (
                          ZcE_GIDNumer                      
                         )
             REFERENCES CDN.ZlcNag
                         (
                          ZcN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZlcElem_DeleteHandler
  ON CDN.ZlcElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DokZwiazane
    IF EXISTS(SELECT * FROM CDN.DokZwiazane JOIN deleted
            ON 
          deleted.ZcE_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND deleted.ZcE_GIDLp = CDN.DokZwiazane.DoZ_DOKLp
      AND (CDN.DokZwiazane.DoZ_DokTyp=4192)
            )
        DELETE CDN.DokZwiazane
        FROM CDN.DokZwiazane JOIN deleted
        ON 
          deleted.ZcE_GIDNumer = CDN.DokZwiazane.DoZ_DOKNumer
      AND deleted.ZcE_GIDLp = CDN.DokZwiazane.DoZ_DOKLp
      AND (CDN.DokZwiazane.DoZ_DokTyp=4192)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.ZcE_GIDTyp = CDN.ZamZamLinki.ZZL_ZZGidTyp
      AND deleted.ZcE_GIDNumer = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND deleted.ZcE_GIDLp = CDN.ZamZamLinki.ZZL_ZZGidLp
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=4192 OR CDN.ZamZamLinki.ZZL_ZZGIDTyp=4240)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.ZcE_GIDTyp = CDN.ZamZamLinki.ZZL_ZZGidTyp
      AND deleted.ZcE_GIDNumer = CDN.ZamZamLinki.ZZL_ZZGidNumer
      AND deleted.ZcE_GIDLp = CDN.ZamZamLinki.ZZL_ZZGidLp
      AND (CDN.ZamZamLinki.ZZL_ZZGIDTyp=4192 OR CDN.ZamZamLinki.ZZL_ZZGIDTyp=4240)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZcE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZcE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.ZcE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( (CDN.Atrybuty.Atr_OBITyp=4192 or CDN.Atrybuty.Atr_OBITyp=4208 or           CDN.Atrybuty.Atr_OBITyp=4240 ) and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and  CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZcE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZcE_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND deleted.ZcE_GIDLp = CDN.Atrybuty.Atr_ObiLp
      AND ( (CDN.Atrybuty.Atr_OBITyp=4192 or CDN.Atrybuty.Atr_OBITyp=4208 or           CDN.Atrybuty.Atr_OBITyp=4240 ) and CDN.Atrybuty.Atr_OBILp &lt;&gt; 0 and  CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZcE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZcE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ZcE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=4192 or CDN.AtrybutyHist.Ath_OBITyp=4208 or           CDN.AtrybutyHist.Ath_OBITyp=4240 ) and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and  CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZcE_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZcE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND deleted.ZcE_GIDLp = CDN.AtrybutyHist.AtH_ObiLp
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=4192 or CDN.AtrybutyHist.Ath_OBITyp=4208 or           CDN.AtrybutyHist.Ath_OBITyp=4240 ) and CDN.AtrybutyHist.Ath_OBILp &lt;&gt; 0 and  CDN.AtrybutyHist.Ath_OBISubLp = 0)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZlcElem_InsertUpdateHandler
  ON CDN.ZlcElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZcE_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ZcE_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZcE_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ZlcElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcE_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZcE_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZcE_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZcE_KntTyp=32)
                AND (
                          IsNull(inserted.ZcE_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZlcElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcE_TwrNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.ZcE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZcE_TwrNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ZlcElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcElemAlias_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcElemAlias_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZlcElemAlias_DeleteHandler
  ON CDN.ZlcElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ZamZamLinki
    IF EXISTS(SELECT * FROM CDN.ZamZamLinki JOIN deleted
            ON 
          deleted.ZcE_GIDTyp = CDN.ZamZamLinki.ZZL_ZSGidTyp
      AND deleted.ZcE_GIDNumer = CDN.ZamZamLinki.ZZL_ZSGidNumer
      AND deleted.ZcE_GIDLp = CDN.ZamZamLinki.ZZL_ZSGidLp
      AND (CDN.ZamZamLinki.ZZL_ZSGIDTyp=4192 OR CDN.ZamZamLinki.ZZL_ZSGIDTyp=4240)
            )
        DELETE CDN.ZamZamLinki
        FROM CDN.ZamZamLinki JOIN deleted
        ON 
          deleted.ZcE_GIDTyp = CDN.ZamZamLinki.ZZL_ZSGidTyp
      AND deleted.ZcE_GIDNumer = CDN.ZamZamLinki.ZZL_ZSGidNumer
      AND deleted.ZcE_GIDLp = CDN.ZamZamLinki.ZZL_ZSGidLp
      AND (CDN.ZamZamLinki.ZZL_ZSGIDTyp=4192 OR CDN.ZamZamLinki.ZZL_ZSGIDTyp=4240)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZlcNag_DeleteHandler
  ON CDN.ZlcNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.ZcN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (4192,4208))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.ZcN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (4192,4208))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.BstDokumenty
    IF EXISTS(SELECT * FROM CDN.BstDokumenty JOIN deleted
            ON 
          deleted.ZcN_GIDNumer = CDN.BstDokumenty.BsD_DokNumer
      AND (CDN.BstDokumenty.BsD_DokTyp=4192)
            )
        DELETE CDN.BstDokumenty
        FROM CDN.BstDokumenty JOIN deleted
        ON 
          deleted.ZcN_GIDNumer = CDN.BstDokumenty.BsD_DokNumer
      AND (CDN.BstDokumenty.BsD_DokTyp=4192)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.ZcN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.ZcN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4192,4208))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.ZcN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.ZcN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4192,4208))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZcN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZcN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( (CDN.Atrybuty.Atr_OBITyp=4192 or CDN.Atrybuty.Atr_OBITyp=4208 or           CDN.Atrybuty.Atr_OBITyp=4240 ) and CDN.Atrybuty.Atr_OBILp = 0 and  CDN.Atrybuty.Atr_OBISubLp = 0)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZcN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZcN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( (CDN.Atrybuty.Atr_OBITyp=4192 or CDN.Atrybuty.Atr_OBITyp=4208 or           CDN.Atrybuty.Atr_OBITyp=4240 ) and CDN.Atrybuty.Atr_OBILp = 0 and  CDN.Atrybuty.Atr_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZcN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZcN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=4192 or CDN.AtrybutyHist.Ath_OBITyp=4208 or           CDN.AtrybutyHist.Ath_OBITyp=4240 ) and CDN.AtrybutyHist.Ath_OBILp = 0 and  CDN.AtrybutyHist.Ath_OBISubLp = 0)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZcN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZcN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=4192 or CDN.AtrybutyHist.Ath_OBITyp=4208 or           CDN.AtrybutyHist.Ath_OBITyp=4240 ) and CDN.AtrybutyHist.Ath_OBILp = 0 and  CDN.AtrybutyHist.Ath_OBISubLp = 0)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.ProdDoPrzeliczenia
    IF EXISTS(SELECT * FROM CDN.ProdDoPrzeliczenia JOIN deleted
            ON 
          deleted.ZcN_GIDNumer = CDN.ProdDoPrzeliczenia.PDL_GIDNumer
      AND (CDN.ProdDoPrzeliczenia.PDL_GIDTyp = 4192)
            )
        DELETE CDN.ProdDoPrzeliczenia
        FROM CDN.ProdDoPrzeliczenia JOIN deleted
        ON 
          deleted.ZcN_GIDNumer = CDN.ProdDoPrzeliczenia.PDL_GIDNumer
      AND (CDN.ProdDoPrzeliczenia.PDL_GIDTyp = 4192)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZlcNag_InsertUpdateHandler
  ON CDN.ZlcNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZcN_MaDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ZcN_MaDNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZcN_MaDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcN_MaZNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ZcN_MaZNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZcN_MaZNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZcN_AkwTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZcN_AkwNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.ZcN_AkwTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZcN_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZcN_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZcN_AkwTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcN_OpiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZcN_OpiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZcN_OpiNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcN_FrSId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.ZcN_FrSId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.ZcN_FrSId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcN_KntNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZcN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZcN_KntNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZcN_KntTyp=32)
                AND (
                          IsNull(inserted.ZcN_KntNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZcN_KnDNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZcN_KnDNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZcN_KnDNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZlcNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZREZRN"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZREZRN */</I><BR>
ALTER TABLE CDN.ZlcRemElem ADD CONSTRAINT FK_ZREZRN
 FOREIGN KEY
   (
                          ZRE_ZrNNumer                      
                         )
             REFERENCES CDN.ZlcRemNag
                         (
                          ZRN_GIDNumer   
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcRemElem_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcRemElem_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZlcRemElem_DeleteHandler
  ON CDN.ZlcRemElem
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZRE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4351)
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZRE_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND ( CDN.Atrybuty.Atr_OBITyp=4351)
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZRE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4351)
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZRE_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( CDN.AtrybutyHist.Ath_OBITyp=4351)
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcRemElem_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcRemElem_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZlcRemElem_InsertUpdateHandler
  ON CDN.ZlcRemElem
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZRE_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZrE_TwrTyp=14337)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.ProdObiekty ON
                    inserted.ZRE_TwrNumer = CDN.ProdObiekty.POB_Id
              WHERE CDN.ProdObiekty.POB_Id IS NULL AND (inserted.ZrE_TwrTyp=14337)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  ProdObiekty) [ZlcRemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRE_TwrNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZrE_TwrTyp=16)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TwrKarty ON
                    inserted.ZRE_TwrNumer = CDN.TwrKarty.Twr_GIDNumer
              WHERE CDN.TwrKarty.Twr_GIDNumer IS NULL AND (inserted.ZrE_TwrTyp=16)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TwrKarty) [ZlcRemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRE_SsWId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsWyposazenia ON
                    inserted.ZRE_SsWId = CDN.SrsWyposazenia.SsW_Id
              WHERE CDN.SrsWyposazenia.SsW_Id IS NULL
                AND (
                          IsNull(inserted.ZRE_SsWId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsWyposazenia) [ZlcRemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRE_KNTNumerO ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZRE_KNTNumerO = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRE_KNTNumerO,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZlcRemElem_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcRemNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcRemNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZlcRemNag_DeleteHandler
  ON CDN.ZlcRemNag
  FOR DELETE
AS
SET NOCOUNT ON


    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.CRMDokumentyLinki
    IF EXISTS(SELECT * FROM CDN.CRMDokumentyLinki JOIN deleted
            ON 
          deleted.ZRN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (4345,4346))
            )
        DELETE CDN.CRMDokumentyLinki
        FROM CDN.CRMDokumentyLinki JOIN deleted
        ON 
          deleted.ZRN_GIDNumer = CDN.CRMDokumentyLinki.CDL_DokNumer
      AND (CDN.CRMDokumentyLinki.CDL_DokTyp in (4345,4346))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.DaneObiekty
    IF EXISTS(SELECT * FROM CDN.DaneObiekty JOIN deleted
            ON 
          deleted.ZRN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.ZRN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4345,4346))
            )
        DELETE CDN.DaneObiekty
        FROM CDN.DaneObiekty JOIN deleted
        ON 
          deleted.ZRN_GIDTyp = CDN.DaneObiekty.DAO_ObiTyp
      AND deleted.ZRN_GIDNumer = CDN.DaneObiekty.DAO_ObiNumer
      AND (CDN.DaneObiekty.DAO_ObiTyp in (4345,4346))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.Atrybuty
    IF EXISTS(SELECT * FROM CDN.Atrybuty JOIN deleted
            ON 
          deleted.ZRN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZRN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( (CDN.Atrybuty.Atr_OBITyp=4345 or CDN.Atrybuty.Atr_OBITyp=4346 ))
            )
        DELETE CDN.Atrybuty
        FROM CDN.Atrybuty JOIN deleted
        ON 
          deleted.ZRN_GIDNumer = CDN.Atrybuty.Atr_ObiNumer
      AND deleted.ZRN_GIDTyp = CDN.Atrybuty.Atr_ObiTyp
      AND ( (CDN.Atrybuty.Atr_OBITyp=4345 or CDN.Atrybuty.Atr_OBITyp=4346 ))
    
    -- obsługa kaskadowego kasowania wierszy z tabeli CDN.AtrybutyHist
    IF EXISTS(SELECT * FROM CDN.AtrybutyHist JOIN deleted
            ON 
          deleted.ZRN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZRN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=4345 or CDN.AtrybutyHist.Ath_OBITyp=4346 ))
            )
        DELETE CDN.AtrybutyHist
        FROM CDN.AtrybutyHist JOIN deleted
        ON 
          deleted.ZRN_GIDTyp = CDN.AtrybutyHist.AtH_ObiTyp
      AND deleted.ZRN_GIDNumer = CDN.AtrybutyHist.AtH_ObiNumer
      AND ( (CDN.AtrybutyHist.Ath_OBITyp=4345 or CDN.AtrybutyHist.Ath_OBITyp=4346 ))
    

SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcRemNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcRemNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZlcRemNag_InsertUpdateHandler
  ON CDN.ZlcRemNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZRN_MagNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.Magazyny ON
                    inserted.ZRN_MagNumer = CDN.Magazyny.Mag_GIDNumer
              WHERE CDN.Magazyny.Mag_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRN_MagNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  Magazyny) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRN_KNONumerZ )  OR UPDATE( ZRN_KNOLpZ ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZRN_KNOTypZ=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntOsoby ON
                    inserted.ZRN_KNONumerZ = CDN.KntOsoby.KnS_KntNumer
                AND inserted.ZRN_KNOLpZ = CDN.KntOsoby.KnS_KntLp
              WHERE CDN.KntOsoby.KnS_KntLp IS NULL AND (inserted.ZRN_KNOTypZ=32)
                AND (
                          IsNull(inserted.ZRN_KNONumerZ,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZRN_KNOLpZ,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntOsoby) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRN_OpiNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZRN_OpiNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRN_OpiNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZrN_AkwTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZRN_AkwNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZrN_AkwTyp=32)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRN_AkwNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZrN_AkwTyp=944)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.PrcKarty ON
                    inserted.ZRN_AkwNumer = CDN.PrcKarty.Prc_GIDNumer
              WHERE CDN.PrcKarty.Prc_GIDNumer IS NULL AND (inserted.ZrN_AkwTyp=944)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  PrcKarty) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRN_FrSId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.ZRN_FrSId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.ZRN_FrSId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRN_KNTNumer ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZRN_KntTyp=32)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZRN_KNTNumer = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL AND (inserted.ZRN_KntTyp=32)
                AND (
                          IsNull(inserted.ZRN_KNTNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRN_KNTNumerO ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.KntKarty ON
                    inserted.ZRN_KNTNumerO = CDN.KntKarty.Knt_GIDNumer
              WHERE CDN.KntKarty.Knt_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRN_KNTNumerO,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  KntKarty) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZRN_SOBTyp )  OR UPDATE( ZRN_SOBNumer ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.SrsObiekty ON
                    inserted.ZRN_SOBTyp = CDN.SrsObiekty.SOb_GIDTyp
                AND inserted.ZRN_SOBNumer = CDN.SrsObiekty.SOb_GIDNumer
              WHERE CDN.SrsObiekty.SOb_GIDNumer IS NULL
                AND (
                          IsNull(inserted.ZRN_SOBTyp,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                      OR  IsNull(inserted.ZRN_SOBNumer,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  SrsObiekty) [ZlcRemNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlcTrsLinki_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlcTrsLinki_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZlcTrsLinki_InsertUpdateHandler
  ON CDN.ZlcTrsLinki
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZTL_PWTRSTyp )  OR UPDATE( ZTL_PWTRSNumer )  OR UPDATE( ZTL_PWTRSLp )  OR UPDATE( ZTL_PWSubTRSLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZTL_PWTRSTyp=1617)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraSElem ON
                    inserted.ZTL_PWTRSTyp = CDN.TraSElem.TrS_GIDTyp
                AND inserted.ZTL_PWTRSNumer = CDN.TraSElem.TrS_GIDNumer
                AND inserted.ZTL_PWTRSLp = CDN.TraSElem.TrS_GIDLp
                AND inserted.ZTL_PWSubTRSLp = CDN.TraSElem.TrS_SubGIDLp
              WHERE CDN.TraSElem.TrS_SubGIDLp IS NULL AND (inserted.ZTL_PWTRSTyp=1617)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraSElem) [ZlcTrsLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZTL_RWTRSTyp )  OR UPDATE( ZTL_RWTRSNumer )  OR UPDATE( ZTL_RWTRSLp )  OR UPDATE( ZTL_RWSubTRSLp ) 
  BEGIN
    IF EXISTS (SELECT * FROM inserted WHERE inserted.ZTL_RWTRSTyp=1616)
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.TraSElem ON
                    inserted.ZTL_RWTRSTyp = CDN.TraSElem.TrS_GIDTyp
                AND inserted.ZTL_RWTRSNumer = CDN.TraSElem.TrS_GIDNumer
                AND inserted.ZTL_RWTRSLp = CDN.TraSElem.TrS_GIDLp
                AND inserted.ZTL_RWSubTRSLp = CDN.TraSElem.TrS_SubGIDLp
              WHERE CDN.TraSElem.TrS_SubGIDLp IS NULL AND (inserted.ZTL_RWTRSTyp=1616)
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  TraSElem) [ZlcTrsLinki_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZWENaglowek"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZWENaglowek */</I><BR>
ALTER TABLE CDN.ZlecWewElem ADD CONSTRAINT FK_ZWENaglowek
 FOREIGN KEY
   (
                          ZWE_ZWNId                         
                         )
             REFERENCES CDN.ZlecWewNag
                         (
                          ZWN_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZWEOperator"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZWEOperator */</I><BR>
ALTER TABLE CDN.ZlecWewElem ADD CONSTRAINT FK_ZWEOperator
 FOREIGN KEY
   (
                          ZWE_OpeNumer                      
                         )
             REFERENCES CDN.OpeKarty
                         (
                          Ope_GIDNumer   
   )
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlecWewNag_DeleteHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlecWewNag_DeleteHandler */</I><BR>
CREATE TRIGGER CDN.ZlecWewNag_DeleteHandler
  ON CDN.ZlecWewNag
  FOR DELETE
AS
SET NOCOUNT ON

    -- obsługa sprawdzania relacji restrict do tabeli CDN.WysKoszty
    IF EXISTS
       ( SELECT * FROM CDN.WysKoszty JOIN deleted
          ON
                deleted.ZWN_GIDTyp = CDN.WysKoszty.WyK_DokTyp
            AND deleted.ZWN_GIDNumer = CDN.WysKoszty.WyK_DokNumer
       AND (CDN.WysKoszty.WyK_DokTyp=4336)
       )
    BEGIN
      RAISERROR('Istnieją zapisy powiązane z modyfikowanym rekordem (powiązanie z tabelą WysKoszty) [ZlecWewNag_DeleteHandler]. ', 16, 1)
      ROLLBACK TRAN
      SET NOCOUNT OFF
      RETURN
    END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="ZlecWewNag_InsertUpdateHandler"></A><PRE>
          <FONT SIZE="2"><I>/* ZlecWewNag_InsertUpdateHandler */</I><BR>
CREATE TRIGGER CDN.ZlecWewNag_InsertUpdateHandler
  ON CDN.ZlecWewNag
  FOR INSERT,UPDATE
AS
SET NOCOUNT ON


  IF  UPDATE( ZWN_MPKZlecId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.ZWN_MPKZlecId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.ZWN_MPKZlecId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ZlecWewNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END

  IF  UPDATE( ZWN_MPKWykId ) 
  BEGIN
        -- Sprawdzenie obecności wierszy w tabeli nadrzędnej
        IF EXISTS
           ( SELECT * FROM inserted LEFT OUTER JOIN CDN.FrmStruktura ON
                    inserted.ZWN_MPKWykId = CDN.FrmStruktura.FRS_Id
              WHERE CDN.FrmStruktura.FRS_Id IS NULL
                AND (
                          IsNull(inserted.ZWN_MPKWykId,0) &lt;&gt; 0            -- Jeżeli pola mają wartości NULL lub 0 to nie sprawdzamy relacji
                    )
           )
        BEGIN
          RAISERROR('Nie istnieje zapis w tabeli nadrzędnej (powiązanie z tabelą  FrmStruktura) [ZlecWewNag_InsertUpdateHandler]. ', 16, 1)
          ROLLBACK TRAN
          SET NOCOUNT OFF
          RETURN
        END
  END


SET NOCOUNT OFF

</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
<DIV CLASS="TextInfo">
      <P><A name="FK_ZprPrmId"></A><PRE>
          <FONT SIZE="2"><I>/* FK_ZprPrmId */</I><BR>
ALTER TABLE CDN.ZstPromocje ADD CONSTRAINT FK_ZprPrmId
 FOREIGN KEY
   (
                          ZPR_PrmID                         
                         )
             REFERENCES CDN.PrmKarty
                         (
                          PRM_Id                            
   )
 ON DELETE CASCADE
 ;
</FONT>
        </PRE>
      </P>
      <HR>
    </DIV>
</BODY>
</HTML>