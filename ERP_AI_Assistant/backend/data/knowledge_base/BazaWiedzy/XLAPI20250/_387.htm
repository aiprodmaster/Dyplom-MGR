<html>

<head>
  <title> Prototyp i opis dzia³ania funkcji</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1250">
  <meta name="GENERATOR" content="Macrobject Word-2-CHM Pro">
  <link rel="stylesheet" href="default.css" type="text/css" />
  <link rel="stylesheet" href="macrobject.css" type="text/css">
</head>

<body>


<div class=Section1>

<h5><a name=Bookmark368></a><span style='mso-bidi-font-family:"Times New Roman"'>Prototyp i opis dzia³ania funkcji</span><span style='mso-bidi-font-family: "Times New Roman"'><o:p></o:p></span></h5>

<p class=MsoNormal><span style='color:black'>Funkcja zmienia aktualny adres
kontrahenta. Kontrahent jest pobierany w pierwszej kolejnoœci na podstawie pól <span
class=SpellE>KntTyp</span>, <span class=SpellE>KntNumer</span>, jeœli ich nie
wype³niono pobierany jest na podstawie pola Akronim. Przy pomocy funkcji <span
class=SpellE>XLZmienAdres</span> jest mo¿liwoœæ zmiany akronimu na adresie. W
tym celu nale¿y wype³niæ pola <span class=SpellE>KntTyp</span>, <span
class=SpellE>KntNumer</span> oraz pole Akronim wartoœci¹ nowego akronimu. W
przypadku zmiany akronimu na adresie zmieniony zostaje tak¿e akronim
kontrahenta.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Pole <span
class=SpellE>CharsetANSI</span> - s³u¿y do przekazania Id jêzyka, w którym ma
byæ kodowanie na karcie nowego kontrahenta.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Jeœli
niczego nie przeka¿emy w tym polu to funkcje zwróc¹ domyœlny <span
class=SpellE>charset</span> czyli 238.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Jeœli
przeka¿emy coœ innego ni¿ 238 np. 0, (hiszpañski), 204 (cyrylica np. rosyjski,
ukraiñski, bu³garski), 161 (grecki), 136 (chiñski), 186 (ba³tycki np. norweski,
szwedzki, estoñski, litewski) to przy ustawionej obs³udze <span class=SpellE>unicode</span>
(<span class=SpellE>KoN_Wartosc</span>=1 dla <span class=SpellE>KoN_Numer</span>=-132)
bêdzie zwrócony taki <span class=SpellE>charset</span> jaki przeka¿emy i w
bazie ustawi siê taki <span class=SpellE>charset</span> w polach <span
class=SpellE>Knt_CharsetANSI</span> i <span class=SpellE>KnA_CharsetANSI</span>
(dla adresu g³ównego).<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Uwaga! API
nie konwertuje znaków zapisanych w polach <span class=SpellE>unicode</span>.
Je¿eli u¿ytkownik wpisze np. <span class=SpellE>cyrlicê</span> wówczas znaki
zapisz¹ siê jako ????. Nale¿y podaæ przekonwertowane znaki, automatyczna
konwersja nie bêdzie robiona.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Przyk³ad:
Ustawienie w bazie <span class=SpellE>KoN_Wartosc</span>=1 <span class=SpellE>where</span>
<span class=SpellE>KoN_Numer</span>=-132 (obs³uga <span class=SpellE>unicode</span>).
Dodajemy akronim, zmieniamy klawiaturê na np. jêzyk rosyjski.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>W polu
Nazwa1 wpisujemy nazwê cyrylic¹.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>W polu <span
class=SpellE>CharsetANSI</span> przekazujemy 204 (<span class=SpellE>charset</span>
dla cyrylicy).<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Doda siê
kontrahent z <span class=SpellE>Knt_CharsetANSI</span>=204 i <span
class=SpellE>KnA_CharsetANSI</span>=204 (dla adresu g³ównego), ale funkcja <span
class=SpellE>XlNowyKontrahent</span> zwróci nam w polu Nazwa1 znaki zapytania.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Jeœli
chcemy, ¿eby nie by³o znaków zapytania to musimy w polu Nazwa1 przekazaæ ju¿
przekonwertowane znaki.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Jeœli
niczego nie przeka¿emy w polu <span class=SpellE>CharsetANSI</span> to bêdzie
zwrócone takie jakie jest na tym adresie (w polu <span class=SpellE>KnA_CharsetANSI</span>).<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>Przyk³ad:<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>- jeœli
zmieniam cokolwiek (nazw, ulica itd.) na adresie innym/wysy³kowym i przekazujê
jak¹œ wartoœæ w polu <span class=SpellE>CharsetANSI</span> np. 161 to po
zmianie ta nowa wartoœæ ustawi siê tylko dla zmienianego adresu czyli w polu <span
class=SpellE>KnA_CharsetANSI</span> dla adresu innego/wysy³kowego, <span
class=SpellE>Knt_CharsetANSI</span> i <span class=SpellE>KnA_CharsetANSI</span>
dla adresu g³ównego pozostaj¹ bez zmian,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>- jeœli
zmieniam cokolwiek na adresie g³ównym i przekazujê jak¹œ wartoœæ w polu <span
class=SpellE>CharsetANSI</span> np. 186 to po zmianie ta nowa wartoœæ ustawi
siê zarówno w polu <span class=SpellE>Knt_CharsetANSI</span> jak i w polu <span
class=SpellE>KnA_CharsetANSI</span> dla adresu g³ównego, dla pozosta³ych
adresów (inny/wysy³kowy o ile takie s¹ na karcie kontrahenta) <span
class=SpellE>KnA_CharsetANSI</span> pozostaj¹ bez zmian.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'><o:p>&nbsp;</o:p></span></p>


</div>







</body>

</html>
