<html>

<head>
  <title> Prototyp i opis dzia³ania funkcji</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1250">
  <meta name="GENERATOR" content="Macrobject Word-2-CHM Pro">
  <link rel="stylesheet" href="default.css" type="text/css" />
  <link rel="stylesheet" href="macrobject.css" type="text/css">
</head>

<body>


<div class=Section1>

<h5><a name=Bookmark356></a><span style='mso-bidi-font-family:"Times New Roman"'>Prototyp i opis dzia³ania funkcji</span><span style='mso-bidi-font-family: "Times New Roman"'><o:p></o:p></span></h5>

<p class=MsoCaption><span class=SpellE><span lang=EN-US style='mso-ansi-language:
EN-US'>XLNowyAdres</span></span><span lang=EN-US style='mso-ansi-language:EN-US'>(<span
class=SpellE>Sesja</span> AS LONG, <span class=SpellE>IDAdresu</span> AS LONG, <span
class=SpellE>AdresInfo</span> As <span class=SpellE>XLAdresInfo</span>) AS LONG</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormalIndent><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>&nbsp;</span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Funkcja dodaje nowy adres do
podanego kontrahenta. Po u¿yciu tej funkcji wymagane jest zakoñczenie edycji
adresu poprzez wywo³anie funkcji <span class=SpellE>XLZamknijAdres</span>.
Funkcja XL nowy adres pozwala dodaæ tylko adresy o typie INNY (<span
class=SpellE>kna_gidtyp</span>=896)<o:p></o:p></span></p>

<p class=MsoNormalIndent>Przy tworzeniu adresu system sam uzupe³nia pola np.
Nazwa2 ze Ÿród³a, je¿eli nie by³o podane. Aby przekazaæ pust¹ wartoœæ nale¿y
u¿yæ &lt;PUS&gt; w parametrze.</p>

<p class=MsoNormalIndent><span style='mso-spacerun:yes'> </span></p>

<p class=MsoNormalIndent>Pola na których mo¿na ustawiæ '&lt;PUS&gt;' to: </p>

<p class=MsoNormalIndent>Nazwa1, Nazwa2, Nazwa3, <span class=SpellE>KodP</span>,
Ulica, Adres, <span class=SpellE>NipPrefiks</span>, <span class=SpellE>NipE</span>,
Regon, Pesel, <span class=SpellE>Odleglosc</span>, Telefon1, Telefon2, Fax, Modem,
Telex, <span class=SpellE>EMail</span>, <span class=SpellE>KontoDostawcy</span>,
<span class=SpellE>KontoOdbiorcy</span>.</p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>Pole <span class=SpellE>CharsetANSI</span> - s³u¿y do
przekazania Id jêzyka, w którym ma byæ kodowanie na karcie nowego kontrahenta.</p>

<p class=MsoNormalIndent>Jeœli niczego nie przeka¿emy w tym polu to funkcje
zwróc¹ domyœlny <span class=SpellE>charset</span> czyli 238.</p>

<p class=MsoNormalIndent>Jeœli przeka¿emy coœ innego ni¿ 238 np. 0,
(hiszpañski), 204 (cyrylica np. rosyjski, ukraiñski, bu³garski), 161 (grecki),
136 (chiñski), 186 (ba³tycki np. norweski, szwedzki, estoñski, litewski) to
przy ustawionej obs³udze <span class=SpellE>unicode</span> (<span class=SpellE>KoN_Wartosc</span>=1
dla <span class=SpellE>KoN_Numer</span>=-132) bêdzie zwrócony taki <span
class=SpellE>charset</span> jaki przeka¿emy i w bazie ustawi siê taki <span
class=SpellE>charset</span> w polach <span class=SpellE>Knt_CharsetANSI</span>
i <span class=SpellE>KnA_CharsetANSI</span> (dla adresu g³ównego).</p>

<p class=MsoNormalIndent><o:p>&nbsp;</o:p></p>

<p class=MsoNormalIndent>Uwaga! API nie konwertuje znaków zapisanych w polach <span
class=SpellE>unicode</span>. Je¿eli u¿ytkownik wpisze np. <span class=SpellE>cyrlicê</span>
wówczas znaki zapisz¹ siê jako ????. Nale¿y podaæ przekonwertowane znaki,
automatyczna konwersja nie bêdzie robiona.</p>

<p class=MsoNormalIndent>Przyk³ad: Ustawienie w bazie <span class=SpellE>KoN_Wartosc</span>=1
<span class=SpellE>where</span> <span class=SpellE>KoN_Numer</span>=-132
(obs³uga <span class=SpellE>unicode</span>). Dodajemy akronim, zmieniamy
klawiaturê na np. jêzyk rosyjski.</p>

<p class=MsoNormalIndent>W polu Nazwa1 wpisujemy nazwê cyrylic¹.</p>

<p class=MsoNormalIndent>W polu <span class=SpellE>CharsetANSI</span>
przekazujemy 204 (<span class=SpellE>charset</span> dla cyrylicy).</p>

<p class=MsoNormalIndent>Doda siê kontrahent z <span class=SpellE>Knt_CharsetANSI</span>=204
i <span class=SpellE>KnA_CharsetANSI</span>=204 (dla adresu g³ównego), ale
funkcja <span class=SpellE>XlNowyKontrahent</span> zwróci nam w polu Nazwa1
znaki zapytania.</p>

<p class=MsoNormalIndent>Jeœli chcemy, ¿eby nie by³o znaków zapytania to musimy
w polu Nazwa1 przekazaæ ju¿ przekonwertowane znaki.</p>

<p class=MsoNormalIndent>Jeœli niczego nie przeka¿emy w polu <span
class=SpellE>CharsetANSI</span> to bêdzie zwrócone <span class=SpellE>CharsetANSI</span>
takie jakie ma kontrahent, dla którego dodajemy adres (w polu <span
class=SpellE>Knt_CharsetANSI</span>).</p>


</div>







</body>

</html>
