<html>

<head>
  <title> Prototyp i opis dzia³ania funkcji</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1250">
  <meta name="GENERATOR" content="Macrobject Word-2-CHM Pro">
  <link rel="stylesheet" href="default.css" type="text/css" />
  <link rel="stylesheet" href="macrobject.css" type="text/css">
</head>

<body>


<div class=Section1>

<h6><a name=Bookmark130></a><span style='mso-bidi-font-family:"Times New Roman"'>Prototyp i opis dzia³ania funkcji</span><span style='mso-bidi-font-family: "Times New Roman"'><o:p></o:p></span></h6>

<p class=MsoCaption><span class=SpellE><span lang=EN-US style='mso-ansi-language:
EN-US'>XLNowyDokumentMag</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>(<span class=SpellE>Sesja</span> AS LONG, <span class=SpellE>IDDokumentuMag</span>
AS LONG, <span class=SpellE>DokumentMagNagInfo</span> As <span class=SpellE>XLDokumentMagNagInfo</span>)
AS LONG</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormalIndent><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>&nbsp;</span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormalIndent>Funkcja tworzy nag³ówek nowego dokumentu magazynowego.
Przez <span class=SpellE>IDDokumentuMag</span> zwracana jest wartoœæ, przez
któr¹ mo¿na odwo³ywaæ siê do tego dokumentu z kolejnych funkcji API. Parametr
Sesja zawiera numer aktualnej sesji, otwartej funkcj¹ <span class=SpellE>XLLogin</span>.</p>

<p class=MsoNormalIndent>Od wersji <b style='mso-bidi-font-weight:normal'>API
20130</b> do funkcji zosta³y dodane dwa parametry: <span class=SpellE>Zwiazane</span>
i Agregacja. S¹ one wykorzystywane przy generowaniu dokumentów AWD i ZWM. Aby
wygenerowaæ dokumenty AWD i ZWM z pozycjami z dokumentów Ÿród³owych, nale¿y w
funkcji <span class=SpellE>XLDokumentyZwiazane</span> utworzyæ odpowiedni¹
kolejkê elementów lub <span class=SpellE>subelementów</span> a nastêpnie w
funkcji <span class=SpellE>XLDodajDokumentMag</span> ustawiæ parametr <span
class=SpellE>Zwiazane</span> = 1. Parametr Agreguj odpowiada za agregowanie
dodawanych pozycji w obrêbie wyznaczników partii towaru, czyli kodu towaru
EAN-u, klasy cechy i jej wartoœci oraz daty wa¿noœci.</p>

<p class=MsoNormalIndent>Kolejnym sposobem na generowanie z wielu dokumentów
Ÿród³owych dla<span style='color:black'> AWD i ZWM mo¿e byæ wskazywanie
dokumentów Ÿród³owych w parametrach <span class=SpellE>Zrd</span>… W zwi¹zku z
tym wartoœci w parametrach <span class=SpellE>Zrd</span>... musz¹ odpowiednio
na to wskazywaæ. Mo¿na wskazaæ, ¿e dany dokument zawiera tylko elementy z
konkretnego dokumentu Ÿród³owego. Wtedy w parametrach <span class=SpellE>Zrd</span>...
nale¿y przekazaæ pe³ny GID dokumentu. API pozwoli wtedy na dodawanie tylko i
wy³¹cznie elementów z tego dokumentu. Mo¿na w funkcji przekazaæ <span
class=SpellE>ZrdTyp</span>, a <span class=SpellE>ZrdNumer</span> pozostawiæ zerowy.
Wtedy dokument AWD/ZWM mo¿e ³¹czyæ w sobie tylko elementy dokumentów o takim
typie np. FZ. API przy próbie dodania elementu z innego typu zg³osi b³¹d. Mo¿na
wreszcie wszystkie <span class=SpellE>Zrd</span>... pozostawiæ puste. Wtedy
dokument AWD/ZWM pozwoli na dodawanie elementów Ÿród³owych dowolnego typu. <b
style='mso-bidi-font-weight:normal'>Dokumenty PM/WM nie podlegaj¹ tym zasadom</b>.</span><span
style='font-size:9.0pt;line-height:107%;color:black'> </span><span
style='color:black'>Je¿eli pozycje do dokumentów PM, WM maj¹ dodaæ siê
automatycznie na podstawie dokumentu Ÿród³owego, to nale¿y w parametrze <span
class=SpellE>ZrdTyp</span>, <span class=SpellE>ZrdFirma</span> i <span
class=SpellE>ZrdNumer</span> ustawiæ jego odpowiednie identyfikatory a w
parametrze <span class=SpellE>ZrdLp</span> ustawiæ wartoœæ ró¿n¹ od zera. <span
class=SpellE>ZrdLp</span> = 1 oznacza wygenerowanie dokumentu magazynowego wraz
mo¿liwymi elementami na maksymaln¹ iloœæ. Na potrzeby korty iloœciowo
wartoœciowych, przekazanie parametru <span class=SpellE>ZrdLp</span> = -1
generuje dokument na <span class=SpellE>ElementyB</span>, czyli elementy
techniczne korekty.</span></p>


</div>







</body>

</html>
