<html>

<head>
  <title> Prototyp i opis dzia³ania funkcji</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1250">
  <meta name="GENERATOR" content="Macrobject Word-2-CHM Pro">
  <link rel="stylesheet" href="default.css" type="text/css" />
  <link rel="stylesheet" href="macrobject.css" type="text/css">
</head>

<body>


<div class=Section1>

<h6><a name=Bookmark27></a><span style='mso-bidi-font-family:"Times New Roman"'>Prototyp i opis dzia³ania funkcji</span><span style='mso-bidi-font-family: "Times New Roman"'><o:p></o:p></span></h6>

<p class=MsoCaption><span lang=EN-US style='mso-ansi-language:EN-US'>XLNOWYDOKUMENT(<span
class=SpellE>Sesja</span> AS LONG, <span class=SpellE>IDDokumentu</span> AS
LONG, <span class=SpellE>DokumentNagInfo</span> As <span class=SpellE>XLDokumentNagInfo</span>)
AS LONG</span><span lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=TekstSQL style='tab-stops:2.0cm 5.0cm'><span lang=EN-US
style='font-family:"Calibri",sans-serif;mso-bidi-font-family:"Times New Roman";
mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Jest to funkcja, która
zapocz¹tkowuje wystawianie dokumentu w systemie.<span
style='mso-spacerun:yes'>  </span>Odpowiada funkcjonalnie naciœniêciu przez
operatora przycisku „+” na liœcie transakcji wybranego typu. Nadaje ona nowy
numer nag³ówka, pobiera kontrahenta, wype³nia rekord standardowymi ustawieniami
i ustawia go w stan zajêtoœci. Wymagane jest u¿ycie w komplecie co najmniej
funkcji <span class=SpellE>XLZamknijDokument</span> w celu zakoñczenia
dokumentu i zwolnienia jego zajêtoœci (bez wywo³ania tej funkcji wewnêtrzna
kontrola <span class=SpellE>XL’a</span> spowoduje wycofanie wszelkich zapisów
do tego dokumentu).</span></p>

<p class=MsoNormalIndent><span style='color:black'>Parametr sesja zawiera numer
sesji, w której dokument bêdzie wystawiany. Poprzez parametr <span
class=SpellE>IDDokumentu</span> funkcja zwraca unikalny identyfikator
za³o¿onego dokumentu, którym nale¿y siê pos³ugiwaæ w czasie dalszej edycji
dokumentu. </span></p>

<p class=MsoNormalIndent><span style='color:black'>Je¿eli wœród przekazywanych
parametrów wyszczególnimy GID potwierdzonego zamówienia, to wystawiony dokument
bêdzie posiada³ wszystkie cechy dokumentu koñcz¹cego zamówienie (w
szczególnoœci podczas dodawania pozycji bêd¹ œci¹gane rezerwacje za³o¿one przez
to zamówienie)</span></p>

<p class=MsoNormalIndent><span style='color:black'>W przypadku wystawiania
korekt dane o kontrahencie, adresie itp., które powinny byæ pobrane z
orygina³u, bêd¹ ignorowane.</span></p>

<p class=MsoNormalIndent><span style='color:black'>Aby wystawiæ korektê nale¿y
w polu: Korekta ustawiæ wartoœæ 1, Typ podaæ <span class=SpellE>GIDTyp</span>
korekty i w polach <span class=SpellE>ZwrTyp</span>, <span class=SpellE>ZwrFirma</span>,
<span class=SpellE>ZwrNumer</span>, <span class=SpellE>ZwrLp</span> podaæ
odpowiednie identyfikatory dokumentu Ÿród³owego korekty.</span></p>

<p class=MsoNormalIndent><span style='color:black'>Aby wystawiæ korektê rêczn¹,
nale¿y w polu: Korekta ustawiæ wartoœæ 1 i nie podawaæ: <span class=SpellE>ZwrTyp</span>,
<span class=SpellE>ZwrFirma</span>, <span class=SpellE>ZwrNumer</span>, <span
class=SpellE>ZwrLp</span>. Przy dodawaniu pozycji do takiego dokumentu za
pomoc¹ funkcji <span class=SpellE>XLDodajPozycje</span>, nale¿y w polu <span
class=SpellE>TypKorekty</span> ustawiæ jedn¹ z wartoœci: 1 - iloœciowa, 2 -
wartoœciowa, 3 – VAT, je¿eli dla korekty rêcznej wymagane jest przekazanie
kosztu na elemencie, to w funkcji <span class=SpellE>XLDodajPozycje</span>,
nale¿y <span class=SpellE>podac</span> koszt w parametrze <span class=SpellE>WartoscR</span>.</span></p>

<p class=MsoNormalIndent>Aby wystawiæ dokument MMP (przyjêcie miêdzymagazynowe)
nale¿y wype³niæ pola <span class=SpellE>ZwrTyp</span>, <span class=SpellE>ZwrFirma</span>,
<span class=SpellE>ZwrNumer</span> odpowiednimi wartoœciami identyfikuj¹cymi
Ÿród³owy dokument MMW (wydanie miêdzymagazynowe). W polu <span class=SpellE>ZwrLp</span>
mo¿na podaæ wartoœæ 1, aby utworzyæ tylko nag³ówek dokumentu MMP bez
automatycznego przepisania pozycji. W przypadku pozostawienia w tym polu
wartoœci zerowej na dokument MMP zostan¹ przepisane pozycje Ÿród³owego
dokumentu MMW.</p>

<p class=MsoNormalIndent>Aby wygenerowaæ dokument zaliczkowy nale¿y wywo³aæ
funkcjê <span class=SpellE>XLNowyDokument</span> ze wskazaniem na dokument
zamówienia, nastêpnie funkcje <span class=SpellE>XLDodajVat</span> i <span
class=SpellE>XLZamknijDokument</span>.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Od wersji <b style='mso-bidi-font-weight:
normal'>2013.5 </b>systemu Comarch ERP XL istnieje mo¿liwoœæ generowania korekt
zbiorczych wykorzystuj¹c do tego celu funkcje API.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Funkcja <span class=SpellE>XLNowyDokument</span>
umo¿liwia wystawienie korekty zbiorczej do dokumentów handlowych (sprzeda¿,
zakup i eksport). W zale¿noœci od zadanego parametru Zbiorcza, mo¿na utworzyæ
nag³ówek pustej korekty zbiorczej, wygenerowaæ korektê z zadanych dokumentów
lub z przedzia³u czasu dla konkretnego kontrahenta oraz wystawiæ spinacz do
wskazanych dokumentów. </p>

<p class=MsoNormal style='margin-left:42.55pt'>Obecnie istnieje mo¿liwoœæ
wystawienia korekty zbiorczej tylko na zadany rabat (<span class=SpellE>RodzajKor</span>
= 0). W przysz³oœci zostanie rozszerzona ta funkcjonalnoœæ o mo¿liwoœæ
wystawiania korekt zbiorczych na zadan¹ wartoœæ i cenê.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Dodatkowo mo¿na wybraæ typ daty
– wystawienia lub sprzeda¿y/zakupu (<span class=SpellE>TypDatyKor</span>), przy
generowaniu korekty zbiorczej z zadanego przedzia³u czasu. </p>

<p class=MsoNormal style='margin-left:42.55pt'>Aby wystawiæ pust¹ korektê
zbiorcz¹ wystarczy podaæ Typ = <span class=SpellE>GIDTyp</span> korekty (1529
dla FZK, 2041 dla FSK, 2045 dla FKE), Spinacz = 1 i Akronim kontrahenta.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Aby wygenerowaæ korektê zbiorcz¹
do dokumentów wystawionych na danego kontrahenta z zadanego przedzia³u czasu,
nale¿y podaæ nastêpuj¹ce parametry: Typ, Spinacz = 1, Zbiorcza = 2, <span
class=SpellE>RodzajKor</span> = 0, Rabat (wartoœæ pomno¿ona przez 100), <span
class=SpellE>DataOdKor</span>, <span class=SpellE>DataDoKor</span> i Akronim.
Przekazanie takich parametrów spowoduje automatyczne wygenerowanie korekt na
wskazany rabat do dokumentów, które spe³niaj¹ warunek okreœlonego kontrahenta i
zakresu dat.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Aby wygenerowaæ korektê zbiorcz¹
do konkretnych dokumentów, nale¿y wykorzystaæ funkcjê <span class=SpellE>XLDokumentyZwiazane</span>.
Za jej pomoc¹ ustawiamy kolejkê tych dokumentów. Nastêpnie w <span
class=SpellE>XLNowyDokument</span> podajemy parametry: Typ, Spinacz = 1,
Zbiorcza = 2, Rabat, Akronim i <span class=SpellE>Zwiazane</span> = 1.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Aby spi¹æ istniej¹ce korekty do
jednej korekty zbiorczej, nale¿y utworzyæ ich kolejkê funkcj¹ <span
class=SpellE>XLDokumentyZwiazane</span>, a w funkcji <span class=SpellE>XLNowyDokument</span>
przekazaæ: Typ, Spinacz = 1, Zbiorcza = 3, <span class=SpellE>Zwiazane</span> =
1 i Akronim kontrahenta.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Od wersji <b style='mso-bidi-font-weight:
normal'>2018.1 </b>mo¿liwe jest wygenerowanie korekty elementów spinaczy przez
API. Funkcjê <span class=SpellE>NowyDokument</span> nale¿y ustawiæ tak jak dla
zwyk³ej korekty, z zaznaczonym parametrem .Spinacz=2, dziêki temu generowany
jest pusty nag³ówek korekty spinacza elementów. Ustawiaj¹c .<span class=SpellE>zwrlp</span>=1
wygeneruje siê ze wszystkimi elementami na maksymaln¹ iloœæ zwrotu. Drugim
sposobem jest równie¿(podobnie jak w przypadku zwyk³ych spinaczy), wype³nienie
kolejki dokumentów/elementów/<span class=SpellE>subelementów</span> z podaniem
iloœci. Dziêki temu mo¿na wygenerowaæ korektê spinacza elementów od razu
skorygowanych wartoœciowo. Do tego celu nale¿y u¿yæ po funkcji <span
class=SpellE>NowyDokument</span>, <span class=SpellE>ModyfikujPozycje</span>.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Aby wystawiæ spinacz(funkcja <span
class=SpellE>NowyDokument</span>) elementów nale¿y w polu .Spinacz podaæ
wartoœæ 2. Mo¿na równie¿ przekazaæ w kolejce, podobnie jak dla zwyk³ych
spinaczy., identyfikator dokumentów(GID) lub elementów (GID z niezerowym LP).
Mo¿na wrêcz przekazaæ identyfikator <span class=SpellE>subelementu</span> GID z
LP i dodatkowo <span class=SpellE>SubLP</span>. Mo¿na równie¿ do³o¿yæ do tego
iloœæ jaka ma byæ <span class=SpellE>zrealizowanna</span>.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Po wykryciu, ¿e ma utworzyæ MMP
do jakiegoœ MMW, a jest ju¿ do tego MMW AWD. Mo¿e uruchomiæ specjalny tryb,
gdzie wygeneruje jeden lub wiêcej dokumentów MMP ale zwróci b³¹d -255. To jest
specjalny b³¹d, który nale¿y potraktowaæ jako sukces, a nie b³¹d i co wiêcej
nie wo³aæ ju¿ <span class=SpellE>ZamknijDokumet</span> czy jakichkolwiek innych
API.</p>

<p class=MsoNormal style='margin-left:42.55pt'>Je¿eli zawo³ano <span
class=SpellE>NowyDokument</span> w trybie wsadowym, to bez wzglêdu na to czy
zostanie wygenerowany jeden czy wiele dokumentów, to nie wstanie ¿adna
formatka. Jeœli interakcyjny, to wstanie tyle razy formatka, ile bêdzie
generowanych dokumentów. Jeœli domyœlny, to jak jeden, wstanie formatka, jak
wiele ¿adna formatka nie zostanie postawiona.</p>


</div>







</body>

</html>
