<html>

<head>
  <title> Prototyp i opis dzia³ania funkcji</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1250">
  <meta name="GENERATOR" content="Macrobject Word-2-CHM Pro">
  <link rel="stylesheet" href="default.css" type="text/css" />
  <link rel="stylesheet" href="macrobject.css" type="text/css">
</head>

<body>


<div class=Section1>

<h5><a name=Bookmark374></a><span style='mso-bidi-font-family:"Times New Roman"'>Prototyp i opis dzia³ania funkcji</span><span style='mso-bidi-font-family: "Times New Roman"'><o:p></o:p></span></h5>

<p class=MsoCaption><span class=SpellE><span lang=EN-US style='mso-ansi-language:
EN-US'>XLNowyKontrahentSQL</span></span><span lang=EN-US style='mso-ansi-language:
EN-US'>(<span class=SpellE>SesjaID</span> AS LONG, <span class=SpellE>KontrahentSQLInfo</span>
As <span class=SpellE>XLKontrahentSQLInfo</span>) AS LONG</span><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-ansi-language:
EN-US'><o:p></o:p></span></p>

<p class=MsoNormalIndent><span lang=EN-US style='color:black;mso-ansi-language:
EN-US'>&nbsp;</span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Funkcja zak³ada now¹ kartê
kontrahenta w systemie CDN XL. Korzysta przy tym z procedury wbudowanej <span
class=SpellE>CDN.KntNowy</span>. GID dodanego kontrahenta zwracany jest w
polach <span class=SpellE>GIDTyp</span>, <span class=SpellE>GIDFirma</span>, <span
class=SpellE>GIDNumer</span>. Wszelkie zwracane b³êdy pochodz¹ce z procedury
zwracane s¹ w polu <span class=SpellE>OpisBledu</span>. <o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Pole <span class=SpellE>CharsetANSI</span>
- s³u¿y do przekazania Id jêzyka, w którym ma byæ kodowanie na karcie nowego
kontrahenta.<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Jeœli niczego nie przeka¿emy
w tym polu to funkcje zwróc¹ domyœlny <span class=SpellE>charset</span> czyli
238.<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Jeœli przeka¿emy coœ innego
ni¿ 238 np. 0, (hiszpañski), 204 (cyrylica np. rosyjski, ukraiñski, bu³garski),
161 (grecki), 136 (chiñski), 186 (ba³tycki np. norweski, szwedzki, estoñski,
litewski) to przy ustawionej obs³udze <span class=SpellE>unicode</span> (<span
class=SpellE>KoN_Wartosc</span>=1 dla <span class=SpellE>KoN_Numer</span>=-132)
bêdzie zwrócony taki <span class=SpellE>charset</span> jaki przeka¿emy i w
bazie ustawi siê taki <span class=SpellE>charset</span> w polach <span
class=SpellE>Knt_CharsetANSI</span> i <span class=SpellE>KnA_CharsetANSI</span>
(dla adresu g³ównego).<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Uwaga! API nie konwertuje
znaków zapisanych w polach <span class=SpellE>unicode</span>. Je¿eli u¿ytkownik
wpisze np. <span class=SpellE>cyrlicê</span> wówczas znaki zapisz¹ siê jako
????. Nale¿y podaæ przekonwertowane znaki, automatyczna konwersja nie bêdzie
robiona.<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Przyk³ad: Ustawienie w bazie
<span class=SpellE>KoN_Wartosc</span>=1 <span class=SpellE>where</span> <span
class=SpellE>KoN_Numer</span>=-132 (obs³uga <span class=SpellE>unicode</span>).
Dodajemy akronim, zmieniamy klawiaturê na np. jêzyk rosyjski.<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>W polu Nazwa1 wpisujemy
nazwê cyrylic¹.<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>W polu <span class=SpellE>CharsetANSI</span>
przekazujemy 204 (<span class=SpellE>charset</span> dla cyrylicy).<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Doda siê kontrahent z <span
class=SpellE>Knt_CharsetANSI</span>=204 i <span class=SpellE>KnA_CharsetANSI</span>=204
(dla adresu g³ównego), ale funkcja <span class=SpellE>XlNowyKontrahent</span>
zwróci nam w polu Nazwa1 znaki zapytania.<o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>Jeœli chcemy, ¿eby nie by³o
znaków zapytania to musimy w polu Nazwa1 przekazaæ ju¿ przekonwertowane znaki.<o:p></o:p></span></p>


</div>







</body>

</html>
