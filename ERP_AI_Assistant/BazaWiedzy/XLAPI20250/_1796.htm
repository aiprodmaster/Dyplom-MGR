<html>

<head>
  <title> Deklarowanie funkcji API</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1250">
  <meta name="GENERATOR" content="Macrobject Word-2-CHM Pro">
  <link rel="stylesheet" href="default.css" type="text/css" />
  <link rel="stylesheet" href="macrobject.css" type="text/css">
</head>

<body>


<div class=Section1>

<h3><a name=Bookmark1506></a><a name="_Toc36896589"></a><span style='mso-bookmark: Bookmark1506'><span style='mso-bidi-font-family:"Times New Roman"'>Deklarowanie funkcji API</span></span><span style='mso-bidi-font-family: "Times New Roman"'><o:p></o:p></span></h3>

<p class=MsoNormal>(Poni¿szy opis przedstawia ogólny schemat deklaracji funkcji
API w systemie WINDOWS)<span style='font-size:12.0pt;line-height:107%'><o:p></o:p></span></p>

<p class=MsoNormal>Przyk³adowa deklaracja funkcji Windows API wygl¹da
nastêpuj¹co: </p>

<p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Arial Unicode MS";
color:#3333FF;mso-ansi-language:EN-US'>Public Declare Function</span><span
lang=EN-US style='mso-fareast-font-family:"Arial Unicode MS";mso-ansi-language:
EN-US'> &lt;<span class=SpellE>NazwaFunkcji</span>&gt; <span style='color:#3333FF'>Lib</span></span><span
lang=EN-US style='mso-ansi-language:EN-US'> „<span class=SpellE>nazwa</span> <span
class=SpellE>biblioteki</span> <span class=SpellE>dll</span>&quot; </span><span
lang=EN-US style='mso-fareast-font-family:"Arial Unicode MS";color:#3333FF;
mso-ansi-language:EN-US'>Alias</span><span lang=EN-US style='mso-ansi-language:
EN-US'> &quot;<span class=SpellE>oryginalna</span> <span class=SpellE>nazwa</span>
<span class=SpellE>wywo³ywanej</span> <span class=SpellE>funkcji</span>&quot; (</span><span
class=SpellE><span lang=EN-US style='mso-fareast-font-family:"Arial Unicode MS";
color:#3333FF;mso-ansi-language:EN-US'>ByVal</span></span><span lang=EN-US
style='mso-fareast-font-family:"Arial Unicode MS";mso-ansi-language:EN-US'> <span
class=SpellE>hFile</span> AS LONG, <span class=SpellE>lpBuffer</span> As <span
style='color:#3333FF'>Any</span>, <span class=SpellE><span style='color:#3333FF'>ByVal</span></span>
<span class=SpellE>nNumberOfBytesToWrite</span> AS LONG, <span class=SpellE>lpNumberOfBytesWritten</span>
AS LONG, <span class=SpellE>lpOverlapped</span> As <span style='color:#3333FF'>OVERLAPPED</span>)
AS LONG </span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal>Sk³adnia funkcji API sk³ada siê z nastêpuj¹cych elementów: <br>
&nbsp; </p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=631
 style='width:473.25pt;mso-cellspacing:0cm;mso-yfti-tbllook:1184;mso-padding-alt:
 0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=631 colspan=3 valign=top style='width:473.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='mso-fareast-font-family:"Arial Unicode MS"'>Public
  | <span class=SpellE>Private</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=605 colspan=2 valign=top style='width:453.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>Funkcje API powinno siê deklarowaæ w sekcji <b><span
  style='mso-fareast-font-family:"Arial Unicode MS"'>General <span
  class=SpellE>Declarations</span></span></b> dowolnego modu³u lub formatki.
  Je¿eli funkcje s¹ wprowadzane do modu³u standardowego, powinny byæ
  deklarowane jako <i><span style='mso-fareast-font-family:"Arial Unicode MS";
  color:#3333FF'>Public</span></i> i mog¹ byæ wywo³ywane z dowolnego miejsca
  aplikacji. Natomiast jeœli deklaracja funkcji odbywa siê w formatce, powinny
  one byæ deklarowane jako <span class=SpellE><i><span style='mso-fareast-font-family:
  "Arial Unicode MS";color:#3333FF'>Private</span></i></span> i wówczas s¹
  lokalnymi funkcjami dla tej formatki, i mog¹ byæ wywo³ywane w jej obrêbie. <br>
  &nbsp;</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=631 colspan=3 valign=top style='width:473.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span class=SpellE><span style='mso-fareast-font-family:
  "Arial Unicode MS"'>Declare</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=605 colspan=2 valign=top style='width:453.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>Wyra¿enie to informuje Visual Basic o deklarowaniu funkcji
  Windows API jako elementu tworzonego programu. <br>
  &nbsp;</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=631 colspan=3 valign=top style='width:473.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span class=SpellE><span style='mso-fareast-font-family:
  "Arial Unicode MS"'>Function</span></span><span style='mso-fareast-font-family:
  "Arial Unicode MS"'> | <span class=SpellE>Sub</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=605 colspan=2 valign=top style='width:453.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>Czêœæ funkcji API zwraca ró¿ne wartoœci i jest wówczas
  deklarowana jest jako <span class=SpellE><i><span style='mso-fareast-font-family:
  "Arial Unicode MS";color:#3333FF'>Funktion</span></i></span>, natomiast gdy
  funkcja API nie zwraca ¿adnych wartoœci stosuje siê deklaracje <span
  class=SpellE><i><span style='mso-fareast-font-family:"Arial Unicode MS";
  color:#3333FF'>Sub</span></i></span>.<br>
  &nbsp;</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=631 colspan=3 valign=top style='width:473.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span class=SpellE><span style='mso-fareast-font-family:
  "Arial Unicode MS"'>Lib</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=605 colspan=2 valign=top style='width:453.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>Okreœla bibliotekê DLL w której znajduje siê wywo³ywana
  funkcja.<br>
  &nbsp;</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=631 colspan=3 valign=top style='width:473.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='mso-fareast-font-family:"Arial Unicode MS"'>Alias</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=605 colspan=2 valign=top style='width:453.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>Funkcje Windows API by³y tworzone z myœl¹ o programistach
  pisz¹cych w C/C++ i podczas deklaracji funkcji w nazwie czasami pojawiaj¹ siê
  znaki niedozwolone w VB (np. znak podkreœlenia &quot;_&quot;). Konieczne jest
  wtedy zastosowanie zamiennika (<i><span style='mso-fareast-font-family:"Arial Unicode MS";
  color:#3333FF'>Alias</span></i>) który bêdzie zawiera³ oryginaln¹ nazwê
  wywo³ywanej funkcji, a po s³owie sk³adniowym <span class=SpellE><i><span
  style='mso-fareast-font-family:"Arial Unicode MS";color:#3333FF'>Function</span></i></span><span
  style='mso-fareast-font-family:"Arial Unicode MS"'> | <span class=SpellE><i><span
  style='color:#3333FF'>Sub</span></i></span></span> now¹ nazwê dziêki której
  bêdzie wywo³ywana ta funkcja. Dziêki temu mo¿na nadawaæ w tworzonym programie
  polskojêzyczne nazwy funkcji API, ale raczej nie radzê nabieraæ &quot;z³ych&quot;
  nawyków.<br>
  &nbsp;</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width=631 colspan=3 valign=top style='width:473.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span class=SpellE><span style='mso-fareast-font-family:
  "Arial Unicode MS"'>ByVal</span></span><span style='mso-fareast-font-family:
  "Arial Unicode MS"'> | <span class=SpellE>ByRef</span></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=605 colspan=2 valign=top style='width:453.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>Zmienne potrzebne podczas wywo³ywania funkcji mog¹ byæ
  przekazywane przez wartoœæ (<span class=SpellE><i><span style='mso-fareast-font-family:
  "Arial Unicode MS";color:#3333FF'>ByVal</span></i></span><span
  style='mso-fareast-font-family:"Arial Unicode MS"'>) lub przez referencje (<span
  class=SpellE><i><span style='color:#3333FF'>ByRef</span></i></span></span>).
  Wówczas podczas deklarowania funkcji Windows API trzeba pos³u¿yæ siê
  odpowiedni¹ komend¹. Sposób przekazywania argumentów jest bardzo istotny i
  mo¿e spowodowaæ b³êdne dzia³anie funkcji, a w przypadku funkcji systemowych
  pomy³ka mo¿e byæ nieprzewidywalna. Przekazywanie wartoœci przez referencje w
  VB odbywa siê domyœlnie i nie trzeba koniecznie stosowaæ s³owa <span
  class=SpellE><i><span style='mso-fareast-font-family:"Arial Unicode MS";
  color:#3333FF'>ByRef</span></i></span><span style='mso-fareast-font-family:
  "Arial Unicode MS"'>. </span></p>
  <p class=MsoNormal>Przy przekazywaniu argumentu przez wartoœæ, zostaje
  przekazana kopia zmiennej jako argument funkcji. Je¿eli wywo³ana procedura
  zmieni wartoœæ tego argumentu, zmiana ta nie pozostanie kiedy funkcja
  zakoñczy swoje dzia³anie. </p>
  <p class=MsoNormal>Natomiast przy przekazywaniu argumentu przez referencjê,
  do funkcji jest przekazana sama zmienna jako argument funkcji. Je¿eli
  wywo³ana funkcja zmieni wartoœæ tego argumentu, to ta zmiana pozostanie kiedy
  funkcja zakoñczy swoje dzia³anie. <br>
  &nbsp;</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width=631 colspan=3 valign=top style='width:473.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-fareast-font-family:"Arial Unicode MS";
  mso-ansi-language:EN-US'>Integer | Long | String | Any | STRUCTURE</span><span
  lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=605 colspan=2 valign=top style='width:453.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>Podczas deklaracji funkcji w programie nale¿y okreœliæ typ
  przekazywanego argumentu wymagany przez funkcjê Windows API. Podstawowe typy
  danych przekazywanych jako argumenty funkcji API: <br>
  &nbsp;</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:14'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=113 valign=top style='width:84.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='mso-fareast-font-family:"Arial Unicode MS"'>Integer
  -</span></p>
  </td>
  <td width=491 valign=top style='width:368.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;informuje funkcje API, ¿e przekazywana wartoœæ
  argumentu jest liczb¹ 16-bitowa. Wartoœæ tej zmiennej jest z zakresu od
  -32.768 do +32.767</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:15'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=113 valign=top style='width:84.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span class=SpellE><span style='mso-fareast-font-family:
  "Arial Unicode MS"'>Long</span></span><span style='mso-fareast-font-family:
  "Arial Unicode MS"'> -</span></p>
  </td>
  <td width=491 valign=top style='width:368.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='mso-fareast-font-family:"Arial Unicode MS"'>przekazywany
  argument funkcji</span> jest liczb¹ 32-bitow¹. Wartoœæ tej zmiennej jest z
  zakresu od -2.147.483.648 do +2.147.483.647</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:16'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=113 valign=top style='width:84.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='mso-fareast-font-family:"Arial Unicode MS"'>String
  -</span></p>
  </td>
  <td width=491 valign=top style='width:368.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>argument jest zmienn¹ tekstow¹ (alfanumeryczn¹). Zawieraæ
  mo¿e dane znakowe od 0 do 2 miliardów znaków dla Windows 95 (od 0 do 65.400
  dla Windows 3.1 i wersji wczeœniejszych)</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:17'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=113 valign=top style='width:84.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span class=SpellE><span style='mso-fareast-font-family:
  "Arial Unicode MS"'>Any</span></span><span style='mso-fareast-font-family:
  "Arial Unicode MS"'> -</span></p>
  </td>
  <td width=491 valign=top style='width:368.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>okreœla ¿e argument funkcji jest dowolnym typem danych,
  poniewa¿ czêœæ funkcji Windows API akceptuje przekazywanie zmiennej jako dan¹
  dowolnego typu</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:18;mso-yfti-lastrow:yes'>
  <td width=26 valign=top style='width:19.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>&nbsp;</p>
  </td>
  <td width=113 valign=top style='width:84.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='mso-fareast-font-family:"Arial Unicode MS"'>STRUCTURE
  -</span></p>
  </td>
  <td width=491 valign=top style='width:368.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal>czêœæ funkcji <span class=SpellE>Widows</span> API
  oczekuje zmiennej w formacie UDT (User-<span class=SpellE>Defined</span> <span
  class=SpellE>Type</span>). <span class=SpellE><span lang=EN-US
  style='mso-ansi-language:EN-US'>Poni¿szy</span></span><span lang=EN-US
  style='mso-ansi-language:EN-US'> <span class=SpellE>przyk³ad</span> <span
  class=SpellE>ilustruje</span> <span class=SpellE>sk³adniê</span> UDT <span
  class=SpellE>typu</span> OVERLAPPED: <o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>Public
  Type OVERLAPPED <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Internal AS LONG <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>InternalHigh</span>
  AS LONG <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offset AS LONG <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>OffsetHigh</span>
  AS LONG <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>hEvent</span>
  AS LONG <br>
  End Type<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>


</div>







</body>

</html>
