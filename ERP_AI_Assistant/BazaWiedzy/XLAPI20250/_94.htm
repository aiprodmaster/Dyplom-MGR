<html>

<head>
  <title> Prototyp i opis dzia³ania funkcji</title>
  <meta http-equiv=Content-Type content="text/html; charset=windows-1250">
  <meta name="GENERATOR" content="Macrobject Word-2-CHM Pro">
  <link rel="stylesheet" href="default.css" type="text/css" />
  <link rel="stylesheet" href="macrobject.css" type="text/css">
</head>

<body>


<div class=Section1>

<h6><a name=Bookmark93></a><span style='mso-bidi-font-family:"Times New Roman"'>Prototyp i opis dzia³ania funkcji</span><span style='mso-bidi-font-family: "Times New Roman"'><o:p></o:p></span></h6>

<p class=MsoCaption><span class=SpellE>XLZamknijDokument</span>(<span
class=SpellE>IDDokumentu</span> AS LONG, <span class=SpellE>ZamkniecieDokumentuInfo</span>
As XL <span class=SpellE>ZamkniecieDokumentuInfo</span>) AS LONG<span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoNormalIndent><span style='color:black'>&nbsp;</span></p>

<p class=MsoNormalIndent><span style='color:black'>Funkcja odpowiada za
zamkniêcie i zapisanie do bazy danych dokumentu zainicjowanego funkcj¹ <span
class=SpellE>XLNowyDokument</span>. Jego zamkniecie zdalne, lub wyœwietlenie
formy dokumentu na ekranie w celu udostêpnienia sprawdzenia lub korekty.
Odpowiada funkcjonalnie naciœniêciu przez operatora przycisku „Dyskietka” na
formatce edytowanego dokumentu. Na czas dzia³ania tej funkcji mo¿e zostaæ
otwarta transakcja o ile Tryb tego dokumentu wskazuje na „wsadowy”. Funkcja ta
dope³nia p³atnoœci, jeœli Tryb jest ustawiony na „wsadowy” i typ dokumentu
wskazuje na dokument zewnêtrzny.</span></p>

<p class=MsoNormalIndent><span style='color:black'>Jeœli parametr Tryb ma
wartoœæ 1 to dokument idzie do bufora, jeœli jest 0 to dokument zostaje
zatwierdzony.</span></p>

<p class=MsoNormalIndent><span style='color:black'>Mo¿liwe jest tak¿e
skasowanie dokumentu, podaj¹c<span style='mso-spacerun:yes'>  </span>–1 jako
wartoœæ parametru Tryb.</span></p>

<p class=MsoNormalIndent><span style='color:black'>Poprzez przekazywan¹ do
funkcji strukturê nastêpuje równie¿ zwrócenie <span class=SpellE>GID’u</span>
zamykanego dokumentu – pozwala to na wykonywanie dalszych akcji z dokumentem
(np. wydruk).</span></p>

<p class=MsoNormalIndent><span style='color:black'>W celu anulowania dokumentu
nale¿y u¿yæ funkcji <span class=SpellE>XLZamknijDokument</span> podaj¹c typ,
numer dokumentu oraz tryb = -2. Nie nale¿y u¿ywaæ funkcji <span class=SpellE>XLOtworzDokument</span>.</span></p>

<p class=MsoNormalIndent><span style='color:black'>W wersji 2015.1 funkcja <span
class=SpellE>XLZamknijDokument</span> ma mo¿liwoœæ zamykania dokumentu z
ustalonym kosztem. Aby ustaliæ koszt na dokumencie, nale¿y go otworzyæ za
pomoc¹ <span class=SpellE>XLOtworzDokument</span>, nastêpnie <span
class=SpellE>poprzed</span> <span class=SpellE>XLModyfikujPozycje</span>
przesy³amy odpowiednie wartoœci z poprawnym kosztem, a na koniec zamykamy
dokument <span class=SpellE>XLZamknijDokument</span> w trybie -5.</span></p>

<p class=MsoNormalIndent><span style='color:black'>Dla trybu anuluj w <span
class=SpellE>XLZamknijDokument</span> mo¿na wykorzystywaæ szósty parametr,
który np. przy trybie zatwierdŸ s³u¿y do sterowania dokumentami magazynowymi. W
trybie anuluj ustawienie go na 1 spowoduje, ¿e dokument handlowy zostanie
anulowany bez dokumentów magazynowych.</span></p>


</div>







</body>

</html>
